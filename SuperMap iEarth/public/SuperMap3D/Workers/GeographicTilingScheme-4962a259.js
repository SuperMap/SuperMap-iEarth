define(["exports","./Cartesian2-21b2f76f","./Check-52a7d806","./when-92c6cf3c","./buildModuleUrl-d80eb436","./Math-ecf82623"],(function(e,t,i,s,n,o){"use strict";function r(e){e=s.u(e,{}),this._ellipsoid=s.u(e.ellipsoid,t.t.WGS84),this._rectangle=s.u(e.rectangle,t.h.MAX_VALUE),this._projection=new n.n(this._ellipsoid),this._numberOfLevelZeroTilesX=s.u(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=s.u(e.numberOfLevelZeroTilesY,1),this._customDPI=e.customDPI,this._scaleDenominators=e.scaleDenominators,this._tileWidth=s.u(e.tileWidth,256),this._tileHeight=s.u(e.tileHeight,256),this._beginLevel=s.u(e.beginLevel,0),this._origin=s.u(e.origin,void 0)}Object.defineProperties(r.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}},beginLevel:{get:function(){return this._beginLevel}},origin:{get:function(){return this._origin}}}),r.prototype.getNumberOfXTilesAtLevel=function(e){if(s.e(this._customDPI)&&s.e(this._scaleDenominators)){var t=this.calculateResolution(e),i=this._tileWidth*t.x;return Math.ceil(this._rectangle.width/i)}return this._numberOfLevelZeroTilesX<<e-this._beginLevel},r.prototype.getNumberOfYTilesAtLevel=function(e){if(s.e(this._customDPI)&&s.e(this._scaleDenominators)){var t=this.calculateResolution(e),i=this._tileHeight*t.y;return Math.ceil(this._rectangle.height/i)}return this._numberOfLevelZeroTilesY<<e-this._beginLevel},r.prototype.rectangleToNativeRectangle=function(e,n){i.o.defined("rectangle",e);var r=o.e.toDegrees(e.west),h=o.e.toDegrees(e.south),l=o.e.toDegrees(e.east),u=o.e.toDegrees(e.north);return s.e(n)?(n.west=r,n.south=h,n.east=l,n.north=u,n):new t.h(r,h,l,u)},r.prototype.tileXYToNativeRectangle=function(e,t,i,s){var n=this.tileXYToRectangle(e,t,i,s);return n.west=o.e.toDegrees(n.west),n.south=o.e.toDegrees(n.south),n.east=o.e.toDegrees(n.east),n.north=o.e.toDegrees(n.north),n},r.prototype.tileXYToRectangle=function(e,i,n,o){var r=this._rectangle,h=s.e(this._origin)?this._origin.longitude:r.west,l=s.e(this._origin)?this._origin.latitude:r.north;if(s.e(this._customDPI)&&s.e(this._scaleDenominators)){var u=this.calculateResolution(n),a=h+e*this._tileWidth*u.x,g=h+(e+1)*this._tileWidth*u.x,c=l-i*this._tileHeight*u.y,_=l-(i+1)*this._tileHeight*u.y;return s.e(o)?(o.west=a,o.south=_,o.east=g,o.north=c,o):new t.h(a,_,g,c)}var f=this.getNumberOfXTilesAtLevel(n),v=this.getNumberOfYTilesAtLevel(n),d=r.width/f,m=(a=e*d+r.west,g=(e+1)*d+r.west,r.height/v);c=r.north-i*m,_=r.north-(i+1)*m;return s.e(o)||(o=new t.h(a,_,g,c)),o.west=a,o.south=_,o.east=g,o.north=c,o},r.prototype.positionToTileXY=function(e,i,n){var r=this._rectangle;if(t.h.contains(r,e)){var h=this.getNumberOfXTilesAtLevel(i),l=this.getNumberOfYTilesAtLevel(i),u=s.e(this._origin)?this._origin.longitude:r.west,a=s.e(this._origin)?this._origin.latitude:r.north,g=r.width/h,c=r.height/l;if(s.e(this._customDPI)&&s.e(this._scaleDenominators)){var _=this.calculateResolution(i);g=this._tileWidth*_.x,c=this._tileHeight*_.y}var f=e.longitude;r.east<r.west&&(f+=o.e.TWO_PI),s.e(this._origin)&&(h+=this._origin.longitude!=r.west?Math.ceil((e.longitude-this._origin.longitude)/g):0,l+=this._origin.latitude!=r.north?Math.ceil((this._origin.latitude-e.latitude)/c):0);var v=(f-u)/g|0;v>=h&&(v=h-1);var d=(a-e.latitude)/c|0;return d>=l&&(d=l-1),s.e(n)?(n.x=v,n.y=d,n):new t.o(v,d)}},r.prototype.calculateResolution=function(e){var i=.0254*this._scaleDenominators[e-this._beginLevel]/this._customDPI.x,s=.0254*this._scaleDenominators[e-this._beginLevel]/this._customDPI.y,n=t.t.WGS84.maximumRadius;return new t.o(i/n,s/n)},e.g=r}));
