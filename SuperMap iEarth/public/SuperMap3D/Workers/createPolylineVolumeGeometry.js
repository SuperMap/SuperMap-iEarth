import{a as ne}from"./chunk-4BBYSOVM.js";import{a as ie,b as G}from"./chunk-MOZH5DHB.js";import"./chunk-PHVMFTD2.js";import"./chunk-XYWAVEQ2.js";import{a as j}from"./chunk-UWLNAHLB.js";import{a as L}from"./chunk-RYEDLSXB.js";import"./chunk-LA5E7NVT.js";import{a as re,b as H}from"./chunk-5MCHN7YC.js";import{a as oe}from"./chunk-D45ASFTR.js";import"./chunk-6X6ULKRC.js";import{a as Z}from"./chunk-JV52GS34.js";import"./chunk-MQMYX2JZ.js";import"./chunk-KW5QJXXE.js";import"./chunk-5YCA7L25.js";import"./chunk-4J7EQ5UP.js";import{a as ee}from"./chunk-44AFRGCG.js";import{a as x}from"./chunk-UIA2BV6O.js";import{d as $,k as I,l as M}from"./chunk-CWROUHP4.js";import"./chunk-NPAFDOYL.js";import{b as V}from"./chunk-F5UB2CPM.js";import{a as W}from"./chunk-SRPTWKHW.js";import"./chunk-6S43R6PL.js";import"./chunk-KJYJTW2V.js";import"./chunk-6NA2GRXE.js";import"./chunk-EHDXVZQM.js";import"./chunk-NLYLRNUA.js";import{a as D,b as s}from"./chunk-7TOCOFC3.js";import"./chunk-ZVKIUA3Y.js";import"./chunk-3HZNWEV7.js";import{a as l}from"./chunk-LBR6REQR.js";import{a as X}from"./chunk-GXFCHGTA.js";import{a as g}from"./chunk-UBHQMGET.js";import"./chunk-EDZQSM3T.js";import{a as C}from"./chunk-PJGSCWXZ.js";import{a as y}from"./chunk-NUC3LT2W.js";import"./chunk-SFC4FDPW.js";function pe(e,o,r,i){var f=e.combinedPositions,n=e.combinedLocalPositions,a=new x;i.position&&(a.position=new M({componentDatatype:W.DOUBLE,componentsPerAttribute:3,values:f}));var t=o.length,_=f.length/3,d=(_-t*2)/(t*2),E=H.triangulate(o),O=(d-1)*t*6+E.length*2,p=ee.createTypedArray(_,O),u,m,b,T,A,B,U=t*2,c=0;for(u=0;u<d-1;u++){for(m=0;m<t-1;m++)b=m*2+u*t*2,B=b+U,T=b+1,A=T+U,p[c++]=T,p[c++]=b,p[c++]=A,p[c++]=A,p[c++]=b,p[c++]=B;b=t*2-2+u*t*2,T=b+1,A=T+U,B=b+U,p[c++]=T,p[c++]=b,p[c++]=A,p[c++]=A,p[c++]=b,p[c++]=B}if(i.st||i.tangent||i.bitangent){var v=new Float32Array(_*2),K=1/(d-1),q=1/r.height,F=r.height/2,w,P,h=0;for(u=0;u<d;u++){for(w=u*K,P=q*(o[0].y+F),v[h++]=w,v[h++]=P,m=1;m<t;m++)P=q*(o[m].y+F),v[h++]=w,v[h++]=P,v[h++]=w,v[h++]=P;P=q*(o[0].y+F),v[h++]=w,v[h++]=P}for(m=0;m<t;m++)w=0,P=q*(o[m].y+F),v[h++]=w,v[h++]=P;for(m=0;m<t;m++)w=(d-1)*K,P=q*(o[m].y+F),v[h++]=w,v[h++]=P;a.st=new M({componentDatatype:W.FLOAT,componentsPerAttribute:2,values:new Float32Array(v)})}var S=_-t*2;for(u=0;u<E.length;u+=3){var Y=E[u]+S,z=E[u+1]+S,Q=E[u+2]+S;p[c++]=Y,p[c++]=z,p[c++]=Q,p[c++]=Q+t,p[c++]=z+t,p[c++]=Y+t}var k=new I({attributes:a,indices:p,boundingSphere:$.fromVertices(f),primitiveType:V.TRIANGLES});if(i.normal&&(k=Z.computeNormal(k)),i.tangent||i.bitangent){try{k=Z.computeTangentAndBitangent(k)}catch{ne("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}i.tangent||(k.attributes.tangent=void 0),i.bitangent||(k.attributes.bitangent=void 0),i.st||(k.attributes.st=void 0)}return y(n)&&(k.attributes.position.values=n,k.attributes.position.componentDatatype=W.FLOAT),k}function N(e){e=g(e,g.EMPTY_OBJECT);var o=e.polylinePositions,r=e.shapePositions;if(!y(o))throw new C("options.polylinePositions is required.");if(!y(r))throw new C("options.shapePositions is required.");this._positions=o,this._shape=r,this._ellipsoid=s.clone(g(e.ellipsoid,s.WGS84)),this._cornerType=g(e.cornerType,ie.ROUNDED),this._vertexFormat=L.clone(g(e.vertexFormat,L.DEFAULT)),this._granularity=g(e.granularity,X.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry",this.enuCenter=g(e.enuCenter,l.ZERO);var i=1+o.length*l.packedLength;i+=1+r.length*D.packedLength+l.packedLength,this.packedLength=i+s.packedLength+L.packedLength+2}N.pack=function(e,o,r){if(!y(e))throw new C("value is required");if(!y(o))throw new C("array is required");r=g(r,0);var i,f=e._positions,n=f.length;for(o[r++]=n,i=0;i<n;++i,r+=l.packedLength)l.pack(f[i],o,r);var a=e._shape;for(n=a.length,o[r++]=n,i=0;i<n;++i,r+=D.packedLength)D.pack(a[i],o,r);return s.pack(e._ellipsoid,o,r),r+=s.packedLength,L.pack(e._vertexFormat,o,r),r+=L.packedLength,o[r++]=e._cornerType,o[r++]=e._granularity,l.pack(e.enuCenter,o,r),o};var te=s.clone(s.UNIT_SPHERE),ae=new L,R={polylinePositions:void 0,shapePositions:void 0,ellipsoid:te,vertexFormat:ae,cornerType:void 0,granularity:void 0,enuCenter:void 0};N.unpack=function(e,o,r){if(!y(e))throw new C("array is required");o=g(o,0);var i,f=e[o++],n=new Array(f);for(i=0;i<f;++i,o+=l.packedLength)n[i]=l.unpack(e,o);f=e[o++];var a=new Array(f);for(i=0;i<f;++i,o+=D.packedLength)a[i]=D.unpack(e,o);var t=s.unpack(e,o,te);o+=s.packedLength;var _=L.unpack(e,o,ae);o+=L.packedLength;var d=e[o++],E=e[o++],O;return O=l.unpack(e,o),y(r)?(r._positions=n,r._shape=a,r._ellipsoid=s.clone(t,r._ellipsoid),r._vertexFormat=L.clone(_,r._vertexFormat),r._cornerType=d,r._granularity=E,r.enuCenter=O,r):(R.polylinePositions=n,R.shapePositions=a,R.cornerType=d,R.granularity=E,R.enuCenter=O,new N(R))};var ce=new j;N.createGeometry=function(e){for(var o=e._positions,r=oe(o,l.equalsEpsilon),i=r.length,f=new Array(i),n=0;n<i;n++)f[n]=l.clone(r[n]);var a=e._shape;if(a=G.removeDuplicatesFromShape(a),!(r.length<2||a.length<3)){H.computeWindingOrder2D(a)===re.CLOCKWISE&&a.reverse();var t=j.fromPoints(a,ce),_={};if(_.combinedPositions=G.computePositions(f,a,t,e,!0),!l.equals(e.enuCenter,l.ZERO)){for(var d=new Array(i),n=0;n<i;n++)d[n]=l.clone(r[n]);_.combinedLocalPositions=G.computeLocalPositions(d,a,t,e,!0,e.enuCenter)}return pe(_,a,t,e._vertexFormat)}};var J=N;function me(e,o){return y(o)&&(e=J.unpack(e,o)),e._ellipsoid=s.clone(e._ellipsoid),J.createGeometry(e)}var Ge=me;export{Ge as default};
