define(["./when-92c6cf3c","./Cartesian2-21b2f76f","./arrayRemoveDuplicates-a6924649","./BoundingRectangle-0a941599","./buildModuleUrl-d80eb436","./Cartesian3-fecb63f1","./ComponentDatatype-98414d16","./PolylineVolumeGeometryLibrary-55e1d5bb","./Check-52a7d806","./GeometryAttribute-60174428","./GeometryAttributes-7f66ea53","./GeometryPipeline-003a7e33","./IndexDatatype-86677ec4","./Math-ecf82623","./PolygonPipeline-d4333960","./FeatureDetection-7479e310","./VertexFormat-f496a3f1","./Cartographic-d606c511","./Event-3390cd7d","./RuntimeError-c6a62a80","./WebGLConstants-42651efd","./Cartesian4-72b88c9e","./EllipsoidTangentPlane-8fa0b2bb","./IntersectionTests-d75410df","./Plane-11c91fbf","./PolylinePipeline-90e3316e","./EllipsoidGeodesic-8e4b8fdd","./EllipsoidRhumbLine-79383554","./AttributeCompression-e8590010","./EncodedCartesian3-cea7f70b"],(function(e,t,n,o,r,i,a,s,p,c,l,u,d,h,y,g,f,m,v,b,k,_,P,L,w,C,E,A,D,T){"use strict";function F(n){var o=(n=e.u(n,e.u.EMPTY_OBJECT)).polylinePositions,r=n.shapePositions;if(!e.e(o))throw new p.t("options.polylinePositions is required.");if(!e.e(r))throw new p.t("options.shapePositions is required.");this._positions=o,this._shape=r,this._ellipsoid=t.t.clone(e.u(n.ellipsoid,t.t.WGS84)),this._cornerType=e.u(n.cornerType,s.S.ROUNDED),this._vertexFormat=f.n.clone(e.u(n.vertexFormat,f.n.DEFAULT)),this._granularity=e.u(n.granularity,h.e.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry",this.enuCenter=e.u(n.enuCenter,i.o.ZERO);var a=1+o.length*i.o.packedLength;a+=1+r.length*t.o.packedLength+i.o.packedLength,this.packedLength=a+t.t.packedLength+f.n.packedLength+2}F.pack=function(n,o,r){if(!e.e(n))throw new p.t("value is required");if(!e.e(o))throw new p.t("array is required");r=e.u(r,0);var a,s=n._positions,c=s.length;for(o[r++]=c,a=0;a<c;++a,r+=i.o.packedLength)i.o.pack(s[a],o,r);var l=n._shape;for(c=l.length,o[r++]=c,a=0;a<c;++a,r+=t.o.packedLength)t.o.pack(l[a],o,r);return t.t.pack(n._ellipsoid,o,r),r+=t.t.packedLength,f.n.pack(n._vertexFormat,o,r),r+=f.n.packedLength,o[r++]=n._cornerType,o[r++]=n._granularity,i.o.pack(n.enuCenter,o,r),o};var G=t.t.clone(t.t.UNIT_SPHERE),R=new f.n,x={polylinePositions:void 0,shapePositions:void 0,ellipsoid:G,vertexFormat:R,cornerType:void 0,granularity:void 0,enuCenter:void 0};F.unpack=function(n,o,r){if(!e.e(n))throw new p.t("array is required");o=e.u(o,0);var a,s=n[o++],c=new Array(s);for(a=0;a<s;++a,o+=i.o.packedLength)c[a]=i.o.unpack(n,o);s=n[o++];var l=new Array(s);for(a=0;a<s;++a,o+=t.o.packedLength)l[a]=t.o.unpack(n,o);var u=t.t.unpack(n,o,G);o+=t.t.packedLength;var d=f.n.unpack(n,o,R);o+=f.n.packedLength;var h,y=n[o++],g=n[o++];return h=i.o.unpack(n,o),e.e(r)?(r._positions=c,r._shape=l,r._ellipsoid=t.t.clone(u,r._ellipsoid),r._vertexFormat=f.n.clone(d,r._vertexFormat),r._cornerType=y,r._granularity=g,r.enuCenter=h,r):(x.polylinePositions=c,x.shapePositions=l,x.cornerType=y,x.granularity=g,x.enuCenter=h,new F(x))};var O=new o.f;return F.createGeometry=function(t){for(var p=t._positions,h=n.D(p,i.o.equalsEpsilon),f=h.length,m=new Array(f),v=0;v<f;v++)m[v]=i.o.clone(h[v]);var b=t._shape;if(b=s.J.removeDuplicatesFromShape(b),!(h.length<2||b.length<3)){y.A.computeWindingOrder2D(b)===y.W.CLOCKWISE&&b.reverse();var k=o.f.fromPoints(b,O),_={};if(_.combinedPositions=s.J.computePositions(m,b,k,t,!0),!i.o.equals(t.enuCenter,i.o.ZERO)){var P=new Array(f);for(v=0;v<f;v++)P[v]=i.o.clone(h[v]);_.combinedLocalPositions=s.J.computeLocalPositions(P,b,k,t,!0,t.enuCenter)}return function(t,n,o,i){var s=t.combinedPositions,p=t.combinedLocalPositions,h=new l.a;i.position&&(h.position=new c.o({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:s}));var f,m,v,b,k,_,P=n.length,L=s.length/3,w=(L-2*P)/(2*P),C=y.A.triangulate(n),E=(w-1)*P*6+2*C.length,A=d.IndexDatatype.createTypedArray(L,E),D=2*P,T=0;for(f=0;f<w-1;f++){for(m=0;m<P-1;m++)_=(v=2*m+f*P*2)+D,k=(b=v+1)+D,A[T++]=b,A[T++]=v,A[T++]=k,A[T++]=k,A[T++]=v,A[T++]=_;k=(b=1+(v=2*P-2+f*P*2))+D,_=v+D,A[T++]=b,A[T++]=v,A[T++]=k,A[T++]=k,A[T++]=v,A[T++]=_}if(i.st||i.tangent||i.bitangent){var F,G,R=new Float32Array(2*L),x=1/(w-1),O=1/o.height,I=o.height/2,S=0;for(f=0;f<w;f++){for(F=f*x,G=O*(n[0].y+I),R[S++]=F,R[S++]=G,m=1;m<P;m++)G=O*(n[m].y+I),R[S++]=F,R[S++]=G,R[S++]=F,R[S++]=G;G=O*(n[0].y+I),R[S++]=F,R[S++]=G}for(m=0;m<P;m++)F=0,G=O*(n[m].y+I),R[S++]=F,R[S++]=G;for(m=0;m<P;m++)F=(w-1)*x,G=O*(n[m].y+I),R[S++]=F,R[S++]=G;h.st=new c.o({componentDatatype:a.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array(R)})}var q=L-2*P;for(f=0;f<C.length;f+=3){var N=C[f]+q,U=C[f+1]+q,W=C[f+2]+q;A[T++]=N,A[T++]=U,A[T++]=W,A[T++]=W+P,A[T++]=U+P,A[T++]=N+P}var B=new c.I({attributes:h,indices:A,boundingSphere:r.i.fromVertices(s),primitiveType:g._0x5eacd0.TRIANGLES});if(i.normal&&(B=u.k.computeNormal(B)),i.tangent||i.bitangent){try{B=u.k.computeTangentAndBitangent(B)}catch{r.e("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}i.tangent||(B.attributes.tangent=void 0),i.bitangent||(B.attributes.bitangent=void 0),i.st||(B.attributes.st=void 0)}return e.e(p)&&(B.attributes.position.values=p,B.attributes.position.componentDatatype=a.ComponentDatatype.FLOAT),B}(_,b,k,t._vertexFormat)}},function(n,o){return e.e(o)&&(n=F.unpack(n,o)),n._ellipsoid=t.t.clone(n._ellipsoid),F.createGeometry(n)}}));
