define(["./buildModuleUrl-cbcc8c56","./BoxGeometry-74de4379","./Cartesian3-3a8bdb0b","./Color-b1bd525f","./CylinderGeometry-9e5c168d","./when-92c6cf3c","./EllipsoidGeometry-19d6e145","./IndexDatatype-86677ec4","./FeatureDetection-fd297af4","./createTaskProcessorWorker","./Cartographic-a2c313d7","./Check-52a7d806","./Math-ecf82623","./Cartesian2-b72655a5","./Event-3390cd7d","./RuntimeError-c6a62a80","./arrayFill-0358accf","./ComponentDatatype-98414d16","./WebGLConstants-42651efd","./GeometryAttribute-65cf868d","./Cartesian4-72b88c9e","./GeometryAttributes-7f66ea53","./GeometryOffsetAttribute-b4d599f5","./VertexFormat-f496a3f1","./CylinderGeometryLibrary-60eef4da"],(function(e,t,n,r,a,o,i,c,d,s,f,l,u,h,p,b,y,v,g,m,x,I,k,w,A){"use strict";function B(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}var O=new n.o,C=d.p.packedLength+n.o.packedLength,L=d.p.packedLength+2,E=d.p.packedLength+n.o.packedLength,U=n.o.packedLength+1,M={modelMatrix:new d.p,boundingVolume:new e.i};function F(e,t){var r=t*C,a=n.o.unpack(e,r,O);r+=n.o.packedLength;var o=d.p.unpack(e,r,M.modelMatrix);d.p.multiplyByScale(o,a,o);var i=M.boundingVolume;return n.o.clone(n.o.ZERO,i.center),i.radius=Math.sqrt(3),M}function V(e,t){var r=t*L,a=e[r++],o=e[r++],i=n.o.fromElements(a,a,o,O),c=d.p.unpack(e,r,M.modelMatrix);d.p.multiplyByScale(c,i,c);var s=M.boundingVolume;return n.o.clone(n.o.ZERO,s.center),s.radius=Math.sqrt(2),M}function G(e,t){var r=t*E,a=n.o.unpack(e,r,O);r+=n.o.packedLength;var o=d.p.unpack(e,r,M.modelMatrix);d.p.multiplyByScale(o,a,o);var i=M.boundingVolume;return n.o.clone(n.o.ZERO,i.center),i.radius=1,M}function T(e,t){var r=t*U,a=e[r++],o=n.o.unpack(e,r,O),i=d.p.fromTranslation(o,M.modelMatrix);d.p.multiplyByUniformScale(i,a,i);var c=M.boundingVolume;return n.o.clone(n.o.ZERO,c.center),c.radius=1,M}var R=new n.o;function S(t,a,i,c,s){if(o.e(a)){for(var f=i.length,l=c.attributes.position.values,u=c.indices,h=t.positions,p=t.vertexBatchIds,b=t.indices,y=t.batchIds,v=t.batchTableColors,g=t.batchedIndices,m=t.indexOffsets,x=t.indexCounts,I=t.boundingVolumes,k=t.modelMatrix,w=t.center,A=t.positionOffset,O=t.batchIdIndex,C=t.indexOffset,L=t.batchedIndicesOffset,E=0;E<f;++E){var U=s(a,E),M=U.modelMatrix;d.p.multiply(k,M,M);for(var F=i[E],V=l.length,G=0;G<V;G+=3){var T=n.o.unpack(l,G,R);d.p.multiplyByPoint(M,T,T),n.o.subtract(T,w,T),n.o.pack(T,h,3*A+G),p[O++]=F}for(var S=u.length,D=0;D<S;++D)b[C+D]=u[D]+A;var Z=E+L;g[Z]=new B({offset:C,count:S,color:r.e.fromRgba(v[F]),batchIds:[F]}),y[Z]=F,m[Z]=C,x[Z]=S,I[Z]=e.i.transform(U.boundingVolume,M),A+=V/3,C+=S}t.positionOffset=A,t.batchIdIndex=O,t.indexOffset=C,t.batchedIndicesOffset+=f}}var D=new n.o,Z=new d.p;function P(t,n,a){var o=a.length,i=2+o*e.i.packedLength+1+function(e){for(var t=e.length,n=0,a=0;a<t;++a)n+=r.e.packedLength+3+e[a].batchIds.length;return n}(n),c=new Float64Array(i),d=0;c[d++]=t,c[d++]=o;for(var s=0;s<o;++s)e.i.pack(a[s],c,d),d+=e.i.packedLength;var f=n.length;c[d++]=f;for(var l=0;l<f;++l){var u=n[l];r.e.pack(u.color,c,d),d+=r.e.packedLength,c[d++]=u.offset,c[d++]=u.count;var h=u.batchIds,p=h.length;c[d++]=p;for(var b=0;b<p;++b)c[d++]=h[b]}return c}return s((function(e,r){var s=o.e(e.boxes)?new Float32Array(e.boxes):void 0,f=o.e(e.boxBatchIds)?new Uint16Array(e.boxBatchIds):void 0,l=o.e(e.cylinders)?new Float32Array(e.cylinders):void 0,u=o.e(e.cylinderBatchIds)?new Uint16Array(e.cylinderBatchIds):void 0,h=o.e(e.ellipsoids)?new Float32Array(e.ellipsoids):void 0,p=o.e(e.ellipsoidBatchIds)?new Uint16Array(e.ellipsoidBatchIds):void 0,b=o.e(e.spheres)?new Float32Array(e.spheres):void 0,y=o.e(e.sphereBatchIds)?new Uint16Array(e.sphereBatchIds):void 0,v=o.e(s)?f.length:0,g=o.e(l)?u.length:0,m=o.e(h)?p.length:0,x=o.e(b)?y.length:0,I=t.O.getUnitBox(),k=a.l.getUnitCylinder(),w=i.b.getUnitEllipsoid(),A=I.attributes.position.values,B=k.attributes.position.values,O=w.attributes.position.values,C=A.length*v;C+=B.length*g,C+=O.length*(m+x);var L=I.indices,E=k.indices,U=w.indices,M=L.length*v;M+=E.length*g,M+=U.length*(m+x);var R=new Float32Array(C),q=new Uint16Array(C/3),W=c.IndexDatatype.createTypedArray(C/3,M),_=v+g+m+x,N=new Uint16Array(_),Y=new Array(_),j=new Uint32Array(_),z=new Uint32Array(_),H=new Array(_);!function(e){var t=new Float64Array(e),r=0;n.o.unpack(t,r,D),r+=n.o.packedLength,d.p.unpack(t,r,Z)}(e.packedBuffer);var J={batchTableColors:new Uint32Array(e.batchTableColors),positions:R,vertexBatchIds:q,indices:W,batchIds:N,batchedIndices:Y,indexOffsets:j,indexCounts:z,boundingVolumes:H,positionOffset:0,batchIdIndex:0,indexOffset:0,batchedIndicesOffset:0,modelMatrix:Z,center:D};S(J,s,f,I,F),S(J,l,u,k,V),S(J,h,p,w,G),S(J,b,y,w,T);var K=P(W.BYTES_PER_ELEMENT,Y,H);return r.push(R.buffer,q.buffer,W.buffer),r.push(N.buffer,j.buffer,z.buffer),r.push(K.buffer),{positions:R.buffer,vertexBatchIds:q.buffer,indices:W.buffer,indexOffsets:j.buffer,indexCounts:z.buffer,batchIds:N.buffer,packedBuffer:K.buffer}}))}));
