!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e,t=(e=!0,function(t,r){var n=e?function(){if(r){var e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}),r=t(void 0,(function(){return r.toString().search("(((.+)+)+)+$").toString().constructor(r).search("(((.+)+)+)+$")}));r();function n(e,t,r){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var i=new Int32Array(this.arrayBuffer);e=i[0],t=i[1],r=i[2],this.d=t+2*r;for(var o=0;o<this.d*this.d;o++){var s=i[3+o],a=i[3+o+1];n.push(s===a?null:i.subarray(s,a))}var u=i[3+n.length],c=i[3+n.length+1];this.keys=i.subarray(u,c),this.bboxes=i.subarray(c),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var l=0;l<this.d*this.d;l++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var h=r/t*e;this.min=-h,this.max=e+h}n.prototype.insert=function(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(e,t,r,n,i,o){this.cells[i].push(o)},n.prototype.query=function(e,t,r,n,i){var o=this.min,s=this.max;if(e<=o&&t<=o&&s<=r&&s<=n&&!i)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(e,t,r,n,this._queryCell,a,{},i),a},n.prototype._queryCell=function(e,t,r,n,i,o,s,a){var u=this.cells[i];if(null!==u)for(var c=this.keys,l=this.bboxes,h=0;h<u.length;h++){var p=u[h];if(void 0===s[p]){var f=4*p;(a?a(l[f+0],l[f+1],l[f+2],l[f+3]):e<=l[f+2]&&t<=l[f+3]&&r>=l[f+0]&&n>=l[f+1])?(s[p]=!0,o.push(c[p])):s[p]=!1}}},n.prototype._forEachCell=function(e,t,r,n,i,o,s,a){for(var u=this._convertToCellCoord(e),c=this._convertToCellCoord(t),l=this._convertToCellCoord(r),h=this._convertToCellCoord(n),p=u;p<=l;p++)for(var f=c;f<=h;f++){var d=this.d*f+p;if((!a||a(this._convertFromCellCoord(p),this._convertFromCellCoord(f),this._convertFromCellCoord(p+1),this._convertFromCellCoord(f+1)))&&i.call(this,e,t,r,n,d,o,s,a))return}},n.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},n.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var i=new Int32Array(t+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=t,s=0;s<e.length;s++){var a=e[s];i[3+s]=o,i.set(a,o),o+=a.length}return i[3+e.length]=o,i.set(this.keys,o),o+=this.keys.length,i[3+e.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};var i,o=(i=!0,function(e,t){var r=i?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return i=!1,r}),s=o(void 0,(function(){return s.toString().search("(((.+)+)+)+$").toString().constructor(s).search("(((.+)+)+)+$")}));s();var a={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(e){return(e=Math.round(e))<0?0:e>255?255:e}function h(e){return e<0?0:e>1?1:e}function p(e){return"%"===e[e.length-1]?l(parseFloat(e)/100*255):l(parseInt(e))}function d(e){return"%"===e[e.length-1]?h(parseFloat(e)/100):h(parseFloat(e))}function A(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}const _=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),m=_(void 0,(function(){return m.toString().search("(((.+)+)+)+$").toString().constructor(m).search("(((.+)+)+)+$")}));m();class y{constructor(e,t,r,n=1){this.r=e,this.g=t,this.b=r,this.a=n}static parse(e){if(!e)return;if(e instanceof y)return e;if("string"!=typeof e)return;const t=function(e){var t,r=e.replace(/ /g,"").toLowerCase();if(r in a)return a[r].slice();if("#"===r[0])return 4===r.length?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===r.length&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var n=r.indexOf("("),i=r.indexOf(")");if(-1!==n&&i+1===r.length){var o=r.substr(0,n),s=r.substr(n+1,i-(n+1)).split(","),u=1;switch(o){case"rgba":if(4!==s.length)return null;u=d(s.pop());case"rgb":return 3!==s.length?null:[p(s[0]),p(s[1]),p(s[2]),u];case"hsla":if(4!==s.length)return null;u=d(s.pop());case"hsl":if(3!==s.length)return null;var c=(parseFloat(s[0])%360+360)%360/360,h=d(s[1]),f=d(s[2]),g=f<=.5?f*(h+1):f+h-f*h,_=2*f-g;return[l(255*A(_,g,c+1/3)),l(255*A(_,g,c)),l(255*A(_,g,c-1/3)),u];default:return null}}return null}(e);return t?new y(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]):void 0}toString(){const[e,t,r,n]=this.toArray();return"rgba("+Math.round(e)+","+Math.round(t)+","+Math.round(r)+","+n+")"}toArray(){const{r:e,g:t,b:r,a:n}=this;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*r/n,n]}}y.black=new y(0,0,0,1),y.white=new y(1,1,1,1),y.transparent=new y(0,0,0,0),y.red=new y(1,0,0,1);const E=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),x=E(void 0,(function(){return x.toString().search("(((.+)+)+)+$").toString().constructor(x).search("(((.+)+)+)+$")}));function b(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}x();var I=function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));function i(t,r){e.call(this,r),this.message=r,this.key=t}return n(),e&&(i.__proto__=e),i.prototype=Object.create(e&&e.prototype),i.prototype.constructor=i,i}(Error);const v=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),T=v(void 0,(function(){return T.toString().search("(((.+)+)+)+$").toString().constructor(T).search("(((.+)+)+)+$")}));T();class R{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[e,r]of t)this.bindings[e]=r}concat(e){return new R(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const S={kind:"null"},M={kind:"number"},w={kind:"string"},B={kind:"boolean"},O={kind:"color"},F={kind:"object"},P={kind:"value"},N={kind:"collator"},L={kind:"formatted"},U={kind:"resolvedImage"};function G(e,t){const r=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));return n(),{kind:"array",itemType:e,N:t}}function Q(e){if("array"===e.kind){const t=Q(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}return e.kind}const k=[S,M,w,B,O,L,F,G(P),U];function z(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!z(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of k)if(!z(e,t))return null}return"Expected "+Q(e)+" but found "+Q(t)+" instead."}function j(e,t){return t.some((t=>t.kind===e.kind))}function q(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}var V,Y=(V=!0,function(e,t){var r=V?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return V=!1,r}),X=Y(void 0,(function(){return X.toString().search("(((.+)+)+)+$").toString().constructor(X).search("(((.+)+)+)+$")}));X();var W=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};W.prototype.compare=function(e,t){return this.collator.compare(e,t)},W.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};const K=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),$=K(void 0,(function(){return $.toString().search("(((.+)+)+)+$").toString().constructor($).search("(((.+)+)+)+$")}));$();class J{constructor(e,t,r,n,i){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i}}class Z{constructor(e){this.sections=e}static fromString(e){return new Z([new J(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Z?e:Z.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}serialize(){const e=["format"];for(const t of this.sections){if(t.image){e.push(["image",t.image.name]);continue}e.push(t.text);const r={};t.fontStack&&(r["text-font"]=["literal",t.fontStack.split(",")]),t.scale&&(r["font-scale"]=t.scale),t.textColor&&(r["text-color"]=["rgba"].concat(t.textColor.toArray())),e.push(r)}return e}}var ee,te=(ee=!0,function(e,t){var r=ee?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return ee=!1,r}),re=te(void 0,(function(){return re.toString().search("(((.+)+)+)+$").toString().constructor(re).search("(((.+)+)+)+$")}));re();class ne{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ne({name:e,available:!1}):null}serialize(){return["image",this.name]}}const ie=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),oe=ie(void 0,(function(){return oe.toString().search("(((.+)+)+)+$").toString().constructor(oe).search("(((.+)+)+)+$")}));function se(e,t,r,n){if(!("number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255)){return"Invalid rgba value ["+("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[e,t,r,n].join(", ")+"]: 'a' must be between 0 and 1."}function ae(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof y)return!0;if(e instanceof W)return!0;if(e instanceof Z)return!0;if(e instanceof ne)return!0;if(Array.isArray(e)){for(const t of e)if(!ae(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!ae(e[t]))return!1;return!0}return!1}function ue(e){if(null===e)return S;if("string"==typeof e)return w;if("boolean"==typeof e)return B;if("number"==typeof e)return M;if(e instanceof y)return O;if(e instanceof W)return N;if(e instanceof Z)return L;if(e instanceof ne)return U;if(Array.isArray(e)){const t=e.length;let r;for(const t of e){const e=ue(t);if(r){if(r===e)continue;r=P;break}r=e}return G(r||P,t)}return F}function ce(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof y||e instanceof Z||e instanceof ne?e.toString():JSON.stringify(e)}oe();const le=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),he=le(void 0,(function(){return he.toString().search("(((.+)+)+)+$").toString().constructor(he).search("(((.+)+)+)+$")}));he();class pe{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!ae(e[1]))return t.error("invalid value");const r=e[1];let n=ue(r);const i=t.expectedType;return"array"===n.kind&&0===n.N&&i&&"array"===i.kind&&("number"!=typeof i.N||0===i.N)&&(n=i),new pe(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof y?["rgba"].concat(this.value.toArray()):this.value instanceof Z?this.value.serialize():this.value}}var fe,de=(fe=!0,function(e,t){var r=fe?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return fe=!1,r}),Ae=de(void 0,(function(){return Ae.toString().search("(((.+)+)+)+$").toString().constructor(Ae).search("(((.+)+)+)+$")}));Ae();var ge=function(e){this.name="ExpressionEvaluationError",this.message=e};ge.prototype.toJSON=function(){return this.message};const _e=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),me=_e(void 0,(function(){return me.toString().search("(((.+)+)+)+$").toString().constructor(me).search("(((.+)+)+)+$")}));me();const ye={string:w,number:M,boolean:B,object:F};class Ee{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const i=e[0];if("array"===i){let i,o;if(e.length>2){const r=e[1];if("string"!=typeof r||!(r in ye)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=ye[r],n++}else i=P;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],n++}r=G(i,o)}else r=ye[i];const o=[];for(;n<e.length;n++){const r=t.parse(e[n],n,P);if(!r)return null;o.push(r)}return new Ee(r,o)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e);if(!z(this.type,ue(r)))return r;if(t===this.args.length-1)throw new ge("Expected value to be of type "+Q(this.type)+", but found "+Q(ue(r))+" instead.")}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=this.type,t=[e.kind];if("array"===e.kind){const r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);const n=e.N;("number"==typeof n||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map((e=>e.serialize())))}}const xe=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Ce=xe(void 0,(function(){return Ce.toString().search("(((.+)+)+)+$").toString().constructor(Ce).search("(((.+)+)+)+$")}));Ce();class be{constructor(e){this.type=L,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");const n=[];let i=!1;for(let r=1;r<=e.length-1;++r){const o=e[r];if(i&&"object"==typeof o&&!Array.isArray(o)){i=!1;let e=null;if(o["font-scale"]&&(e=t.parse(o["font-scale"],1,M),!e))return null;let r=null;if(o["text-font"]&&(r=t.parse(o["text-font"],1,G(w)),!r))return null;let s=null;if(o["text-color"]&&(s=t.parse(o["text-color"],1,O),!s))return null;const a=n[n.length-1];a.scale=e,a.font=r,a.textColor=s}else{const o=t.parse(e[r],1,P);if(!o)return null;const s=o.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:o,scale:null,font:null,textColor:null})}}return new be(n)}evaluate(e){return new Z(this.sections.map((t=>{const r=t.content.evaluate(e);return ue(r)===U?new J("",r,null,null,null):new J(ce(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const t of this.sections){e.push(t.content.serialize());const r={};t.scale&&(r["font-scale"]=t.scale.serialize()),t.font&&(r["text-font"]=t.font.serialize()),t.textColor&&(r["text-color"]=t.textColor.serialize()),e.push(r)}return e}}const Ie=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),ve=Ie(void 0,(function(){return ve.toString().search("(((.+)+)+)+$").toString().constructor(ve).search("(((.+)+)+)+$")}));ve();class Te{constructor(e){this.type=U,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,w);return r?new Te(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=ne.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Re=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Se=Re(void 0,(function(){return Se.toString().search("(((.+)+)+)+$").toString().constructor(Se).search("(((.+)+)+)+$")}));Se();const Me={"to-boolean":B,"to-color":O,"to-number":M,"to-string":w};class we{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=Me[r],i=[];for(let r=1;r<e.length;r++){const n=t.parse(e[r],r,P);if(!n)return null;i.push(n)}return new we(n,i)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof y)return t;if("string"==typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":se(t[0],t[1],t[2],t[3]),!r))return new y(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ge(r||"Could not parse color from value '"+("string"==typeof t?t:String(JSON.stringify(t)))+"'")}if("number"===this.type.kind){let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new ge("Could not convert "+JSON.stringify(t)+" to number.")}return"formatted"===this.type.kind?Z.fromString(ce(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?ne.fromString(ce(this.args[0].evaluate(e))):ce(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new be([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Te(this.args[0]).serialize();const e=["to-"+this.type.kind];return this.eachChild((t=>{e.push(t.serialize())})),e}}const Be=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Oe=Be(void 0,(function(){return Oe.toString().search("(((.+)+)+)+$").toString().constructor(Oe).search("(((.+)+)+)+$")}));Oe();const De=["Unknown","Point","LineString","Polygon"];class Fe{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?De[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:r,y:n}=this.featureTileCoord,i=r*t-e[0],o=n*t-e[1];return this.featureDistanceData.bearing[0]*i+this.featureDistanceData.bearing[1]*o}return 0}parseColor(e){let t=this._parseColorCache[e];return!t&&(t=this._parseColorCache[e]=y.parse(e)),t}}const Pe=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Ne=Pe(void 0,(function(){return Ne.toString().search("(((.+)+)+)+$").toString().constructor(Ne).search("(((.+)+)+)+$")}));Ne();let Le={};class Ue{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((e=>e.serialize())))}static parse(e,t){const r=e[0],n=Le[r];if(!n)return t.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);const i=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=o.filter((([t])=>!Array.isArray(t)||t.length===e.length-1));let a=null;for(const[n,o]of s){a=new mt(t.registry,t.path,null,t.scope);const s=[];let u=!1;for(let t=1;t<e.length;t++){const r=e[t],i=Array.isArray(n)?n[t-1]:n.type,o=a.parse(r,1+s.length,i);if(!o){u=!0;break}s.push(o)}if(!u)if(Array.isArray(n)&&n.length!==s.length)a.error("Expected "+n.length+" arguments, but found "+s.length+" instead.");else{for(let e=0;e<s.length;e++){const t=Array.isArray(n)?n[e]:n.type,r=s[e];a.concat(e+1).checkSubtype(t,r.type)}if(0===a.errors.length)return new Ue(r,i,o,s)}}if(1===s.length)t.errors.push(...a.errors);else{const r=(s.length?s:o).map((([e])=>{return t=e,Array.isArray(t)?"("+t.map(Q).join(", ")+")":"("+Q(t.type)+"...)";var t})).join(" | "),n=[];for(let r=1;r<e.length;r++){const i=t.parse(e[r],1+n.length);if(!i)return null;n.push(Q(i.type))}t.error("Expected arguments of type "+r+", but found ("+n.join(", ")+") instead.")}return null}static register(e,t){Le=t;for(const r in t)e[r]=Ue}}const Ge=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Qe=Ge(void 0,(function(){return Qe.toString().search("(((.+)+)+)+$").toString().constructor(Qe).search("(((.+)+)+)+$")}));Qe();class ke{constructor(e,t,r){this.type=N,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,B);if(!n)return null;const i=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,B);if(!i)return null;let o=null;return r.locale&&(o=t.parse(r.locale,1,w),!o)?null:new ke(n,i,o)}evaluate(e){return new W(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const ze=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),je=ze(void 0,(function(){return je.toString().search("(((.+)+)+)+$").toString().constructor(je).search("(((.+)+)+)+$")}));je();const He=8192;function qe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Ve(e,t){return!(e[0]<=t[0])&&(!(e[2]>=t[2])&&(!(e[1]<=t[1])&&!(e[3]>=t[3])))}function Ye(e,t){const r=(180+e[0])/360,n=(o=e[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360),i=Math.pow(2,t.z);var o;return[Math.round(r*i*He),Math.round(n*i*He)]}function Xe(e,t,r){const n=e[0]-t[0],i=e[1]-t[1],o=e[0]-r[0],s=e[1]-r[1];return n*s-o*i==0&&n*o<=0&&i*s<=0}function We(e,t){let r=!1;for(let s=0,a=t.length;s<a;s++){const a=t[s];for(let t=0,s=a.length;t<s-1;t++){if(Xe(e,a[t],a[t+1]))return!1;n=e,i=a[t],o=a[t+1],i[1]>n[1]!=o[1]>n[1]&&n[0]<(o[0]-i[0])*(n[1]-i[1])/(o[1]-i[1])+i[0]&&(r=!r)}}var n,i,o;return r}function Ke(e,t){for(let r=0;r<t.length;r++)if(We(e,t[r]))return!0;return!1}function $e(e,t,r,n){const i=e[0]-r[0],o=e[1]-r[1],s=t[0]-r[0],a=t[1]-r[1],u=n[0]-r[0],c=n[1]-r[1],l=i*c-u*o,h=s*c-u*a;return l>0&&h<0||l<0&&h>0}function Je(e,t,r,n){const i=[t[0]-e[0],t[1]-e[1]],o=[n[0]-r[0],n[1]-r[1]];return 0!=(s=o)[0]*(a=i)[1]-s[1]*a[0]&&!(!$e(e,t,r,n)||!$e(r,n,e,t));var s,a}function Ze(e,t,r){for(const n of r)for(let r=0;r<n.length-1;++r)if(Je(e,t,n[r],n[r+1]))return!0;return!1}function et(e,t){for(let r=0;r<e.length;++r)if(!We(e[r],t))return!1;for(let r=0;r<e.length-1;++r)if(Ze(e[r],e[r+1],t))return!1;return!0}function tt(e,t){for(let r=0;r<t.length;r++)if(et(e,t[r]))return!0;return!1}function rt(e,t,r){const n=[];for(let i=0;i<e.length;i++){const o=[];for(let n=0;n<e[i].length;n++){const s=Ye(e[i][n],r);qe(t,s),o.push(s)}n.push(o)}return n}function nt(e,t,r){const n=[];for(let i=0;i<e.length;i++){const o=rt(e[i],t,r);n.push(o)}return n}function it(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let i=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===i&&(i=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=i}qe(t,e)}function ot(e,t,r,n){const i=Math.pow(2,n.z)*He,o=[n.x*He,n.y*He],s=[];if(!e)return s;for(const n of e)for(const e of n){const n=[e.x+o[0],e.y+o[1]];it(n,t,r,i),s.push(n)}return s}function st(e,t,r,n){const i=Math.pow(2,n.z)*He,o=[n.x*He,n.y*He],s=[];if(!e)return s;for(const r of e){const e=[];for(const n of r){const r=[n.x+o[0],n.y+o[1]];qe(t,r),e.push(r)}s.push(e)}if(t[2]-t[0]<=i/2){(a=t)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const e of s)for(const n of e)it(n,t,r,i)}var a;return s}class at{constructor(e,t){this.type=B,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(ae(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const r=t.features[e].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new at(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new at(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new at(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(!i)return!1;if("Polygon"===t.type){const o=rt(t.coordinates,n,i),s=ot(e.geometry(),r,n,i);if(!Ve(r,n))return!1;for(const e of s)if(!We(e,o))return!1}if("MultiPolygon"===t.type){const o=nt(t.coordinates,n,i),s=ot(e.geometry(),r,n,i);if(!Ve(r,n))return!1;for(const e of s)if(!Ke(e,o))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(!i)return!1;if("Polygon"===t.type){const o=rt(t.coordinates,n,i),s=st(e.geometry(),r,n,i);if(!Ve(r,n))return!1;for(const e of s)if(!et(e,o))return!1}if("MultiPolygon"===t.type){const o=nt(t.coordinates,n,i),s=st(e.geometry(),r,n,i);if(!Ve(r,n))return!1;for(const e of s)if(!tt(e,o))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const ut=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),ct=ut(void 0,(function(){return ct.toString().search("(((.+)+)+)+$").toString().constructor(ct).search("(((.+)+)+)+$")}));function lt(e){if(e instanceof Ue){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof at)return!1;let t=!0;return e.eachChild((e=>{t&&!lt(e)&&(t=!1)})),t}function ht(e){if(e instanceof Ue&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!ht(e)&&(t=!1)})),t}function pt(e,t){if(e instanceof Ue&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild((e=>{r&&!pt(e,t)&&(r=!1)})),r}ct();const ft=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),dt=ft(void 0,(function(){return dt.toString().search("(((.+)+)+)+$").toString().constructor(dt).search("(((.+)+)+)+$")}));dt();class At{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new At(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}const gt=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),_t=gt(void 0,(function(){return _t.toString().search("(((.+)+)+)+$").toString().constructor(_t).search("(((.+)+)+)+$")}));_t();class mt{constructor(e,t=[],r,n=new R,i=[]){this.registry=e,this.path=t,this.key=t.map((e=>"["+e+"]")).join(""),this.scope=n,this.errors=i,this.expectedType=r}parse(e,t,r,n,i={}){return t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)}_parse(e,t){function r(e,t,r){return"assert"===r?new Ee(t,[e]):"coerce"===r?new we(t,[e]):e}if((null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)&&(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+typeof n+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;const i=this.registry[n];if(i){let n=i.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,i=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==i.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==i.kind&&"string"!==i.kind){if(this.checkSubtype(e,i))return null}else n=r(n,e,t.typeAnnotation||"coerce");else n=r(n,e,t.typeAnnotation||"assert")}if(!(n instanceof pe)&&"resolvedImage"!==n.type.kind&&yt(n)){const e=new Fe;try{n=new pe(n.type,n.evaluate(e))}catch(e){return this.error(e.message),null}}return n}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===e?this.error("'undefined' value invalid. Use null instead."):"object"==typeof e?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof e+" instead.")}concat(e,t,r){const n="number"==typeof e?this.path.concat(e):this.path,i=r?this.scope.concat(r):this.scope;return new mt(this.registry,n,t||null,i,this.errors)}error(e,...t){const r=""+this.key+t.map((e=>"["+e+"]")).join("");this.errors.push(new I(r,e))}checkSubtype(e,t){const r=z(e,t);return r&&this.error(r),r}}function yt(e){if(e instanceof At)return yt(e.boundExpression);if(e instanceof Ue&&"error"===e.name)return!1;if(e instanceof ke)return!1;if(e instanceof at)return!1;const t=e instanceof we||e instanceof Ee;let r=!0;return e.eachChild((e=>{r=t?r&&yt(e):r&&e instanceof pe})),!!r&&(lt(e)&&pt(e,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]))}const Et=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),xt=Et(void 0,(function(){return xt.toString().search("(((.+)+)+)+$").toString().constructor(xt).search("(((.+)+)+)+$")}));function Ct(e,t){const r=e.length-1;let n,i,o=0,s=r,a=0;for(;o<=s;)if(a=Math.floor((o+s)/2),n=e[a],i=e[a+1],n<=t){if(a===r||t<i)return a;o=a+1}else{if(!(n>t))throw new ge("Input is not a number.");s=a-1}return 0}xt();const bt=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),It=bt(void 0,(function(){return It.toString().search("(((.+)+)+)+$").toString().constructor(It).search("(((.+)+)+)+$")}));It();class vt{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[e,t]of r)this.labels.push(e),this.outputs.push(t)}static parse(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,M);if(!r)return null;const n=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let r=1;r<e.length;r+=2){const o=1===r?-1/0:e[r],s=e[r+1],a=r,u=r+1;if("number"!=typeof o)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(n.length&&n[n.length-1][0]>=o)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=t.parse(s,u,i);if(!c)return null;i=i||c.type,n.push([o,c])}return new vt(i,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);return r[Ct(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){const e=["step",this.input.serialize()];for(let t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}var Tt,Rt=(Tt=!0,function(e,t){var r=Tt?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Tt=!1,r}),St=Rt(void 0,(function(){return St.toString().search("(((.+)+)+)+$").toString().constructor(St).search("(((.+)+)+)+$")}));function Mt(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}St(),Mt.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r-=i/o}var s=0,a=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?s=r:a=r,r=.5*(a-s)+s;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var wt,Bt=(wt=!0,function(e,t){var r=wt?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return wt=!1,r}),Ot=Bt(void 0,(function(){return Ot.toString().search("(((.+)+)+)+$").toString().constructor(Ot).search("(((.+)+)+)+$")}));function Dt(e,t,r){return e*(1-r)+t*r}Ot();var Ft=Object.freeze({__proto__:null,number:Dt,color:function(e,t,r){return new y(Dt(e.r,t.r,r),Dt(e.g,t.g,r),Dt(e.b,t.b,r),Dt(e.a,t.a,r))},array:function(e,t,r){return e.map(((e,n)=>Dt(e,t[n],r)))}});const Pt=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Nt=Pt(void 0,(function(){return Nt.toString().search("(((.+)+)+)+$").toString().constructor(Nt).search("(((.+)+)+)+$")}));Nt();const Lt=.95047,Ut=1.08883,Gt=4/29,Qt=6/29,kt=.12841854934601665,zt=Math.PI/180,jt=180/Math.PI;function Ht(e){return e>.008856451679035631?Math.pow(e,1/3):e/kt+Gt}function qt(e){return e>Qt?e*e*e:kt*(e-Gt)}function Vt(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Yt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Xt(e){const t=Yt(e.r),r=Yt(e.g),n=Yt(e.b),i=Ht((.4124564*t+.3575761*r+.1804375*n)/Lt),o=Ht((.2126729*t+.7151522*r+.072175*n)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-Ht((.0193339*t+.119192*r+.9503041*n)/Ut)),alpha:e.a}}function Wt(e){let t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*qt(t),r=Lt*qt(r),n=Ut*qt(n),new y(Vt(3.2404542*r-1.5371385*t-.4985314*n),Vt(-.969266*r+1.8760108*t+.041556*n),Vt(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}function Kt(e,t,r){const n=t-e;return e+r*(n>180||n<-180?n-360*Math.round(n/360):n)}const $t={forward:Xt,reverse:Wt,interpolate:function(e,t,r){return{l:Dt(e.l,t.l,r),a:Dt(e.a,t.a,r),b:Dt(e.b,t.b,r),alpha:Dt(e.alpha,t.alpha,r)}}},Jt={forward:function(e){const{l:t,a:r,b:n}=Xt(e),i=Math.atan2(n,r)*jt;return{h:i<0?i+360:i,c:Math.sqrt(r*r+n*n),l:t,alpha:e.a}},reverse:function(e){const t=e.h*zt,r=e.c;return Wt({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:Kt(e.h,t.h,r),c:Dt(e.c,t.c,r),l:Dt(e.l,t.l,r),alpha:Dt(e.alpha,t.alpha,r)}}};var Zt=Object.freeze({__proto__:null,lab:$t,hcl:Jt});const er=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),tr=er(void 0,(function(){return tr.toString().search("(((.+)+)+)+$").toString().constructor(tr).search("(((.+)+)+)+$")}));tr();class rr{constructor(e,t,r,n,i){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[e,t]of i)this.labels.push(e),this.outputs.push(t)}static interpolationFactor(e,t,r,n){let i=0;if("exponential"===e.name)i=nr(t,e.base,r,n);else if("linear"===e.name)i=nr(t,1,r,n);else if("cubic-bezier"===e.name){const o=e.controlPoints;i=new Mt(o[0],o[1],o[2],o[3]).solve(nr(t,1,r,n))}return i}static parse(e,t){let[r,n,i,...o]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error("Unknown interpolation type "+String(n[0]),1,0);{const e=n.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(i=t.parse(i,2,M),!i)return null;const s=[];let a=null;"interpolate-hcl"===r||"interpolate-lab"===r?a=O:t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType);for(let e=0;e<o.length;e+=2){const r=o[e],n=o[e+1],i=e+3,u=e+4;if("number"!=typeof r)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(s.length&&s[s.length-1][0]>=r)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const c=t.parse(n,u,a);if(!c)return null;a=a||c.type,s.push([r,c])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new rr(a,r,n,i,s):t.error("Type "+Q(a)+" is not interpolatable.")}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);const o=Ct(t,n),s=t[o],a=t[o+1],u=rr.interpolationFactor(this.interpolation,n,s,a),c=r[o].evaluate(e),l=r[o+1].evaluate(e);return"interpolate"===this.operator?Ft[this.type.kind.toLowerCase()](c,l,u):"interpolate-hcl"===this.operator?Jt.reverse(Jt.interpolate(Jt.forward(c),Jt.forward(l),u)):$t.reverse($t.interpolate($t.forward(c),$t.forward(l),u))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const t=[this.operator,e,this.input.serialize()];for(let e=0;e<this.labels.length;e++)t.push(this.labels[e],this.outputs[e].serialize());return t}}function nr(e,t,r,n){const i=n-r,o=e-r;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}const ir=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),or=ir(void 0,(function(){return or.toString().search("(((.+)+)+)+$").toString().constructor(or).search("(((.+)+)+)+$")}));or();class sr{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const i=[];for(const n of e.slice(1)){const e=t.parse(n,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,i.push(e)}const o=n&&i.some((e=>z(n,e.type)));return new sr(o?P:r,i)}evaluate(e){let t,r=null,n=0;for(const i of this.args){if(n++,r=i.evaluate(e),r&&r instanceof ne&&!r.available&&(!t&&(t=r),r=null,n===this.args.length))return t;if(null!==r)break}return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=["coalesce"];return this.eachChild((t=>{e.push(t.serialize())})),e}}const ar=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),ur=ar(void 0,(function(){return ur.toString().search("(((.+)+)+)+$").toString().constructor(ur).search("(((.+)+)+)+$")}));ur();class cr{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");const r=[];for(let n=1;n<e.length-1;n+=2){const i=e[n];if("string"!=typeof i)return t.error("Expected string, but found "+typeof i+" instead.",n);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);const o=t.parse(e[n+1],n+1);if(!o)return null;r.push([i,o])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new cr(r,n):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[t,r]of this.bindings)e.push(t,r.serialize());return e.push(this.result.serialize()),e}}const lr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),hr=lr(void 0,(function(){return hr.toString().search("(((.+)+)+)+$").toString().constructor(hr).search("(((.+)+)+)+$")}));hr();class pr{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");const r=t.parse(e[1],1,M),n=t.parse(e[2],2,G(t.expectedType||P));if(!r||!n)return null;const i=n.type;return new pr(i.itemType,r,n)}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new ge("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new ge("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new ge("Array index must be an integer, but found "+t+" instead.");return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}const fr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),dr=fr(void 0,(function(){return dr.toString().search("(((.+)+)+)+$").toString().constructor(dr).search("(((.+)+)+)+$")}));dr();class Ar{constructor(e,t){this.type=B,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");const r=t.parse(e[1],1,P),n=t.parse(e[2],2,P);return r&&n?j(r.type,[B,w,M,S,P])?new Ar(r,n):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Q(r.type)+" instead"):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(null==r)return!1;if(!q(t,["boolean","string","number","null"]))throw new ge("Expected first argument to be of type boolean, string, number or null, but found "+Q(ue(t))+" instead.");if(!q(r,["string","array"]))throw new ge("Expected second argument to be of type array or string, but found "+Q(ue(r))+" instead.");return r.indexOf(t)>=0}eachChild(){fn(this.needle),fn(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}const gr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),_r=gr(void 0,(function(){return _r.toString().search("(((.+)+)+)+$").toString().constructor(_r).search("(((.+)+)+)+$")}));_r();class mr{constructor(e,t,r){this.type=M,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");const r=t.parse(e[1],1,P),n=t.parse(e[2],2,P);if(!r||!n)return null;if(!j(r.type,[B,w,M,S,P]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Q(r.type)+" instead");if(4===e.length){const i=t.parse(e[3],3,M);return i?new mr(r,n,i):null}return new mr(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!q(t,["boolean","string","number","null"]))throw new ge("Expected first argument to be of type boolean, string, number or null, but found "+Q(ue(t))+" instead.");if(!q(r,["string","array"]))throw new ge("Expected second argument to be of type array or string, but found "+Q(ue(r))+" instead.");if(this.fromIndex){const n=this.fromIndex.evaluate(e);return r.indexOf(t,n)}return r.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}const yr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Er=yr(void 0,(function(){return Er.toString().search("(((.+)+)+)+$").toString().constructor(Er).search("(((.+)+)+)+$")}));Er();class xr{constructor(e,t,r,n,i,o){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const i={},o=[];for(let s=2;s<e.length-1;s+=2){let a=e[s];const u=e[s+1];!Array.isArray(a)&&(a=[a]);const c=t.concat(s);if(0===a.length)return c.error("Expected at least one branch label.");for(const e of a){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(r){if(c.checkSubtype(r,ue(e)))return null}else r=ue(e);if(void 0!==i[String(e)])return c.error("Branch labels must be unique.");i[String(e)]=o.length}const l=t.parse(u,s,n);if(!l)return null;n=n||l.type,o.push(l)}const s=t.parse(e[1],1,P);if(!s)return null;const a=t.parse(e[e.length-1],e.length-1,n);return a?"value"!==s.type.kind&&t.concat(1).checkSubtype(r,s.type)?null:new xr(r,n,s,i,o,a):null}evaluate(e){const t=this.input.evaluate(e);return(ue(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],t=Object.keys(this.cases).sort(),r=[],n={};for(const e of t){const t=n[this.cases[e]];void 0===t?(n[this.cases[e]]=r.length,r.push([this.cases[e],[e]])):r[t][1].push(e)}const i=e=>"number"===this.inputType.kind?Number(e):e;for(const[t,n]of r)1===n.length?e.push(i(n[0])):e.push(n.map(i)),e.push(this.outputs[t].serialize());return e.push(this.otherwise.serialize()),e}}const Cr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),br=Cr(void 0,(function(){return br.toString().search("(((.+)+)+)+$").toString().constructor(br).search("(((.+)+)+)+$")}));br();class Ir{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let i=1;i<e.length-1;i+=2){const o=t.parse(e[i],i,B);if(!o)return null;const s=t.parse(e[i+1],i+1,r);if(!s)return null;n.push([o,s]),r=r||s.type}const i=t.parse(e[e.length-1],e.length-1,r);return i?new Ir(r,n,i):null}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((([e,t])=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild((t=>{e.push(t.serialize())})),e}}const vr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Tr=vr(void 0,(function(){return Tr.toString().search("(((.+)+)+)+$").toString().constructor(Tr).search("(((.+)+)+)+$")}));Tr();class Rr{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");const r=t.parse(e[1],1,P),n=t.parse(e[2],2,M);if(!r||!n)return null;if(!j(r.type,[G(P),w,P]))return t.error("Expected first argument to be of type array or string, but found "+Q(r.type)+" instead");if(4===e.length){const i=t.parse(e[3],3,M);return i?new Rr(r.type,r,n,i):null}return new Rr(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!q(t,["string","array"]))throw new ge("Expected first argument to be of type array or string, but found "+Q(ue(t))+" instead.");if(this.endIndex){const n=this.endIndex.evaluate(e);return t.slice(r,n)}return t.slice(r)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Sr(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Mr(e,t,r,n){return 0===n.compare(t,r)}function wr(e,t,r){const n=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),i=n(this,(function(){return i.toString().search("(((.+)+)+)+$").toString().constructor(i).search("(((.+)+)+)+$")}));i();const o="=="!==e&&"!="!==e;return class n{constructor(e,t,r){this.type=B,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let i=t.parse(e[1],1,P);if(!i)return null;if(!Sr(r,i.type))return t.concat(1).error('"'+r+"\" comparisons are not supported for type '"+Q(i.type)+"'.");let s=t.parse(e[2],2,P);if(!s)return null;if(!Sr(r,s.type))return t.concat(2).error('"'+r+"\" comparisons are not supported for type '"+Q(s.type)+"'.");if(i.type.kind!==s.type.kind&&"value"!==i.type.kind&&"value"!==s.type.kind)return t.error("Cannot compare types '"+Q(i.type)+"' and '"+Q(s.type)+"'.");o&&("value"===i.type.kind&&"value"!==s.type.kind?i=new Ee(s.type,[i]):"value"!==i.type.kind&&"value"===s.type.kind&&(s=new Ee(i.type,[s])));let a=null;if(4===e.length){if("string"!==i.type.kind&&"string"!==s.type.kind&&"value"!==i.type.kind&&"value"!==s.type.kind)return t.error("Cannot use collator to compare non-string types.");if(a=t.parse(e[3],3,N),!a)return null}return new n(i,s,a)}evaluate(n){const i=this.lhs.evaluate(n),s=this.rhs.evaluate(n);if(o&&this.hasUntypedArgument){const t=ue(i),r=ue(s);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new ge('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+t.kind+", "+r.kind+") instead.")}if(this.collator&&!o&&this.hasUntypedArgument){const e=ue(i),r=ue(s);if("string"!==e.kind||"string"!==r.kind)return t(n,i,s)}return this.collator?r(n,i,s,this.collator.evaluate(n)):t(n,i,s)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}serialize(){const t=[e];return this.eachChild((e=>{t.push(e.serialize())})),t}}}const Br=wr("==",(function(e,t,r){return t===r}),Mr),Or=wr("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!Mr(0,t,r,n)})),Dr=wr("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),Fr=wr(">",(function(e,t,r){return t>r}),(function(e,t,r,n){return n.compare(t,r)>0})),Pr=wr("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),Nr=wr(">=",(function(e,t,r){return t>=r}),(function(e,t,r,n){return n.compare(t,r)>=0})),Lr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Ur=Lr(void 0,(function(){return Ur.toString().search("(((.+)+)+)+$").toString().constructor(Ur).search("(((.+)+)+)+$")}));Ur();class Gr{constructor(e,t,r,n,i,o){this.type=w,this.number=e,this.locale=t,this.currency=r,this.unit=n,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,M);if(!r)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let i=null;if(n.locale&&(i=t.parse(n.locale,1,w),!i))return null;let o=null;if(n.currency&&(o=t.parse(n.currency,1,w),!o))return null;let s=null;if(n.unit&&(s=t.parse(n.unit,1,w),!s))return null;let a=null;if(n["min-fraction-digits"]&&(a=t.parse(n["min-fraction-digits"],1,M),!a))return null;let u=null;return n["max-fraction-digits"]&&(u=t.parse(n["max-fraction-digits"],1,M),!u)?null:new Gr(r,i,o,s,a,u)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}const Qr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),kr=Qr(void 0,(function(){return kr.toString().search("(((.+)+)+)+$").toString().constructor(kr).search("(((.+)+)+)+$")}));kr();class zr{constructor(e){this.type=M,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error("Expected argument of type string or array, but found "+Q(r.type)+" instead."):new zr(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new ge("Expected value to be of type string or array, but found "+Q(ue(t))+" instead.")}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild((t=>{e.push(t.serialize())})),e}}const jr=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Hr=jr(void 0,(function(){return Hr.toString().search("(((.+)+)+)+$").toString().constructor(Hr).search("(((.+)+)+)+$")}));Hr();const qr={"==":Br,"!=":Or,">":Fr,"<":Dr,">=":Nr,"<=":Pr,array:Ee,at:pr,boolean:Ee,case:Ir,coalesce:sr,collator:ke,format:be,image:Te,in:Ar,"index-of":mr,interpolate:rr,"interpolate-hcl":rr,"interpolate-lab":rr,length:zr,let:cr,literal:pe,match:xr,number:Ee,"number-format":Gr,object:Ee,slice:Rr,step:vt,string:Ee,"to-boolean":we,"to-color":we,"to-number":we,"to-string":we,var:At,within:at};function Vr(e,[t,r,n,i]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const o=i?i.evaluate(e):1,s=se(t,r,n,o);if(s)throw new ge(s);return new y(t/255*o,r/255*o,n/255*o,o)}function Yr(e,t){return e in t}function Xr(e,t){const r=t[e];return void 0===r?null:r}function Wr(e){return{type:e}}Ue.register(qr,{error:[{kind:"error"},[w],(e,[t])=>{throw new ge(t.evaluate(e))}],typeof:[w,[P],(e,[t])=>Q(ue(t.evaluate(e)))],"to-rgba":[G(M,4),[O],(e,[t])=>t.evaluate(e).toArray()],rgb:[O,[M,M,M],Vr],rgba:[O,[M,M,M,M],Vr],has:{type:B,overloads:[[[w],(e,[t])=>Yr(t.evaluate(e),e.properties())],[[w,F],(e,[t,r])=>Yr(t.evaluate(e),r.evaluate(e))]]},get:{type:P,overloads:[[[w],(e,[t])=>Xr(t.evaluate(e),e.properties())],[[w,F],(e,[t,r])=>Xr(t.evaluate(e),r.evaluate(e))]]},"feature-state":[P,[w],(e,[t])=>Xr(t.evaluate(e),e.featureState||{})],properties:[F,[],e=>e.properties()],"geometry-type":[w,[],e=>e.geometryType()],id:[P,[],e=>e.id()],zoom:[M,[],e=>e.globals.zoom],pitch:[M,[],e=>e.globals.pitch||0],"distance-from-center":[M,[],e=>e.distanceFromCenter()],"heatmap-density":[M,[],e=>e.globals.heatmapDensity||0],"line-progress":[M,[],e=>e.globals.lineProgress||0],"sky-radial-progress":[M,[],e=>e.globals.skyRadialProgress||0],accumulated:[P,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[M,Wr(M),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[M,Wr(M),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:M,overloads:[[[M,M],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[M],(e,[t])=>-t.evaluate(e)]]},"/":[M,[M,M],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[M,[M,M],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[M,[],()=>Math.LN2],pi:[M,[],()=>Math.PI],e:[M,[],()=>Math.E],"^":[M,[M,M],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[M,[M],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[M,[M],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[M,[M],(e,[t])=>Math.log(t.evaluate(e))],log2:[M,[M],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[M,[M],(e,[t])=>Math.sin(t.evaluate(e))],cos:[M,[M],(e,[t])=>Math.cos(t.evaluate(e))],tan:[M,[M],(e,[t])=>Math.tan(t.evaluate(e))],asin:[M,[M],(e,[t])=>Math.asin(t.evaluate(e))],acos:[M,[M],(e,[t])=>Math.acos(t.evaluate(e))],atan:[M,[M],(e,[t])=>Math.atan(t.evaluate(e))],min:[M,Wr(M),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[M,Wr(M),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[M,[M],(e,[t])=>Math.abs(t.evaluate(e))],round:[M,[M],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[M,[M],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[M,[M],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[B,[w,P],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[B,[P],(e,[t])=>e.id()===t.value],"filter-type-==":[B,[w],(e,[t])=>e.geometryType()===t.value],"filter-<":[B,[w,P],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[B,[P],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[B,[w,P],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[B,[P],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[B,[w,P],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[B,[P],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[B,[w,P],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[B,[P],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[B,[P],(e,[t])=>t.value in e.properties()],"filter-has-id":[B,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[B,[G(w)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[B,[G(P)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[B,[w,G(P)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[B,[w,G(P)],(e,[t,r])=>function(e,t,r,n){for(;r<=n;){const i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:B,overloads:[[[B,B],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Wr(B),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:B,overloads:[[[B,B],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Wr(B),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[B,[B],(e,[t])=>!t.evaluate(e)],"is-supported-script":[B,[w],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[w,[w],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[w,[w],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[w,Wr(P),(e,t)=>t.map((t=>ce(t.evaluate(e)))).join("")],"resolved-locale":[w,[N],(e,[t])=>t.evaluate(e).resolvedLocale()]});var Kr,$r=(Kr=!0,function(e,t){var r=Kr?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Kr=!1,r}),Jr=$r(void 0,(function(){return Jr.toString().search("(((.+)+)+)+$").toString().constructor(Jr).search("(((.+)+)+)+$")}));function Zr(e){return{result:"success",value:e}}function en(e){return{result:"error",value:e}}Jr();var tn,rn=(tn=!0,function(e,t){var r=tn?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return tn=!1,r}),nn=rn(void 0,(function(){return nn.toString().search("(((.+)+)+)+$").toString().constructor(nn).search("(((.+)+)+)+$")}));function on(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function sn(e){return!!e.expression&&e.expression.interpolated}nn();var an,un=(an=!0,function(e,t){var r=an?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return an=!1,r}),cn=un(void 0,(function(){return cn.toString().search("(((.+)+)+)+$").toString().constructor(cn).search("(((.+)+)+)+$")}));function ln(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}cn();const hn=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),pn=hn(void 0,(function(){return pn.toString().search("(((.+)+)+)+$").toString().constructor(pn).search("(((.+)+)+)+$")}));function dn(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function An(e){return e}function gn(e,t){const r="color"===t.type,n=e.stops&&"object"==typeof e.stops[0][0],i=n||void 0!==e.property,o=n||!i,s=e.type||(sn(t)?"exponential":"interval");if(r&&((e=b({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],y.parse(e[1])]))),e.default?e.default=y.parse(e.default):e.default=y.parse(t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Zt[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);let a,u,c;if("exponential"===s)a=En;else if("interval"===s)a=yn;else if("categorical"===s){a=mn,u=Object.create(null);for(const t of e.stops)u[t[0]]=t[1];c=typeof e.stops[0][0]}else{if("identity"!==s)throw new Error('Unknown function type "'+s+'"');a=xn}if(n){const r={},n=[];for(let t=0;t<e.stops.length;t++){const i=e.stops[t],o=i[0].zoom;void 0===r[o]&&(r[o]={zoom:o,type:e.type,property:e.property,default:e.default,stops:[]},n.push(o)),r[o].stops.push([i[0].value,i[1]])}const i=[];for(const e of n)i.push([r[e].zoom,gn(r[e],t)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:rr.interpolationFactor.bind(void 0,o),zoomStops:i.map((e=>e[0])),evaluate:({zoom:r},n)=>En({stops:i,base:e.base},t,r).evaluate(r,n)}}if(o){const r="exponential"===s?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:r,interpolationFactor:rr.interpolationFactor.bind(void 0,r),zoomStops:e.stops.map((e=>e[0])),evaluate:({zoom:r})=>a(e,t,r,u,c)}}return{kind:"source",evaluate(r,n){const i=n&&n.properties?n.properties[e.property]:void 0;return void 0===i?_n(e.default,t.default):a(e,t,i,u,c)}}}function _n(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function mn(e,t,r,n,i){return _n(typeof r===i?n[r]:void 0,e.default,t.default)}function yn(e,t,r){if("number"!==ln(r))return _n(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];const i=Ct(e.stops.map((e=>e[0])),r);return e.stops[i][1]}function En(e,t,r){const n=void 0!==e.base?e.base:1;if("number"!==ln(r))return _n(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];const o=Ct(e.stops.map((e=>e[0])),r),s=function(e,t,r,n){const i=n-r,o=e-r;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}(r,n,e.stops[o][0],e.stops[o+1][0]),a=e.stops[o][1],u=e.stops[o+1][1];let c=Ft[t.type]||An;if(e.colorSpace&&"rgb"!==e.colorSpace){const t=Zt[e.colorSpace];c=(e,r)=>t.reverse(t.interpolate(t.forward(e),t.forward(r),s))}return"function"==typeof a.evaluate?{evaluate(...e){const t=a.evaluate.apply(void 0,e),r=u.evaluate.apply(void 0,e);if(void 0!==t&&void 0!==r)return c(t,r,s)}}:c(a,u,s)}function xn(e,t,r){return"color"===t.type?r=y.parse(r):"formatted"===t.type?r=Z.fromString(r.toString()):"resolvedImage"===t.type?r=ne.fromString(r.toString()):ln(r)!==t.type&&("enum"!==t.type||!t.values[r])&&(r=void 0),_n(r,e.default,t.default)}pn();const Cn=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),bn=Cn(void 0,(function(){return bn.toString().search("(((.+)+)+)+$").toString().constructor(bn).search("(((.+)+)+)+$")}));bn();class In{constructor(e,t){var r;this.expression=e,this._warningHistory={},this._evaluator=new Fe,this._defaultValue=t?"color"===(r=t).type&&(dn(r.default)||Array.isArray(r.default))?new y(0,0,0,0):"color"===r.type?y.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,i,o,s,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,i,o,s,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new ge("Expected value to be one of "+Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")+", but found "+JSON.stringify(e)+" instead.");return e}catch(e){return!this._warningHistory[e.message]&&(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function vn(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in qr}function Tn(e,t){const r=new mt(qr,[],t?function(e){const t={color:O,string:w,number:M,enum:w,boolean:B,formatted:L,resolvedImage:U};return"array"===e.type?G(t[e.value]||P,e.length):t[e.type]}(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?Zr(new In(n,t)):en(r.errors)}class Rn{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!ht(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)}evaluate(e,t,r,n,i,o){return this._styleExpression.evaluate(e,t,r,n,i,o)}}class Sn{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!ht(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)}evaluate(e,t,r,n,i,o){return this._styleExpression.evaluate(e,t,r,n,i,o)}interpolationFactor(e,t,r){return this.interpolationType?rr.interpolationFactor(this.interpolationType,e,t,r):0}}function Mn(e,t){if("error"===(e=Tn(e,t)).result)return e;const r=e.value.expression,n=lt(r);if(!n&&!on(t))return en([new I("","data expressions not supported")]);const i=pt(r,["zoom","pitch","distance-from-center"]);if(!(i||(o=t,o.expression&&o.expression.parameters.indexOf("zoom")>-1)))return en([new I("","zoom expressions not supported")]);var o;const s=Bn(r);if(!s&&!i)return en([new I("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(s instanceof I)return en([s]);if(s instanceof rr&&!sn(t))return en([new I("",'"interpolate" expressions cannot be used with this property')]);if(!s)return Zr(new Rn(n?"constant":"source",e.value));const a=s instanceof rr?s.interpolation:void 0;return Zr(new Sn(n?"camera":"composite",e.value,s.labels,a))}class wn{constructor(e,t){this._parameters=e,this._specification=t,b(this,gn(this._parameters,this._specification))}static deserialize(e){return new wn(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Bn(e){let t=null;if(e instanceof cr)t=Bn(e.result);else if(e instanceof sr){for(const r of e.args)if(t=Bn(r),t)break}else(e instanceof vt||e instanceof rr)&&e.input instanceof Ue&&"zoom"===e.input.name&&(t=e);return t instanceof I||e.eachChild((e=>{const r=Bn(e);r instanceof I?t=r:!t&&r?t=new I("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new I("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}var On,Dn=(On=!0,function(e,t){var r=On?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return On=!1,r}),Fn=Dn(void 0,(function(){return Fn.toString().search("(((.+)+)+)+$").toString().constructor(Fn).search("(((.+)+)+)+$")}));function Pn(e,t){this.x=e,this.y=t}function Nn(e){return null!=e}function Ln(e){var t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}Fn(),Pn.prototype={clone:function(){return new Pn(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Pn.convert=function(e){return e instanceof Pn?e:Array.isArray(e)?new Pn(e[0],e[1]):e},Nn(Object.create)&&(Ln.prototype=Object.create(Error.prototype),Ln.prototype.constructor=Ln),Ln.prototype.toString=function(){var e=this.name+": "+this.message;return Nn(this.stack)&&(e+="\n"+this.stack.toString()),e},Ln.throwInstantiationError=function(){throw new Ln("This function defines an interface and should not be called directly.")};var Un={};function Gn(e,t,r){return"Expected "+r+" to be typeof "+t+", actual typeof was "+e}function Qn(e,t){return null!=e?e:t}Un.typeOf={},Un.defined=function(e,t){if(!Nn(t))throw new Ln(function(e){return e+" is required, actual value was undefined"}(e))},Un.typeOf.func=function(e,t){if("function"!=typeof t)throw new Ln(Gn(typeof t,"function",e))},Un.typeOf.string=function(e,t){if("string"!=typeof t)throw new Ln(Gn(typeof t,"string",e))},Un.typeOf.number=function(e,t){if("number"!=typeof t)throw new Ln(Gn(typeof t,"number",e))},Un.typeOf.number.lessThan=function(e,t,r){if(Un.typeOf.number(e,t),t>=r)throw new Ln("Expected "+e+" to be less than "+r+", actual value was "+t)},Un.typeOf.number.lessThanOrEquals=function(e,t,r){if(Un.typeOf.number(e,t),t>r)throw new Ln("Expected "+e+" to be less than or equal to "+r+", actual value was "+t)},Un.typeOf.number.greaterThan=function(e,t,r){if(Un.typeOf.number(e,t),t<=r)throw new Ln("Expected "+e+" to be greater than "+r+", actual value was "+t)},Un.typeOf.number.greaterThanOrEquals=function(e,t,r){if(Un.typeOf.number(e,t),t<r)throw new Ln("Expected "+e+" to be greater than or equal to"+r+", actual value was "+t)},Un.typeOf.object=function(e,t){if("object"!=typeof t)throw new Ln(Gn(typeof t,"object",e))},Un.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new Ln(Gn(typeof t,"boolean",e))},Un.typeOf.number.equals=function(e,t,r,n){if(Un.typeOf.number(e,r),Un.typeOf.number(t,n),r!==n)throw new Ln(e+" must be equal to "+t+", the actual values are "+r+" and "+n)},Qn.EMPTY_OBJECT=Object.freeze({});
/**
    @license

       Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
       All rights reserved.

       Redistribution and use in source and binary forms, with or without
       modification, are permitted provided that the following conditions
       are met:

         1. Redistributions of source code must retain the above copyright
            notice, this list of conditions and the following disclaimer.

         2. Redistributions in binary form must reproduce the above copyright
            notice, this list of conditions and the following disclaimer in the
            documentation and/or other materials provided with the distribution.

         3. The names of its contributors may not be used to endorse or promote
            products derived from this software without specific prior written
            permission.

       THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
       "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
       LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
       A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
       CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
       EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
       PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
       PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
       LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
       NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
       SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    */
var kn=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(e)};kn.prototype.init_genrand=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},kn.prototype.genrand_int32=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var r;for(this.mti==this.N+1&&this.init_genrand(5489),r=0;r<this.N-this.M;r++)e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+this.M]^e>>>1^t[1&e];for(;r<this.N-1;r++)e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},kn.prototype.random=function(){return this.genrand_int32()*(1/4294967296)};var zn={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536};zn.sign=Qn(Math.sign,(function(e){return 0===(e=+e)||e!=e?e:e>0?1:-1})),zn.signNotZero=function(e){return e<0?-1:1},zn.toSNorm=function(e,t){return t=Qn(t,255),Math.round((.5*zn.clamp(e,-1,1)+.5)*t)},zn.fromSNorm=function(e,t){return t=Qn(t,255),zn.clamp(e,0,t)/t*2-1},zn.normalize=function(e,t,r){return 0===(r=Math.max(r-t,0))?0:zn.clamp((e-t)/r,0,1)},zn.sinh=Qn(Math.sinh,(function(e){return(Math.exp(e)-Math.exp(-e))/2})),zn.cosh=Qn(Math.cosh,(function(e){return(Math.exp(e)+Math.exp(-e))/2})),zn.lerp=function(e,t,r){return(1-r)*e+r*t},zn.PI=Math.PI,zn.ONE_OVER_PI=1/Math.PI,zn.PI_OVER_TWO=Math.PI/2,zn.PI_OVER_THREE=Math.PI/3,zn.PI_OVER_FOUR=Math.PI/4,zn.PI_OVER_SIX=Math.PI/6,zn.THREE_PI_OVER_TWO=3*Math.PI/2,zn.TWO_PI=2*Math.PI,zn.ONE_OVER_TWO_PI=1/(2*Math.PI),zn.RADIANS_PER_DEGREE=Math.PI/180,zn.DEGREES_PER_RADIAN=180/Math.PI,zn.RADIANS_PER_ARCSECOND=zn.RADIANS_PER_DEGREE/3600,zn.toRadians=function(e){if(!Nn(e))throw new Ln("degrees is required.");return e*zn.RADIANS_PER_DEGREE},zn.toDegrees=function(e){if(!Nn(e))throw new Ln("radians is required.");return e*zn.DEGREES_PER_RADIAN},zn.convertLongitudeRange=function(e){if(!Nn(e))throw new Ln("angle is required.");var t=zn.TWO_PI,r=e-Math.floor(e/t)*t;return r<-Math.PI?r+t:r>=Math.PI?r-t:r},zn.clampToLatitudeRange=function(e){if(!Nn(e))throw new Ln("angle is required.");return zn.clamp(e,-1*zn.PI_OVER_TWO,zn.PI_OVER_TWO)},zn.negativePiToPi=function(e){if(!Nn(e))throw new Ln("angle is required.");return zn.zeroToTwoPi(e+zn.PI)-zn.PI},zn.zeroToTwoPi=function(e){if(!Nn(e))throw new Ln("angle is required.");var t=zn.mod(e,zn.TWO_PI);return Math.abs(t)<zn.EPSILON14&&Math.abs(e)>zn.EPSILON14?zn.TWO_PI:t},zn.mod=function(e,t){if(!Nn(e))throw new Ln("m is required.");if(!Nn(t))throw new Ln("n is required.");return(e%t+t)%t},zn.equalsEpsilon=function(e,t,r,n){if(!Nn(e))throw new Ln("left is required.");if(!Nn(t))throw new Ln("right is required.");if(!Nn(r))throw new Ln("relativeEpsilon is required.");n=Qn(n,r);var i=Math.abs(e-t);return i<=n||i<=r*Math.max(Math.abs(e),Math.abs(t))},zn.lessThan=function(e,t,r){if(!Nn(e))throw new Ln("first is required.");if(!Nn(t))throw new Ln("second is required.");if(!Nn(r))throw new Ln("relativeEpsilon is required.");return e-t<-r},zn.lessThanOrEquals=function(e,t,r){if(!Nn(e))throw new Ln("first is required.");if(!Nn(t))throw new Ln("second is required.");if(!Nn(r))throw new Ln("relativeEpsilon is required.");return e-t<r},zn.greaterThan=function(e,t,r){if(!Nn(e))throw new Ln("first is required.");if(!Nn(t))throw new Ln("second is required.");if(!Nn(r))throw new Ln("relativeEpsilon is required.");return e-t>r},zn.greaterThanOrEquals=function(e,t,r){if(!Nn(e))throw new Ln("first is required.");if(!Nn(t))throw new Ln("second is required.");if(!Nn(r))throw new Ln("relativeEpsilon is required.");return e-t>-r};var jn=[1];zn.factorial=function(e){if("number"!=typeof e||e<0)throw new Ln("A number greater than or equal to 0 is required.");var t=jn.length;if(e>=t)for(var r=jn[t-1],n=t;n<=e;n++){var i=r*n;jn.push(i),r=i}return jn[e]},zn.incrementWrap=function(e,t,r){if(r=Qn(r,0),!Nn(e))throw new Ln("n is required.");if(t<=r)throw new Ln("maximumValue must be greater than minimumValue.");return++e>t&&(e=r),e},zn.isPowerOfTwo=function(e){if("number"!=typeof e||e<0)throw new Ln("A number greater than or equal to 0 is required.");return 0!==e&&!(e&e-1)},zn.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0)throw new Ln("A number greater than or equal to 0 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},zn.clamp=function(e,t,r){if(!Nn(e))throw new Ln("value is required");if(!Nn(t))throw new Ln("min is required.");if(!Nn(r))throw new Ln("max is required.");return e<t?t:e>r?r:e};var Hn=new kn;function qn(e,t,r){this.x=Qn(e,0),this.y=Qn(t,0),this.z=Qn(r,0)}zn.setRandomNumberSeed=function(e){if(!Nn(e))throw new Ln("seed is required.");Hn=new kn(e)},zn.nextRandomNumber=function(){return Hn.random()},zn.randomBetween=function(e,t){return zn.nextRandomNumber()*(t-e)+e},zn.acosClamped=function(e){if(!Nn(e))throw new Ln("value is required.");return Math.acos(zn.clamp(e,-1,1))},zn.asinClamped=function(e){if(!Nn(e))throw new Ln("value is required.");return Math.asin(zn.clamp(e,-1,1))},zn.chordLength=function(e,t){if(!Nn(e))throw new Ln("angle is required.");if(!Nn(t))throw new Ln("radius is required.");return 2*t*Math.sin(.5*e)},zn.logBase=function(e,t){if(!Nn(e))throw new Ln("number is required.");if(!Nn(t))throw new Ln("base is required.");return Math.log(e)/Math.log(t)},zn.cbrt=Qn(Math.cbrt,(function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t})),zn.log2=Qn(Math.log2,(function(e){return Math.log(e)*Math.LOG2E})),zn.fog=function(e,t){var r=e*t;return 1-Math.exp(-r*r)},zn.fastApproximateAtan=function(e){return Un.typeOf.number("x",e),e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},zn.fastApproximateAtan2=function(e,t){var r,n;Un.typeOf.number("x",e),Un.typeOf.number("y",t);var i=Math.abs(e);r=Math.abs(t),n=Math.max(i,r);var o=(r=Math.min(i,r))/n;if(isNaN(o))throw new Ln("either x or y must be nonzero");return i=zn.fastApproximateAtan(o),i=Math.abs(t)>Math.abs(e)?zn.PI_OVER_TWO-i:i,i=e<0?zn.PI-i:i,i=t<0?-i:i},qn.fromSpherical=function(e,t){Un.typeOf.object("spherical",e),Nn(t)||(t=new qn);var r=e.clock,n=e.cone,i=Qn(e.magnitude,1),o=i*Math.sin(n);return t.x=o*Math.cos(r),t.y=o*Math.sin(r),t.z=i*Math.cos(n),t},qn.fromElements=function(e,t,r,n){return Nn(n)?(n.x=e,n.y=t,n.z=r,n):new qn(e,t,r)},qn.clone=function(e,t){if(Nn(e))return Nn(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new qn(e.x,e.y,e.z)},qn.fromCartesian4=qn.clone,qn.packedLength=3,qn.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e.x,t[r++]=e.y,t[r]=e.z,t},qn.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new qn),r.x=e[t++],r.y=e[t++],r.z=e[t],r},qn.packArray=function(e,t){Un.defined("array",e);var r=e.length,n=3*r;if(Nn(t)){if(!Array.isArray(t)&&t.length!==n)throw new Ln("If result is a typed array, it must have exactly array.length * 3 elements");t.length!==n&&(t.length=n)}else t=new Array(n);for(var i=0;i<r;++i)qn.pack(e[i],t,3*i);return t},qn.unpackArray=function(e,t){if(Un.defined("array",e),Un.typeOf.number.greaterThanOrEquals("array.length",e.length,3),e.length%3!=0)throw new Ln("array length must be a multiple of 3.");var r=e.length;Nn(t)?t.length=r/3:t=new Array(r/3);for(var n=0;n<r;n+=3){var i=n/3;t[i]=qn.unpack(e,n,t[i])}return t},qn.fromArray=qn.unpack,qn.maximumComponent=function(e){return Un.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z)},qn.minimumComponent=function(e){return Un.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z)},qn.minimumByComponent=function(e,t,r){return Un.typeOf.object("first",e),Un.typeOf.object("second",t),Un.typeOf.object("result",r),r.x=Math.min(e.x,t.x),r.y=Math.min(e.y,t.y),r.z=Math.min(e.z,t.z),r},qn.maximumByComponent=function(e,t,r){return Un.typeOf.object("first",e),Un.typeOf.object("second",t),Un.typeOf.object("result",r),r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r.z=Math.max(e.z,t.z),r},qn.magnitudeSquared=function(e){return Un.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z},qn.magnitude=function(e){return Math.sqrt(qn.magnitudeSquared(e))};var Vn=new qn;qn.distance=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),qn.subtract(e,t,Vn),qn.magnitude(Vn)},qn.distanceSquared=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),qn.subtract(e,t,Vn),qn.magnitudeSquared(Vn)},qn.normalize=function(e,t){Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t);var r=qn.magnitude(e);if(0===r)return e;if(t.x=e.x/r,t.y=e.y/r,t.z=e.z/r,isNaN(t.x)||isNaN(t.y)||isNaN(t.z))throw new Ln("normalized result is not a number");return t},qn.dot=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z},qn.multiplyComponents=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x*t.x,r.y=e.y*t.y,r.z=e.z*t.z,r},qn.divideComponents=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x/t.x,r.y=e.y/t.y,r.z=e.z/t.z,r},qn.add=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z,r},qn.subtract=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z,r},qn.multiplyByScalar=function(e,t,r){return Un.typeOf.object("cartesian",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r.z=e.z*t,r},qn.divideByScalar=function(e,t,r){return Un.typeOf.object("cartesian",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r},qn.negate=function(e,t){return Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t},qn.abs=function(e,t){return Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var Yn=new qn;qn.lerp=function(e,t,r,n){return Un.typeOf.object("start",e),Un.typeOf.object("end",t),Un.typeOf.number("t",r),Un.typeOf.object("result",n),qn.multiplyByScalar(t,r,Yn),n=qn.multiplyByScalar(e,1-r,n),qn.add(Yn,n,n)};var Xn=new qn,Wn=new qn;qn.angleBetween=function(e,t){Un.typeOf.object("left",e),Un.typeOf.object("right",t),qn.normalize(e,Xn),qn.normalize(t,Wn);var r=qn.dot(Xn,Wn),n=qn.magnitude(qn.cross(Xn,Wn,Xn));return Math.atan2(n,r)};var Kn=new qn;qn.mostOrthogonalAxis=function(e,t){Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t);var r=qn.normalize(e,Kn);return qn.abs(r,r),t=r.x<=r.y?r.x<=r.z?qn.clone(qn.UNIT_X,t):qn.clone(qn.UNIT_Z,t):r.y<=r.z?qn.clone(qn.UNIT_Y,t):qn.clone(qn.UNIT_Z,t)},qn.projectVector=function(e,t,r){Un.defined("a",e),Un.defined("b",t),Un.defined("result",r);var n=qn.dot(e,t)/qn.dot(t,t);return qn.multiplyByScalar(t,n,r)},qn.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},qn.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]},qn.equalsEpsilon=function(e,t,r,n){return e===t||Nn(e)&&Nn(t)&&zn.equalsEpsilon(e.x,t.x,r,n)&&zn.equalsEpsilon(e.y,t.y,r,n)&&zn.equalsEpsilon(e.z,t.z,r,n)},qn.cross=function(e,t,r){Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r);var n=e.x,i=e.y,o=e.z,s=t.x,a=t.y,u=t.z,c=i*u-o*a,l=o*s-n*u,h=n*a-i*s;return r.x=c,r.y=l,r.z=h,r},qn.midpoint=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=.5*(e.x+t.x),r.y=.5*(e.y+t.y),r.z=.5*(e.z+t.z),r},qn.fromDegrees=function(e,t,r,n,i){return Un.typeOf.number("longitude",e),Un.typeOf.number("latitude",t),e=zn.toRadians(e),t=zn.toRadians(t),qn.fromRadians(e,t,r,n,i)};var $n=new qn,Jn=new qn,Zn=new qn(40680631590769,40680631590769,40408299984661.445);qn.fromRadians=function(e,t,r,n,i){Un.typeOf.number("longitude",e),Un.typeOf.number("latitude",t),r=Qn(r,0);var o=Nn(n)?n.radiiSquared:Zn,s=Math.cos(t);$n.x=s*Math.cos(e),$n.y=s*Math.sin(e),$n.z=Math.sin(t),$n=qn.normalize($n,$n),qn.multiplyComponents(o,$n,Jn);var a=Math.sqrt(qn.dot($n,Jn));return Jn=qn.divideByScalar(Jn,a,Jn),$n=qn.multiplyByScalar($n,r,$n),Nn(i)||(i=new qn),qn.add(Jn,$n,i)},qn.fromDegreesArray=function(e,t,r){if(Un.defined("coordinates",e),e.length<2||e.length%2!=0)throw new Ln("the number of coordinates must be a multiple of 2 and at least 2");var n=e.length;Nn(r)?r.length=n/2:r=new Array(n/2);for(var i=0;i<n;i+=2){var o=e[i],s=e[i+1],a=i/2;r[a]=qn.fromDegrees(o,s,0,t,r[a])}return r},qn.fromRadiansArray=function(e,t,r){if(Un.defined("coordinates",e),e.length<2||e.length%2!=0)throw new Ln("the number of coordinates must be a multiple of 2 and at least 2");var n=e.length;Nn(r)?r.length=n/2:r=new Array(n/2);for(var i=0;i<n;i+=2){var o=e[i],s=e[i+1],a=i/2;r[a]=qn.fromRadians(o,s,0,t,r[a])}return r},qn.fromDegreesArrayHeights=function(e,t,r){if(Un.defined("coordinates",e),e.length<3||e.length%3!=0)throw new Ln("the number of coordinates must be a multiple of 3 and at least 3");var n=e.length;Nn(r)?r.length=n/3:r=new Array(n/3);for(var i=0;i<n;i+=3){var o=e[i],s=e[i+1],a=e[i+2],u=i/3;r[u]=qn.fromDegrees(o,s,a,t,r[u])}return r},qn.fromRadiansArrayHeights=function(e,t,r){if(Un.defined("coordinates",e),e.length<3||e.length%3!=0)throw new Ln("the number of coordinates must be a multiple of 3 and at least 3");var n=e.length;Nn(r)?r.length=n/3:r=new Array(n/3);for(var i=0;i<n;i+=3){var o=e[i],s=e[i+1],a=e[i+2],u=i/3;r[u]=qn.fromRadians(o,s,a,t,r[u])}return r},qn.ZERO=Object.freeze(new qn(0,0,0)),qn.ONE=Object.freeze(new qn(1,1,1)),qn.UNIT_X=Object.freeze(new qn(1,0,0)),qn.UNIT_Y=Object.freeze(new qn(0,1,0)),qn.UNIT_Z=Object.freeze(new qn(0,0,1)),qn.UNIT_XYZ=Object.freeze(new qn(1,1,1)),qn.prototype.clone=function(e){return qn.clone(this,e)},qn.prototype.equals=function(e){return qn.equals(this,e)},qn.prototype.equalsEpsilon=function(e,t,r){return qn.equalsEpsilon(this,e,t,r)},qn.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},qn.prototype.toArray=function(e,t){qn.pack(this,e,t)},qn.globalOffset=new qn(0,0,0);var ei=new qn,ti=new qn;function ri(e,t,r,n,i){if(!Nn(e))throw new Ln("cartesian is required.");if(!Nn(t))throw new Ln("oneOverRadii is required.");if(!Nn(r))throw new Ln("oneOverRadiiSquared is required.");if(!Nn(n))throw new Ln("centerToleranceSquared is required.");var o=e.x,s=e.y,a=e.z,u=t.x,c=t.y,l=t.z,h=o*o*u*u,p=s*s*c*c,f=a*a*l*l,d=h+p+f,A=Math.sqrt(1/d),g=qn.multiplyByScalar(e,A,ei);if(d<n)return isFinite(A)?qn.clone(g,i):void 0;var _=r.x,m=r.y,y=r.z,E=ti;E.x=g.x*_*2,E.y=g.y*m*2,E.z=g.z*y*2;var x,C,b,I,v,T,R,S=(1-A)*qn.magnitude(e)/(.5*qn.magnitude(E)),M=0;do{M=(x=h*(v=(C=1/(1+(S-=M)*_))*C)+p*(T=(b=1/(1+S*m))*b)+f*(R=(I=1/(1+S*y))*I)-1)/(-2*(h*(v*C)*_+p*(T*b)*m+f*(R*I)*y))}while(Math.abs(x)>zn.EPSILON12);return Nn(i)?(i.x=o*C,i.y=s*b,i.z=a*I,i):new qn(o*C,s*b,a*I)}function ni(e,t,r){this.longitude=Qn(e,0),this.latitude=Qn(t,0),this.height=Qn(r,0)}ni.fromRadians=function(e,t,r,n){return Un.typeOf.number("longitude",e),Un.typeOf.number("latitude",t),r=Qn(r,0),Nn(n)?(n.longitude=e,n.latitude=t,n.height=r,n):new ni(e,t,r)},ni.fromDegrees=function(e,t,r,n){return Un.typeOf.number("longitude",e),Un.typeOf.number("latitude",t),e=zn.toRadians(e),t=zn.toRadians(t),ni.fromRadians(e,t,r,n)};var ii=new qn,oi=new qn,si=new qn,ai=new qn(1/6378137,1/6378137,1/6356752.314245179),ui=new qn(1/40680631590769,1/40680631590769,1/40408299984661.445),ci=zn.EPSILON1;function li(e,t){this.x=Qn(e,0),this.y=Qn(t,0)}ni.fromCartesian=function(e,t,r){var n=Nn(t)?t.oneOverRadii:ai,i=Nn(t)?t.oneOverRadiiSquared:ui,o=ri(e,n,i,Nn(t)?t._centerToleranceSquared:ci,oi);if(Nn(o)){var s=qn.multiplyComponents(o,i,ii);s=qn.normalize(s,s);var a=qn.subtract(e,o,si),u=Math.atan2(s.y,s.x),c=Math.asin(s.z),l=zn.sign(qn.dot(a,e))*qn.magnitude(a);return Nn(r)?(r.longitude=u,r.latitude=c,r.height=l,r):new ni(u,c,l)}},ni.toCartesian=function(e,t,r){return Un.defined("cartographic",e),qn.fromRadians(e.longitude,e.latitude,e.height,t,r)},ni.sphericalDistance=function(e,t,r,n){if(Un.defined("longitudeA",e),Un.defined("longitudeB",r),Un.defined("latitudeA",t),Un.defined("latitudeB",n),e===r&&t===n)return 0;var i=zn.toRadians(t),o=zn.toRadians(n),s=zn.toRadians(e),a=zn.toRadians(r),u=s*s+i*i,c=a*a+o*o,l=(u+c-((s-a)*(s-a)+(i-o)*(i-o)))/(2*Math.sqrt(u)*Math.sqrt(c));return l=zn.clamp(l,-1,1),6378137*Math.acos(l)},ni.clone=function(e,t){if(Nn(e))return Nn(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new ni(e.longitude,e.latitude,e.height)},ni.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},ni.equalsEpsilon=function(e,t,r){return Un.typeOf.number("epsilon",r),e===t||Nn(e)&&Nn(t)&&Math.abs(e.longitude-t.longitude)<=r&&Math.abs(e.latitude-t.latitude)<=r&&Math.abs(e.height-t.height)<=r},ni.ZERO=Object.freeze(new ni(0,0,0)),ni.prototype.clone=function(e){return ni.clone(this,e)},ni.prototype.equals=function(e){return ni.equals(this,e)},ni.prototype.equalsEpsilon=function(e,t){return ni.equalsEpsilon(this,e,t)},ni.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},li.fromElements=function(e,t,r){return Nn(r)?(r.x=e,r.y=t,r):new li(e,t)},li.clone=function(e,t){if(Nn(e))return Nn(t)?(t.x=e.x,t.y=e.y,t):new li(e.x,e.y)},li.fromCartesian3=li.clone,li.fromCartesian4=li.clone,li.packedLength=2,li.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e.x,t[r]=e.y,t},li.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new li),r.x=e[t++],r.y=e[t],r},li.packArray=function(e,t){Un.defined("array",e);var r=e.length,n=2*r;if(Nn(t)){if(!Array.isArray(t)&&t.length!==n)throw new Ln("If result is a typed array, it must have exactly array.length * 2 elements");t.length!==n&&(t.length=n)}else t=new Array(n);for(var i=0;i<r;++i)li.pack(e[i],t,2*i);return t},li.unpackArray=function(e,t){if(Un.defined("array",e),Un.typeOf.number.greaterThanOrEquals("array.length",e.length,2),e.length%2!=0)throw new Ln("array length must be a multiple of 2.");var r=e.length;Nn(t)?t.length=r/2:t=new Array(r/2);for(var n=0;n<r;n+=2){var i=n/2;t[i]=li.unpack(e,n,t[i])}return t},li.fromArray=li.unpack,li.maximumComponent=function(e){return Un.typeOf.object("cartesian",e),Math.max(e.x,e.y)},li.minimumComponent=function(e){return Un.typeOf.object("cartesian",e),Math.min(e.x,e.y)},li.minimumByComponent=function(e,t,r){return Un.typeOf.object("first",e),Un.typeOf.object("second",t),Un.typeOf.object("result",r),r.x=Math.min(e.x,t.x),r.y=Math.min(e.y,t.y),r},li.maximumByComponent=function(e,t,r){return Un.typeOf.object("first",e),Un.typeOf.object("second",t),Un.typeOf.object("result",r),r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r},li.magnitudeSquared=function(e){return Un.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y},li.magnitude=function(e){return Math.sqrt(li.magnitudeSquared(e))};var hi=new li;li.distance=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),li.subtract(e,t,hi),li.magnitude(hi)},li.distanceSquared=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),li.subtract(e,t,hi),li.magnitudeSquared(hi)},li.normalize=function(e,t){Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t);var r=li.magnitude(e);if(t.x=e.x/r,t.y=e.y/r,isNaN(t.x)||isNaN(t.y))throw new Ln("normalized result is not a number");return t},li.dot=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),e.x*t.x+e.y*t.y},li.multiplyComponents=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x*t.x,r.y=e.y*t.y,r},li.divideComponents=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x/t.x,r.y=e.y/t.y,r},li.add=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r},li.subtract=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r},li.multiplyByScalar=function(e,t,r){return Un.typeOf.object("cartesian",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r},li.divideByScalar=function(e,t,r){return Un.typeOf.object("cartesian",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r},li.negate=function(e,t){return Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t},li.abs=function(e,t){return Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var pi=new li;li.lerp=function(e,t,r,n){return Un.typeOf.object("start",e),Un.typeOf.object("end",t),Un.typeOf.number("t",r),Un.typeOf.object("result",n),li.multiplyByScalar(t,r,pi),n=li.multiplyByScalar(e,1-r,n),li.add(pi,n,n)};var fi=new li,di=new li;li.angleBetween=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),li.normalize(e,fi),li.normalize(t,di),zn.acosClamped(li.dot(fi,di))};var Ai=new li;function gi(e,t,r,n){this.x=Qn(e,0),this.y=Qn(t,0),this.z=Qn(r,0),this.w=Qn(n,0)}li.mostOrthogonalAxis=function(e,t){Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t);var r=li.normalize(e,Ai);return li.abs(r,r),t=r.x<=r.y?li.clone(li.UNIT_X,t):li.clone(li.UNIT_Y,t)},li.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.x===t.x&&e.y===t.y},li.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]},li.equalsEpsilon=function(e,t,r,n){return e===t||Nn(e)&&Nn(t)&&zn.equalsEpsilon(e.x,t.x,r,n)&&zn.equalsEpsilon(e.y,t.y,r,n)},li.ZERO=Object.freeze(new li(0,0)),li.UNIT_X=Object.freeze(new li(1,0)),li.UNIT_Y=Object.freeze(new li(0,1)),li.prototype.clone=function(e){return li.clone(this,e)},li.prototype.equals=function(e){return li.equals(this,e)},li.prototype.equalsEpsilon=function(e,t,r){return li.equalsEpsilon(this,e,t,r)},li.prototype.toString=function(){return"("+this.x+", "+this.y+")"},li.prototype.toArray=function(e,t){li.pack(this,e,t)},gi.fromElements=function(e,t,r,n,i){return Nn(i)?(i.x=e,i.y=t,i.z=r,i.w=n,i):new gi(e,t,r,n)},gi.fromColor=function(e,t){return Un.typeOf.object("color",e),Nn(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new gi(e.red,e.green,e.blue,e.alpha)},gi.clone=function(e,t){if(Nn(e))return Nn(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new gi(e.x,e.y,e.z,e.w)},gi.packedLength=4,gi.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e.x,t[r++]=e.y,t[r++]=e.z,t[r]=e.w,t},gi.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new gi),r.x=e[t++],r.y=e[t++],r.z=e[t++],r.w=e[t],r},gi.packArray=function(e,t){Un.defined("array",e);var r=e.length,n=4*r;if(Nn(t)){if(!Array.isArray(t)&&t.length!==n)throw new Ln("If result is a typed array, it must have exactly array.length * 4 elements");t.length!==n&&(t.length=n)}else t=new Array(n);for(var i=0;i<r;++i)gi.pack(e[i],t,4*i);return t},gi.unpackArray=function(e,t){if(Un.defined("array",e),Un.typeOf.number.greaterThanOrEquals("array.length",e.length,4),e.length%4!=0)throw new Ln("array length must be a multiple of 4.");var r=e.length;Nn(t)?t.length=r/4:t=new Array(r/4);for(var n=0;n<r;n+=4){var i=n/4;t[i]=gi.unpack(e,n,t[i])}return t},gi.fromArray=gi.unpack,gi.maximumComponent=function(e){return Un.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z,e.w)},gi.minimumComponent=function(e){return Un.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z,e.w)},gi.minimumByComponent=function(e,t,r){return Un.typeOf.object("first",e),Un.typeOf.object("second",t),Un.typeOf.object("result",r),r.x=Math.min(e.x,t.x),r.y=Math.min(e.y,t.y),r.z=Math.min(e.z,t.z),r.w=Math.min(e.w,t.w),r},gi.maximumByComponent=function(e,t,r){return Un.typeOf.object("first",e),Un.typeOf.object("second",t),Un.typeOf.object("result",r),r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r.z=Math.max(e.z,t.z),r.w=Math.max(e.w,t.w),r},gi.magnitudeSquared=function(e){return Un.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},gi.magnitude=function(e){return Math.sqrt(gi.magnitudeSquared(e))};var _i=new gi;gi.distance=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),gi.subtract(e,t,_i),gi.magnitude(_i)},gi.distanceSquared=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),gi.subtract(e,t,_i),gi.magnitudeSquared(_i)},gi.normalize=function(e,t){Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t);var r=gi.magnitude(e);if(t.x=e.x/r,t.y=e.y/r,t.z=e.z/r,t.w=e.w/r,isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||isNaN(t.w))throw new Ln("normalized result is not a number");return t},gi.dot=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},gi.multiplyComponents=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x*t.x,r.y=e.y*t.y,r.z=e.z*t.z,r.w=e.w*t.w,r},gi.divideComponents=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x/t.x,r.y=e.y/t.y,r.z=e.z/t.z,r.w=e.w/t.w,r},gi.add=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z,r.w=e.w+t.w,r},gi.subtract=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z,r.w=e.w-t.w,r},gi.multiplyByScalar=function(e,t,r){return Un.typeOf.object("cartesian",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r.z=e.z*t,r.w=e.w*t,r},gi.divideByScalar=function(e,t,r){return Un.typeOf.object("cartesian",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r.w=e.w/t,r},gi.negate=function(e,t){return Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},gi.abs=function(e,t){return Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var mi=new gi;gi.lerp=function(e,t,r,n){return Un.typeOf.object("start",e),Un.typeOf.object("end",t),Un.typeOf.number("t",r),Un.typeOf.object("result",n),gi.multiplyByScalar(t,r,mi),n=gi.multiplyByScalar(e,1-r,n),gi.add(mi,n,n)};var yi=new gi;gi.mostOrthogonalAxis=function(e,t){Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t);var r=gi.normalize(e,yi);return gi.abs(r,r),t=r.x<=r.y?r.x<=r.z?r.x<=r.w?gi.clone(gi.UNIT_X,t):gi.clone(gi.UNIT_W,t):r.z<=r.w?gi.clone(gi.UNIT_Z,t):gi.clone(gi.UNIT_W,t):r.y<=r.z?r.y<=r.w?gi.clone(gi.UNIT_Y,t):gi.clone(gi.UNIT_W,t):r.z<=r.w?gi.clone(gi.UNIT_Z,t):gi.clone(gi.UNIT_W,t)},gi.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},gi.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]&&e.w===t[r+3]},gi.equalsEpsilon=function(e,t,r,n){return e===t||Nn(e)&&Nn(t)&&zn.equalsEpsilon(e.x,t.x,r,n)&&zn.equalsEpsilon(e.y,t.y,r,n)&&zn.equalsEpsilon(e.z,t.z,r,n)&&zn.equalsEpsilon(e.w,t.w,r,n)},gi.ZERO=Object.freeze(new gi(0,0,0,0)),gi.UNIT_X=Object.freeze(new gi(1,0,0,0)),gi.UNIT_Y=Object.freeze(new gi(0,1,0,0)),gi.UNIT_Z=Object.freeze(new gi(0,0,1,0)),gi.UNIT_W=Object.freeze(new gi(0,0,0,1)),gi.prototype.clone=function(e){return gi.clone(this,e)},gi.prototype.equals=function(e){return gi.equals(this,e)},gi.prototype.equalsEpsilon=function(e,t,r){return gi.equalsEpsilon(this,e,t,r)},gi.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var Ei=new Float32Array(1),xi=256,Ci=1/65536,bi=1/16777216;function Ii(e,t,r){Un.defined("array",e),Un.defined("itemToFind",t),Un.defined("comparator",r);for(var n,i,o=0,s=e.length-1;o<=s;)if((i=r(e[n=~~((o+s)/2)],t))<0)o=n+1;else{if(!(i>0))return n;s=n-1}return~(s+1)}function vi(e,t,r,n,i){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=r,this.yPoleOffset=n,this.ut1MinusUtc=i}function Ti(){var e=arguments,t=0,r=e[t++],n=function(e,t,r,n){r||(r=" ");var i=e.length>=t?"":Array(1+t-e.length>>>0).join(r);return n?e+i:i+e},i=function(e,t,r,i,o,s){var a=i-e.length;return a>0&&(e=r||!o?n(e,i,s,r):e.slice(0,t.length)+n("",a,"0",!0)+e.slice(t.length)),e},o=function(e,t,r,o,s,a,u){var c=e>>>0;return e=(r=r&&c&&{2:"0b",8:"0",16:"0x"}[t]||"")+n(c.toString(t),a||0,"0",!1),i(e,r,o,s,u)},s=function(e,t,r,n,o,s){return null!=n&&(e=e.slice(0,n)),i(e,"",t,r,o,s)};return r.replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,(function(r,a,u,c,l,h,p){var f,d,A,g,_;if("%%"==r)return"%";for(var m=!1,y="",E=!1,x=!1,C=" ",b=u.length,I=0;u&&I<b;I++)switch(u.charAt(I)){case" ":y=" ";break;case"+":y="+";break;case"-":m=!0;break;case"'":C=u.charAt(I+1);break;case"0":E=!0;break;case"#":x=!0}if((c=c?"*"==c?+e[t++]:"*"==c.charAt(0)?+e[c.slice(1,-1)]:+c:0)<0&&(c=-c,m=!0),!isFinite(c))throw new Error("sprintf: (minimum-)width must be finite");switch(h=h?"*"==h?+e[t++]:"*"==h.charAt(0)?+e[h.slice(1,-1)]:+h:"fFeE".indexOf(p)>-1?6:"d"==p?0:void 0,_=a?e[a.slice(0,-1)]:e[t++],p){case"s":return s(String(_),m,c,h,E,C);case"c":return s(String.fromCharCode(+_),m,c,h,E);case"b":return o(_,2,x,m,c,h,E);case"o":return o(_,8,x,m,c,h,E);case"x":return o(_,16,x,m,c,h,E);case"X":return o(_,16,x,m,c,h,E).toUpperCase();case"u":return o(_,10,x,m,c,h,E);case"i":case"d":return f=+_||0,_=(d=(f=Math.round(f-f%1))<0?"-":y)+n(String(Math.abs(f)),h,"0",!1),i(_,d,m,c,E);case"e":case"E":case"f":case"F":case"g":case"G":return d=(f=+_)<0?"-":y,A=["toExponential","toFixed","toPrecision"]["efg".indexOf(p.toLowerCase())],g=["toString","toUpperCase"]["eEfFgG".indexOf(p)%2],_=d+Math.abs(f)[A](h),i(_,d,m,c,E)[g]();default:return r}}))}function Ri(e,t,r,n,i,o,s,a){this.year=e,this.month=t,this.day=r,this.hour=n,this.minute=i,this.second=o,this.millisecond=s,this.isLeapSecond=a}function Si(e){if(null===e||isNaN(e))throw new Ln("year is required and must be a number.");return e%4==0&&e%100!=0||e%400==0}function Mi(e,t){this.julianDate=e,this.offset=t}gi.packFloat=function(e,t){if(Un.typeOf.number("value",e),Nn(t)||(t=new gi),Ei[0]=e,0===(e=Ei[0]))return gi.clone(gi.ZERO,t);var r,n=e<0?1:0;isFinite(e)?(e=Math.abs(e),r=Math.floor(zn.logBase(e,10))+1,e/=Math.pow(10,r)):(e=.1,r=38);var i=e*xi;return t.x=Math.floor(i),i=(i-t.x)*xi,t.y=Math.floor(i),i=(i-t.y)*xi,t.z=Math.floor(i),t.w=2*(r+38)+n,t},gi.unpackFloat=function(e){Un.typeOf.object("packedFloat",e);var t=e.w/2,r=Math.floor(t),n=2*(t-r);if(n=-(n=2*n-1),(r-=38)>=38)return n<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;var i=n*e.x*.00390625;return i+=n*e.y*Ci,(i+=n*e.z*bi)*Math.pow(10,r)},gi.prototype.toArray=function(e,t){gi.pack(this,e,t)};var wi=Object.freeze({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5}),Bi=Object.freeze({UTC:0,TAI:1}),Oi=new Ri,Di=[31,28,31,30,31,30,31,31,30,31,30,31];function Fi(e,t){return Ki.compare(e.julianDate,t.julianDate)}var Pi=new Mi;function Ni(e){Pi.julianDate=e;var t=Ki.leapSeconds,r=Ii(t,Pi,Fi);r<0&&(r=~r),r>=t.length&&(r=t.length-1);var n=t[r].offset;r>0&&(Ki.secondsDifference(t[r].julianDate,e)>n&&(n=t[--r].offset));Ki.addSeconds(e,n,e)}function Li(e,t){Pi.julianDate=e;var r=Ki.leapSeconds,n=Ii(r,Pi,Fi);if(n<0&&(n=~n),0===n)return Ki.addSeconds(e,-r[0].offset,t);if(n>=r.length)return Ki.addSeconds(e,-r[n-1].offset,t);var i=Ki.secondsDifference(r[n].julianDate,e);return 0===i?Ki.addSeconds(e,-r[n].offset,t):i<=1?void 0:Ki.addSeconds(e,-r[--n].offset,t)}function Ui(e,t,r){var n=t/wi.SECONDS_PER_DAY|0;return e+=n,(t-=wi.SECONDS_PER_DAY*n)<0&&(e--,t+=wi.SECONDS_PER_DAY),r.dayNumber=e,r.secondsOfDay=t,r}function Gi(e,t,r,n,i,o,s){var a=(t-14)/12|0,u=e+4800+a,c=(1461*u/4|0)+(367*(t-2-12*a)/12|0)-(3*((u+100)/100|0)/4|0)+r-32075;(n-=12)<0&&(n+=24);var l=o+(n*wi.SECONDS_PER_HOUR+i*wi.SECONDS_PER_MINUTE+s*wi.SECONDS_PER_MILLISECOND);return l>=43200&&(c-=1),[c,l]}var Qi=/^(\d{4})$/,ki=/^(\d{4})-(\d{2})$/,zi=/^(\d{4})-?(\d{3})$/,ji=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,Hi=/^(\d{4})-?(\d{2})-?(\d{2})$/,qi=/([Z+\-])?(\d{2})?:?(\d{2})?$/,Vi=/^(\d{2})(\.\d+)?/.source+qi.source,Yi=/^(\d{2}):?(\d{2})(\.\d+)?/.source+qi.source,Xi=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+qi.source,Wi="Invalid ISO 8601 date.";function Ki(e,t,r){this.dayNumber=void 0,this.secondsOfDay=void 0,e=Qn(e,0),t=Qn(t,0),r=Qn(r,Bi.UTC);var n=0|e;Ui(n,t+=(e-n)*wi.SECONDS_PER_DAY,this),r===Bi.UTC&&Ni(this)}Ki.fromGregorianDate=function(e,t){if(!(e instanceof Ri))throw new Ln("date must be a valid GregorianDate.");var r=Gi(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return Nn(t)?(Ui(r[0],r[1],t),Ni(t),t):new Ki(r[0],r[1],Bi.UTC)},Ki.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime()))throw new Ln("date must be a valid JavaScript Date.");var r=Gi(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return Nn(t)?(Ui(r[0],r[1],t),Ni(t),t):new Ki(r[0],r[1],Bi.UTC)},Ki.fromIso8601=function(e,t){if("string"!=typeof e)throw new Ln(Wi);var r,n,i,o,s,a=(e=e.replace(",",".")).split("T"),u=1,c=1,l=0,h=0,p=0,f=0,d=a[0],A=a[1];if(!Nn(d))throw new Ln(Wi);if(null!==(a=d.match(Hi))){if((o=d.split("-").length-1)>0&&2!==o)throw new Ln(Wi);r=+a[1],u=+a[2],c=+a[3]}else if(null!==(a=d.match(ki)))r=+a[1],u=+a[2];else if(null!==(a=d.match(Qi)))r=+a[1];else{var g;if(null!==(a=d.match(zi))){if(r=+a[1],g=+a[2],i=Si(r),g<1||i&&g>366||!i&&g>365)throw new Ln(Wi)}else{if(null===(a=d.match(ji)))throw new Ln(Wi);r=+a[1];var _=+a[2],m=+a[3]||0;if((o=d.split("-").length-1)>0&&(!Nn(a[3])&&1!==o||Nn(a[3])&&2!==o))throw new Ln(Wi);g=7*_+m-new Date(Date.UTC(r,0,4)).getUTCDay()-3}(n=new Date(Date.UTC(r,0,1))).setUTCDate(g),u=n.getUTCMonth()+1,c=n.getUTCDate()}if(i=Si(r),u<1||u>12||c<1||(2!==u||!i)&&c>Di[u-1]||i&&2===u&&c>29)throw new Ln(Wi);if(Nn(A)){if(null!==(a=A.match(Xi))){if((o=A.split(":").length-1)>0&&2!==o&&3!==o)throw new Ln(Wi);l=+a[1],h=+a[2],p=+a[3],f=1e3*+(a[4]||0),s=5}else if(null!==(a=A.match(Yi))){if((o=A.split(":").length-1)>2)throw new Ln(Wi);l=+a[1],h=+a[2],p=60*+(a[3]||0),s=4}else{if(null===(a=A.match(Vi)))throw new Ln(Wi);l=+a[1],h=60*+(a[2]||0),s=3}if(h>=60||p>=61||l>24||24===l&&(h>0||p>0||f>0))throw new Ln(Wi);var y=a[s],E=+a[s+1],x=+(a[s+2]||0);switch(y){case"+":l-=E,h-=x;break;case"-":l+=E,h+=x;break;case"Z":break;default:h+=new Date(Date.UTC(r,u-1,c,l,h)).getTimezoneOffset()}}var C=60===p;for(C&&p--;h>=60;)h-=60,l++;for(;l>=24;)l-=24,c++;for(n=i&&2===u?29:Di[u-1];c>n;)c-=n,++u>12&&(u-=12,r++),n=i&&2===u?29:Di[u-1];for(;h<0;)h+=60,l--;for(;l<0;)l+=24,c--;for(;c<1;)--u<1&&(u+=12,r--),c+=n=i&&2===u?29:Di[u-1];var b=Gi(r,u,c,l,h,p,f);return Nn(t)?(Ui(b[0],b[1],t),Ni(t)):t=new Ki(b[0],b[1],Bi.UTC),C&&Ki.addSeconds(t,1,t),t},Ki.now=function(e){return Ki.fromDate(new Date,e)};var $i=new Ki(0,0,Bi.TAI);Ki.toGregorianDate=function(e,t){if(!Nn(e))throw new Ln("julianDate is required.");var r=!1,n=Li(e,$i);Nn(n)||(Ki.addSeconds(e,-1,$i),n=Li($i,$i),r=!0);var i=n.dayNumber,o=n.secondsOfDay;o>=43200&&(i+=1);var s=i+68569|0,a=4*s/146097|0,u=4e3*((s=s-((146097*a+3)/4|0)|0)+1)/1461001|0,c=80*(s=s-(1461*u/4|0)+31|0)/2447|0,l=s-(2447*c/80|0)|0,h=c+2-12*(s=c/11|0)|0,p=100*(a-49)+u+s|0,f=o/wi.SECONDS_PER_HOUR|0,d=o-f*wi.SECONDS_PER_HOUR,A=d/wi.SECONDS_PER_MINUTE|0,g=0|(d-=A*wi.SECONDS_PER_MINUTE),_=(d-g)/wi.SECONDS_PER_MILLISECOND;return(f+=12)>23&&(f-=24),r&&(g+=1),Nn(t)?(t.year=p,t.month=h,t.day=l,t.hour=f,t.minute=A,t.second=g,t.millisecond=_,t.isLeapSecond=r,t):new Ri(p,h,l,f,A,g,_,r)},Ki.toDate=function(e){if(!Nn(e))throw new Ln("julianDate is required.");var t=Ki.toGregorianDate(e,Oi),r=t.second;return t.isLeapSecond&&(r-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,r,t.millisecond))},Ki.toIso8601=function(e,t){if(!Nn(e))throw new Ln("julianDate is required.");var r=Ki.toGregorianDate(e,Oi),n=r.year,i=r.month,o=r.day,s=r.hour,a=r.minute,u=r.second,c=r.millisecond;return 1e4===n&&1===i&&1===o&&0===s&&0===a&&0===u&&0===c&&(n=9999,i=12,o=31,s=24),Nn(t)||0===c?Nn(t)&&0!==t?Ti("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",n,i,o,s,a,u,(.01*c).toFixed(t).replace(".","").slice(0,t)):Ti("%04d-%02d-%02dT%02d:%02d:%02dZ",n,i,o,s,a,u):Ti("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",n,i,o,s,a,u,(.01*c).toString().replace(".",""))},Ki.clone=function(e,t){if(Nn(e))return Nn(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new Ki(e.dayNumber,e.secondsOfDay,Bi.TAI)},Ki.compare=function(e,t){if(!Nn(e))throw new Ln("left is required.");if(!Nn(t))throw new Ln("right is required.");var r=e.dayNumber-t.dayNumber;return 0!==r?r:e.secondsOfDay-t.secondsOfDay},Ki.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},Ki.equalsEpsilon=function(e,t,r){if(!Nn(r))throw new Ln("epsilon is required.");return e===t||Nn(e)&&Nn(t)&&Math.abs(Ki.secondsDifference(e,t))<=r},Ki.totalDays=function(e){if(!Nn(e))throw new Ln("julianDate is required.");return e.dayNumber+e.secondsOfDay/wi.SECONDS_PER_DAY},Ki.secondsDifference=function(e,t){if(!Nn(e))throw new Ln("left is required.");if(!Nn(t))throw new Ln("right is required.");return(e.dayNumber-t.dayNumber)*wi.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},Ki.daysDifference=function(e,t){if(!Nn(e))throw new Ln("left is required.");if(!Nn(t))throw new Ln("right is required.");return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/wi.SECONDS_PER_DAY},Ki.computeTaiMinusUtc=function(e){Pi.julianDate=e;var t=Ki.leapSeconds,r=Ii(t,Pi,Fi);return r<0&&(r=~r,--r<0&&(r=0)),t[r].offset},Ki.addSeconds=function(e,t,r){if(!Nn(e))throw new Ln("julianDate is required.");if(!Nn(t))throw new Ln("seconds is required.");if(!Nn(r))throw new Ln("result is required.");return Ui(e.dayNumber,e.secondsOfDay+t,r)},Ki.addMinutes=function(e,t,r){if(!Nn(e))throw new Ln("julianDate is required.");if(!Nn(t))throw new Ln("minutes is required.");if(!Nn(r))throw new Ln("result is required.");var n=e.secondsOfDay+t*wi.SECONDS_PER_MINUTE;return Ui(e.dayNumber,n,r)},Ki.addHours=function(e,t,r){if(!Nn(e))throw new Ln("julianDate is required.");if(!Nn(t))throw new Ln("hours is required.");if(!Nn(r))throw new Ln("result is required.");var n=e.secondsOfDay+t*wi.SECONDS_PER_HOUR;return Ui(e.dayNumber,n,r)},Ki.addDays=function(e,t,r){if(!Nn(e))throw new Ln("julianDate is required.");if(!Nn(t))throw new Ln("days is required.");if(!Nn(r))throw new Ln("result is required.");return Ui(e.dayNumber+t,e.secondsOfDay,r)},Ki.lessThan=function(e,t){return Ki.compare(e,t)<0},Ki.lessThanOrEquals=function(e,t){return Ki.compare(e,t)<=0},Ki.greaterThan=function(e,t){return Ki.compare(e,t)>0},Ki.greaterThanOrEquals=function(e,t){return Ki.compare(e,t)>=0},Ki.prototype.clone=function(e){return Ki.clone(this,e)},Ki.prototype.equals=function(e){return Ki.equals(this,e)},Ki.prototype.equalsEpsilon=function(e,t){return Ki.equalsEpsilon(this,e,t)},Ki.prototype.toString=function(){return Ki.toIso8601(this)},Ki.leapSeconds=[new Mi(new Ki(2441317,43210,Bi.TAI),10),new Mi(new Ki(2441499,43211,Bi.TAI),11),new Mi(new Ki(2441683,43212,Bi.TAI),12),new Mi(new Ki(2442048,43213,Bi.TAI),13),new Mi(new Ki(2442413,43214,Bi.TAI),14),new Mi(new Ki(2442778,43215,Bi.TAI),15),new Mi(new Ki(2443144,43216,Bi.TAI),16),new Mi(new Ki(2443509,43217,Bi.TAI),17),new Mi(new Ki(2443874,43218,Bi.TAI),18),new Mi(new Ki(2444239,43219,Bi.TAI),19),new Mi(new Ki(2444786,43220,Bi.TAI),20),new Mi(new Ki(2445151,43221,Bi.TAI),21),new Mi(new Ki(2445516,43222,Bi.TAI),22),new Mi(new Ki(2446247,43223,Bi.TAI),23),new Mi(new Ki(2447161,43224,Bi.TAI),24),new Mi(new Ki(2447892,43225,Bi.TAI),25),new Mi(new Ki(2448257,43226,Bi.TAI),26),new Mi(new Ki(2448804,43227,Bi.TAI),27),new Mi(new Ki(2449169,43228,Bi.TAI),28),new Mi(new Ki(2449534,43229,Bi.TAI),29),new Mi(new Ki(2450083,43230,Bi.TAI),30),new Mi(new Ki(2450630,43231,Bi.TAI),31),new Mi(new Ki(2451179,43232,Bi.TAI),32),new Mi(new Ki(2453736,43233,Bi.TAI),33),new Mi(new Ki(2454832,43234,Bi.TAI),34),new Mi(new Ki(2456109,43235,Bi.TAI),35),new Mi(new Ki(2457204,43236,Bi.TAI),36),new Mi(new Ki(2457754,43237,Bi.TAI),37)];var Ji="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Zi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var eo,to={exports:{}},ro={exports:{}},no=ro.exports;var io,oo={exports:{}},so=oo.exports;
/*!
     * URI.js - Mutating URLs
     * IPv6 Support
     *
     * Version: 1.19.11
     *
     * Author: Rodney Rehm
     * Web: http://medialize.github.io/URI.js/
     *
     * Licensed under
     *   MIT License http://www.opensource.org/licenses/mit-license
     *
     */var ao,uo={exports:{}},co=uo.exports;
/*!
     * URI.js - Mutating URLs
     * Second Level Domain (SLD) Support
     *
     * Version: 1.19.11
     *
     * Author: Rodney Rehm
     * Web: http://medialize.github.io/URI.js/
     *
     * Licensed under
     *   MIT License http://www.opensource.org/licenses/mit-license
     *
     */
/*!
     * URI.js - Mutating URLs
     *
     * Version: 1.19.11
     *
     * Author: Rodney Rehm
     * Web: http://medialize.github.io/URI.js/
     *
     * Licensed under
     *   MIT License http://www.opensource.org/licenses/mit-license
     *
     */
var lo,ho=to.exports;var po=(lo||(lo=1,function(e){var t,r;t=ho,r=function(e,t,r,n){var i=n&&n.URI;function o(e,t){var r=arguments.length>=1;if(!(this instanceof o))return r?arguments.length>=2?new o(e,t):new o(e):new o;if(void 0===e){if(r)throw new TypeError("undefined is not a valid argument for URI");e="undefined"!=typeof location?location.href+"":""}if(null===e&&r)throw new TypeError("null is not a valid argument for URI");return this.href(e),void 0!==t?this.absoluteTo(t):this}o.version="1.19.11";var s=o.prototype,a=Object.prototype.hasOwnProperty;function u(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function c(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function l(e){return"Array"===c(e)}function h(e,t){var r,n,i={};if("RegExp"===c(t))i=null;else if(l(t))for(r=0,n=t.length;r<n;r++)i[t[r]]=!0;else i[t]=!0;for(r=0,n=e.length;r<n;r++)(i&&void 0!==i[e[r]]||!i&&t.test(e[r]))&&(e.splice(r,1),n--,r--);return e}function p(e,t){var r,n;if(l(t)){for(r=0,n=t.length;r<n;r++)if(!p(e,t[r]))return!1;return!0}var i=c(t);for(r=0,n=e.length;r<n;r++)if("RegExp"===i){if("string"==typeof e[r]&&e[r].match(t))return!0}else if(e[r]===t)return!0;return!1}function f(e,t){if(!l(e)||!l(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function d(e){return e.replace(/^\/+|\/+$/g,"")}function A(e){return escape(e)}function g(e){return encodeURIComponent(e).replace(/[!'()*]/g,A).replace(/\*/g,"%2A")}o._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:o.preventInvalidHostname,duplicateQueryParameters:o.duplicateQueryParameters,escapeQuerySpace:o.escapeQuerySpace}},o.preventInvalidHostname=!1,o.duplicateQueryParameters=!1,o.escapeQuerySpace=!0,o.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,o.idn_expression=/[^a-z0-9\._-]/i,o.punycode_expression=/(xn--)/i,o.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,o.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,o.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},o.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,o.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},o.hostProtocols=["http","https"],o.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,o.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},o.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return o.domAttributes[t]}},o.encode=g,o.decode=decodeURIComponent,o.iso8859=function(){o.encode=escape,o.decode=unescape},o.unicode=function(){o.encode=g,o.decode=decodeURIComponent},o.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},o.encodeQuery=function(e,t){var r=o.encode(e+"");return void 0===t&&(t=o.escapeQuerySpace),t?r.replace(/%20/g,"+"):r},o.decodeQuery=function(e,t){e+="",void 0===t&&(t=o.escapeQuerySpace);try{return o.decode(t?e.replace(/\+/g,"%20"):e)}catch(t){return e}};var _,m={encode:"encode",decode:"decode"},y=function(e,t){return function(r){try{return o[t](r+"").replace(o.characters[e][t].expression,(function(r){return o.characters[e][t].map[r]}))}catch(e){return r}}};for(_ in m)o[_+"PathSegment"]=y("pathname",m[_]),o[_+"UrnPathSegment"]=y("urnpath",m[_]);var E=function(e,t,r){return function(n){var i;i=r?function(e){return o[t](o[r](e))}:o[t];for(var s=(n+"").split(e),a=0,u=s.length;a<u;a++)s[a]=i(s[a]);return s.join(e)}};function x(e){return function(t,r){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!r),this)}}function C(e,t){return function(r,n){return void 0===r?this._parts[e]||"":(null!==r&&(r+="").charAt(0)===t&&(r=r.substring(1)),this._parts[e]=r,this.build(!n),this)}}o.decodePath=E("/","decodePathSegment"),o.decodeUrnPath=E(":","decodeUrnPathSegment"),o.recodePath=E("/","encodePathSegment","decode"),o.recodeUrnPath=E(":","encodeUrnPathSegment","decode"),o.encodeReserved=y("reserved","encode"),o.parse=function(e,t){var r;return t||(t={preventInvalidHostname:o.preventInvalidHostname}),(r=(e=(e=e.replace(o.leading_whitespace_expression,"")).replace(o.ascii_tab_whitespace,"")).indexOf("#"))>-1&&(t.fragment=e.substring(r+1)||null,e=e.substring(0,r)),(r=e.indexOf("?"))>-1&&(t.query=e.substring(r+1)||null,e=e.substring(0,r)),"//"===(e=(e=e.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://")).replace(/^[/\\]{2,}/i,"//")).substring(0,2)?(t.protocol=null,e=e.substring(2),e=o.parseAuthority(e,t)):(r=e.indexOf(":"))>-1&&(t.protocol=e.substring(0,r)||null,t.protocol&&!t.protocol.match(o.protocol_expression)?t.protocol=void 0:"//"===e.substring(r+1,r+3).replace(/\\/g,"/")?(e=e.substring(r+3),e=o.parseAuthority(e,t)):(e=e.substring(r+1),t.urn=!0)),t.path=e,t},o.parseHost=function(e,t){e||(e="");var r,n,i=(e=e.replace(/\\/g,"/")).indexOf("/");if(-1===i&&(i=e.length),"["===e.charAt(0))r=e.indexOf("]"),t.hostname=e.substring(1,r)||null,t.port=e.substring(r+2,i)||null,"/"===t.port&&(t.port=null);else{var s=e.indexOf(":"),a=e.indexOf("/"),u=e.indexOf(":",s+1);-1!==u&&(-1===a||u<a)?(t.hostname=e.substring(0,i)||null,t.port=null):(n=e.substring(0,i).split(":"),t.hostname=n[0]||null,t.port=n[1]||null)}return t.hostname&&"/"!==e.substring(i).charAt(0)&&(i++,e="/"+e),t.preventInvalidHostname&&o.ensureValidHostname(t.hostname,t.protocol),t.port&&o.ensureValidPort(t.port),e.substring(i)||"/"},o.parseAuthority=function(e,t){return e=o.parseUserinfo(e,t),o.parseHost(e,t)},o.parseUserinfo=function(e,t){var r=e;-1!==e.indexOf("\\")&&(e=e.replace(/\\/g,"/"));var n,i=e.indexOf("/"),s=e.lastIndexOf("@",i>-1?i:e.length-1);return s>-1&&(-1===i||s<i)?(n=e.substring(0,s).split(":"),t.username=n[0]?o.decode(n[0]):null,n.shift(),t.password=n[0]?o.decode(n.join(":")):null,e=r.substring(s+1)):(t.username=null,t.password=null),e},o.parseQuery=function(e,t){if(!e)return{};if(!(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var r,n,i,s={},u=e.split("&"),c=u.length,l=0;l<c;l++)r=u[l].split("="),n=o.decodeQuery(r.shift(),t),i=r.length?o.decodeQuery(r.join("="),t):null,"__proto__"!==n&&(a.call(s,n)?("string"!=typeof s[n]&&null!==s[n]||(s[n]=[s[n]]),s[n].push(i)):s[n]=i);return s},o.build=function(e){var t="",r=!1;return e.protocol&&(t+=e.protocol+":"),e.urn||!t&&!e.hostname||(t+="//",r=!0),t+=o.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&r&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},o.buildHost=function(e){var t="";return e.hostname?(o.ip6_expression.test(e.hostname)?t+="["+e.hostname+"]":t+=e.hostname,e.port&&(t+=":"+e.port),t):""},o.buildAuthority=function(e){return o.buildUserinfo(e)+o.buildHost(e)},o.buildUserinfo=function(e){var t="";return e.username&&(t+=o.encode(e.username)),e.password&&(t+=":"+o.encode(e.password)),t&&(t+="@"),t},o.buildQuery=function(e,t,r){var n,i,s,u,c="";for(i in e)if("__proto__"!==i&&a.call(e,i))if(l(e[i]))for(n={},s=0,u=e[i].length;s<u;s++)void 0!==e[i][s]&&void 0===n[e[i][s]+""]&&(c+="&"+o.buildQueryParameter(i,e[i][s],r),!0!==t&&(n[e[i][s]+""]=!0));else void 0!==e[i]&&(c+="&"+o.buildQueryParameter(i,e[i],r));return c.substring(1)},o.buildQueryParameter=function(e,t,r){return o.encodeQuery(e,r)+(null!==t?"="+o.encodeQuery(t,r):"")},o.addQuery=function(e,t,r){if("object"==typeof t)for(var n in t)a.call(t,n)&&o.addQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=r);"string"==typeof e[t]&&(e[t]=[e[t]]),l(r)||(r=[r]),e[t]=(e[t]||[]).concat(r)}},o.setQuery=function(e,t,r){if("object"==typeof t)for(var n in t)a.call(t,n)&&o.setQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");e[t]=void 0===r?null:r}},o.removeQuery=function(e,t,r){var n,i,s;if(l(t))for(n=0,i=t.length;n<i;n++)e[t[n]]=void 0;else if("RegExp"===c(t))for(s in e)t.test(s)&&(e[s]=void 0);else if("object"==typeof t)for(s in t)a.call(t,s)&&o.removeQuery(e,s,t[s]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==r?"RegExp"===c(r)?!l(e[t])&&r.test(e[t])?e[t]=void 0:e[t]=h(e[t],r):e[t]!==String(r)||l(r)&&1!==r.length?l(e[t])&&(e[t]=h(e[t],r)):e[t]=void 0:e[t]=void 0}},o.hasQuery=function(e,t,r,n){switch(c(t)){case"String":break;case"RegExp":for(var i in e)if(a.call(e,i)&&t.test(i)&&(void 0===r||o.hasQuery(e,i,r)))return!0;return!1;case"Object":for(var s in t)if(a.call(t,s)&&!o.hasQuery(e,s,t[s]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(c(r)){case"Undefined":return t in e;case"Boolean":return r===Boolean(l(e[t])?e[t].length:e[t]);case"Function":return!!r(e[t],t,e);case"Array":return!!l(e[t])&&(n?p:f)(e[t],r);case"RegExp":return l(e[t])?!!n&&p(e[t],r):Boolean(e[t]&&e[t].match(r));case"Number":r=String(r);case"String":return l(e[t])?!!n&&p(e[t],r):e[t]===r;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},o.joinPaths=function(){for(var e=[],t=[],r=0,n=0;n<arguments.length;n++){var i=new o(arguments[n]);e.push(i);for(var s=i.segment(),a=0;a<s.length;a++)"string"==typeof s[a]&&t.push(s[a]),s[a]&&r++}if(!t.length||!r)return new o("");var u=new o("").segment(t);return""!==e[0].path()&&"/"!==e[0].path().slice(0,1)||u.path("/"+u.path()),u.normalize()},o.commonPath=function(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r++)if(e.charAt(r)!==t.charAt(r)){r--;break}return r<1?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":("/"===e.charAt(r)&&"/"===t.charAt(r)||(r=e.substring(0,r).lastIndexOf("/")),e.substring(0,r+1))},o.withinString=function(e,t,r){r||(r={});var n=r.start||o.findUri.start,i=r.end||o.findUri.end,s=r.trim||o.findUri.trim,a=r.parens||o.findUri.parens,u=/[a-z0-9-]=["']?$/i;for(n.lastIndex=0;;){var c=n.exec(e);if(!c)break;var l=c.index;if(r.ignoreHtml){var h=e.slice(Math.max(l-3,0),l);if(h&&u.test(h))continue}for(var p=l+e.slice(l).search(i),f=e.slice(l,p),d=-1;;){var A=a.exec(f);if(!A)break;var g=A.index+A[0].length;d=Math.max(d,g)}if(!((f=d>-1?f.slice(0,d)+f.slice(d).replace(s,""):f.replace(s,"")).length<=c[0].length||r.ignore&&r.ignore.test(f))){var _=t(f,l,p=l+f.length,e);void 0!==_?(_=String(_),e=e.slice(0,l)+_+e.slice(p),n.lastIndex=l+_.length):n.lastIndex=p}}return n.lastIndex=0,e},o.ensureValidHostname=function(t,r){var n=!!t,i=!1;if(!!r&&(i=p(o.hostProtocols,r)),i&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+r);if(t&&t.match(o.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(t).match(o.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},o.ensureValidPort=function(e){if(e){var t=Number(e);if(!(/^[0-9]+$/.test(t)&&t>0&&t<65536))throw new TypeError('Port "'+e+'" is not a valid port')}},o.noConflict=function(e){if(e){var t={URI:this.noConflict()};return n.URITemplate&&"function"==typeof n.URITemplate.noConflict&&(t.URITemplate=n.URITemplate.noConflict()),n.IPv6&&"function"==typeof n.IPv6.noConflict&&(t.IPv6=n.IPv6.noConflict()),n.SecondLevelDomains&&"function"==typeof n.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=n.SecondLevelDomains.noConflict()),t}return n.URI===this&&(n.URI=i),this},s.build=function(e){return!0===e?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=o.build(this._parts),this._deferred_build=!1),this},s.clone=function(){return new o(this)},s.valueOf=s.toString=function(){return this.build(!1)._string},s.protocol=x("protocol"),s.username=x("username"),s.password=x("password"),s.hostname=x("hostname"),s.port=x("port"),s.query=C("query","?"),s.fragment=C("fragment","#"),s.search=function(e,t){var r=this.query(e,t);return"string"==typeof r&&r.length?"?"+r:r},s.hash=function(e,t){var r=this.fragment(e,t);return"string"==typeof r&&r.length?"#"+r:r},s.pathname=function(e,t){if(void 0===e||!0===e){var r=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?o.decodeUrnPath:o.decodePath)(r):r}return this._parts.urn?this._parts.path=e?o.recodeUrnPath(e):"":this._parts.path=e?o.recodePath(e):"/",this.build(!t),this},s.path=s.pathname,s.href=function(e,t){var r;if(void 0===e)return this.toString();this._string="",this._parts=o._parts();var n=e instanceof o,i="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName&&(e=e[o.getDomAttribute(e)]||"",i=!1),!n&&i&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e||e instanceof String)this._parts=o.parse(String(e),this._parts);else{if(!n&&!i)throw new TypeError("invalid input");var s=n?e._parts:e;for(r in s)"query"!==r&&a.call(this._parts,r)&&(this._parts[r]=s[r]);s.query&&this.query(s.query,!1)}return this.build(!t),this},s.is=function(e){var t=!1,n=!1,i=!1,s=!1,a=!1,u=!1,c=!1,l=!this._parts.urn;switch(this._parts.hostname&&(l=!1,n=o.ip4_expression.test(this._parts.hostname),i=o.ip6_expression.test(this._parts.hostname),a=(s=!(t=n||i))&&r&&r.has(this._parts.hostname),u=s&&o.idn_expression.test(this._parts.hostname),c=s&&o.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return s;case"sld":return a;case"ip":return t;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return i;case"idn":return u;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return c}return null};var b=s.protocol,I=s.port,v=s.hostname;s.protocol=function(e,t){if(e&&!(e=e.replace(/:(\/\/)?$/,"")).match(o.protocol_expression))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return b.call(this,e,t)},s.scheme=s.protocol,s.port=function(e,t){return this._parts.urn?void 0===e?"":this:(void 0!==e&&(0===e&&(e=null),e&&(":"===(e+="").charAt(0)&&(e=e.substring(1)),o.ensureValidPort(e))),I.call(this,e,t))},s.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var r={preventInvalidHostname:this._parts.preventInvalidHostname};if("/"!==o.parseHost(e,r))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=r.hostname,this._parts.preventInvalidHostname&&o.ensureValidHostname(e,this._parts.protocol)}return v.call(this,e,t)},s.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var r=this.protocol();return this.authority()?(r?r+"://":"")+this.authority():""}var n=o(e);return this.protocol(n.protocol()).authority(n.authority()).build(!t),this},s.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildHost(this._parts):"";if("/"!==o.parseHost(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},s.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildAuthority(this._parts):"";if("/"!==o.parseAuthority(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},s.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var r=o.buildUserinfo(this._parts);return r?r.substring(0,r.length-1):r}return"@"!==e[e.length-1]&&(e+="@"),o.parseUserinfo(e,this._parts),this.build(!t),this},s.resource=function(e,t){var r;return void 0===e?this.path()+this.search()+this.hash():(r=o.parse(e),this._parts.path=r.path,this._parts.query=r.query,this._parts.fragment=r.fragment,this.build(!t),this)},s.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,r)||""}var n=this._parts.hostname.length-this.domain().length,i=this._parts.hostname.substring(0,n),s=new RegExp("^"+u(i));if(e&&"."!==e.charAt(e.length-1)&&(e+="."),-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");return e&&o.ensureValidHostname(e,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(s,e),this.build(!t),this},s.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.match(/\./g);if(r&&r.length<2)return this._parts.hostname;var n=this._parts.hostname.length-this.tld(t).length-1;return n=this._parts.hostname.lastIndexOf(".",n-1)+1,this._parts.hostname.substring(n)||""}if(!e)throw new TypeError("cannot set domain empty");if(-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(o.ensureValidHostname(e,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var i=new RegExp(u(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(i,e)}return this.build(!t),this},s.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),i=this._parts.hostname.substring(n+1);return!0!==t&&r&&r.list[i.toLowerCase()]&&r.get(this._parts.hostname)||i}var o;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!r||!r.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');o=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");o=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,e)}return this.build(!t),this},s.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var r=this._parts.path.length-this.filename().length-1,n=this._parts.path.substring(0,r)||(this._parts.hostname?"/":"");return e?o.decodePath(n):n}var i=this._parts.path.length-this.filename().length,s=this._parts.path.substring(0,i),a=new RegExp("^"+u(s));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=o.recodePath(e),this._parts.path=this._parts.path.replace(a,e),this.build(!t),this},s.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("string"!=typeof e){if(!this._parts.path||"/"===this._parts.path)return"";var r=this._parts.path.lastIndexOf("/"),n=this._parts.path.substring(r+1);return e?o.decodePathSegment(n):n}var i=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(i=!0);var s=new RegExp(u(this.filename())+"$");return e=o.recodePath(e),this._parts.path=this._parts.path.replace(s,e),i?this.normalizePath(t):this.build(!t),this},s.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var r,n,i=this.filename(),s=i.lastIndexOf(".");return-1===s?"":(r=i.substring(s+1),n=/^[a-z0-9%]+$/i.test(r)?r:"",e?o.decodePathSegment(n):n)}"."===e.charAt(0)&&(e=e.substring(1));var a,c=this.suffix();if(c)a=e?new RegExp(u(c)+"$"):new RegExp(u("."+c)+"$");else{if(!e)return this;this._parts.path+="."+o.recodePath(e)}return a&&(e=o.recodePath(e),this._parts.path=this._parts.path.replace(a,e)),this.build(!t),this},s.segment=function(e,t,r){var n=this._parts.urn?":":"/",i=this.path(),o="/"===i.substring(0,1),s=i.split(n);if(void 0!==e&&"number"!=typeof e&&(r=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error('Bad segment "'+e+'", must be 0-based integer');if(o&&s.shift(),e<0&&(e=Math.max(s.length+e,0)),void 0===t)return void 0===e?s:s[e];if(null===e||void 0===s[e])if(l(t)){s=[];for(var a=0,u=t.length;a<u;a++)(t[a].length||s.length&&s[s.length-1].length)&&(s.length&&!s[s.length-1].length&&s.pop(),s.push(d(t[a])))}else(t||"string"==typeof t)&&(t=d(t),""===s[s.length-1]?s[s.length-1]=t:s.push(t));else t?s[e]=d(t):s.splice(e,1);return o&&s.unshift(""),this.path(s.join(n),r)},s.segmentCoded=function(e,t,r){var n,i,s;if("number"!=typeof e&&(r=t,t=e,e=void 0),void 0===t){if(l(n=this.segment(e,t,r)))for(i=0,s=n.length;i<s;i++)n[i]=o.decode(n[i]);else n=void 0!==n?o.decode(n):void 0;return n}if(l(t))for(i=0,s=t.length;i<s;i++)t[i]=o.encode(t[i]);else t="string"==typeof t||t instanceof String?o.encode(t):t;return this.segment(e,t,r)};var T=s.query;return s.query=function(e,t){if(!0===e)return o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var r=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace),n=e.call(this,r);return this._parts.query=o.buildQuery(n||r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=o.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):T.call(this,e,t)},s.setQuery=function(e,t,r){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)n[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var i in e)a.call(e,i)&&(n[i]=e[i])}return this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(r=t),this.build(!r),this},s.addQuery=function(e,t,r){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.addQuery(n,e,void 0===t?null:t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(r=t),this.build(!r),this},s.removeQuery=function(e,t,r){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.removeQuery(n,e,t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(r=t),this.build(!r),this},s.hasQuery=function(e,t,r){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.hasQuery(n,e,t,r)},s.setSearch=s.setQuery,s.addSearch=s.addQuery,s.removeSearch=s.removeQuery,s.hasSearch=s.hasQuery,s.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},s.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},s.normalizeHostname=function(r){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!r)),this},s.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===o.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},s.normalizePath=function(e){var t,r=this._parts.path;if(!r)return this;if(this._parts.urn)return this._parts.path=o.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;var n,i,s="";for("/"!==(r=o.recodePath(r)).charAt(0)&&(t=!0,r="/"+r),"/.."!==r.slice(-3)&&"/."!==r.slice(-2)||(r+="/"),r=r.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),t&&(s=r.substring(1).match(/^(\.\.\/)+/)||"")&&(s=s[0]);-1!==(n=r.search(/\/\.\.(\/|$)/));)0!==n?(-1===(i=r.substring(0,n).lastIndexOf("/"))&&(i=n),r=r.substring(0,i)+r.substring(n+3)):r=r.substring(3);return t&&this.is("relative")&&(r=s+r.substring(1)),this._parts.path=r,this.build(!e),this},s.normalizePathname=s.normalizePath,s.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(o.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},s.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},s.normalizeSearch=s.normalizeQuery,s.normalizeHash=s.normalizeFragment,s.iso8859=function(){var e=o.encode,t=o.decode;o.encode=escape,o.decode=decodeURIComponent;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},s.unicode=function(){var e=o.encode,t=o.decode;o.encode=g,o.decode=unescape;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},s.readable=function(){var t=this.clone();t.username("").password("").normalize();var r="";if(t._parts.protocol&&(r+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(r+=e.toUnicode(t._parts.hostname),t._parts.port&&(r+=":"+t._parts.port)):r+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(r+="/"),r+=t.path(!0),t._parts.query){for(var n="",i=0,s=t._parts.query.split("&"),a=s.length;i<a;i++){var u=(s[i]||"").split("=");n+="&"+o.decodeQuery(u[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==u[1]&&(n+="="+o.decodeQuery(u[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}r+="?"+n.substring(1)}return r+=o.decodeQuery(t.hash(),!0)},s.absoluteTo=function(e){var t,r,n,i=this.clone(),s=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof o||(e=new o(e)),i._parts.protocol)return i;if(i._parts.protocol=e._parts.protocol,this._parts.hostname)return i;for(r=0;n=s[r];r++)i._parts[n]=e._parts[n];return i._parts.path?(".."===i._parts.path.substring(-2)&&(i._parts.path+="/"),"/"!==i.path().charAt(0)&&(t=(t=e.directory())||(0===e.path().indexOf("/")?"/":""),i._parts.path=(t?t+"/":"")+i._parts.path,i.normalizePath())):(i._parts.path=e._parts.path,i._parts.query||(i._parts.query=e._parts.query)),i.build(),i},s.relativeTo=function(e){var t,r,n,i,s,a=this.clone().normalize();if(a._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new o(e).normalize(),t=a._parts,r=e._parts,i=a.path(),s=e.path(),"/"!==i.charAt(0))throw new Error("URI is already relative");if("/"!==s.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(t.protocol===r.protocol&&(t.protocol=null),t.username!==r.username||t.password!==r.password)return a.build();if(null!==t.protocol||null!==t.username||null!==t.password)return a.build();if(t.hostname!==r.hostname||t.port!==r.port)return a.build();if(t.hostname=null,t.port=null,i===s)return t.path="",a.build();if(!(n=o.commonPath(i,s)))return a.build();var u=r.path.substring(n.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return t.path=u+t.path.substring(n.length)||"./",a.build()},s.equals=function(e){var t,r,n,i,s,u=this.clone(),c=new o(e),h={};if(u.normalize(),c.normalize(),u.toString()===c.toString())return!0;if(n=u.query(),i=c.query(),u.query(""),c.query(""),u.toString()!==c.toString())return!1;if(n.length!==i.length)return!1;for(s in t=o.parseQuery(n,this._parts.escapeQuerySpace),r=o.parseQuery(i,this._parts.escapeQuerySpace),t)if(a.call(t,s)){if(l(t[s])){if(!f(t[s],r[s]))return!1}else if(t[s]!==r[s])return!1;h[s]=!0}for(s in r)if(a.call(r,s)&&!h[s])return!1;return!0},s.preventInvalidHostname=function(e){return this._parts.preventInvalidHostname=!!e,this},s.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},s.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},o},e.exports?e.exports=r((eo||(eo=1,function(e,t){!function(r){var n=t&&!t.nodeType&&t,i=e&&!e.nodeType&&e,o="object"==typeof Ji&&Ji;o.global!==o&&o.window!==o&&o.self!==o||(r=o);var s,a,u=2147483647,c=36,l=/^xn--/,h=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,A=String.fromCharCode;function g(e){throw new RangeError(f[e])}function _(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function m(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+_((e=e.replace(p,".")).split("."),t).join(".")}function y(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function E(e){return _(e,(function(e){var t="";return e>65535&&(t+=A((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+A(e)})).join("")}function x(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function C(e,t,r){var n=0;for(e=r?d(e/700):e>>1,e+=d(e/t);e>455;n+=c)e=d(e/35);return d(n+36*e/(e+38))}function b(e){var t,r,n,i,o,s,a,l,h,p,f,A=[],_=e.length,m=0,y=128,x=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&g("not-basic"),A.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<_;){for(o=m,s=1,a=c;i>=_&&g("invalid-input"),((l=(f=e.charCodeAt(i++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:c)>=c||l>d((u-m)/s))&&g("overflow"),m+=l*s,!(l<(h=a<=x?1:a>=x+26?26:a-x));a+=c)s>d(u/(p=c-h))&&g("overflow"),s*=p;x=C(m-o,t=A.length+1,0==o),d(m/t)>u-y&&g("overflow"),y+=d(m/t),m%=t,A.splice(m++,0,y)}return E(A)}function I(e){var t,r,n,i,o,s,a,l,h,p,f,_,m,E,b,I=[];for(_=(e=y(e)).length,t=128,r=0,o=72,s=0;s<_;++s)(f=e[s])<128&&I.push(A(f));for(n=i=I.length,i&&I.push("-");n<_;){for(a=u,s=0;s<_;++s)(f=e[s])>=t&&f<a&&(a=f);for(a-t>d((u-r)/(m=n+1))&&g("overflow"),r+=(a-t)*m,t=a,s=0;s<_;++s)if((f=e[s])<t&&++r>u&&g("overflow"),f==t){for(l=r,h=c;!(l<(p=h<=o?1:h>=o+26?26:h-o));h+=c)b=l-p,E=c-p,I.push(A(x(p+b%E,0))),l=d(b/E);I.push(A(x(l,0))),o=C(r,m,n==i),r=0,++n}++r,++t}return I.join("")}if(s={version:"1.3.2",ucs2:{decode:y,encode:E},decode:b,encode:I,toASCII:function(e){return m(e,(function(e){return h.test(e)?"xn--"+I(e):e}))},toUnicode:function(e){return m(e,(function(e){return l.test(e)?b(e.slice(4).toLowerCase()):e}))}},n&&i)if(e.exports==n)i.exports=s;else for(a in s)s.hasOwnProperty(a)&&(n[a]=s[a]);else r.punycode=s}(no)}(ro,ro.exports)),ro.exports),(io||(io=1,function(e){var t,r;t=so,r=function(e){var t=e&&e.IPv6;return{best:function(e){var t,r,n=e.toLowerCase().split(":"),i=n.length,o=8;for(""===n[0]&&""===n[1]&&""===n[2]?(n.shift(),n.shift()):""===n[0]&&""===n[1]?n.shift():""===n[i-1]&&""===n[i-2]&&n.pop(),-1!==n[(i=n.length)-1].indexOf(".")&&(o=7),t=0;t<i&&""!==n[t];t++);if(t<o)for(n.splice(t,1,"0000");n.length<o;)n.splice(t,0,"0000");for(var s=0;s<o;s++){r=n[s].split("");for(var a=0;a<3&&"0"===r[0]&&r.length>1;a++)r.splice(0,1);n[s]=r.join("")}var u=-1,c=0,l=0,h=-1,p=!1;for(s=0;s<o;s++)p?"0"===n[s]?l+=1:(p=!1,l>c&&(u=h,c=l)):"0"===n[s]&&(p=!0,h=s,l=1);l>c&&(u=h,c=l),c>1&&n.splice(u,c,""),i=n.length;var f="";for(""===n[0]&&(f=":"),s=0;s<i&&(f+=n[s],s!==i-1);s++)f+=":";return""===n[i-1]&&(f+=":"),f},noConflict:function(){return e.IPv6===this&&(e.IPv6=t),this}}},e.exports?e.exports=r():t.IPv6=r(t)}(oo)),oo.exports),(ao||(ao=1,function(e){var t,r;t=co,r=function(e){var t=e&&e.SecondLevelDomains,r={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;var n=e.lastIndexOf(".",t-1);if(n<=0||n>=t-1)return!1;var i=r.list[e.slice(t+1)];return!!i&&i.indexOf(" "+e.slice(n+1,t)+" ")>=0},is:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;if(e.lastIndexOf(".",t-1)>=0)return!1;var n=r.list[e.slice(t+1)];return!!n&&n.indexOf(" "+e.slice(0,t)+" ")>=0},get:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return null;var n=e.lastIndexOf(".",t-1);if(n<=0||n>=t-1)return null;var i=r.list[e.slice(t+1)];return i?i.indexOf(" "+e.slice(n+1,t)+" ")<0?null:e.slice(n+1):null},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return r},e.exports?e.exports=r():t.SecondLevelDomains=r(t)}(uo)),uo.exports)):t.URI=r(t.punycode,t.IPv6,t.SecondLevelDomains,t)}(to)),to.exports),fo=Zi(po);function Ao(e,t){if(null===e||"object"!=typeof e)return e;t=Qn(t,!1);var r=new e.constructor;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];t&&(i=Ao(i,t)),r[n]=i}return r}function go(e,t,r){r=Qn(r,!1);var n,i,o,s={},a=Nn(e),u=Nn(t);if(a)for(n in e)e.hasOwnProperty(n)&&(i=e[n],u&&r&&"object"==typeof i&&t.hasOwnProperty(n)?(o=t[n],s[n]="object"==typeof o?go(i,o,r):i):s[n]=i);if(u)for(n in t)t.hasOwnProperty(n)&&!s.hasOwnProperty(n)&&(o=t[n],s[n]=o);return s}function _o(){let e,t;const r=new Promise((function(r,n){e=r,t=n}));return{resolve:e,reject:t,promise:r}}function mo(e){if(e instanceof mo)this.scheme=e.scheme,this.authority=e.authority,this.path=e.path,this.query=e.query,this.fragment=e.fragment;else if(e){var t=yo.exec(e);this.scheme=t[1],this.authority=t[2],this.path=t[3],this.query=t[4],this.fragment=t[5]}}mo.prototype.scheme=null,mo.prototype.authority=null,mo.prototype.path="",mo.prototype.query=null,mo.prototype.fragment=null;var yo=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");mo.prototype.getScheme=function(){return this.scheme},mo.prototype.getAuthority=function(){return this.authority},mo.prototype.getPath=function(){return this.path},mo.prototype.getQuery=function(){return this.query},mo.prototype.getFragment=function(){return this.fragment},mo.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},mo.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},mo.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},mo.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(Co,Io).replace(Eo,bo)),this.path&&(this.path=this.path.replace(Eo,bo)),this.query&&(this.query=this.query.replace(Eo,bo)),this.fragment&&(this.fragment=this.fragment.replace(Eo,bo))};var Eo=/%[0-9a-z]{2}/gi,xo=/[a-zA-Z0-9\-\._~]/,Co=/(.*@)?([^@:]*)(:.*)?/;function bo(e){var t=unescape(e);return xo.test(t)?t:e.toUpperCase()}function Io(e,t,r,n){return(t||"")+r.toLowerCase()+(n||"")}function vo(e,t){var r;return"undefined"!=typeof document&&(r=document),vo._implementation(e,t,r)}mo.prototype.resolve=function(e){var t=new mo;return this.scheme?(t.scheme=this.scheme,t.authority=this.authority,t.path=this.path,t.query=this.query):(t.scheme=e.scheme,this.authority?(t.authority=this.authority,t.path=this.path,t.query=this.query):(t.authority=e.authority,""==this.path?(t.path=e.path,t.query=this.query||e.query):("/"==this.path.charAt(0)?(t.path=this.path,t.removeDotSegments()):(e.authority&&""==e.path?t.path="/"+this.path:t.path=e.path.substring(0,e.path.lastIndexOf("/")+1)+this.path,t.removeDotSegments()),t.query=this.query))),t.fragment=this.fragment,t},mo.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),r=[],n=""==t[0];for(n&&t.shift(),""==t[0]&&t.shift();t.length;)".."==(e=t.shift())?r.pop():"."!=e&&r.push(e);"."!=e&&".."!=e||r.push(""),n&&r.unshift(""),this.path=r.join("/")},mo.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},vo._implementation=function(e,t,r){if(!Nn(e))throw new Ln("relative uri is required.");if(!Nn(t)){if(void 0===r)return e;t=Qn(r.baseURI,r.location.href)}var n=new mo(t);return new mo(e).resolve(n).toString()};var To={};function Ro(e,t,r){Nn(t)||(t=e.width),Nn(r)||(r=e.height);var n=To[t];Nn(n)||(n={},To[t]=n);var i=n[r];if(!Nn(i)){var o=document.createElement("canvas");o.width=t,o.height=r,(i=o.getContext("2d",{willReadFrequently:!0})).globalCompositeOperation="copy",n[r]=i}return i.drawImage(e,0,0,t,r),i.getImageData(0,0,t,r).data}var So,Mo=/^blob:/i;function wo(e){return Un.typeOf.string("uri",e),Mo.test(e)}var Bo=/^data:/i;function Oo(e){return Un.typeOf.string("uri",e),Bo.test(e)}function Do(e,t){if(!Nn(e))throw new Ln("obj is required.");var r="";for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],o=encodeURIComponent(n)+"=";if(Array.isArray(i))for(var s=0,a=i.length;s<a;++s)r+=!0===t?o+encodeURI(i[s])+"&":o+encodeURIComponent(i[s])+"&";else r+=!0===t?o+encodeURI(i)+"&":o+encodeURIComponent(i)+"&"}return r=r.slice(0,-1)}var Fo=Object.freeze({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5}),Po=Object.freeze({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3,PACK:4,BLOCK:5,BLOCKPACK:6});function No(e){e=Qn(e,Qn.EMPTY_OBJECT);var t=Qn(e.throttleByServer,!1),r=Qn(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=Qn(e.priority,0),this.throttle=r,this.throttleByServer=t,this.type=Qn(e.type,Po.OTHER),this.serverKey=void 0,this.state=Fo.UNISSUED,this.deferred=void 0,this.cancelled=!1}function Lo(e,t,r){this.statusCode=e,this.response=t,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=function(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),n=0;n<r.length;++n){var i=r[n],o=i.indexOf(": ");if(o>0){var s=i.substring(0,o),a=i.substring(o+2);t[s]=a}}return t}(this.responseHeaders))}function Uo(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function Go(e,t){return t-e}function Qo(e){Un.typeOf.object("options",e),Un.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function ko(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}No.prototype.cancel=function(){this.cancelled=!0},No.prototype.clone=function(e){return Nn(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new No(this)},Lo.prototype.toString=function(){var e="Request has failed.";return Nn(this.statusCode)&&(e+=" Status Code: "+this.statusCode),e},Object.defineProperties(Uo.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),Uo.prototype.addEventListener=function(e,t){Un.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);var r=this;return function(){r.removeEventListener(e,t)}},Uo.prototype.removeEventListener=function(e,t){Un.typeOf.func("listener",e);for(var r=this._listeners,n=this._scopes,i=-1,o=0;o<r.length;o++)if(r[o]===e&&n[o]===t){i=o;break}return-1!==i&&(this._insideRaiseEvent?(this._toRemove.push(i),r[i]=void 0,n[i]=void 0):(r.splice(i,1),n.splice(i,1)),!0)},Uo.prototype.raiseEvent=function(){var e;this._insideRaiseEvent=!0;var t=this._listeners,r=this._scopes,n=t.length;for(e=0;e<n;e++){Nn(t[e])&&t[e].apply(r[e],arguments)}var i=this._toRemove;if((n=i.length)>0){for(i.sort(Go),e=0;e<n;e++){var o=i[e];t.splice(o,1),r.splice(o,1)}i.length=0}this._insideRaiseEvent=!1},Object.defineProperties(Qo.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),Qo.prototype.reserve=function(e){e=Qn(e,this._length),this._array.length=e},Qo.prototype.heapify=function(e){e=Qn(e,0);for(var t=this._length,r=this._comparator,n=this._array,i=-1,o=!0;o;){var s=2*(e+1),a=s-1;i=a<t&&r(n[a],n[e])<0?a:e,s<t&&r(n[s],n[i])<0&&(i=s),i!==e?(ko(n,i,e),e=i):o=!1}},Qo.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},Qo.prototype.insert=function(e){Un.defined("element",e);var t,r=this._array,n=this._comparator,i=this._maximumLength,o=this._length++;for(o<r.length?r[o]=e:r.push(e);0!==o;){var s=Math.floor((o-1)/2);if(!(n(r[o],r[s])<0))break;ko(r,o,s),o=s}return Nn(i)&&this._length>i&&(t=r[i],r.pop(),this._length=i),t},Qo.prototype.pop=function(e){if(e=Qn(e,0),0!==this._length){Un.typeOf.number.lessThan("index",e,this._length);var t=this._array,r=t[e];return ko(t,e,--this._length),t[this._length]=void 0,this.heapify(e),r}};var zo="undefined"!=typeof performance&&"function"==typeof performance.now&&isFinite(performance.now())?function(){return performance.now()}:function(){return Date.now()};function jo(e,t){return e.priority-t.priority}var Ho={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0,totalRequestTime:0},qo=20,Vo=new Qo({comparator:jo});Vo.maximumLength=qo,Vo.reserve(qo);var Yo=[],Xo={},Wo="undefined"!=typeof document?new mo(document.location.href):new mo,Ko=new Uo;function $o(){}function Jo(e){Nn(e.priorityFunction)&&(e.priority=e.priorityFunction())}function Zo(e){return Nn(e.packKey)||(e.packKey=e.serverKey+"_"+e.providerName),e.packKey}function es(e){return Nn(e.blockKey)||(e.blockKey=e.serverKey+"_"+e.providerName+"_"+e.quadKey+e.url.substring(e.url.indexOf("dataVersion"))),e.blockKey}function ts(e){var t=Zo(e);return Nn($o.packRequestGroup[t])||($o.packRequestGroup[t]=[]),Nn($o.packRequestQuadKey[t])||($o.packRequestQuadKey[t]=""),Nn($o.packRequestPromise[t])||($o.packRequestPromise[t]=_o()),Nn($o.quadKeyIndex[t])||($o.quadKeyIndex[t]=0),e.quadKeyIndex=$o.quadKeyIndex[t]++,e.deferred=$o.packRequestPromise[t],e.state=Fo.ISSUED,$o.packRequestGroup[t].push(e),e.deferred.promise}function rs(e){for(var t=0,r=e.length;t<r;t++){e[t].state=Fo.CANCELLED}}function ns(e){for(var t=[],r={},n=0,i=e.length;n<i;n++){var o=e[n];if(!o.cancelled){var s=o.quadKey;r[s]||(r[s]=!0,t.push(s))}}return t}function is(){var e=$o.packRequestGroup;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(r.length<1)continue;var n=r[0].clone(),i=-1!==n.url.indexOf("rest/maps");n.serverKey=r[0].serverKey,n.state=r[0].state;var o=n.url,s=ns(r);if(s.length<1)continue;$o.packRequestQuadKey[t]=i?s.join(","):s.join(";");var a=$o.packRequestQuadKey[t];if(n.throttleByServer&&!$o.serverHasOpenSlots(n.serverKey)){rs(r),$o.packRequestPromise[t].reject();continue}n.deferred=$o.packRequestPromise[t];var u=new mo(o);u.query=i?Nn(u.query)?u.query+"&tiles="+a:"tiles="+a:Nn(u.query)?u.query+"&extratiles="+a:"extratiles="+a,n.url=u.toString(),as(n,n.url)}$o.packRequestGroup={},$o.packRequestPromise={},$o.packRequestQuadKey={},$o.quadKeyIndex={}}function os(){var e=$o.blockRequest;for(var t in e){if(e.hasOwnProperty(t))as(e[t])}$o.blockRequest={}}function ss(e){if(e.state===Fo.UNISSUED)if(e.state=Fo.ISSUED,e.type===Po.PACK||e.type===Po.BLOCKPACK){var t=Zo(e);Nn($o.packRequestPromise[t])||($o.packRequestPromise[t]=_o()),e.deferred=$o.packRequestPromise[t]}else e.deferred=_o();return e.deferred.promise}function as(e,t){var r=ss(e);return e.state=Fo.ACTIVE,Yo.push(e),++Ho.numberOfActiveRequests,++Ho.numberOfActiveRequestsEver,++Xo[e.serverKey],e.startTime=zo(),e.requestFunction(t).then(function(e){return function(t){if(e.state!==Fo.CANCELLED&&(--Ho.numberOfActiveRequests,--Xo[e.serverKey],Ko.raiseEvent(),e.state=Fo.RECEIVED,e.deferred.resolve(t),e.endTime=zo(),($o.statisticRequestTime>0||e.type!==Po.OTHER)&&(Ho.totalRequestTime+=e.endTime-e.startTime),e.type===Po.BLOCK||e.type===Po.BLOCKPACK)){var r=es(e);Nn($o.blockDefer[r])&&($o.blockDefer[r]=void 0,delete $o.blockDefer[r])}}}(e)).catch(function(e){return function(t){e.state!==Fo.CANCELLED&&(++Ho.numberOfFailedRequests,--Ho.numberOfActiveRequests,--Xo[e.serverKey],Ko.raiseEvent(t),e.state=Fo.FAILED,e.deferred.reject(t))}}(e)),r}function us(e){var t=e.state===Fo.ACTIVE;e.state=Fo.CANCELLED,++Ho.numberOfCancelledRequests,e.deferred.reject(),t&&(--Ho.numberOfActiveRequests,--Xo[e.serverKey],++Ho.numberOfCancelledActiveRequests),Nn(e.cancelFunction)&&e.cancelFunction()}function cs(e){var t;this.name="RuntimeError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}$o.TIMEOUT=5e3,$o.CANCLE_COUNT=3,$o.statisticRequestTime=-1,$o.maximumRequests=50,$o.maximumRequestsPerServer=18,$o.perPacketCount=20,$o.requestsByServer={},$o.throttleRequests=!0,$o.debugShowStatistics=!1,$o.requestCompletedEvent=Ko,Object.defineProperties($o,{activeRequestLength:{get:function(){return Yo.length}},statistics:{get:function(){return Ho}},priorityHeapLength:{get:function(){return qo},set:function(e){if(e<qo)for(;Vo.length>e;){us(Vo.pop())}qo=e,Vo.maximumLength=e,Vo.reserve(e)}}}),$o.serverHasOpenSlots=function(e,t){t=Qn(t,1);const r=Qn($o.requestsByServer[e],$o.maximumRequestsPerServer);return Xo[e]+t<=r},$o.heapHasOpenSlots=function(e){return Vo.length+e<=qo},$o.packRequestGroup={},$o.packRequestPromise={},$o.packRequestQuadKey={},$o.quadKeyIndex={},$o.packRequestHeap={},$o.blockDefer={},$o.blockRequest={},$o.update=function(){var e,t,r=0,n=Yo.length;for(e=0;e<n;++e)(t=Yo[e]).cancelled&&us(t),t.state===Fo.ACTIVE?r>0&&(Yo[e-r]=t):++r;Yo.length-=r;var i=Vo.internalArray,o=Vo.length;for(e=0;e<o;++e)Jo(i[e]);Vo.resort(),function(){for(var e in $o.packRequestHeap)if($o.packRequestHeap.hasOwnProperty(e)){for(var t=$o.packRequestHeap[e],r=t.internalArray,n=t.length,i=0;i<n;++i)Jo(r[i]);t.resort()}}(),os(),function(){for(var e in $o.packRequestHeap)if($o.packRequestHeap.hasOwnProperty(e))for(var t=$o.packRequestHeap[e];t.length>0;){var r=t.pop();r.cancelled?us(r):ts(r)}is()}();for(var s=Math.max($o.maximumRequests-Yo.length,0),a=0;a<s&&Vo.length>0;)(t=Vo.pop()).cancelled?us(t):!t.throttleByServer||$o.serverHasOpenSlots(t.serverKey)?(as(t),++a):us(t);!function(){if(!$o.debugShowStatistics)return;0===Ho.numberOfActiveRequests&&Ho.lastNumberOfActiveRequests>0&&(Ho.numberOfAttemptedRequests>0&&(console.log("Number of attempted requests: "+Ho.numberOfAttemptedRequests),Ho.numberOfAttemptedRequests=0),Ho.numberOfCancelledRequests>0&&(console.log("Number of cancelled requests: "+Ho.numberOfCancelledRequests),Ho.numberOfCancelledRequests=0),Ho.numberOfCancelledActiveRequests>0&&(console.log("Number of cancelled active requests: "+Ho.numberOfCancelledActiveRequests),Ho.numberOfCancelledActiveRequests=0),Ho.numberOfFailedRequests>0&&(console.log("Number of failed requests: "+Ho.numberOfFailedRequests),Ho.numberOfFailedRequests=0));Ho.lastNumberOfActiveRequests=Ho.numberOfActiveRequests}()},$o.getServerKey=function(e){Un.typeOf.string("url",e);var t=new mo(e).resolve(Wo);t.normalize();var r=t.authority;return/:/.test(r)||(r=r+":"+("https"===t.scheme?"443":"80")),Nn(Xo[r])||(Xo[r]=0),r},$o.request=function(e){if(Un.typeOf.object("request",e),Un.typeOf.string("request.url",e.url),Un.typeOf.func("request.requestFunction",e.requestFunction),Oo(e.url)||wo(e.url))return Ko.raiseEvent(),e.state=Fo.RECEIVED,e.requestFunction();if(++Ho.numberOfAttemptedRequests,Nn(e.serverKey)||(e.serverKey=$o.getServerKey(e.url)),e.type===Po.BLOCK)return function(e){var t=es(e),r=$o.blockDefer[t];return Nn(r)||(r=$o.blockDefer[t]=_o(),$o.blockRequest[t]=e),e.deferred=r,e.state=Fo.ISSUED,e.deferred.promise}(e);if(!e.throttleByServer||$o.serverHasOpenSlots(e.serverKey)){if(!$o.throttleRequests||!e.throttle)return as(e);if(!(Yo.length>=$o.maximumRequests)){var t;if(Jo(e),e.type===Po.PACK||e.type===Po.BLOCKPACK){var r=function(e){var t=Zo(e),r=$o.packRequestHeap[t];return Nn(r)||((r=$o.packRequestHeap[t]=new Qo({comparator:jo})).maximumLength=$o.perPacketCount,r.reserve(qo)),r}(e),n=!0;if(e.type===Po.BLOCKPACK)for(var i=0;i<r.length;i++)if(r._array[i].quadKey===e.quadKey){e.blockRequest=r._array[i],n=!1;break}n&&(t=r.insert(e))}else t=Vo.insert(e);if(Nn(t)){if(t===e)return;us(t)}return ss(e)}}},$o.clearForSpecs=function(){for(;Vo.length>0;){us(Vo.pop())}for(var e=Yo.length,t=0;t<e;++t)us(Yo[t]);Yo.length=0,Xo={},Ho.numberOfAttemptedRequests=0,Ho.numberOfActiveRequests=0,Ho.numberOfCancelledRequests=0,Ho.numberOfCancelledActiveRequests=0,Ho.numberOfFailedRequests=0,Ho.numberOfActiveRequestsEver=0,Ho.lastNumberOfActiveRequests=0,Ho.totalRequestTime=0},$o.numberOfActiveRequestsByServer=function(e){return Xo[e]},$o.requestHeap=Vo,Nn(Object.create)&&(cs.prototype=Object.create(Error.prototype),cs.prototype.constructor=cs),cs.prototype.toString=function(){var e=this.name+": "+this.message;return Nn(this.stack)&&(e+="\n"+this.stack.toString()),e};var ls={},hs={};ls.add=function(e,t){if(!Nn(e))throw new Ln("host is required.");if(!Nn(t)||t<=0)throw new Ln("port is required to be greater than 0.");var r=e.toLowerCase()+":"+t;Nn(hs[r])||(hs[r]=!0)},ls.remove=function(e,t){if(!Nn(e))throw new Ln("host is required.");if(!Nn(t)||t<=0)throw new Ln("port is required to be greater than 0.");var r=e.toLowerCase()+":"+t;Nn(hs[r])&&delete hs[r]},ls.contains=function(e){if(!Nn(e))throw new Ln("url is required.");var t=function(e){var t=new mo(e);t.normalize();var r=t.getAuthority();if(Nn(r)){if(-1!==r.indexOf("@")){var n=r.split("@");r=n[1]}if(-1===r.indexOf(":")){var i=t.getScheme();if(Nn(i)||(i=(i=window.location.protocol).substring(0,i.length-1)),"http"===i)r+=":80";else{if("https"!==i)return;r+=":443"}}return r}}(e);return!(!Nn(t)||!Nn(hs[t]))},ls.clear=function(){hs={}};var ps=Object.freeze({Error:"cacheError"});const fs=function(){try{const e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function ds(e){"string"==typeof(e=Qn(e,Qn.EMPTY_OBJECT))&&(e={url:e}),Un.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=As(e.templateValues,{}),this._queryParameters=As(e.queryParameters,{}),this.headers=As(e.headers,{}),this.request=Qn(e.request,new No),this.dbConnector=e.dbConnector,this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=Qn(e.retryAttempts,0),this._retryCount=0;Qn(e.parseUrl,!0)?this.parseUrl(e.url,!0,!0):this._url=e.url,this._credits=e.credits}function As(e,t){return Nn(e)?Ao(e):t}let gs;function _s(e,t,r){if(!r)return go(e,t);const n=Ao(e,!0);for(const e in t)if(t.hasOwnProperty(e)){let r=n[e];const i=t[e];Nn(r)?(Array.isArray(r)||(r=n[e]=[r]),n[e]=r.concat(i)):n[e]=Array.isArray(i)?i.slice():i}return n}function ms(e){const t=e.resource,r=e.flipY,n=e.skipColorSpaceConversion,i=e.preferImageBitmap,o=t.request;o.url=t.url,o.requestFunction=function(){let e=!1;t.isDataUri||t.isBlobUri||(e=t.isCrossOriginUrl);const s=_o();return Nn(t.dbConnector)?t.dbConnector.getElementFromDB(o.url,"blob").then((a=>a===ps.Error?(ds._Implementations.createImage(o,e,s,r,n,i,t.dbConnector),s.promise):a)):(ds._Implementations.createImage(o,e,s,r,n,i),s.promise)};const s=$o.request(o);if(Nn(s))return s.catch((function(e){return o.state!==Fo.FAILED?Promise.reject(e):t.retryOnError(e).then((function(s){return s?(o.state=Fo.UNISSUED,o.deferred=void 0,ms({resource:t,flipY:r,skipColorSpaceConversion:n,preferImageBitmap:i})):Promise.reject(e)}))}))}function ys(e,t,r){const n={};n[t]=r,e.setQueryParameters(n);const i=e.request,o=e.url;i.url=o,i.requestFunction=function(){const e=_o();return window[r]=function(t){e.resolve(t);try{delete window[r]}catch(e){window[r]=void 0}},ds._Implementations.loadAndExecuteScript(o,r,e),e.promise};const s=$o.request(i);if(Nn(s))return s.catch((function(n){return i.state!==Fo.FAILED?Promise.reject(n):e.retryOnError(n).then((function(o){return o?(i.state=Fo.UNISSUED,i.deferred=void 0,ys(e,t,r)):Promise.reject(n)}))}))}function Es(e){if(e.state===Fo.ISSUED||e.state===Fo.ACTIVE)throw new cs("The Resource is already being fetched.");e.state=Fo.UNISSUED,e.deferred=void 0}ds.createIfNeeded=function(e){return e instanceof ds?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new ds({url:e})},ds.supportsImageBitmapOptions=function(){if(Nn(gs))return gs;if("function"!=typeof createImageBitmap)return gs=Promise.resolve(!1),gs;return gs=ds.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC"}).then((function(e){return Promise.all([createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"}),createImageBitmap(e)])})).then((function(e){const t=Ro(e[0]),r=Ro(e[1]);return t[1]!==r[1]})).catch((function(){return!1})),gs},Object.defineProperties(ds,{isBlobSupported:{get:function(){return fs}}}),Object.defineProperties(ds.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){this.parseUrl(e,!1,!1)}},extension:{get:function(){return function(e){if(!Nn(e))throw new Ln("uri is required.");var t=new mo(e);t.normalize();var r=t.path,n=r.lastIndexOf("/");return-1!==n&&(r=r.substr(n+1)),n=r.lastIndexOf("."),-1===n?"":r.substr(n+1)}(this._url)}},isDataUri:{get:function(){return Oo(this._url)}},isBlobUri:{get:function(){return wo(this._url)}},isCrossOriginUrl:{get:function(){return function(e){Nn(So)||(So=document.createElement("a")),So.href=window.location.href;var t=So.host,r=So.protocol;return So.href=e,So.href=So.href,r!==So.protocol||t!==So.host}(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}},credits:{get:function(){return this._credits}}}),ds.prototype.toString=function(){return this.getUrlComponent(!0,!0)},ds.prototype.parseUrl=function(e,t,r,n){let i=new fo(e);const o=function(e){if(0===e.length)return{};if(-1===e.indexOf("="))return{[e]:void 0};return function(e){if(!Nn(e))throw new Ln("queryString is required.");var t={};if(""===e)return t;for(var r=e.replace(/\+/g,"%20").split(/[&;]/),n=0,i=r.length;n<i;++n){var o=r[n].split("=");if(o.length>2){var s=r[n].indexOf("=");o=[r[n].substring(0,s),r[n].substring(s+1,r[n].length)]}var a=decodeURIComponent(o[0]),u=o[1];u=Nn(u)?decodeURIComponent(u):"";var c=t[a];"string"==typeof c?t[a]=[c,u]:Array.isArray(c)?c.push(u):t[a]=u}return t}(e)}(i.query());this._queryParameters=t?_s(o,this.queryParameters,r):o,i.search(""),i.fragment(""),Nn(n)&&""===i.scheme()&&(i=i.absoluteTo(vo(n))),this._url=i.toString()},ds.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let r=this._url;e&&(r=`${r}${function(e){const t=Object.keys(e);if(0===t.length)return"";if(1===t.length&&!Nn(e[t[0]]))return`?${t[0]}`;return`?${Do(e)}`}(this.queryParameters)}`),r=r.replace(/%7B/g,"{").replace(/%7D/g,"}");const n=this._templateValues;return Object.keys(n).length>0&&(r=r.replace(/{(.*?)}/g,(function(e,t){const r=n[t];return Nn(r)&&"s"===t?encodeURI(r):Nn(r)?encodeURIComponent(r):e}))),t&&Nn(this.proxy)&&(r=this.proxy.getURL(r)),r},ds.prototype.setQueryParameters=function(e,t){this._queryParameters=t?_s(this._queryParameters,e,!1):_s(e,this._queryParameters,!1)},ds.prototype.appendQueryParameters=function(e){this._queryParameters=_s(e,this._queryParameters,!0)},ds.prototype.setTemplateValues=function(e,t){this._templateValues=t?go(this._templateValues,e):go(e,this._templateValues)},ds.prototype.getDerivedResource=function(e){const t=this.clone();if(t._retryCount=0,Nn(e.url)){const r=Qn(e.preserveQueryParameters,!1);t.parseUrl(e.url,!0,r,this._url)}return Nn(e.queryParameters)&&(t._queryParameters=go(e.queryParameters,t.queryParameters)),Nn(e.templateValues)&&(t._templateValues=go(e.templateValues,t.templateValues)),Nn(e.headers)&&(t.headers=go(e.headers,t.headers)),Nn(e.proxy)&&(t.proxy=e.proxy),Nn(e.request)&&(t.request=e.request),Nn(e.retryCallback)&&(t.retryCallback=e.retryCallback),Nn(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},ds.prototype.retryOnError=function(e){const t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);const r=this;return Promise.resolve(t(this,e)).then((function(e){return++r._retryCount,e}))},ds.prototype.clone=function(e){return Nn(e)?(e._url=this._url,e._queryParameters=Ao(this._queryParameters),e._templateValues=Ao(this._templateValues),e.headers=Ao(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e.dbConnector=this.dbConnector,e):new ds({url:this._url,queryParameters:this.queryParameters,templateValues:this.templateValues,headers:this.headers,proxy:this.proxy,retryCallback:this.retryCallback,retryAttempts:this.retryAttempts,request:this.request.clone(),parseUrl:!1,credits:Nn(this.credits)?this.credits.slice():void 0})},ds.prototype.getBaseUri=function(e){return function(e,t){if(!Nn(e))throw new Ln("uri is required.");var r="",n=e.lastIndexOf("/");return-1!==n&&(r=e.substring(0,n+1)),t?(Nn((e=new mo(e)).query)&&(r+="?"+e.query),Nn(e.fragment)&&(r+="#"+e.fragment),r):r}(this.getUrlComponent(e),e)},ds.prototype.appendForwardSlash=function(){var e;this._url=(0!==(e=this._url).length&&"/"===e[e.length-1]||(e+="/"),e)},ds.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},ds.fetchArrayBuffer=function(e){return new ds(e).fetchArrayBuffer()},ds.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},ds.fetchBlob=function(e){return new ds(e).fetchBlob()},ds.prototype.fetchImage=function(e){e=Qn(e,Qn.EMPTY_OBJECT);const t=Qn(e.preferImageBitmap,!1),r=Qn(e.preferBlob,!1),n=Qn(e.flipY,!1),i=Qn(e.skipColorSpaceConversion,!1);if(Es(this.request),!fs||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!r)return ms({resource:this,flipY:n,skipColorSpaceConversion:i,preferImageBitmap:t});const o=this.fetchBlob();if(!Nn(o))return;let s,a,u,c;return ds.supportsImageBitmapOptions().then((function(e){return s=e,a=s&&t,o})).then((function(e){if(!Nn(e))return;if(c=e,a)return ds.createImageBitmapFromBlob(e,{flipY:n,premultiplyAlpha:!1,skipColorSpaceConversion:i});const t=window.URL.createObjectURL(e);return u=new ds({url:t}),ms({resource:u,flipY:n,skipColorSpaceConversion:i,preferImageBitmap:!1})})).then((function(e){if(Nn(e))return e.blob=c,a||window.URL.revokeObjectURL(u.url),e})).catch((function(e){return Nn(u)&&window.URL.revokeObjectURL(u.url),e.blob=c,Promise.reject(e)}))},ds.fetchImage=function(e){return new ds(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},ds.prototype.fetchText=function(){return this.fetch({responseType:"text"})},ds.fetchText=function(e){return new ds(e).fetchText()},ds.prototype.fetchJson=function(){const e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(Nn(e))return e.then((function(e){if(Nn(e))return JSON.parse(e)}))},ds.fetchJson=function(e){return new ds(e).fetchJson()},ds.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},ds.fetchXML=function(e){return new ds(e).fetchXML()},ds.prototype.fetchJsonp=function(e){let t;e=Qn(e,"callback"),Es(this.request);do{t=`loadJsonp${zn.nextRandomNumber().toString().substring(2,8)}`}while(Nn(window[t]));return ys(this,e,t)},ds.fetchJsonp=function(e){return new ds(e).fetchJsonp(e.callbackParameterName)},ds.prototype._makeRequest=function(e){const t=this;Es(t.request);const r=t.request,n=t.url;r.url=n,r.requestFunction=function(n){const i=e.responseType,o=go(e.headers,t.headers),s=e.overrideMimeType,a=e.method,u=e.data,c=_o(),l=Nn(n)?n:t.url;if(Nn(t.dbConnector))return t.dbConnector.getElementFromDB(l,i).then((e=>{if(e===ps.Error){var n=ds._Implementations.loadWithXhr(l,i,a,u,o,c,s,t.dbConnector);return Nn(n)&&Nn(n.abort)&&(r.cancelFunction=function(){n.abort()}),c.promise}return e}));const h=ds._Implementations.loadWithXhr(l,i,a,u,o,c,s);return Nn(h)&&Nn(h.abort)&&(r.cancelFunction=function(){h.abort()}),c.promise};const i=$o.request(r);if(Nn(i))return i.then((function(e){return r.cancelFunction=void 0,e})).catch((function(n){return r.cancelFunction=void 0,r.state!==Fo.FAILED?Promise.reject(n):t.retryOnError(n).then((function(i){return i?(r.state=Fo.UNISSUED,r.deferred=void 0,t.fetch(e)):Promise.reject(n)}))}))};const xs=/^data:(.*?)(;base64)?,(.*)$/;function Cs(e,t){const r=decodeURIComponent(t);return e?atob(r):r}function bs(e,t){const r=Cs(e,t),n=new ArrayBuffer(r.length),i=new Uint8Array(n);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);return n}ds.prototype.fetch=function(e){return(e=As(e,{})).method="GET",this._makeRequest(e)},ds.fetch=function(e){return new ds(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},ds.prototype.delete=function(e){return(e=As(e,{})).method="DELETE",this._makeRequest(e)},ds.delete=function(e){return new ds(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},ds.prototype.head=function(e){return(e=As(e,{})).method="HEAD",this._makeRequest(e)},ds.head=function(e){return new ds(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},ds.prototype.options=function(e){return(e=As(e,{})).method="OPTIONS",this._makeRequest(e)},ds.options=function(e){return new ds(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},ds.prototype.post=function(e,t){return Un.defined("data",e),(t=As(t,{})).method="POST",t.data=e,this._makeRequest(t)},ds.post=function(e){return new ds(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},ds.prototype.put=function(e,t){return Un.defined("data",e),(t=As(t,{})).method="PUT",t.data=e,this._makeRequest(t)},ds.put=function(e){return new ds(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},ds.prototype.patch=function(e,t){return Un.defined("data",e),(t=As(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},ds.patch=function(e){return new ds(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},ds._Implementations={},ds._Implementations.loadImageElement=function(e,t,r){const n=new Image;n.onload=function(){0===n.naturalWidth&&0===n.naturalHeight&&0===n.width&&0===n.height&&(n.width=300,n.height=150),r.resolve(n)},n.onerror=function(e){r.reject(e)},t&&(ls.contains(e)?n.crossOrigin="use-credentials":n.crossOrigin=""),n.src=e},ds._Implementations.createImage=function(e,t,r,n,i,o,s){const a=e.url;ds.supportsImageBitmapOptions().then((function(u){if(!u||!o)return void ds._Implementations.loadImageElement(a,t,r);const c=_o(),l=ds._Implementations.loadWithXhr(a,"blob","GET",void 0,void 0,c,void 0,s);return Nn(l)&&Nn(l.abort)&&(e.cancelFunction=function(){l.abort()}),c.promise.then((function(e){if(Nn(e))return ds.createImageBitmapFromBlob(e,{flipY:n,premultiplyAlpha:!1,skipColorSpaceConversion:i});r.reject(new cs(`Successfully retrieved ${a} but it contained no content.`))})).then((function(e){r.resolve(e)}))})).catch((function(e){r.reject(e)}))},ds.createImageBitmapFromBlob=function(e,t){return Un.defined("options",t),Un.typeOf.bool("options.flipY",t.flipY),Un.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),Un.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};const Is="undefined"==typeof XMLHttpRequest;function vs(e){if(e=Qn(e,Qn.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=Qn(e.addNewLeapSeconds,!0),Nn(e.data))Rs(this,e.data);else if(Nn(e.url)){var t=ds.createIfNeeded(e.url),r=this;this._downloadPromise=Promise.resolve(t.fetchJson()).then((function(e){Rs(r,e)})).catch((function(){r._dataError="An error occurred while retrieving the EOP data from the URL "+t.url+"."}))}else Rs(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function Ts(e,t){return Ki.compare(e.julianDate,t)}function Rs(e,t){if(Nn(t.columnNames))if(Nn(t.samples)){var r=t.columnNames.indexOf("modifiedJulianDateUtc"),n=t.columnNames.indexOf("xPoleWanderRadians"),i=t.columnNames.indexOf("yPoleWanderRadians"),o=t.columnNames.indexOf("ut1MinusUtcSeconds"),s=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),a=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),u=t.columnNames.indexOf("taiMinusUtcSeconds");if(r<0||n<0||i<0||o<0||s<0||a<0||u<0)e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";else{var c,l=e._samples=t.samples,h=e._dates=[];e._dateColumn=r,e._xPoleWanderRadiansColumn=n,e._yPoleWanderRadiansColumn=i,e._ut1MinusUtcSecondsColumn=o,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=a,e._taiMinusUtcSecondsColumn=u,e._columnCount=t.columnNames.length,e._lastIndex=void 0;for(var p=e._addNewLeapSeconds,f=0,d=l.length;f<d;f+=e._columnCount){var A=l[f+r],g=l[f+u],_=new Ki(A+wi.MODIFIED_JULIAN_DATE_DIFFERENCE,g,Bi.TAI);if(h.push(_),p){if(g!==c&&Nn(c)){var m=Ki.leapSeconds,y=Ii(m,_,Ts);if(y<0){var E=new Mi(_,g);m.splice(~y,0,E)}}c=g}}}}else e._dataError="Error in loaded EOP data: The samples property is required.";else e._dataError="Error in loaded EOP data: The columnNames property is required."}function Ss(e,t,r,n,i){var o=r*n;i.xPoleWander=t[o+e._xPoleWanderRadiansColumn],i.yPoleWander=t[o+e._yPoleWanderRadiansColumn],i.xPoleOffset=t[o+e._xCelestialPoleOffsetRadiansColumn],i.yPoleOffset=t[o+e._yCelestialPoleOffsetRadiansColumn],i.ut1MinusUtc=t[o+e._ut1MinusUtcSecondsColumn]}function Ms(e,t,r){return t+e*(r-t)}function ws(e,t,r,n,i,o,s){var a=e._columnCount;if(o>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;var u=t[i],c=t[o];if(u.equals(c)||n.equals(u))return Ss(e,r,i,a,s),s;if(n.equals(c))return Ss(e,r,o,a,s),s;var l=Ki.secondsDifference(n,u)/Ki.secondsDifference(c,u),h=i*a,p=o*a,f=r[h+e._ut1MinusUtcSecondsColumn],d=r[p+e._ut1MinusUtcSecondsColumn],A=d-f;if(A>.5||A<-.5){var g=r[h+e._taiMinusUtcSecondsColumn],_=r[p+e._taiMinusUtcSecondsColumn];g!==_&&(c.equals(n)?f=d:d-=_-g)}return s.xPoleWander=Ms(l,r[h+e._xPoleWanderRadiansColumn],r[p+e._xPoleWanderRadiansColumn]),s.yPoleWander=Ms(l,r[h+e._yPoleWanderRadiansColumn],r[p+e._yPoleWanderRadiansColumn]),s.xPoleOffset=Ms(l,r[h+e._xCelestialPoleOffsetRadiansColumn],r[p+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=Ms(l,r[h+e._yCelestialPoleOffsetRadiansColumn],r[p+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=Ms(l,f,d),s}function Bs(e,t,r,n){t=Qn(t,0),r=Qn(r,0),n=Qn(n,0),Un.typeOf.number.greaterThanOrEquals("x",t,0),Un.typeOf.number.greaterThanOrEquals("y",r,0),Un.typeOf.number.greaterThanOrEquals("z",n,0),e._radii=new qn(t,r,n),e._radiiSquared=new qn(t*t,r*r,n*n),e._radiiToTheFourth=new qn(t*t*t*t,r*r*r*r,n*n*n*n),e._oneOverRadii=new qn(0===t?0:1/t,0===r?0:1/r,0===n?0:1/n),e._oneOverRadiiSquared=new qn(0===t?0:1/(t*t),0===r?0:1/(r*r),0===n?0:1/(n*n)),e._minimumRadius=Math.min(t,r,n),e._maximumRadius=Math.max(t,r,n),e._centerToleranceSquared=zn.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function Os(e,t,r){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,Bs(this,e,t,r)}ds._Implementations.loadWithXhr=function(e,t,r,n,i,o,s,a){var u=e;const c=xs.exec(e);if(null!==c)return void o.resolve(function(e,t){t=Qn(t,"");const r=e[1],n=!!e[2],i=e[3];let o,s;switch(t){case"":case"text":return Cs(n,i);case"arraybuffer":return bs(n,i);case"blob":return o=bs(n,i),new Blob([o],{type:r});case"document":return s=new DOMParser,s.parseFromString(Cs(n,i),r);case"json":return JSON.parse(Cs(n,i));default:throw new Ln(`Unhandled responseType: ${t}`)}}(c,t));if(Is)return void function(e,t,r,n,i,o){fetch(e,{method:r,headers:i}).then((async e=>{if(!e.ok){const t={};return e.headers.forEach(((e,r)=>{t[r]=e})),void o.reject(new Lo(e.status,e,t))}switch(t){case"text":o.resolve(e.text());break;case"json":o.resolve(e.json());break;default:o.resolve(new Uint8Array(await e.arrayBuffer()).buffer)}})).catch((()=>{o.reject(new Lo)}))}(e,t,r,0,i,o);const l=new XMLHttpRequest;if(ls.contains(e)&&(l.withCredentials=!0),e=e.replace(/{/g,"%7B").replace(/}/g,"%7D"),l.open(r,e,!0),Nn(s)&&Nn(l.overrideMimeType)&&l.overrideMimeType(s),Nn(i))for(const e in i)i.hasOwnProperty(e)&&l.setRequestHeader(e,i[e]);Nn(t)&&(l.responseType=t);let h=!1;return"string"==typeof e&&(h=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),l.onload=function(){if((l.status<200||l.status>=300)&&(!h||0!==l.status))return void o.reject(new Lo(l.status,l.response,l.getAllResponseHeaders()));const e=l.response,n=l.responseType;if("HEAD"===r||"OPTIONS"===r){const e=l.getAllResponseHeaders().trim().split(/[\r\n]+/),t={};return e.forEach((function(e){const r=e.split(": "),n=r.shift();t[n]=r.join(": ")})),void o.resolve(t)}if(204===l.status)o.resolve(void 0);else if(!Nn(e)||Nn(t)&&n!==t)if("json"===t&&"string"==typeof e)try{o.resolve(JSON.parse(e))}catch(e){o.reject(e)}else(""===n||"document"===n)&&Nn(l.responseXML)&&l.responseXML.hasChildNodes()?o.resolve(l.responseXML):""!==n&&"text"!==n||!Nn(l.responseText)?o.reject(new cs("Invalid XMLHttpRequest response type.")):o.resolve(l.responseText);else Nn(a)&&a.putElementInDB(void 0,u,e),o.resolve(e)},l.onerror=function(e){o.reject(new Lo)},l.send(n),l},ds._Implementations.loadAndExecuteScript=function(e,t,r){return function(e){var t=_o(),r=document.createElement("script");r.async=!0,r.src=e;var n=document.getElementsByTagName("head")[0];return r.onload=function(){r.onload=void 0,n.removeChild(r),t.resolve()},r.onerror=function(e){t.reject(e)},n.appendChild(r),t.promise}(e).catch((function(e){r.reject(e)}))},ds._DefaultImplementations={},ds._DefaultImplementations.createImage=ds._Implementations.createImage,ds._DefaultImplementations.loadWithXhr=ds._Implementations.loadWithXhr,ds._DefaultImplementations.loadAndExecuteScript=ds._Implementations.loadAndExecuteScript,ds.DEFAULT=Object.freeze(new ds({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),vs.NONE=Object.freeze({getPromiseToLoad:function(){return Promise.resolve()},compute:function(e,t){return Nn(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new vi(0,0,0,0,0),t}}),vs.prototype.getPromiseToLoad=function(){return Promise.resolve(this._downloadPromise)},vs.prototype.compute=function(e,t){if(Nn(this._samples)){if(Nn(t)||(t=new vi(0,0,0,0,0)),0===this._samples.length)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;var r=this._dates,n=this._lastIndex,i=0,o=0;if(Nn(n)){var s=r[n],a=r[n+1],u=Ki.lessThanOrEquals(s,e),c=!Nn(a),l=c||Ki.greaterThanOrEquals(a,e);if(u&&l)return i=n,!c&&a.equals(e)&&++i,o=i+1,ws(this,r,this._samples,e,i,o,t),t}var h=Ii(r,e,Ki.compare,this._dateColumn);return h>=0?(h<r.length-1&&r[h+1].equals(e)&&++h,i=h,o=h):(i=(o=~h)-1)<0&&(i=0),this._lastIndex=i,ws(this,r,this._samples,e,i,o,t),t}if(Nn(this._dataError))throw new cs(this._dataError)},Object.defineProperties(Os.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),Os.clone=function(e,t){if(Nn(e)){var r=e._radii;return Nn(t)?(qn.clone(r,t._radii),qn.clone(e._radiiSquared,t._radiiSquared),qn.clone(e._radiiToTheFourth,t._radiiToTheFourth),qn.clone(e._oneOverRadii,t._oneOverRadii),qn.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new Os(r.x,r.y,r.z)}},Os.fromCartesian3=function(e,t){return Nn(t)||(t=new Os),Nn(e)?(Bs(t,e.x,e.y,e.z),t):t},Os.WGS84=Object.freeze(new Os(6378137,6378137,6356752.314245179)),Os.XIAN80=Object.freeze(new Os(6378140,6378140,6356755.29)),Os.CGCS2000=Object.freeze(new Os(6378137,6378137,6356752.31)),Os.UNIT_SPHERE=Object.freeze(new Os(1,1,1)),Os.MOON=Object.freeze(new Os(zn.LUNAR_RADIUS,zn.LUNAR_RADIUS,zn.LUNAR_RADIUS)),Os.prototype.clone=function(e){return Os.clone(this,e)},Os.packedLength=qn.packedLength,Os.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),qn.pack(e._radii,t,r),t},Os.unpack=function(e,t,r){Un.defined("array",e),t=Qn(t,0);var n=qn.unpack(e,t);return Os.fromCartesian3(n,r)},Os.prototype.geocentricSurfaceNormal=qn.normalize,Os.prototype.geodeticSurfaceNormalCartographic=function(e,t){Un.typeOf.object("cartographic",e);var r=e.longitude,n=e.latitude,i=Math.cos(n),o=i*Math.cos(r),s=i*Math.sin(r),a=Math.sin(n);return Nn(t)||(t=new qn),t.x=o,t.y=s,t.z=a,qn.normalize(t,t)},Os.prototype.geodeticSurfaceNormal=function(e,t){return Nn(t)||(t=new qn),t=qn.multiplyComponents(e,this._oneOverRadiiSquared,t),qn.normalize(t,t)};var Ds=new qn,Fs=new qn;Os.prototype.cartographicToCartesian=function(e,t){var r=Ds,n=Fs;this.geodeticSurfaceNormalCartographic(e,r),qn.multiplyComponents(this._radiiSquared,r,n);var i=Math.sqrt(qn.dot(r,n));return qn.divideByScalar(n,i,n),qn.multiplyByScalar(r,e.height,r),Nn(t)||(t=new qn),qn.add(n,r,t)},Os.prototype.cartographicArrayToCartesianArray=function(e,t){Un.defined("cartographics",e);var r=e.length;Nn(t)?t.length=r:t=new Array(r);for(var n=0;n<r;n++)t[n]=this.cartographicToCartesian(e[n],t[n]);return t};var Ps=new qn,Ns=new qn,Ls=new qn;Os.prototype.cartesianToCartographic=function(e,t){var r=this.scaleToGeodeticSurface(e,Ns);if(Nn(r)){var n=this.geodeticSurfaceNormal(r,Ps),i=qn.subtract(e,r,Ls),o=Math.atan2(n.y,n.x),s=Math.asin(n.z),a=zn.sign(qn.dot(i,e))*qn.magnitude(i);return Nn(t)?(t.longitude=o,t.latitude=s,t.height=a,t):new ni(o,s,a)}},Os.prototype.cartesianArrayToCartographicArray=function(e,t){Un.defined("cartesians",e);var r=e.length;Nn(t)?t.length=r:t=new Array(r);for(var n=0;n<r;++n)t[n]=this.cartesianToCartographic(e[n],t[n]);return t},Os.prototype.scaleToGeodeticSurface=function(e,t){return ri(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},Os.prototype.scaleToGeocentricSurface=function(e,t){Un.typeOf.object("cartesian",e),Nn(t)||(t=new qn);var r=e.x,n=e.y,i=e.z,o=this._oneOverRadiiSquared,s=1/Math.sqrt(r*r*o.x+n*n*o.y+i*i*o.z);return qn.multiplyByScalar(e,s,t)},Os.prototype.transformPositionToScaledSpace=function(e,t){return Nn(t)||(t=new qn),qn.multiplyComponents(e,this._oneOverRadii,t)},Os.prototype.transformPositionFromScaledSpace=function(e,t){return Nn(t)||(t=new qn),qn.multiplyComponents(e,this._radii,t)},Os.prototype.equals=function(e){return this===e||Nn(e)&&qn.equals(this._radii,e._radii)},Os.prototype.toString=function(){return this._radii.toString()},Os.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,r){if(Un.typeOf.object("position",e),!zn.equalsEpsilon(this._radii.x,this._radii.y,zn.EPSILON15))throw new Ln("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");Un.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),t=Qn(t,0);var n=this._squaredXOverSquaredZ;if(Nn(r)||(r=new qn),r.x=0,r.y=0,r.z=e.z*(1-n),!(Math.abs(r.z)>=this._radii.z-t))return r};const Us=new qn;function Gs(e,t,r){this.heading=Qn(e,0),this.pitch=Qn(t,0),this.roll=Qn(r,0)}Os.prototype.getLocalCurvature=function(e,t){Un.typeOf.object("surfacePosition",e),Nn(t)||(t=new li);const r=this.getSurfaceNormalIntersectionWithZAxis(e,0,Us),n=qn.distance(e,r),i=n*(this.minimumRadius*n/this.maximumRadius**2)**2;return li.fromElements(1/n,1/i,t)},Gs.fromQuaternion=function(e,t){if(!Nn(e))throw new Ln("quaternion is required");Nn(t)||(t=new Gs);var r=2*(e.w*e.y-e.z*e.x),n=1-2*(e.x*e.x+e.y*e.y),i=2*(e.w*e.x+e.y*e.z),o=1-2*(e.y*e.y+e.z*e.z),s=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(s,o),t.roll=Math.atan2(i,n),t.pitch=-zn.asinClamped(r),t},Gs.fromDegrees=function(e,t,r,n){if(!Nn(e))throw new Ln("heading is required");if(!Nn(t))throw new Ln("pitch is required");if(!Nn(r))throw new Ln("roll is required");return Nn(n)||(n=new Gs),n.heading=e*zn.RADIANS_PER_DEGREE,n.pitch=t*zn.RADIANS_PER_DEGREE,n.roll=r*zn.RADIANS_PER_DEGREE,n},Gs.clone=function(e,t){if(Nn(e))return Nn(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new Gs(e.heading,e.pitch,e.roll)},Gs.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll},Gs.equalsEpsilon=function(e,t,r,n){return e===t||Nn(e)&&Nn(t)&&zn.equalsEpsilon(e.heading,t.heading,r,n)&&zn.equalsEpsilon(e.pitch,t.pitch,r,n)&&zn.equalsEpsilon(e.roll,t.roll,r,n)},Gs.prototype.clone=function(e){return Gs.clone(this,e)},Gs.prototype.equals=function(e){return Gs.equals(this,e)},Gs.prototype.equalsEpsilon=function(e,t,r){return Gs.equalsEpsilon(this,e,t,r)},Gs.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"};var Qs,ks,zs,js=/((?:.*\/)|^)SuperMap3D\.js$/;function Hs(e){return"undefined"==typeof document?e:(Nn(Qs)||(Qs=document.createElement("a")),Qs.href=e,Qs.href=Qs.href,Qs.href)}function qs(){if(Nn(ks))return ks;var e;if(e="undefined"!=typeof SUPERMAP3D_BASE_URL?SUPERMAP3D_BASE_URL:"object"==typeof define&&Nn(define.amd)&&!define.amd.toUrlUndefined&&Nn(require.toUrl)?vo("..",Xs("Core/buildModuleUrl.js")):function(){for(var e=document.getElementsByTagName("script"),t=0,r=e.length;t<r;++t){var n=e[t].getAttribute("src"),i=js.exec(n);if(null!==i)return i[1]}}(),!Nn(e))throw new Ln("Unable to determine SuperMap3D base URL automatically, try defining a global variable called SUPERMAP3D_BASE_URL.");return(ks=new ds({url:Hs(e)})).appendForwardSlash(),ks}function Vs(e){return Hs(require.toUrl("../"+e))}function Ys(e){return qs().getDerivedResource({url:e}).url}function Xs(e){return Nn(zs)||(zs="object"==typeof define&&Nn(define.amd)&&!define.amd.toUrlUndefined&&Nn(require.toUrl)?Vs:Ys),zs(e)}function Ws(e,t,r){this.x=e,this.y=t,this.s=r}function Ks(e){e=Qn(e,Qn.EMPTY_OBJECT),this._xysFileUrlTemplate=ds.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=Qn(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=Qn(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new Ki(this._sampleZeroJulianEphemerisDate,0,Bi.TAI),this._stepSizeDays=Qn(e.stepSizeDays,1),this._samplesPerXysFile=Qn(e.samplesPerXysFile,1e3),this._totalSamples=Qn(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var t=this._interpolationOrder,r=this._denominators=new Array(t+1),n=this._xTable=new Array(t+1),i=Math.pow(this._stepSizeDays,t),o=0;o<=t;++o){r[o]=i,n[o]=o*this._stepSizeDays;for(var s=0;s<=t;++s)s!==o&&(r[o]*=o-s);r[o]=1/r[o]}this._work=new Array(t+1),this._coef=new Array(t+1)}Xs._cesiumScriptRegex=js,Xs._buildModuleUrlFromBaseUrl=Ys,Xs._clearBaseResource=function(){ks=void 0},Xs.setBaseUrl=function(e){ks=ds.DEFAULT.getDerivedResource({url:e})},Xs.getCesiumBaseUrl=qs;var $s=new Ki(0,0,Bi.TAI);function Js(e,t,r){var n=$s;return n.dayNumber=t,n.secondsOfDay=r,Ki.daysDifference(n,e._sampleZeroDateTT)}function Zs(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];var r,n=_o();e._chunkDownloadsInProgress[t]=n;var i=e._xysFileUrlTemplate;return r=Nn(i)?i.getDerivedResource({templateValues:{0:t}}):new ds({url:Xs("Assets/IAU2006_XYS/IAU2006_XYS_"+t+".json")}),Promise.resolve(r.fetchJson()).then((function(r){e._chunkDownloadsInProgress[t]=!1;for(var i=e._samples,o=r.samples,s=t*e._samplesPerXysFile*3,a=0,u=o.length;a<u;++a)i[s+a]=o[a];n.resolve()})).catch((function(e){console.log(e)})),n.promise}function ea(e,t,r,n,i,o,s,a,u){this[0]=Qn(e,0),this[1]=Qn(n,0),this[2]=Qn(s,0),this[3]=Qn(t,0),this[4]=Qn(i,0),this[5]=Qn(a,0),this[6]=Qn(r,0),this[7]=Qn(o,0),this[8]=Qn(u,0),this.isMatrix3=!0}Ks.prototype.preload=function(e,t,r,n){var i=Js(this,e,t),o=Js(this,r,n),s=i/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);var a=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;a>=this._totalSamples&&(a=this._totalSamples-1);for(var u=s/this._samplesPerXysFile|0,c=a/this._samplesPerXysFile|0,l=[],h=u;h<=c;++h)l.push(Zs(this,h));return Promise.all(l)},Ks.prototype.computeXysRadians=function(e,t,r){var n=Js(this,e,t);if(!(n<0)){var i=n/this._stepSizeDays|0;if(!(i>=this._totalSamples)){var o=this._interpolationOrder,s=i-(o/2|0);s<0&&(s=0);var a=s+o;a>=this._totalSamples&&(s=(a=this._totalSamples-1)-o)<0&&(s=0);var u=!1,c=this._samples;if(Nn(c[3*s])||(Zs(this,s/this._samplesPerXysFile|0),u=!0),Nn(c[3*a])||(Zs(this,a/this._samplesPerXysFile|0),u=!0),!u){Nn(r)?(r.x=0,r.y=0,r.s=0):r=new Ws(0,0,0);var l,h,p=n-s*this._stepSizeDays,f=this._work,d=this._denominators,A=this._coef,g=this._xTable;for(l=0;l<=o;++l)f[l]=p-g[l];for(l=0;l<=o;++l){for(A[l]=1,h=0;h<=o;++h)h!==l&&(A[l]*=f[h]);A[l]*=d[l];var _=3*(s+l);r.x+=A[l]*c[_++],r.y+=A[l]*c[_++],r.s+=A[l]*c[_]}return r}}}},ea.packedLength=9,ea.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t[r++]=e[4],t[r++]=e[5],t[r++]=e[6],t[r++]=e[7],t[r++]=e[8],t},ea.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new ea),r[0]=e[t++],r[1]=e[t++],r[2]=e[t++],r[3]=e[t++],r[4]=e[t++],r[5]=e[t++],r[6]=e[t++],r[7]=e[t++],r[8]=e[t++],r},ea.clone=function(e,t){if(Nn(e))return Nn(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new ea(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},ea.fromArray=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new ea),r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],r[4]=e[t+4],r[5]=e[t+5],r[6]=e[t+6],r[7]=e[t+7],r[8]=e[t+8],r},ea.fromColumnMajorArray=function(e,t){return Un.defined("values",e),ea.clone(e,t)},ea.fromRowMajorArray=function(e,t){return Un.defined("values",e),Nn(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new ea(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},ea.fromQuaternion=function(e,t){Un.typeOf.object("quaternion",e);var r=e.x*e.x,n=e.x*e.y,i=e.x*e.z,o=e.x*e.w,s=e.y*e.y,a=e.y*e.z,u=e.y*e.w,c=e.z*e.z,l=e.z*e.w,h=e.w*e.w,p=r-s-c+h,f=2*(n-l),d=2*(i+u),A=2*(n+l),g=-r+s-c+h,_=2*(a-o),m=2*(i-u),y=2*(a+o),E=-r-s+c+h;return Nn(t)?(t[0]=p,t[1]=A,t[2]=m,t[3]=f,t[4]=g,t[5]=y,t[6]=d,t[7]=_,t[8]=E,t):new ea(p,f,d,A,g,_,m,y,E)},ea.fromHeadingPitchRoll=function(e,t){Un.typeOf.object("headingPitchRoll",e);var r=Math.cos(-e.pitch),n=Math.cos(-e.heading),i=Math.cos(e.roll),o=Math.sin(-e.pitch),s=Math.sin(-e.heading),a=Math.sin(e.roll),u=r*n,c=-i*s+a*o*n,l=a*s+i*o*n,h=r*s,p=i*n+a*o*s,f=-a*n+i*o*s,d=-o,A=a*r,g=i*r;return Nn(t)?(t[0]=u,t[1]=h,t[2]=d,t[3]=c,t[4]=p,t[5]=A,t[6]=l,t[7]=f,t[8]=g,t):new ea(u,c,l,h,p,f,d,A,g)},ea.fromScale=function(e,t){return Un.typeOf.object("scale",e),Nn(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new ea(e.x,0,0,0,e.y,0,0,0,e.z)},ea.fromUniformScale=function(e,t){return Un.typeOf.number("scale",e),Nn(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new ea(e,0,0,0,e,0,0,0,e)},ea.fromCrossProduct=function(e,t){return Un.typeOf.object("vector",e),Nn(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new ea(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},ea.fromRotationX=function(e,t){Un.typeOf.number("angle",e);var r=Math.cos(e),n=Math.sin(e);return Nn(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=r,t[5]=n,t[6]=0,t[7]=-n,t[8]=r,t):new ea(1,0,0,0,r,-n,0,n,r)},ea.fromRotationY=function(e,t){Un.typeOf.number("angle",e);var r=Math.cos(e),n=Math.sin(e);return Nn(t)?(t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=1,t[5]=0,t[6]=n,t[7]=0,t[8]=r,t):new ea(r,0,n,0,1,0,-n,0,r)},ea.fromRotationZ=function(e,t){Un.typeOf.number("angle",e);var r=Math.cos(e),n=Math.sin(e);return Nn(t)?(t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new ea(r,-n,0,n,r,0,0,0,1)},ea.toArray=function(e,t){return Un.typeOf.object("matrix",e),Nn(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},ea.getElementIndex=function(e,t){return Un.typeOf.number.greaterThanOrEquals("row",t,0),Un.typeOf.number.lessThanOrEquals("row",t,2),Un.typeOf.number.greaterThanOrEquals("column",e,0),Un.typeOf.number.lessThanOrEquals("column",e,2),3*e+t},ea.getColumn=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,2),Un.typeOf.object("result",r);var n=3*t,i=e[n],o=e[n+1],s=e[n+2];return r.x=i,r.y=o,r.z=s,r},ea.setColumn=function(e,t,r,n){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,2),Un.typeOf.object("cartesian",r),Un.typeOf.object("result",n);var i=3*t;return(n=ea.clone(e,n))[i]=r.x,n[i+1]=r.y,n[i+2]=r.z,n},ea.getRow=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,2),Un.typeOf.object("result",r);var n=e[t],i=e[t+3],o=e[t+6];return r.x=n,r.y=i,r.z=o,r},ea.setRow=function(e,t,r,n){return Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,2),Un.typeOf.object("cartesian",r),Un.typeOf.object("result",n),(n=ea.clone(e,n))[t]=r.x,n[t+3]=r.y,n[t+6]=r.z,n};var ta=new qn;ea.getScale=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t.x=qn.magnitude(qn.fromElements(e[0],e[1],e[2],ta)),t.y=qn.magnitude(qn.fromElements(e[3],e[4],e[5],ta)),t.z=qn.magnitude(qn.fromElements(e[6],e[7],e[8],ta)),t};var ra=new qn;ea.getMaximumScale=function(e){return ea.getScale(e,ra),qn.maximumComponent(ra)},ea.multiply=function(e,t,r){Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r);var n=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],i=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],o=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],s=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],a=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],u=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],c=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],l=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],h=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return r[0]=n,r[1]=i,r[2]=o,r[3]=s,r[4]=a,r[5]=u,r[6]=c,r[7]=l,r[8]=h,r},ea.add=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r},ea.subtract=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r},ea.multiplyByVector=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("cartesian",t),Un.typeOf.object("result",r);var n=t.x,i=t.y,o=t.z,s=e[0]*n+e[3]*i+e[6]*o,a=e[1]*n+e[4]*i+e[7]*o,u=e[2]*n+e[5]*i+e[8]*o;return r.x=s,r.y=a,r.z=u,r},ea.multiplyByScalar=function(e,t,r){return Un.typeOf.object("matrix",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r},ea.multiplyByScale=function(e,t,r){return Un.typeOf.object("matrix",e),Un.typeOf.object("scale",t),Un.typeOf.object("result",r),r[0]=e[0]*t.x,r[1]=e[1]*t.x,r[2]=e[2]*t.x,r[3]=e[3]*t.y,r[4]=e[4]*t.y,r[5]=e[5]*t.y,r[6]=e[6]*t.z,r[7]=e[7]*t.z,r[8]=e[8]*t.z,r},ea.negate=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},ea.transpose=function(e,t){Un.typeOf.object("matrix",e),Un.typeOf.object("result",t);var r=e[0],n=e[3],i=e[6],o=e[1],s=e[4],a=e[7],u=e[2],c=e[5],l=e[8];return t[0]=r,t[1]=n,t[2]=i,t[3]=o,t[4]=s,t[5]=a,t[6]=u,t[7]=c,t[8]=l,t};var na=new qn(1,1,1);ea.getRotation=function(e,t){Un.typeOf.object("matrix",e),Un.typeOf.object("result",t);var r=qn.divideComponents(na,ea.getScale(e,ra),ra);return t=ea.multiplyByScale(e,r,t)};var ia=[1,0,0],oa=[2,2,1];function sa(e){for(var t=0,r=0;r<3;++r){var n=e[ea.getElementIndex(oa[r],ia[r])];t+=2*n*n}return Math.sqrt(t)}function aa(e,t){for(var r=zn.EPSILON15,n=0,i=1,o=0;o<3;++o){var s=Math.abs(e[ea.getElementIndex(oa[o],ia[o])]);s>n&&(i=o,n=s)}var a=1,u=0,c=ia[i],l=oa[i];if(Math.abs(e[ea.getElementIndex(l,c)])>r){var h,p=(e[ea.getElementIndex(l,l)]-e[ea.getElementIndex(c,c)])/2/e[ea.getElementIndex(l,c)];u=(h=p<0?-1/(-p+Math.sqrt(1+p*p)):1/(p+Math.sqrt(1+p*p)))*(a=1/Math.sqrt(1+h*h))}return(t=ea.clone(ea.IDENTITY,t))[ea.getElementIndex(c,c)]=t[ea.getElementIndex(l,l)]=a,t[ea.getElementIndex(l,c)]=u,t[ea.getElementIndex(c,l)]=-u,t}var ua=new ea,ca=new ea;function la(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A){this[0]=Qn(e,0),this[1]=Qn(i,0),this[2]=Qn(u,0),this[3]=Qn(p,0),this[4]=Qn(t,0),this[5]=Qn(o,0),this[6]=Qn(c,0),this[7]=Qn(f,0),this[8]=Qn(r,0),this[9]=Qn(s,0),this[10]=Qn(l,0),this[11]=Qn(d,0),this[12]=Qn(n,0),this[13]=Qn(a,0),this[14]=Qn(h,0),this[15]=Qn(A,0),this.isMatrix4=!0}ea.computeEigenDecomposition=function(e,t){Un.typeOf.object("matrix",e);var r=zn.EPSILON20,n=0,i=0;Nn(t)||(t={});for(var o=t.unitary=ea.clone(ea.IDENTITY,t.unitary),s=t.diagonal=ea.clone(e,t.diagonal),a=r*function(e){for(var t=0,r=0;r<9;++r){var n=e[r];t+=n*n}return Math.sqrt(t)}(s);i<10&&sa(s)>a;)aa(s,ua),ea.transpose(ua,ca),ea.multiply(s,ua,s),ea.multiply(ca,s,s),ea.multiply(o,ua,o),++n>2&&(++i,n=0);return t},ea.abs=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},ea.determinant=function(e){Un.typeOf.object("matrix",e);var t=e[0],r=e[3],n=e[6],i=e[1],o=e[4],s=e[7],a=e[2],u=e[5],c=e[8];return t*(o*c-u*s)+i*(u*n-r*c)+a*(r*s-o*n)},ea.inverse=function(e,t){Un.typeOf.object("matrix",e),Un.typeOf.object("result",t);var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=ea.determinant(e);if(Math.abs(h)<=zn.EPSILON15)throw new Ln("matrix is not invertible");t[0]=s*l-c*a,t[1]=c*i-n*l,t[2]=n*a-s*i,t[3]=u*a-o*l,t[4]=r*l-u*i,t[5]=o*i-r*a,t[6]=o*c-u*s,t[7]=u*n-r*c,t[8]=r*s-o*n;var p=1/h;return ea.multiplyByScalar(t,p,t)},ea.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},ea.equalsEpsilon=function(e,t,r){return Un.typeOf.number("epsilon",r),e===t||Nn(e)&&Nn(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r&&Math.abs(e[4]-t[4])<=r&&Math.abs(e[5]-t[5])<=r&&Math.abs(e[6]-t[6])<=r&&Math.abs(e[7]-t[7])<=r&&Math.abs(e[8]-t[8])<=r},ea.IDENTITY=Object.freeze(new ea(1,0,0,0,1,0,0,0,1)),ea.ZERO=Object.freeze(new ea(0,0,0,0,0,0,0,0,0)),ea.COLUMN0ROW0=0,ea.COLUMN0ROW1=1,ea.COLUMN0ROW2=2,ea.COLUMN1ROW0=3,ea.COLUMN1ROW1=4,ea.COLUMN1ROW2=5,ea.COLUMN2ROW0=6,ea.COLUMN2ROW1=7,ea.COLUMN2ROW2=8,Object.defineProperties(ea.prototype,{length:{get:function(){return ea.packedLength}}}),ea.prototype.clone=function(e){return ea.clone(this,e)},ea.prototype.equals=function(e){return ea.equals(this,e)},ea.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]&&e[4]===t[r+4]&&e[5]===t[r+5]&&e[6]===t[r+6]&&e[7]===t[r+7]&&e[8]===t[r+8]},ea.prototype.equalsEpsilon=function(e,t){return ea.equalsEpsilon(this,e,t)},ea.prototype.toString=function(){return"("+this[0]+", "+this[3]+", "+this[6]+")\n("+this[1]+", "+this[4]+", "+this[7]+")\n("+this[2]+", "+this[5]+", "+this[8]+")"},ea.prototype.toArray=function(e,t){ea.pack(this,e,t)},la.packedLength=16,la.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t[r++]=e[4],t[r++]=e[5],t[r++]=e[6],t[r++]=e[7],t[r++]=e[8],t[r++]=e[9],t[r++]=e[10],t[r++]=e[11],t[r++]=e[12],t[r++]=e[13],t[r++]=e[14],t[r]=e[15],t},la.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new la),r[0]=e[t++],r[1]=e[t++],r[2]=e[t++],r[3]=e[t++],r[4]=e[t++],r[5]=e[t++],r[6]=e[t++],r[7]=e[t++],r[8]=e[t++],r[9]=e[t++],r[10]=e[t++],r[11]=e[t++],r[12]=e[t++],r[13]=e[t++],r[14]=e[t++],r[15]=e[t],r},la.clone=function(e,t){if(Nn(e))return Nn(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new la(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},la.fromArray=la.unpack,la.fromColumnMajorArray=function(e,t){return Un.defined("values",e),la.clone(e,t)},la.fromRowMajorArray=function(e,t){return Un.defined("values",e),Nn(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new la(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},la.fromRotationTranslation=function(e,t,r){return Un.typeOf.object("rotation",e),t=Qn(t,qn.ZERO),Nn(r)?(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=0,r[4]=e[3],r[5]=e[4],r[6]=e[5],r[7]=0,r[8]=e[6],r[9]=e[7],r[10]=e[8],r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,r):new la(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)},la.fromTranslationQuaternionRotationScale=function(e,t,r,n){Un.typeOf.object("translation",e),Un.typeOf.object("rotation",t),Un.typeOf.object("scale",r),Nn(n)||(n=new la);var i=r.x,o=r.y,s=r.z,a=t.x*t.x,u=t.x*t.y,c=t.x*t.z,l=t.x*t.w,h=t.y*t.y,p=t.y*t.z,f=t.y*t.w,d=t.z*t.z,A=t.z*t.w,g=t.w*t.w,_=a-h-d+g,m=2*(u-A),y=2*(c+f),E=2*(u+A),x=-a+h-d+g,C=2*(p-l),b=2*(c-f),I=2*(p+l),v=-a-h+d+g;return n[0]=_*i,n[1]=E*i,n[2]=b*i,n[3]=0,n[4]=m*o,n[5]=x*o,n[6]=I*o,n[7]=0,n[8]=y*s,n[9]=C*s,n[10]=v*s,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,n},la.fromTranslationRotationScale=function(e,t){return Un.typeOf.object("translationRotationScale",e),la.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},la.fromTranslation=function(e,t){return Un.typeOf.object("translation",e),la.fromRotationTranslation(ea.IDENTITY,e,t)},la.fromScale=function(e,t){return Un.typeOf.object("scale",e),Nn(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new la(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},la.fromUniformScale=function(e,t){return Un.typeOf.number("scale",e),Nn(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new la(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};var ha=new qn,pa=new qn,fa=new qn;la.fromCamera=function(e,t){Un.typeOf.object("camera",e);var r=e.position,n=e.direction,i=e.up;Un.typeOf.object("camera.position",r),Un.typeOf.object("camera.direction",n),Un.typeOf.object("camera.up",i),qn.normalize(n,ha),qn.normalize(qn.cross(ha,i,pa),pa),qn.normalize(qn.cross(pa,ha,fa),fa);var o=pa.x,s=pa.y,a=pa.z,u=ha.x,c=ha.y,l=ha.z,h=fa.x,p=fa.y,f=fa.z,d=r.x,A=r.y,g=r.z,_=o*-d+s*-A+a*-g,m=h*-d+p*-A+f*-g,y=u*d+c*A+l*g;return Nn(t)?(t[0]=o,t[1]=h,t[2]=-u,t[3]=0,t[4]=s,t[5]=p,t[6]=-c,t[7]=0,t[8]=a,t[9]=f,t[10]=-l,t[11]=0,t[12]=_,t[13]=m,t[14]=y,t[15]=1,t):new la(o,s,a,_,h,p,f,m,-u,-c,-l,y,0,0,0,1)},la.computePerspectiveFieldOfView=function(e,t,r,n,i){Un.typeOf.number.greaterThan("fovY",e,0),Un.typeOf.number.lessThan("fovY",e,Math.PI),Un.typeOf.number.greaterThan("near",r,0),Un.typeOf.number.greaterThan("far",n,0),Un.typeOf.object("result",i);var o=1/Math.tan(.5*e),s=o/t,a=(n+r)/(r-n),u=2*n*r/(r-n);return i[0]=s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=a,i[11]=-1,i[12]=0,i[13]=0,i[14]=u,i[15]=0,i},la.computeOrthographicOffCenter=function(e,t,r,n,i,o,s){Un.typeOf.number("left",e),Un.typeOf.number("right",t),Un.typeOf.number("bottom",r),Un.typeOf.number("top",n),Un.typeOf.number("near",i),Un.typeOf.number("far",o),Un.typeOf.object("result",s);var a=1/(t-e),u=1/(n-r),c=1/(o-i),l=-(t+e)*a,h=-(n+r)*u,p=-(o+i)*c;return a*=2,u*=2,c*=-2,s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=u,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=c,s[11]=0,s[12]=l,s[13]=h,s[14]=p,s[15]=1,la.halfZRange&&la.multiply(la.ConvertNDCToHalfZRange,s,s),s},la.computePerspectiveOffCenter=function(e,t,r,n,i,o,s){Un.typeOf.number("left",e),Un.typeOf.number("right",t),Un.typeOf.number("bottom",r),Un.typeOf.number("top",n),Un.typeOf.number("near",i),Un.typeOf.number("far",o),Un.typeOf.object("result",s);var a=2*i/(t-e),u=2*i/(n-r),c=(t+e)/(t-e),l=(n+r)/(n-r),h=-(o+i)/(o-i),p=-2*o*i/(o-i);return s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=u,s[6]=0,s[7]=0,s[8]=c,s[9]=l,s[10]=h,s[11]=-1,s[12]=0,s[13]=0,s[14]=p,s[15]=0,la.halfZRange&&la.multiply(la.ConvertNDCToHalfZRange,s,s),s},la.computeInfinitePerspectiveOffCenter=function(e,t,r,n,i,o){Un.typeOf.number("left",e),Un.typeOf.number("right",t),Un.typeOf.number("bottom",r),Un.typeOf.number("top",n),Un.typeOf.number("near",i),Un.typeOf.object("result",o);var s=2*i/(t-e),a=2*i/(n-r),u=(t+e)/(t-e),c=(n+r)/(n-r),l=-2*i;return o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=a,o[6]=0,o[7]=0,o[8]=u,o[9]=c,o[10]=-1,o[11]=-1,o[12]=0,o[13]=0,o[14]=l,o[15]=0,la.halfZRange&&la.multiply(la.ConvertNDCToHalfZRange,o,o),o},la.computeViewportTransformation=function(e,t,r,n){Un.typeOf.object("result",n),e=Qn(e,Qn.EMPTY_OBJECT);var i=Qn(e.x,0),o=Qn(e.y,0),s=Qn(e.width,0),a=Qn(e.height,0);t=Qn(t,0);var u=.5*s,c=.5*a,l=.5*((r=Qn(r,1))-t),h=u,p=c,f=l,d=i+u,A=o+c,g=t+l;return n[0]=h,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=p,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=f,n[11]=0,n[12]=d,n[13]=A,n[14]=g,n[15]=1,n},la.computeView=function(e,t,r,n,i){return Un.typeOf.object("position",e),Un.typeOf.object("direction",t),Un.typeOf.object("up",r),Un.typeOf.object("right",n),Un.typeOf.object("result",i),i[0]=n.x,i[1]=r.x,i[2]=-t.x,i[3]=0,i[4]=n.y,i[5]=r.y,i[6]=-t.y,i[7]=0,i[8]=n.z,i[9]=r.z,i[10]=-t.z,i[11]=0,i[12]=-qn.dot(n,e),i[13]=-qn.dot(r,e),i[14]=qn.dot(t,e),i[15]=1,i},la.toArray=function(e,t){return Un.typeOf.object("matrix",e),Nn(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},la.getElementIndex=function(e,t){return Un.typeOf.number.greaterThanOrEquals("row",t,0),Un.typeOf.number.lessThanOrEquals("row",t,3),Un.typeOf.number.greaterThanOrEquals("column",e,0),Un.typeOf.number.lessThanOrEquals("column",e,3),4*e+t},la.getColumn=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,3),Un.typeOf.object("result",r);var n=4*t,i=e[n],o=e[n+1],s=e[n+2],a=e[n+3];return r.x=i,r.y=o,r.z=s,r.w=a,r},la.setColumn=function(e,t,r,n){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,3),Un.typeOf.object("cartesian",r),Un.typeOf.object("result",n);var i=4*t;return(n=la.clone(e,n))[i]=r.x,n[i+1]=r.y,n[i+2]=r.z,n[i+3]=r.w,n},la.setTranslation=function(e,t,r){return Un.typeOf.object("matrix",e),Un.typeOf.object("translation",t),Un.typeOf.object("result",r),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=e[15],r};var da=new qn;la.setScale=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("scale",t),Un.typeOf.object("result",r);var n=la.getScale(e,da),i=qn.divideComponents(t,n,da);return la.multiplyByScale(e,i,r)},la.getRow=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,3),Un.typeOf.object("result",r);var n=e[t],i=e[t+4],o=e[t+8],s=e[t+12];return r.x=n,r.y=i,r.z=o,r.w=s,r},la.setRow=function(e,t,r,n){return Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,3),Un.typeOf.object("cartesian",r),Un.typeOf.object("result",n),(n=la.clone(e,n))[t]=r.x,n[t+4]=r.y,n[t+8]=r.z,n[t+12]=r.w,n};var Aa=new qn;la.getScale=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t.x=qn.magnitude(qn.fromElements(e[0],e[1],e[2],Aa)),t.y=qn.magnitude(qn.fromElements(e[4],e[5],e[6],Aa)),t.z=qn.magnitude(qn.fromElements(e[8],e[9],e[10],Aa)),t};var ga=new qn;la.getMaximumScale=function(e){return la.getScale(e,ga),qn.maximumComponent(ga)},la.multiply=function(e,t,r){Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r);var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],p=e[9],f=e[10],d=e[11],A=e[12],g=e[13],_=e[14],m=e[15],y=t[0],E=t[1],x=t[2],C=t[3],b=t[4],I=t[5],v=t[6],T=t[7],R=t[8],S=t[9],M=t[10],w=t[11],B=t[12],O=t[13],D=t[14],F=t[15],P=n*y+a*E+h*x+A*C,N=i*y+u*E+p*x+g*C,L=o*y+c*E+f*x+_*C,U=s*y+l*E+d*x+m*C,G=n*b+a*I+h*v+A*T,Q=i*b+u*I+p*v+g*T,k=o*b+c*I+f*v+_*T,z=s*b+l*I+d*v+m*T,j=n*R+a*S+h*M+A*w,H=i*R+u*S+p*M+g*w,q=o*R+c*S+f*M+_*w,V=s*R+l*S+d*M+m*w,Y=n*B+a*O+h*D+A*F,X=i*B+u*O+p*D+g*F,W=o*B+c*O+f*D+_*F,K=s*B+l*O+d*D+m*F;return r[0]=P,r[1]=N,r[2]=L,r[3]=U,r[4]=G,r[5]=Q,r[6]=k,r[7]=z,r[8]=j,r[9]=H,r[10]=q,r[11]=V,r[12]=Y,r[13]=X,r[14]=W,r[15]=K,r},la.add=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r},la.subtract=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r},la.multiplyTransformation=function(e,t,r){Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r);var n=e[0],i=e[1],o=e[2],s=e[4],a=e[5],u=e[6],c=e[8],l=e[9],h=e[10],p=e[12],f=e[13],d=e[14],A=t[0],g=t[1],_=t[2],m=t[4],y=t[5],E=t[6],x=t[8],C=t[9],b=t[10],I=t[12],v=t[13],T=t[14],R=n*A+s*g+c*_,S=i*A+a*g+l*_,M=o*A+u*g+h*_,w=n*m+s*y+c*E,B=i*m+a*y+l*E,O=o*m+u*y+h*E,D=n*x+s*C+c*b,F=i*x+a*C+l*b,P=o*x+u*C+h*b,N=n*I+s*v+c*T+p,L=i*I+a*v+l*T+f,U=o*I+u*v+h*T+d;return r[0]=R,r[1]=S,r[2]=M,r[3]=0,r[4]=w,r[5]=B,r[6]=O,r[7]=0,r[8]=D,r[9]=F,r[10]=P,r[11]=0,r[12]=N,r[13]=L,r[14]=U,r[15]=1,r},la.multiplyByMatrix3=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("rotation",t),Un.typeOf.object("result",r);var n=e[0],i=e[1],o=e[2],s=e[4],a=e[5],u=e[6],c=e[8],l=e[9],h=e[10],p=t[0],f=t[1],d=t[2],A=t[3],g=t[4],_=t[5],m=t[6],y=t[7],E=t[8],x=n*p+s*f+c*d,C=i*p+a*f+l*d,b=o*p+u*f+h*d,I=n*A+s*g+c*_,v=i*A+a*g+l*_,T=o*A+u*g+h*_,R=n*m+s*y+c*E,S=i*m+a*y+l*E,M=o*m+u*y+h*E;return r[0]=x,r[1]=C,r[2]=b,r[3]=0,r[4]=I,r[5]=v,r[6]=T,r[7]=0,r[8]=R,r[9]=S,r[10]=M,r[11]=0,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},la.multiplyByTranslation=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("translation",t),Un.typeOf.object("result",r);var n=t.x,i=t.y,o=t.z,s=n*e[0]+i*e[4]+o*e[8]+e[12],a=n*e[1]+i*e[5]+o*e[9]+e[13],u=n*e[2]+i*e[6]+o*e[10]+e[14];return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=s,r[13]=a,r[14]=u,r[15]=e[15],r};var _a=new qn;la.multiplyByUniformScale=function(e,t,r){return Un.typeOf.object("matrix",e),Un.typeOf.number("scale",t),Un.typeOf.object("result",r),_a.x=t,_a.y=t,_a.z=t,la.multiplyByScale(e,_a,r)},la.multiplyByScale=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("scale",t),Un.typeOf.object("result",r);var n=t.x,i=t.y,o=t.z;return 1===n&&1===i&&1===o?la.clone(e,r):(r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=0,r[4]=i*e[4],r[5]=i*e[5],r[6]=i*e[6],r[7]=0,r[8]=o*e[8],r[9]=o*e[9],r[10]=o*e[10],r[11]=0,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=1,r)},la.multiplyByVector=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("cartesian",t),Un.typeOf.object("result",r);var n=t.x,i=t.y,o=t.z,s=t.w,a=e[0]*n+e[4]*i+e[8]*o+e[12]*s,u=e[1]*n+e[5]*i+e[9]*o+e[13]*s,c=e[2]*n+e[6]*i+e[10]*o+e[14]*s,l=e[3]*n+e[7]*i+e[11]*o+e[15]*s;return r.x=a,r.y=u,r.z=c,r.w=l,r},la.multiplyByPointAsVector=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("cartesian",t),Un.typeOf.object("result",r);var n=t.x,i=t.y,o=t.z,s=e[0]*n+e[4]*i+e[8]*o,a=e[1]*n+e[5]*i+e[9]*o,u=e[2]*n+e[6]*i+e[10]*o;return r.x=s,r.y=a,r.z=u,r},la.multiplyByPoint=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("cartesian",t),Un.typeOf.object("result",r);var n=t.x,i=t.y,o=t.z,s=e[0]*n+e[4]*i+e[8]*o+e[12],a=e[1]*n+e[5]*i+e[9]*o+e[13],u=e[2]*n+e[6]*i+e[10]*o+e[14];return r.x=s,r.y=a,r.z=u,r},la.multiplyByDirection=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("cartesian",t),Un.typeOf.object("result",r);var n=t.x,i=t.y,o=t.z;return r.x=n*e[0]+i*e[4]+o*e[8],r.y=n*e[1]+i*e[5]+o*e[9],r.z=n*e[2]+i*e[6]+o*e[10],r},la.multiplyByScalar=function(e,t,r){return Un.typeOf.object("matrix",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r},la.multiplyByPlane=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("plane",t),Un.typeOf.object("result",r);var n=new la,i=new la;la.inverse(e,n),la.transpose(n,i);var o=new gi(t.normal.x,t.normal.y,t.normal.z,t.distance);la.multiplyByVector(i,o,o),r.normal.x=o.x,r.normal.y=o.y,r.normal.z=o.z;var s=qn.magnitude(r.normal);return qn.normalize(r.normal,r.normal),r.distance=o.w/s,r},la.negate=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},la.transpose=function(e,t){Un.typeOf.object("matrix",e),Un.typeOf.object("result",t);var r=e[1],n=e[2],i=e[3],o=e[6],s=e[7],a=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[10]=e[10],t[11]=e[14],t[12]=i,t[13]=s,t[14]=a,t[15]=e[15],t},la.abs=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},la.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},la.equalsEpsilon=function(e,t,r){return Un.typeOf.number("epsilon",r),e===t||Nn(e)&&Nn(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r&&Math.abs(e[4]-t[4])<=r&&Math.abs(e[5]-t[5])<=r&&Math.abs(e[6]-t[6])<=r&&Math.abs(e[7]-t[7])<=r&&Math.abs(e[8]-t[8])<=r&&Math.abs(e[9]-t[9])<=r&&Math.abs(e[10]-t[10])<=r&&Math.abs(e[11]-t[11])<=r&&Math.abs(e[12]-t[12])<=r&&Math.abs(e[13]-t[13])<=r&&Math.abs(e[14]-t[14])<=r&&Math.abs(e[15]-t[15])<=r},la.getTranslation=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t.x=e[12],t.y=e[13],t.z=e[14],t},la.getMatrix3=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},la.getRotation=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var ma=new ea,ya=new ea,Ea=new gi,xa=new gi(0,0,0,1);la.inverse=function(e,t){Un.typeOf.object("matrix",e),Un.typeOf.object("result",t);var r=e[0],n=e[4],i=e[8],o=e[12],s=e[1],a=e[5],u=e[9],c=e[13],l=e[2],h=e[6],p=e[10],f=e[14],d=e[3],A=e[7],g=e[11],_=e[15],m=p*_,y=f*g,E=h*_,x=f*A,C=h*g,b=p*A,I=l*_,v=f*d,T=l*g,R=p*d,S=l*A,M=h*d,w=m*a+x*u+C*c-(y*a+E*u+b*c),B=y*s+I*u+R*c-(m*s+v*u+T*c),O=E*s+v*a+S*c-(x*s+I*a+M*c),D=b*s+T*a+M*u-(C*s+R*a+S*u),F=y*n+E*i+b*o-(m*n+x*i+C*o),P=m*r+v*i+T*o-(y*r+I*i+R*o),N=x*r+I*n+M*o-(E*r+v*n+S*o),L=C*r+R*n+S*i-(b*r+T*n+M*i),U=(m=i*c)*A+(x=o*a)*g+(C=n*u)*_-((y=o*u)*A+(E=n*c)*g+(b=i*a)*_),G=y*d+(I=r*c)*g+(R=i*s)*_-(m*d+(v=o*s)*g+(T=r*u)*_),Q=E*d+v*A+(S=r*a)*_-(x*d+I*A+(M=n*s)*_),k=b*d+T*A+M*g-(C*d+R*A+S*g),z=E*p+b*f+y*h-(C*f+m*h+x*p),j=T*f+m*l+v*p-(I*p+R*f+y*l),H=I*h+M*f+x*l-(S*f+E*l+v*h),q=S*p+C*l+R*h-(T*h+M*p+b*l),V=r*w+n*B+i*O+o*D;if(Math.abs(V)<zn.EPSILON21){if(ea.equalsEpsilon(la.getRotation(e,ma),ya,zn.EPSILON5)&&gi.equals(la.getRow(e,3,Ea),xa))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new cs("matrix is not invertible because its determinate is zero.")}return V=1/V,t[0]=w*V,t[1]=B*V,t[2]=O*V,t[3]=D*V,t[4]=F*V,t[5]=P*V,t[6]=N*V,t[7]=L*V,t[8]=U*V,t[9]=G*V,t[10]=Q*V,t[11]=k*V,t[12]=z*V,t[13]=j*V,t[14]=H*V,t[15]=q*V,t},la.inverseTransformation=function(e,t){Un.typeOf.object("matrix",e),Un.typeOf.object("result",t);var r=e[0],n=e[1],i=e[2],o=e[4],s=e[5],a=e[6],u=e[8],c=e[9],l=e[10],h=e[12],p=e[13],f=e[14],d=-r*h-n*p-i*f,A=-o*h-s*p-a*f,g=-u*h-c*p-l*f;return t[0]=r,t[1]=o,t[2]=u,t[3]=0,t[4]=n,t[5]=s,t[6]=c,t[7]=0,t[8]=i,t[9]=a,t[10]=l,t[11]=0,t[12]=d,t[13]=A,t[14]=g,t[15]=1,t};const Ca=new la;var ba;la.inverseTranspose=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),la.inverse(la.transpose(e,Ca),t)},la.IDENTITY=Object.freeze(new la(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),la.ZERO=Object.freeze(new la(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),la.ConvertNDCToHalfZRange=Object.freeze(new la(1,0,0,0,0,1,0,0,0,0,.5,.5,0,0,0,1)),la.COLUMN0ROW0=0,la.COLUMN0ROW1=1,la.COLUMN0ROW2=2,la.COLUMN0ROW3=3,la.COLUMN1ROW0=4,la.COLUMN1ROW1=5,la.COLUMN1ROW2=6,la.COLUMN1ROW3=7,la.COLUMN2ROW0=8,la.COLUMN2ROW1=9,la.COLUMN2ROW2=10,la.COLUMN2ROW3=11,la.COLUMN3ROW0=12,la.COLUMN3ROW1=13,la.COLUMN3ROW2=14,la.COLUMN3ROW3=15,la.halfZRange=!1,Object.defineProperties(la.prototype,{length:{get:function(){return la.packedLength}}}),la.prototype.clone=function(e){return la.clone(this,e)},la.prototype.equals=function(e){return la.equals(this,e)},la.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]&&e[4]===t[r+4]&&e[5]===t[r+5]&&e[6]===t[r+6]&&e[7]===t[r+7]&&e[8]===t[r+8]&&e[9]===t[r+9]&&e[10]===t[r+10]&&e[11]===t[r+11]&&e[12]===t[r+12]&&e[13]===t[r+13]&&e[14]===t[r+14]&&e[15]===t[r+15]},la.prototype.equalsEpsilon=function(e,t){return la.equalsEpsilon(this,e,t)},la.prototype.toString=function(){return"("+this[0]+", "+this[4]+", "+this[8]+", "+this[12]+")\n("+this[1]+", "+this[5]+", "+this[9]+", "+this[13]+")\n("+this[2]+", "+this[6]+", "+this[10]+", "+this[14]+")\n("+this[3]+", "+this[7]+", "+this[11]+", "+this[15]+")"},la.prototype.toArray=function(e,t){la.pack(this,e,t)};var Ia,va,Ta,Ra,Sa,Ma,wa,Ba,Oa,Da,Fa,Pa,Na,La,Ua,Ga,Qa,ka,za={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},ja={};function Ha(e){for(var t=e.split("."),r=0,n=t.length;r<n;++r)t[r]=parseInt(t[r],10);return t}function qa(){if(!Nn(va)&&(va=!1,!Wa())){var e=/ Chrome\/([\.0-9]+)/.exec(Ia.userAgent);null!==e&&(va=!0,Ta=Ha(e[1]))}return va}function Va(){if(!Nn(Ra)&&(Ra=!1,!qa()&&!Wa()&&/ Safari\/[\.0-9]+/.test(Ia.userAgent))){var e=/ Version\/([\.0-9]+)/.exec(Ia.userAgent);null!==e&&(Ra=!0,Sa=Ha(e[1]))}return Ra}function Ya(){if(!Nn(Ma)){Ma=!1;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(Ia.userAgent);null!==e&&(Ma=!0,(wa=Ha(e[1])).isNightly=!!e[2])}return Ma}function Xa(){var e;Nn(Ba)||(Ba=!1,"Microsoft Internet Explorer"===Ia.appName?null!==(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(Ia.userAgent))&&(Ba=!0,Oa=Ha(e[1])):"Netscape"===Ia.appName&&null!==(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(Ia.userAgent))&&(Ba=!0,Oa=Ha(e[1])));return Ba}function Wa(){if(!Nn(Da)){Da=!1;var e=/ Edge\/([\.0-9]+)/.exec(Ia.userAgent);null!==e&&(Da=!0,Fa=Ha(e[1]))}return Da}function Ka(){if(!Nn(Pa)){Pa=!1;var e=/Firefox\/([\.0-9]+)/.exec(Ia.userAgent);null!==e&&(Pa=!0,Na=Ha(e[1]))}return Pa}function $a(){if(!Nn(ka)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var t=e.style.imageRendering;(ka=Nn(t)&&""!==t)&&(Qa=t)}return ka}function Ja(){if(!Ja.initialized)throw new DeveloperError("You must call FeatureDetection.supportsWebP.initialize and wait for the promise to resolve before calling FeatureDetection.supportsWebP");return Ja._result}Object.defineProperties(ja,{element:{get:function(){if(ja.supportsFullscreen())return document[za.fullscreenElement]}},changeEventName:{get:function(){if(ja.supportsFullscreen())return za.fullscreenchange}},errorEventName:{get:function(){if(ja.supportsFullscreen())return za.fullscreenerror}},enabled:{get:function(){if(ja.supportsFullscreen())return document[za.fullscreenEnabled]}},fullscreen:{get:function(){if(ja.supportsFullscreen())return null!==ja.element}}}),ja.supportsFullscreen=function(){if(Nn(ba))return ba;ba=!1;var e=document.body;if("function"==typeof e.requestFullscreen)return za.requestFullscreen="requestFullscreen",za.exitFullscreen="exitFullscreen",za.fullscreenEnabled="fullscreenEnabled",za.fullscreenElement="fullscreenElement",za.fullscreenchange="fullscreenchange",za.fullscreenerror="fullscreenerror",ba=!0;for(var t,r=["webkit","moz","o","ms","khtml"],n=0,i=r.length;n<i;++n){var o=r[n];("function"==typeof e[t=o+"RequestFullscreen"]||"function"==typeof e[t=o+"RequestFullScreen"])&&(za.requestFullscreen=t,ba=!0),t=o+"ExitFullscreen","function"==typeof document[t]?za.exitFullscreen=t:(t=o+"CancelFullScreen","function"==typeof document[t]&&(za.exitFullscreen=t)),t=o+"FullscreenEnabled",void 0!==document[t]?za.fullscreenEnabled=t:(t=o+"FullScreenEnabled",void 0!==document[t]&&(za.fullscreenEnabled=t)),t=o+"FullscreenElement",void 0!==document[t]?za.fullscreenElement=t:(t=o+"FullScreenElement",void 0!==document[t]&&(za.fullscreenElement=t)),t=o+"fullscreenchange",void 0!==document["on"+t]&&("ms"===o&&(t="MSFullscreenChange"),za.fullscreenchange=t),t=o+"fullscreenerror",void 0!==document["on"+t]&&("ms"===o&&(t="MSFullscreenError"),za.fullscreenerror=t)}return ba},ja.requestFullscreen=function(e,t){ja.supportsFullscreen()&&e[za.requestFullscreen]({vrDisplay:t})},ja.exitFullscreen=function(){ja.supportsFullscreen()&&document[za.exitFullscreen]()},ja._names=za,Ia="undefined"!=typeof navigator?navigator:{},Ja._promise=void 0,Ja._result=void 0,Ja.initialize=function(){if(Nn(Ja._promise))return Ja._promise;const e=_o();if(Ja._promise=e.promise,Wa())return Ja._result=!1,e.resolve(Ja._result),e.promise;const t=new Image;return t.onload=function(){Ja._result=t.width>0&&t.height>0,e.resolve(Ja._result)},t.onerror=function(){Ja._result=!1,e.resolve(Ja._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.promise},Object.defineProperties(Ja,{initialized:{get:function(){return Nn(Ja._result)}}});var Za=[];"undefined"!=typeof ArrayBuffer&&(Za.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&Za.push(Uint8ClampedArray),"undefined"!=typeof CanvasPixelArray&&Za.push(CanvasPixelArray));var eu={isChrome:qa,chromeVersion:function(){return qa()&&Ta},isSafari:Va,safariVersion:function(){return Va()&&Sa},isWebkit:Ya,webkitVersion:function(){return Ya()&&wa},isInternetExplorer:Xa,internetExplorerVersion:function(){return Xa()&&Oa},isEdge:Wa,edgeVersion:function(){return Wa()&&Fa},isFirefox:Ka,firefoxVersion:function(){return Ka()&&Na},isWindows:function(){return Nn(La)||(La=/Windows/i.test(Ia.appVersion)),La},isNodeJs:function(){return Nn(Ua)||(Ua="object"==typeof process&&"[object process]"===Object.prototype.toString.call(process)),Ua},hardwareConcurrency:Qn(Ia.hardwareConcurrency,3),supportsPointerEvents:function(){return Nn(Ga)||(Ga=!Ka()&&"undefined"!=typeof PointerEvent&&(!Nn(Ia.pointerEnabled)||Ia.pointerEnabled)),Ga},supportsImageRenderingPixelated:$a,supportsWebP:Ja,supportsWebPSync:function(){return Nn(undefined)||Ja.initialize(),Ja._result},imageRenderingValue:function(){return $a()?Qa:void 0},typedArrayTypes:Za,isPCBroswer:function(){var e=window.navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),r="iphone os"==e.match(/iphone os/i),n="midp"==e.match(/midp/i),i="ucweb"==e.match(/ucweb/i),o="android"==e.match(/android/i),s="windows ce"==e.match(/windows ce/i),a="windows mobile"==e.match(/windows mobile/i);return!(t||r||n||i||o||s||a)}};function tu(e,t,r,n){this.x=Qn(e,0),this.y=Qn(t,0),this.z=Qn(r,0),this.w=Qn(n,0)}eu.supportsFullscreen=function(){return ja.supportsFullscreen()},eu.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},eu.supportsWebWorkers=function(){return"undefined"!=typeof Worker},eu.supportsWebAssembly=function(){return"undefined"!=typeof WebAssembly&&!eu.isEdge()},eu.supportsOffscreenCanvas=function(){return"undefined"!=typeof OffscreenCanvas&&!eu.isEdge()},eu.supportsEsmWebWorkers=function(){return!Ka()||parseInt(Na)>=114};var ru=new qn;tu.fromAxisAngle=function(e,t,r){Un.typeOf.object("axis",e),Un.typeOf.number("angle",t);var n=t/2,i=Math.sin(n),o=(ru=qn.normalize(e,ru)).x*i,s=ru.y*i,a=ru.z*i,u=Math.cos(n);return Nn(r)?(r.x=o,r.y=s,r.z=a,r.w=u,r):new tu(o,s,a,u)};var nu=[1,2,0],iu=new Array(3);tu.fromRotationMatrix=function(e,t){var r,n,i,o,s;Un.typeOf.object("matrix",e);var a=e[ea.COLUMN0ROW0],u=e[ea.COLUMN1ROW1],c=e[ea.COLUMN2ROW2],l=a+u+c;if(l>0)s=.5*(r=Math.sqrt(l+1)),r=.5/r,n=(e[ea.COLUMN1ROW2]-e[ea.COLUMN2ROW1])*r,i=(e[ea.COLUMN2ROW0]-e[ea.COLUMN0ROW2])*r,o=(e[ea.COLUMN0ROW1]-e[ea.COLUMN1ROW0])*r;else{var h=0;u>a&&(h=1),c>a&&c>u&&(h=2);var p=nu[h],f=nu[p];r=Math.sqrt(e[ea.getElementIndex(h,h)]-e[ea.getElementIndex(p,p)]-e[ea.getElementIndex(f,f)]+1);var d=iu;d[h]=.5*r,r=.5/r,s=(e[ea.getElementIndex(f,p)]-e[ea.getElementIndex(p,f)])*r,d[p]=(e[ea.getElementIndex(p,h)]+e[ea.getElementIndex(h,p)])*r,d[f]=(e[ea.getElementIndex(f,h)]+e[ea.getElementIndex(h,f)])*r,n=-d[0],i=-d[1],o=-d[2]}return Nn(t)?(t.x=n,t.y=i,t.z=o,t.w=s,t):new tu(n,i,o,s)};var ou=new tu,su=new tu,au=new tu,uu=new tu;tu.fromHeadingPitchRoll=function(e,t){return Un.typeOf.object("headingPitchRoll",e),uu=tu.fromAxisAngle(qn.UNIT_X,e.roll,ou),au=tu.fromAxisAngle(qn.UNIT_Y,-e.pitch,t),t=tu.multiply(au,uu,au),su=tu.fromAxisAngle(qn.UNIT_Z,-e.heading,ou),tu.multiply(su,t,t)};var cu=new qn,lu=new qn,hu=new tu,pu=new tu,fu=new tu;tu.packedLength=4,tu.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e.x,t[r++]=e.y,t[r++]=e.z,t[r]=e.w,t},tu.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new tu),r.x=e[t],r.y=e[t+1],r.z=e[t+2],r.w=e[t+3],r},tu.packedInterpolationLength=3,tu.convertPackedArrayForInterpolation=function(e,t,r,n){tu.unpack(e,4*r,fu),tu.conjugate(fu,fu);for(var i=0,o=r-t+1;i<o;i++){var s=3*i;tu.unpack(e,4*(t+i),hu),tu.multiply(hu,fu,hu),hu.w<0&&tu.negate(hu,hu),tu.computeAxis(hu,cu);var a=tu.computeAngle(hu);n[s]=cu.x*a,n[s+1]=cu.y*a,n[s+2]=cu.z*a}},tu.unpackInterpolationResult=function(e,t,r,n,i){Nn(i)||(i=new tu),qn.fromArray(e,0,lu);var o=qn.magnitude(lu);return tu.unpack(t,4*n,pu),0===o?tu.clone(tu.IDENTITY,hu):tu.fromAxisAngle(lu,o,hu),tu.multiply(hu,pu,i)},tu.clone=function(e,t){if(Nn(e))return Nn(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new tu(e.x,e.y,e.z,e.w)},tu.conjugate=function(e,t){return Un.typeOf.object("quaternion",e),Un.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},tu.magnitudeSquared=function(e){return Un.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},tu.magnitude=function(e){return Math.sqrt(tu.magnitudeSquared(e))},tu.normalize=function(e,t){Un.typeOf.object("result",t);var r=1/tu.magnitude(e),n=e.x*r,i=e.y*r,o=e.z*r,s=e.w*r;return t.x=n,t.y=i,t.z=o,t.w=s,t},tu.inverse=function(e,t){Un.typeOf.object("result",t);var r=tu.magnitudeSquared(e);return t=tu.conjugate(e,t),tu.multiplyByScalar(t,1/r,t)},tu.add=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z,r.w=e.w+t.w,r},tu.subtract=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z,r.w=e.w-t.w,r},tu.negate=function(e,t){return Un.typeOf.object("quaternion",e),Un.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},tu.dot=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},tu.multiply=function(e,t,r){Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r);var n=e.x,i=e.y,o=e.z,s=e.w,a=t.x,u=t.y,c=t.z,l=t.w,h=s*a+n*l+i*c-o*u,p=s*u-n*c+i*l+o*a,f=s*c+n*u-i*a+o*l,d=s*l-n*a-i*u-o*c;return r.x=h,r.y=p,r.z=f,r.w=d,r},tu.multiplyByVec=function(e,t,r){var n=new qn,i=new qn,o=new qn(e.x,e.y,e.z);n=qn.cross(o,t,n),i=qn.cross(o,n,i);var s=new qn;s=qn.multiplyByScalar(n,2*e.w,s);var a=new qn;return a=qn.multiplyByScalar(n,2,a),r=qn.add(t,s,r),r=qn.add(r,a,r)},tu.multiplyByScalar=function(e,t,r){return Un.typeOf.object("quaternion",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r.z=e.z*t,r.w=e.w*t,r},tu.divideByScalar=function(e,t,r){return Un.typeOf.object("quaternion",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r.w=e.w/t,r},tu.computeAxis=function(e,t){Un.typeOf.object("quaternion",e),Un.typeOf.object("result",t);var r=e.w;if(Math.abs(r-1)<zn.EPSILON6)return t.x=t.y=t.z=0,t;var n=1/Math.sqrt(1-r*r);return t.x=e.x*n,t.y=e.y*n,t.z=e.z*n,t},tu.computeAngle=function(e){return Un.typeOf.object("quaternion",e),Math.abs(e.w-1)<zn.EPSILON6?0:2*Math.acos(e.w)};var du=new tu;tu.lerp=function(e,t,r,n){return Un.typeOf.object("start",e),Un.typeOf.object("end",t),Un.typeOf.number("t",r),Un.typeOf.object("result",n),du=tu.multiplyByScalar(t,r,du),n=tu.multiplyByScalar(e,1-r,n),tu.add(du,n,n)};var Au=new tu,gu=new tu,_u=new tu;tu.slerp=function(e,t,r,n){Un.typeOf.object("start",e),Un.typeOf.object("end",t),Un.typeOf.number("t",r),Un.typeOf.object("result",n);var i=tu.dot(e,t),o=t;if(i<0&&(i=-i,o=Au=tu.negate(t,Au)),1-i<zn.EPSILON6)return tu.lerp(e,o,r,n);var s=Math.acos(i);return gu=tu.multiplyByScalar(e,Math.sin((1-r)*s),gu),_u=tu.multiplyByScalar(o,Math.sin(r*s),_u),n=tu.add(gu,_u,n),tu.multiplyByScalar(n,1/Math.sin(s),n)},tu.log=function(e,t){Un.typeOf.object("quaternion",e),Un.typeOf.object("result",t);var r=zn.acosClamped(e.w),n=0;return 0!==r&&(n=r/Math.sin(r)),qn.multiplyByScalar(e,n,t)},tu.exp=function(e,t){Un.typeOf.object("cartesian",e),Un.typeOf.object("result",t);var r=qn.magnitude(e),n=0;return 0!==r&&(n=Math.sin(r)/r),t.x=e.x*n,t.y=e.y*n,t.z=e.z*n,t.w=Math.cos(r),t};var mu=new qn,yu=new qn,Eu=new tu,xu=new tu;tu.computeInnerQuadrangle=function(e,t,r,n){Un.typeOf.object("q0",e),Un.typeOf.object("q1",t),Un.typeOf.object("q2",r),Un.typeOf.object("result",n);var i=tu.conjugate(t,Eu);tu.multiply(i,r,xu);var o=tu.log(xu,mu);tu.multiply(i,e,xu);var s=tu.log(xu,yu);return qn.add(o,s,o),qn.multiplyByScalar(o,.25,o),qn.negate(o,o),tu.exp(o,Eu),tu.multiply(t,Eu,n)},tu.squad=function(e,t,r,n,i,o){Un.typeOf.object("q0",e),Un.typeOf.object("q1",t),Un.typeOf.object("s0",r),Un.typeOf.object("s1",n),Un.typeOf.number("t",i),Un.typeOf.object("result",o);var s=tu.slerp(e,t,i,Eu),a=tu.slerp(r,n,i,xu);return tu.slerp(s,a,2*i*(1-i),o)};for(var Cu=new tu,bu=1.9011074535173003,Iu=eu.supportsTypedArrays()?new Float32Array(8):[],vu=eu.supportsTypedArrays()?new Float32Array(8):[],Tu=eu.supportsTypedArrays()?new Float32Array(8):[],Ru=eu.supportsTypedArrays()?new Float32Array(8):[],Su=0;Su<7;++Su){var Mu=Su+1,wu=2*Mu+1;Iu[Su]=1/(Mu*wu),vu[Su]=Mu/wu}function Bu(e){this._ellipsoid=Qn(e,Os.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Iu[7]=bu/136,vu[7]=8*bu/17,tu.fastSlerp=function(e,t,r,n){Un.typeOf.object("start",e),Un.typeOf.object("end",t),Un.typeOf.number("t",r),Un.typeOf.object("result",n);var i,o=tu.dot(e,t);o>=0?i=1:(i=-1,o=-o);for(var s=o-1,a=1-r,u=r*r,c=a*a,l=7;l>=0;--l)Tu[l]=(Iu[l]*u-vu[l])*s,Ru[l]=(Iu[l]*c-vu[l])*s;var h=i*r*(1+Tu[0]*(1+Tu[1]*(1+Tu[2]*(1+Tu[3]*(1+Tu[4]*(1+Tu[5]*(1+Tu[6]*(1+Tu[7])))))))),p=a*(1+Ru[0]*(1+Ru[1]*(1+Ru[2]*(1+Ru[3]*(1+Ru[4]*(1+Ru[5]*(1+Ru[6]*(1+Ru[7])))))))),f=tu.multiplyByScalar(e,p,Cu);return tu.multiplyByScalar(t,h,n),tu.add(f,n,n)},tu.fastSquad=function(e,t,r,n,i,o){Un.typeOf.object("q0",e),Un.typeOf.object("q1",t),Un.typeOf.object("s0",r),Un.typeOf.object("s1",n),Un.typeOf.number("t",i),Un.typeOf.object("result",o);var s=tu.fastSlerp(e,t,i,Eu),a=tu.fastSlerp(r,n,i,xu);return tu.fastSlerp(s,a,2*i*(1-i),o)},tu.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},tu.equalsEpsilon=function(e,t,r){return Un.typeOf.number("epsilon",r),e===t||Nn(e)&&Nn(t)&&Math.abs(e.x-t.x)<=r&&Math.abs(e.y-t.y)<=r&&Math.abs(e.z-t.z)<=r&&Math.abs(e.w-t.w)<=r},tu.ZERO=Object.freeze(new tu(0,0,0,0)),tu.IDENTITY=Object.freeze(new tu(0,0,0,1)),tu.prototype.clone=function(e){return tu.clone(this,e)},tu.prototype.equals=function(e){return tu.equals(this,e)},tu.prototype.equalsEpsilon=function(e,t){return tu.equalsEpsilon(this,e,t)},tu.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},Object.defineProperties(Bu.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),Bu.prototype.project=function(e,t){var r=this._semimajorAxis,n=e.longitude*r,i=e.latitude*r,o=e.height;return Nn(t)?(t.x=n,t.y=i,t.z=o,t):new qn(n,i,o)},Bu.prototype.unproject=function(e,t){if(!Nn(e))throw new Ln("cartesian is required");var r=this._oneOverSemimajorAxis,n=e.x*r,i=e.y*r,o=e.z;return Nn(t)?(t.longitude=n,t.latitude=i,t.height=o,t):new ni(n,i,o)};var Ou={},Du={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Fu={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Pu={},Nu={east:new qn,north:new qn,up:new qn,west:new qn,south:new qn,down:new qn},Lu=new qn,Uu=new qn,Gu=new qn;Ou.localFrameToFixedFrameGenerator=function(e,t){if(!Du.hasOwnProperty(e)||!Du[e].hasOwnProperty(t))throw new Ln("firstAxis and secondAxis must be east, north, up, west, south or down.");var r,n=Du[e][t],i=e+t;return Nn(Pu[i])?r=Pu[i]:(r=function(r,i,o){if(!Nn(r))throw new Ln("origin is required.");if(Nn(o)||(o=new la),qn.equalsEpsilon(r,qn.ZERO,zn.EPSILON14))qn.unpack(Fu[e],0,Lu),qn.unpack(Fu[t],0,Uu),qn.unpack(Fu[n],0,Gu);else if(zn.equalsEpsilon(r.x,0,zn.EPSILON14)&&zn.equalsEpsilon(r.y,0,zn.EPSILON14)){var s=zn.sign(r.z);qn.unpack(Fu[e],0,Lu),"east"!==e&&"west"!==e&&qn.multiplyByScalar(Lu,s,Lu),qn.unpack(Fu[t],0,Uu),"east"!==t&&"west"!==t&&qn.multiplyByScalar(Uu,s,Uu),qn.unpack(Fu[n],0,Gu),"east"!==n&&"west"!==n&&qn.multiplyByScalar(Gu,s,Gu)}else{(i=Qn(i,Os.WGS84)).geodeticSurfaceNormal(r,Nu.up);var a=Nu.up,u=Nu.east;u.x=-r.y,u.y=r.x,u.z=0,qn.normalize(u,Nu.east),qn.cross(a,u,Nu.north),qn.multiplyByScalar(Nu.up,-1,Nu.down),qn.multiplyByScalar(Nu.east,-1,Nu.west),qn.multiplyByScalar(Nu.north,-1,Nu.south),Lu=Nu[e],Uu=Nu[t],Gu=Nu[n]}return o[0]=Lu.x,o[1]=Lu.y,o[2]=Lu.z,o[3]=0,o[4]=Uu.x,o[5]=Uu.y,o[6]=Uu.z,o[7]=0,o[8]=Gu.x,o[9]=Gu.y,o[10]=Gu.z,o[11]=0,o[12]=r.x,o[13]=r.y,o[14]=r.z,o[15]=1,o},Pu[i]=r),r},Ou.eastNorthUpToFixedFrame=Ou.localFrameToFixedFrameGenerator("east","north"),Ou.northEastDownToFixedFrame=Ou.localFrameToFixedFrameGenerator("north","east"),Ou.northUpEastToFixedFrame=Ou.localFrameToFixedFrameGenerator("north","up"),Ou.northWestUpToFixedFrame=Ou.localFrameToFixedFrameGenerator("north","west");var Qu=new tu,ku=new qn(1,1,1),zu=new la;Ou.headingPitchRollToFixedFrame=function(e,t,r,n,i){Un.typeOf.object("HeadingPitchRoll",t),n=Qn(n,Ou.eastNorthUpToFixedFrame);var o=tu.fromHeadingPitchRoll(t,Qu),s=la.fromTranslationQuaternionRotationScale(qn.ZERO,o,ku,zu);return i=n(e,r,i),la.multiply(i,s,i)};var ju=new la,Hu=new ea;Ou.headingPitchRollQuaternion=function(e,t,r,n,i){Un.typeOf.object("HeadingPitchRoll",t);var o=Ou.headingPitchRollToFixedFrame(e,t,r,n,ju),s=la.getMatrix3(o,Hu);return tu.fromRotationMatrix(s,i)};var qu=new qn(1,1,1),Vu=new qn,Yu=new la,Xu=new la,Wu=new ea,Ku=new tu;Ou.fixedFrameToHeadingPitchRoll=function(e,t,r,n){Un.defined("transform",e),t=Qn(t,Os.WGS84),r=Qn(r,Ou.eastNorthUpToFixedFrame),Nn(n)||(n=new Gs);var i=la.getTranslation(e,Vu);if(qn.equals(i,qn.ZERO))return n.heading=0,n.pitch=0,n.roll=0,n;var o=la.inverseTransformation(r(i,t,Yu),Yu),s=la.setScale(e,qu,Xu);s=la.setTranslation(s,qn.ZERO,s),o=la.multiply(o,s,o);var a=tu.fromRotationMatrix(la.getMatrix3(o,Wu),Ku);return a=tu.normalize(a,a),Gs.fromQuaternion(a,n)};var $u=zn.TWO_PI/86400,Ju=new Ki;Ou.computeTemeToPseudoFixedMatrix=function(e,t){if(!Nn(e))throw new Ln("date is required.");var r,n=(Ju=Ki.addSeconds(e,-Ki.computeTaiMinusUtc(e),Ju)).dayNumber,i=Ju.secondsOfDay,o=n-2451545,s=(24110.54841+(r=i>=43200?(o+.5)/wi.DAYS_PER_JULIAN_CENTURY:(o-.5)/wi.DAYS_PER_JULIAN_CENTURY)*(8640184.812866+r*(.093104+-62e-7*r)))*$u%zn.TWO_PI+(72921158553e-15+11772758384668e-32*(n-2451545.5))*((i+.5*wi.SECONDS_PER_DAY)%wi.SECONDS_PER_DAY),a=Math.cos(s),u=Math.sin(s);return Nn(t)?(t[0]=a,t[1]=-u,t[2]=0,t[3]=u,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new ea(a,u,0,-u,a,0,0,0,1)},Ou.iau2006XysData=new Ks,Ou.earthOrientationParameters=vs.NONE;var Zu=32.184;Ou.preloadIcrfFixed=function(e){var t=e.start.dayNumber,r=e.start.secondsOfDay+Zu,n=e.stop.dayNumber,i=e.stop.secondsOfDay+Zu,o=Ou.iau2006XysData.preload(t,r,n,i),s=Ou.earthOrientationParameters.getPromiseToLoad();return Promise.all([o,s])},Ou.computeIcrfToFixedMatrix=function(e,t){if(!Nn(e))throw new Ln("date is required.");Nn(t)||(t=new ea);var r=Ou.computeFixedToIcrfMatrix(e,t);if(Nn(r))return ea.transpose(r,t)};var ec=new Ws(0,0,0),tc=new vi(0,0,0,0,0),rc=new ea,nc=new ea;Ou.computeFixedToIcrfMatrix=function(e,t){if(!Nn(e))throw new Ln("date is required.");Nn(t)||(t=new ea);var r=Ou.earthOrientationParameters.compute(e,tc);if(Nn(r)){var n=e.dayNumber,i=e.secondsOfDay+Zu,o=Ou.iau2006XysData.computeXysRadians(n,i,ec);if(Nn(o)){var s=o.x+r.xPoleOffset,a=o.y+r.yPoleOffset,u=1/(1+Math.sqrt(1-s*s-a*a)),c=rc;c[0]=1-u*s*s,c[3]=-u*s*a,c[6]=s,c[1]=-u*s*a,c[4]=1-u*a*a,c[7]=a,c[2]=-s,c[5]=-a,c[8]=1-u*(s*s+a*a);var l=ea.fromRotationZ(-o.s,nc),h=ea.multiply(c,l,rc),p=e.dayNumber-2451545,f=(e.secondsOfDay-Ki.computeTaiMinusUtc(e)+r.ut1MinusUtc)/wi.SECONDS_PER_DAY,d=.779057273264+f+.00273781191135448*(p+f);d=d%1*zn.TWO_PI;var A=ea.fromRotationZ(d,nc),g=ea.multiply(h,A,rc),_=Math.cos(r.xPoleWander),m=Math.cos(r.yPoleWander),y=Math.sin(r.xPoleWander),E=Math.sin(r.yPoleWander),x=n-2451545+i/wi.SECONDS_PER_DAY,C=-47e-6*(x/=36525)*zn.RADIANS_PER_DEGREE/3600,b=Math.cos(C),I=Math.sin(C),v=nc;return v[0]=_*b,v[1]=_*I,v[2]=y,v[3]=-m*I+E*y*b,v[4]=m*b+E*y*I,v[5]=-E*_,v[6]=-E*I-m*y*b,v[7]=E*b-m*y*I,v[8]=m*_,ea.multiply(g,v,t)}}};var ic=new gi;Ou.pointToWindowCoordinates=function(e,t,r,n){return(n=Ou.pointToGLWindowCoordinates(e,t,r,n)).y=2*t[5]-n.y,n},Ou.pointToGLWindowCoordinates=function(e,t,r,n){if(!Nn(e))throw new Ln("modelViewProjectionMatrix is required.");if(!Nn(t))throw new Ln("viewportTransformation is required.");if(!Nn(r))throw new Ln("point is required.");Nn(n)||(n=new li);var i=ic;return la.multiplyByVector(e,gi.fromElements(r.x,r.y,r.z,1,i),i),gi.multiplyByScalar(i,1/i.w,i),la.multiplyByVector(t,i,i),li.fromCartesian4(i,n)};var oc=new qn,sc=new qn,ac=new qn;Ou.rotationMatrixFromPositionVelocity=function(e,t,r,n){if(!Nn(e))throw new Ln("position is required.");if(!Nn(t))throw new Ln("velocity is required.");var i=Qn(r,Os.WGS84).geodeticSurfaceNormal(e,oc),o=qn.cross(t,i,sc);qn.equalsEpsilon(o,qn.ZERO,zn.EPSILON6)&&(o=qn.clone(qn.UNIT_X,o));var s=qn.cross(o,t,ac);return qn.normalize(s,s),qn.cross(t,s,o),qn.negate(o,o),qn.normalize(o,o),Nn(n)||(n=new ea),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=o.x,n[4]=o.y,n[5]=o.z,n[6]=s.x,n[7]=s.y,n[8]=s.z,n};var uc=new la(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),cc=new ni,lc=new qn,hc=new qn,pc=new ea,fc=new la,dc=new la;Ou.basisTo2D=function(e,t,r){if(!Nn(e))throw new Ln("projection is required.");if(!Nn(t))throw new Ln("matrix is required.");if(!Nn(r))throw new Ln("result is required.");var n=la.getTranslation(t,hc),i=e.ellipsoid,o=i.cartesianToCartographic(n,cc),s=e.project(o,lc);qn.fromElements(s.z,s.x,s.y,s);var a=Ou.eastNorthUpToFixedFrame(n,i,fc),u=la.inverseTransformation(a,dc),c=la.getMatrix3(t,pc),l=la.multiplyByMatrix3(u,c,r);return la.multiply(uc,l,r),la.setTranslation(r,s,r),r},Ou.wgs84To2DModelMatrix=function(e,t,r){if(!Nn(e))throw new Ln("projection is required.");if(!Nn(t))throw new Ln("center is required.");if(!Nn(r))throw new Ln("result is required.");var n=e.ellipsoid,i=Ou.eastNorthUpToFixedFrame(t,n,fc),o=la.inverseTransformation(i,dc),s=n.cartesianToCartographic(t,cc),a=e.project(s,lc);qn.fromElements(a.z,a.x,a.y,a);var u=la.fromTranslation(a,fc);return la.multiply(uc,o,r),la.multiply(u,r,r),r},Ou.buildUp=function(e,t){var r=t.clone(),n=e.clone();n=qn.normalize(n,n),Math.abs(qn.dot(n,r))>=1&&(n=Math.abs(qn.dot(r,qn.UNIT_Y))<1?qn.clone(qn.UNIT_Y,n):qn.clone(qn.UNIT_Z,n));var i=new qn;return qn.cross(n,r,i),i=qn.normalize(i,i),qn.cross(r,i,n),n=qn.normalize(n,n)},Ou.getHeading=function(e,t){var r;return r=zn.equalsEpsilon(Math.abs(e.z),1,zn.EPSILON3)?Math.atan2(t.y,t.x)-zn.PI_OVER_TWO:Math.atan2(e.y,e.x)-zn.PI_OVER_TWO,zn.TWO_PI-zn.zeroToTwoPi(r)},Ou.convertToColumbusCartesian=function(e){var t=new Bu,r=t.ellipsoid,n=new qn,i=new ni;return r.cartesianToCartographic(e,i),t.project(i,n),qn.fromElements(n.z,n.x,n.y)},Ou.convertTo3DCartesian=function(e){var t=new Bu,r=t.ellipsoid,n=new qn,i=new ni;return n=qn.fromElements(e.y,e.z,e.x),t.unproject(n,i),r.cartographicToCartesian(i,n)};var Ac,gc={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3,getMorphTime:function(e){return e===gc.SCENE3D?1:e!==gc.MORPHING?0:void 0}},_c=Object.freeze(gc),mc=(Ac=!0,function(e,t){var r=Ac?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Ac=!1,r}),yc=mc(void 0,(function(){return yc.toString().search("(((.+)+)+)+$").toString().constructor(yc).search("(((.+)+)+)+$")}));yc();var Ec=8192;const xc=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Cc=xc(void 0,(function(){return Cc.toString().search("(((.+)+)+)+$").toString().constructor(Cc).search("(((.+)+)+)+$")}));Cc();var bc=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function Ic(e,t){this.start=Qn(e,0),this.stop=Qn(t,0)}function vc(e,t,r,n){this.west=Qn(e,0),this.south=Qn(t,0),this.east=Qn(r,0),this.north=Qn(n,0)}Object.defineProperties(vc.prototype,{width:{get:function(){return vc.computeWidth(this)}},height:{get:function(){return vc.computeHeight(this)}}}),vc.packedLength=4,vc.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e.west,t[r++]=e.south,t[r++]=e.east,t[r]=e.north,t},vc.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new vc),r.west=e[t++],r.south=e[t++],r.east=e[t++],r.north=e[t],r},vc.computeWidth=function(e){Un.typeOf.object("rectangle",e);var t=e.east,r=e.west;return t<r&&(t+=zn.TWO_PI),t-r},vc.computeHeight=function(e){return Un.typeOf.object("rectangle",e),e.north-e.south},vc.fromDegrees=function(e,t,r,n,i){return e=zn.toRadians(Qn(e,0)),t=zn.toRadians(Qn(t,0)),r=zn.toRadians(Qn(r,0)),n=zn.toRadians(Qn(n,0)),Nn(i)?(i.west=e,i.south=t,i.east=r,i.north=n,i):new vc(e,t,r,n)},vc.fromRadians=function(e,t,r,n,i){return Nn(i)?(i.west=Qn(e,0),i.south=Qn(t,0),i.east=Qn(r,0),i.north=Qn(n,0),i):new vc(e,t,r,n)},vc.fromCartographicArray=function(e,t){Un.defined("cartographics",e);for(var r=Number.MAX_VALUE,n=-Number.MAX_VALUE,i=Number.MAX_VALUE,o=-Number.MAX_VALUE,s=Number.MAX_VALUE,a=-Number.MAX_VALUE,u=0,c=e.length;u<c;u++){var l=e[u];r=Math.min(r,l.longitude),n=Math.max(n,l.longitude),s=Math.min(s,l.latitude),a=Math.max(a,l.latitude);var h=l.longitude>=0?l.longitude:l.longitude+zn.TWO_PI;i=Math.min(i,h),o=Math.max(o,h)}return n-r>o-i&&(r=i,(n=o)>zn.PI&&(n-=zn.TWO_PI),r>zn.PI&&(r-=zn.TWO_PI)),Nn(t)?(t.west=r,t.south=s,t.east=n,t.north=a,t):new vc(r,s,n,a)},vc.fromCartesianArray=function(e,t,r){Un.defined("cartesians",e),t=Qn(t,Os.WGS84);for(var n=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=0,l=e.length;c<l;c++){var h=t.cartesianToCartographic(e[c]);n=Math.min(n,h.longitude),i=Math.max(i,h.longitude),a=Math.min(a,h.latitude),u=Math.max(u,h.latitude);var p=h.longitude>=0?h.longitude:h.longitude+zn.TWO_PI;o=Math.min(o,p),s=Math.max(s,p)}return i-n>s-o&&(n=o,(i=s)>zn.PI&&(i-=zn.TWO_PI),n>zn.PI&&(n-=zn.TWO_PI)),Nn(r)?(r.west=n,r.south=a,r.east=i,r.north=u,r):new vc(n,a,i,u)},vc.clone=function(e,t){if(Nn(e))return Nn(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new vc(e.west,e.south,e.east,e.north)},vc.equalsEpsilon=function(e,t,r){return Un.typeOf.number("absoluteEpsilon",r),e===t||Nn(e)&&Nn(t)&&Math.abs(e.west-t.west)<=r&&Math.abs(e.south-t.south)<=r&&Math.abs(e.east-t.east)<=r&&Math.abs(e.north-t.north)<=r},vc.prototype.clone=function(e){return vc.clone(this,e)},vc.prototype.equals=function(e){return vc.equals(this,e)},vc.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},vc.prototype.equalsEpsilon=function(e,t){return Un.typeOf.number("epsilon",t),vc.equalsEpsilon(this,e,t)},vc.validate=function(e){Un.typeOf.object("rectangle",e);var t=e.north;Un.typeOf.number.greaterThanOrEquals("north",t,-zn.PI_OVER_TWO),Un.typeOf.number.lessThanOrEquals("north",t,zn.PI_OVER_TWO);var r=e.south;Un.typeOf.number.greaterThanOrEquals("south",r,-zn.PI_OVER_TWO),Un.typeOf.number.lessThanOrEquals("south",r,zn.PI_OVER_TWO);var n=e.west;Un.typeOf.number.greaterThanOrEquals("west",n,-Math.PI),Un.typeOf.number.lessThanOrEquals("west",n,Math.PI);var i=e.east;Un.typeOf.number.greaterThanOrEquals("east",i,-Math.PI),Un.typeOf.number.lessThanOrEquals("east",i,Math.PI)},vc.southwest=function(e,t){return Un.typeOf.object("rectangle",e),Nn(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new ni(e.west,e.south)},vc.northwest=function(e,t){return Un.typeOf.object("rectangle",e),Nn(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new ni(e.west,e.north)},vc.northeast=function(e,t){return Un.typeOf.object("rectangle",e),Nn(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new ni(e.east,e.north)},vc.southeast=function(e,t){return Un.typeOf.object("rectangle",e),Nn(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new ni(e.east,e.south)},vc.center=function(e,t){Un.typeOf.object("rectangle",e);var r=e.east,n=e.west;r<n&&(r+=zn.TWO_PI);var i=zn.negativePiToPi(.5*(n+r)),o=.5*(e.south+e.north);return Nn(t)?(t.longitude=i,t.latitude=o,t.height=0,t):new ni(i,o)},vc.intersection=function(e,t,r){Un.typeOf.object("rectangle",e),Un.typeOf.object("otherRectangle",t);var n=e.east,i=e.west,o=t.east,s=t.west;n<i&&o>0?n+=zn.TWO_PI:o<s&&n>0&&(o+=zn.TWO_PI),n<i&&s<0?s+=zn.TWO_PI:o<s&&i<0&&(i+=zn.TWO_PI);var a=zn.negativePiToPi(Math.max(i,s)),u=zn.negativePiToPi(Math.min(n,o));if(!((e.west<e.east||t.west<t.east)&&u<=a)){var c=Math.max(e.south,t.south),l=Math.min(e.north,t.north);if(!(c>=l))return Nn(r)?(r.west=a,r.south=c,r.east=u,r.north=l,r):new vc(a,c,u,l)}},vc.simpleIntersection=function(e,t,r){Un.typeOf.object("rectangle",e),Un.typeOf.object("otherRectangle",t);var n=Math.max(e.west,t.west),i=Math.max(e.south,t.south),o=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(i>=s||n>=o))return Nn(r)?(r.west=n,r.south=i,r.east=o,r.north=s,r):new vc(n,i,o,s)},vc.union=function(e,t,r){Un.typeOf.object("rectangle",e),Un.typeOf.object("otherRectangle",t),Nn(r)||(r=new vc);var n=e.east,i=e.west,o=t.east,s=t.west;n<i&&o>0?n+=zn.TWO_PI:o<s&&n>0&&(o+=zn.TWO_PI),n<i&&s<0?s+=zn.TWO_PI:o<s&&i<0&&(i+=zn.TWO_PI);var a=zn.convertLongitudeRange(Math.min(i,s)),u=zn.convertLongitudeRange(Math.max(n,o));return r.west=a,r.south=Math.min(e.south,t.south),r.east=u,r.east<r.west&&(r.east+=zn.TWO_PI),r.north=Math.max(e.north,t.north),r},vc.expand=function(e,t,r){return Un.typeOf.object("rectangle",e),Un.typeOf.object("cartographic",t),Nn(r)||(r=new vc),r.west=Math.min(e.west,t.longitude),r.south=Math.min(e.south,t.latitude),r.east=Math.max(e.east,t.longitude),r.north=Math.max(e.north,t.latitude),r},vc.contains=function(e,t){Un.typeOf.object("rectangle",e),Un.typeOf.object("cartographic",t);var r=t.longitude,n=t.latitude,i=e.west,o=e.east;return o<i&&(o+=zn.TWO_PI,r<0&&(r+=zn.TWO_PI)),(r>i||zn.equalsEpsilon(r,i,zn.EPSILON14))&&(r<o||zn.equalsEpsilon(r,o,zn.EPSILON14))&&n>=e.south&&n<=e.north};var Tc=new ni;vc.subsample=function(e,t,r,n){Un.typeOf.object("rectangle",e),t=Qn(t,Os.WGS84),r=Qn(r,0),Nn(n)||(n=[]);var i=0,o=e.north,s=e.south,a=e.east,u=e.west,c=Tc;c.height=r,c.longitude=u,c.latitude=o,n[i]=t.cartographicToCartesian(c,n[i]),i++,c.longitude=a,n[i]=t.cartographicToCartesian(c,n[i]),i++,c.latitude=s,n[i]=t.cartographicToCartesian(c,n[i]),i++,c.longitude=u,n[i]=t.cartographicToCartesian(c,n[i]),i++,c.latitude=o<0?o:s>0?s:0;for(var l=1;l<8;++l)c.longitude=-Math.PI+l*zn.PI_OVER_TWO,vc.contains(e,c)&&(n[i]=t.cartographicToCartesian(c,n[i]),i++);return 0===c.latitude&&(c.longitude=u,n[i]=t.cartographicToCartesian(c,n[i]),i++,c.longitude=a,n[i]=t.cartographicToCartesian(c,n[i]),i++),n.length=i,n};var Rc=new ni;function Sc(e,t){this.center=qn.clone(Qn(e,qn.ZERO)),this.radius=Qn(t,0)}vc.prototype.contains=function(e){return vc.contains(this,vc.southwest(e,Rc))&&vc.contains(this,vc.northwest(e,Rc))&&vc.contains(this,vc.southeast(e,Rc))&&vc.contains(this,vc.northeast(e,Rc))},vc.MAX_VALUE=Object.freeze(new vc(-Math.PI,-zn.PI_OVER_TWO,Math.PI,zn.PI_OVER_TWO));var Mc=new qn,wc=new qn,Bc=new qn,Oc=new qn,Dc=new qn,Fc=new qn,Pc=new qn,Nc=new qn,Lc=new qn,Uc=new qn,Gc=new qn,Qc=new qn,kc=4/3*zn.PI;Sc.fromPoints=function(e,t){if(Nn(t)||(t=new Sc),!Nn(e)||0===e.length)return t.center=qn.clone(qn.ZERO,t.center),t.radius=0,t;var r,n=qn.clone(e[0],Pc),i=qn.clone(n,Mc),o=qn.clone(n,wc),s=qn.clone(n,Bc),a=qn.clone(n,Oc),u=qn.clone(n,Dc),c=qn.clone(n,Fc),l=e.length;for(r=1;r<l;r++){qn.clone(e[r],n);var h=n.x,p=n.y,f=n.z;h<i.x&&qn.clone(n,i),h>a.x&&qn.clone(n,a),p<o.y&&qn.clone(n,o),p>u.y&&qn.clone(n,u),f<s.z&&qn.clone(n,s),f>c.z&&qn.clone(n,c)}var d=qn.magnitudeSquared(qn.subtract(a,i,Nc)),A=qn.magnitudeSquared(qn.subtract(u,o,Nc)),g=qn.magnitudeSquared(qn.subtract(c,s,Nc)),_=i,m=a,y=d;A>y&&(y=A,_=o,m=u),g>y&&(y=g,_=s,m=c);var E=Lc;E.x=.5*(_.x+m.x),E.y=.5*(_.y+m.y),E.z=.5*(_.z+m.z);var x=qn.magnitudeSquared(qn.subtract(m,E,Nc)),C=Math.sqrt(x),b=Uc;b.x=i.x,b.y=o.y,b.z=s.z;var I=Gc;I.x=a.x,I.y=u.y,I.z=c.z;var v=qn.midpoint(b,I,Qc),T=0;for(r=0;r<l;r++){qn.clone(e[r],n);var R=qn.magnitude(qn.subtract(n,v,Nc));R>T&&(T=R);var S=qn.magnitudeSquared(qn.subtract(n,E,Nc));if(S>x){var M=Math.sqrt(S);x=(C=.5*(C+M))*C;var w=M-C;E.x=(C*E.x+w*n.x)/M,E.y=(C*E.y+w*n.y)/M,E.z=(C*E.z+w*n.z)/M}}return C<T?(qn.clone(E,t.center),t.radius=C):(qn.clone(v,t.center),t.radius=T),t};var zc=new Bu,jc=new qn,Hc=new qn,qc=new ni,Vc=new ni;Sc.fromRectangle2D=function(e,t,r){return Sc.fromRectangleWithHeights2D(e,t,0,0,r)},Sc.fromRectangleWithHeights2D=function(e,t,r,n,i){if(Nn(i)||(i=new Sc),!Nn(e))return i.center=qn.clone(qn.ZERO,i.center),i.radius=0,i;t=Qn(t,zc),vc.southwest(e,qc),qc.height=r,vc.northeast(e,Vc),Vc.height=n;var o=t.project(qc,jc),s=t.project(Vc,Hc),a=s.x-o.x,u=s.y-o.y,c=s.z-o.z;i.radius=.5*Math.sqrt(a*a+u*u+c*c);var l=i.center;return l.x=o.x+.5*a,l.y=o.y+.5*u,l.z=o.z+.5*c,i};var Yc=[];Sc.fromRectangle3D=function(e,t,r,n){if(t=Qn(t,Os.WGS84),r=Qn(r,0),Nn(n)||(n=new Sc),!Nn(e))return n.center=qn.clone(qn.ZERO,n.center),n.radius=0,n;var i=vc.subsample(e,t,r,Yc);return Sc.fromPoints(i,n)},Sc.fromVertices=function(e,t,r,n){if(Nn(n)||(n=new Sc),!Nn(e)||0===e.length)return n.center=qn.clone(qn.ZERO,n.center),n.radius=0,n;t=Qn(t,qn.ZERO),r=Qn(r,3),Un.typeOf.number.greaterThanOrEquals("stride",r,3);var i=Pc;i.x=e[0]+t.x,i.y=e[1]+t.y,i.z=e[2]+t.z;var o,s=qn.clone(i,Mc),a=qn.clone(i,wc),u=qn.clone(i,Bc),c=qn.clone(i,Oc),l=qn.clone(i,Dc),h=qn.clone(i,Fc),p=e.length;for(o=0;o<p;o+=r){var f=e[o]+t.x,d=e[o+1]+t.y,A=e[o+2]+t.z;i.x=f,i.y=d,i.z=A,f<s.x&&qn.clone(i,s),f>c.x&&qn.clone(i,c),d<a.y&&qn.clone(i,a),d>l.y&&qn.clone(i,l),A<u.z&&qn.clone(i,u),A>h.z&&qn.clone(i,h)}var g=qn.magnitudeSquared(qn.subtract(c,s,Nc)),_=qn.magnitudeSquared(qn.subtract(l,a,Nc)),m=qn.magnitudeSquared(qn.subtract(h,u,Nc)),y=s,E=c,x=g;_>x&&(x=_,y=a,E=l),m>x&&(x=m,y=u,E=h);var C=Lc;C.x=.5*(y.x+E.x),C.y=.5*(y.y+E.y),C.z=.5*(y.z+E.z);var b=qn.magnitudeSquared(qn.subtract(E,C,Nc)),I=Math.sqrt(b),v=Uc;v.x=s.x,v.y=a.y,v.z=u.z;var T=Gc;T.x=c.x,T.y=l.y,T.z=h.z;var R=qn.midpoint(v,T,Qc),S=0;for(o=0;o<p;o+=r){i.x=e[o]+t.x,i.y=e[o+1]+t.y,i.z=e[o+2]+t.z;var M=qn.magnitude(qn.subtract(i,R,Nc));M>S&&(S=M);var w=qn.magnitudeSquared(qn.subtract(i,C,Nc));if(w>b){var B=Math.sqrt(w);b=(I=.5*(I+B))*I;var O=B-I;C.x=(I*C.x+O*i.x)/B,C.y=(I*C.y+O*i.y)/B,C.z=(I*C.z+O*i.z)/B}}return I<S?(qn.clone(C,n.center),n.radius=I):(qn.clone(R,n.center),n.radius=S),n},Sc.fromEncodedCartesianVertices=function(e,t,r){if(Nn(r)||(r=new Sc),!Nn(e)||!Nn(t)||e.length!==t.length||0===e.length)return r.center=qn.clone(qn.ZERO,r.center),r.radius=0,r;var n=Pc;n.x=e[0]+t[0],n.y=e[1]+t[1],n.z=e[2]+t[2];var i,o=qn.clone(n,Mc),s=qn.clone(n,wc),a=qn.clone(n,Bc),u=qn.clone(n,Oc),c=qn.clone(n,Dc),l=qn.clone(n,Fc),h=e.length;for(i=0;i<h;i+=3){var p=e[i]+t[i],f=e[i+1]+t[i+1],d=e[i+2]+t[i+2];n.x=p,n.y=f,n.z=d,p<o.x&&qn.clone(n,o),p>u.x&&qn.clone(n,u),f<s.y&&qn.clone(n,s),f>c.y&&qn.clone(n,c),d<a.z&&qn.clone(n,a),d>l.z&&qn.clone(n,l)}var A=qn.magnitudeSquared(qn.subtract(u,o,Nc)),g=qn.magnitudeSquared(qn.subtract(c,s,Nc)),_=qn.magnitudeSquared(qn.subtract(l,a,Nc)),m=o,y=u,E=A;g>E&&(E=g,m=s,y=c),_>E&&(E=_,m=a,y=l);var x=Lc;x.x=.5*(m.x+y.x),x.y=.5*(m.y+y.y),x.z=.5*(m.z+y.z);var C=qn.magnitudeSquared(qn.subtract(y,x,Nc)),b=Math.sqrt(C),I=Uc;I.x=o.x,I.y=s.y,I.z=a.z;var v=Gc;v.x=u.x,v.y=c.y,v.z=l.z;var T=qn.midpoint(I,v,Qc),R=0;for(i=0;i<h;i+=3){n.x=e[i]+t[i],n.y=e[i+1]+t[i+1],n.z=e[i+2]+t[i+2];var S=qn.magnitude(qn.subtract(n,T,Nc));S>R&&(R=S);var M=qn.magnitudeSquared(qn.subtract(n,x,Nc));if(M>C){var w=Math.sqrt(M);C=(b=.5*(b+w))*b;var B=w-b;x.x=(b*x.x+B*n.x)/w,x.y=(b*x.y+B*n.y)/w,x.z=(b*x.z+B*n.z)/w}}return b<R?(qn.clone(x,r.center),r.radius=b):(qn.clone(T,r.center),r.radius=R),r},Sc.fromCornerPoints=function(e,t,r){Un.typeOf.object("corner",e),Un.typeOf.object("oppositeCorner",t),Nn(r)||(r=new Sc);var n=qn.midpoint(e,t,r.center);return r.radius=qn.distance(n,t),r},Sc.fromEllipsoid=function(e,t){return Un.typeOf.object("ellipsoid",e),Nn(t)||(t=new Sc),qn.clone(qn.ZERO,t.center),t.radius=e.maximumRadius,t};var Xc=new qn;Sc.fromBoundingSpheres=function(e,t){if(Nn(t)||(t=new Sc),!Nn(e)||0===e.length)return t.center=qn.clone(qn.ZERO,t.center),t.radius=0,t;var r=e.length;if(1===r)return Sc.clone(e[0],t);if(2===r)return Sc.union(e[0],e[1],t);var n,i=[];for(n=0;n<r;n++)i.push(e[n].center);var o=(t=Sc.fromPoints(i,t)).center,s=t.radius;for(n=0;n<r;n++){var a=e[n];s=Math.max(s,qn.distance(o,a.center,Xc)+a.radius)}return t.radius=s,t};var Wc=new qn,Kc=new qn,$c=new qn;Sc.fromOrientedBoundingBox=function(e,t){Un.defined("orientedBoundingBox",e),Nn(t)||(t=new Sc);var r=e.halfAxes,n=ea.getColumn(r,0,Wc),i=ea.getColumn(r,1,Kc),o=ea.getColumn(r,2,$c);return qn.add(n,i,n),qn.add(n,o,n),t.center=qn.clone(e.center,t.center),t.radius=qn.magnitude(n),t},Sc.clone=function(e,t){if(Nn(e))return Nn(t)?(t.center=qn.clone(e.center,t.center),t.radius=e.radius,t):new Sc(e.center,e.radius)},Sc.packedLength=4,Sc.pack=function(e,t,r){Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0);var n=e.center;return t[r++]=n.x,t[r++]=n.y,t[r++]=n.z,t[r]=e.radius,t},Sc.unpack=function(e,t,r){Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new Sc);var n=r.center;return n.x=e[t++],n.y=e[t++],n.z=e[t++],r.radius=e[t],r};var Jc=new qn,Zc=new qn;Sc.union=function(e,t,r){Un.typeOf.object("left",e),Un.typeOf.object("right",t),Nn(r)||(r=new Sc);var n=e.center,i=e.radius,o=t.center,s=t.radius,a=qn.subtract(o,n,Jc),u=qn.magnitude(a);if(i>=u+s)return e.clone(r),r;if(s>=u+i)return t.clone(r),r;var c=.5*(i+u+s),l=qn.multiplyByScalar(a,(-i+c)/u,Zc);return qn.add(l,n,l),qn.clone(l,r.center),r.radius=c,r};var el=new qn;Sc.expand=function(e,t,r){Un.typeOf.object("sphere",e),Un.typeOf.object("point",t),r=Sc.clone(e,r);var n=qn.magnitude(qn.subtract(t,r.center,el));return n>r.radius&&(r.radius=n),r},Sc.intersectPlane=function(e,t){Un.typeOf.object("sphere",e),Un.typeOf.object("plane",t);var r=e.center,n=e.radius,i=t.normal,o=qn.dot(i,r)+t.distance;return o<-n?bc.OUTSIDE:o<n?bc.INTERSECTING:bc.INSIDE},Sc.transform=function(e,t,r){return Un.typeOf.object("sphere",e),Un.typeOf.object("transform",t),Nn(r)||(r=new Sc),r.center=la.multiplyByPoint(t,e.center,r.center),r.radius=la.getMaximumScale(t)*e.radius,r};var tl=new qn;Sc.distanceSquaredTo=function(e,t){Un.typeOf.object("sphere",e),Un.typeOf.object("cartesian",t);var r=qn.subtract(e.center,t,tl);return qn.magnitudeSquared(r)-e.radius*e.radius},Sc.transformWithoutScale=function(e,t,r){return Un.typeOf.object("sphere",e),Un.typeOf.object("transform",t),Nn(r)||(r=new Sc),r.center=la.multiplyByPoint(t,e.center,r.center),r.radius=e.radius,r};var rl=new qn;Sc.computePlaneDistances=function(e,t,r,n){Un.typeOf.object("sphere",e),Un.typeOf.object("position",t),Un.typeOf.object("direction",r),Nn(n)||(n=new Ic);var i=qn.subtract(e.center,t,rl),o=qn.dot(r,i);return n.start=o-e.radius,n.stop=o+e.radius,n};for(var nl=new qn,il=new qn,ol=new qn,sl=new qn,al=new qn,ul=new ni,cl=new Array(8),ll=0;ll<8;++ll)cl[ll]=new qn;var hl=new Bu;function pl(e,t,r){this.minimum=qn.clone(Qn(e,qn.ZERO)),this.maximum=qn.clone(Qn(t,qn.ZERO)),r=Nn(r)?qn.clone(r):qn.midpoint(this.minimum,this.maximum,new qn),this.center=r}Sc.projectTo2D=function(e,t,r){Un.typeOf.object("sphere",e);var n,i=(t=Qn(t,hl)).ellipsoid,o=e.center,s=e.radius;n=qn.equals(o,qn.ZERO)?qn.clone(qn.UNIT_X,nl):i.geodeticSurfaceNormal(o,nl);var a=qn.cross(qn.UNIT_Z,n,il);qn.normalize(a,a);var u=qn.cross(n,a,ol);qn.normalize(u,u),qn.multiplyByScalar(n,s,n),qn.multiplyByScalar(u,s,u),qn.multiplyByScalar(a,s,a);var c=qn.negate(u,al),l=qn.negate(a,sl),h=cl,p=h[0];qn.add(n,u,p),qn.add(p,a,p),p=h[1],qn.add(n,u,p),qn.add(p,l,p),p=h[2],qn.add(n,c,p),qn.add(p,l,p),p=h[3],qn.add(n,c,p),qn.add(p,a,p),qn.negate(n,n),p=h[4],qn.add(n,u,p),qn.add(p,a,p),p=h[5],qn.add(n,u,p),qn.add(p,l,p),p=h[6],qn.add(n,c,p),qn.add(p,l,p),p=h[7],qn.add(n,c,p),qn.add(p,a,p);for(var f=h.length,d=0;d<f;++d){var A=h[d];qn.add(o,A,A);var g=i.cartesianToCartographic(A,ul);t.project(g,A)}var _=(o=(r=Sc.fromPoints(h,r)).center).x,m=o.y,y=o.z;return o.x=y,o.y=_,o.z=m,r},Sc.isOccluded=function(e,t){return Un.typeOf.object("sphere",e),Un.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},Sc.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&qn.equals(e.center,t.center)&&e.radius===t.radius},Sc.prototype.intersectPlane=function(e){return Sc.intersectPlane(this,e)},Sc.prototype.distanceSquaredTo=function(e){return Sc.distanceSquaredTo(this,e)},Sc.prototype.computePlaneDistances=function(e,t,r){return Sc.computePlaneDistances(this,e,t,r)},Sc.prototype.isOccluded=function(e){return Sc.isOccluded(this,e)},Sc.prototype.equals=function(e){return Sc.equals(this,e)},Sc.prototype.clone=function(e){return Sc.clone(this,e)},Sc.prototype.volume=function(){var e=this.radius;return kc*e*e*e},pl.fromPoints=function(e,t){if(Nn(t)||(t=new pl),!Nn(e)||0===e.length)return t.minimum=qn.clone(qn.ZERO,t.minimum),t.maximum=qn.clone(qn.ZERO,t.maximum),t.center=qn.clone(qn.ZERO,t.center),t;for(var r=e[0].x,n=e[0].y,i=e[0].z,o=e[0].x,s=e[0].y,a=e[0].z,u=e.length,c=1;c<u;c++){var l=e[c],h=l.x,p=l.y,f=l.z;r=Math.min(h,r),o=Math.max(h,o),n=Math.min(p,n),s=Math.max(p,s),i=Math.min(f,i),a=Math.max(f,a)}var d=t.minimum;d.x=r,d.y=n,d.z=i;var A=t.maximum;return A.x=o,A.y=s,A.z=a,t.center=qn.midpoint(d,A,t.center),t},pl.clone=function(e,t){if(Nn(e))return Nn(t)?(t.minimum=qn.clone(e.minimum,t.minimum),t.maximum=qn.clone(e.maximum,t.maximum),t.center=qn.clone(e.center,t.center),t):new pl(e.minimum,e.maximum,e.center)},pl.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&qn.equals(e.center,t.center)&&qn.equals(e.minimum,t.minimum)&&qn.equals(e.maximum,t.maximum)};var fl=new qn;pl.intersectPlane=function(e,t){Un.defined("box",e),Un.defined("plane",t),fl=qn.subtract(e.maximum,e.minimum,fl);var r=qn.multiplyByScalar(fl,.5,fl),n=t.normal,i=r.x*Math.abs(n.x)+r.y*Math.abs(n.y)+r.z*Math.abs(n.z),o=qn.dot(e.center,n)+t.distance;return o-i>0?bc.INSIDE:o+i<0?bc.OUTSIDE:bc.INTERSECTING},pl.prototype.clone=function(e){return pl.clone(this,e)},pl.prototype.intersectPlane=function(e){return pl.intersectPlane(this,e)},pl.prototype.equals=function(e){return pl.equals(this,e)};var dl={};function Al(e,t,r){var n=e+t;return zn.sign(e)!==zn.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<r?0:n}dl.computeDiscriminant=function(e,t,r){if("number"!=typeof e)throw new Ln("a is a required number.");if("number"!=typeof t)throw new Ln("b is a required number.");if("number"!=typeof r)throw new Ln("c is a required number.");return t*t-4*e*r},dl.computeRealRoots=function(e,t,r){if("number"!=typeof e)throw new Ln("a is a required number.");if("number"!=typeof t)throw new Ln("b is a required number.");if("number"!=typeof r)throw new Ln("c is a required number.");var n;if(0===e)return 0===t?[]:[-r/t];if(0===t){if(0===r)return[0,0];var i=Math.abs(r),o=Math.abs(e);if(i<o&&i/o<zn.EPSILON14)return[0,0];if(i>o&&o/i<zn.EPSILON14)return[];if((n=-r/e)<0)return[];var s=Math.sqrt(n);return[-s,s]}if(0===r)return(n=-t/e)<0?[n,0]:[0,n];var a=Al(t*t,-(4*e*r),zn.EPSILON14);if(a<0)return[];var u=-.5*Al(t,zn.sign(t)*Math.sqrt(a),zn.EPSILON14);return t>0?[u/e,r/u]:[r/u,u/e]};var gl={};function _l(e,t,r,n){var i,o,s=e,a=t/3,u=r/3,c=n,l=s*u,h=a*c,p=a*a,f=u*u,d=s*u-p,A=s*c-a*u,g=a*c-f,_=4*d*g-A*A;if(_<0){var m,y,E;p*h>=l*f?(m=s,y=d,E=-2*a*d+s*A):(m=c,y=g,E=-c*A+2*u*g);var x=-(E<0?-1:1)*Math.abs(m)*Math.sqrt(-_),C=(o=-E+x)/2,b=C<0?-Math.pow(-C,1/3):Math.pow(C,1/3),I=o===x?-b:-y/b;return i=y<=0?b+I:-E/(b*b+I*I+y),p*h>=l*f?[(i-a)/s]:[-c/(i+u)]}var v=d,T=-2*a*d+s*A,R=g,S=-c*A+2*u*g,M=Math.sqrt(_),w=Math.sqrt(3)/2,B=Math.abs(Math.atan2(s*M,-T)/3);i=2*Math.sqrt(-v);var O=Math.cos(B);o=i*O;var D=i*(-O/2-w*Math.sin(B)),F=o+D>2*a?o-a:D-a,P=s,N=F/P;B=Math.abs(Math.atan2(c*M,-S)/3);var L=-c,U=(o=(i=2*Math.sqrt(-R))*(O=Math.cos(B)))+(D=i*(-O/2-w*Math.sin(B)))<2*u?o+u:D+u,G=L/U,Q=-F*U-P*L,k=(u*Q-a*(F*L))/(-a*Q+u*(P*U));return N<=k?N<=G?k<=G?[N,k,G]:[N,G,k]:[G,N,k]:N<=G?[k,N,G]:k<=G?[k,G,N]:[G,k,N]}gl.computeDiscriminant=function(e,t,r,n){if("number"!=typeof e)throw new Ln("a is a required number.");if("number"!=typeof t)throw new Ln("b is a required number.");if("number"!=typeof r)throw new Ln("c is a required number.");if("number"!=typeof n)throw new Ln("d is a required number.");var i=t*t,o=r*r;return 18*e*t*r*n+i*o-27*(e*e)*(n*n)-4*(e*o*r+i*t*n)},gl.computeRealRoots=function(e,t,r,n){if("number"!=typeof e)throw new Ln("a is a required number.");if("number"!=typeof t)throw new Ln("b is a required number.");if("number"!=typeof r)throw new Ln("c is a required number.");if("number"!=typeof n)throw new Ln("d is a required number.");var i,o;if(0===e)return dl.computeRealRoots(t,r,n);if(0===t){if(0===r){if(0===n)return[0,0,0];var s=(o=-n/e)<0?-Math.pow(-o,1/3):Math.pow(o,1/3);return[s,s,s]}return 0===n?0===(i=dl.computeRealRoots(e,0,r)).Length?[0]:[i[0],0,i[1]]:_l(e,0,r,n)}return 0===r?0===n?(o=-t/e)<0?[o,0,0]:[0,0,o]:_l(e,t,0,n):0===n?0===(i=dl.computeRealRoots(e,t,r)).length?[0]:i[1]<=0?[i[0],i[1],0]:i[0]>=0?[0,i[0],i[1]]:[i[0],0,i[1]]:_l(e,t,r,n)};var ml={};function yl(e,t,r,n){var i=e*e,o=t-3*i/8,s=r-t*e/2+i*e/8,a=n-r*e/4+t*i/16-3*i*i/256,u=gl.computeRealRoots(1,2*o,o*o-4*a,-s*s);if(u.length>0){var c=-e/4,l=u[u.length-1];if(Math.abs(l)<zn.EPSILON14){var h=dl.computeRealRoots(1,o,a);if(2===h.length){var p,f=h[0],d=h[1];if(f>=0&&d>=0){var A=Math.sqrt(f),g=Math.sqrt(d);return[c-g,c-A,c+A,c+g]}if(f>=0&&d<0)return[c-(p=Math.sqrt(f)),c+p];if(f<0&&d>=0)return[c-(p=Math.sqrt(d)),c+p]}return[]}if(l>0){var _=Math.sqrt(l),m=(o+l-s/_)/2,y=(o+l+s/_)/2,E=dl.computeRealRoots(1,_,m),x=dl.computeRealRoots(1,-_,y);return 0!==E.length?(E[0]+=c,E[1]+=c,0!==x.length?(x[0]+=c,x[1]+=c,E[1]<=x[0]?[E[0],E[1],x[0],x[1]]:x[1]<=E[0]?[x[0],x[1],E[0],E[1]]:E[0]>=x[0]&&E[1]<=x[1]?[x[0],E[0],E[1],x[1]]:x[0]>=E[0]&&x[1]<=E[1]?[E[0],x[0],x[1],E[1]]:E[0]>x[0]&&E[0]<x[1]?[x[0],E[0],x[1],E[1]]:[E[0],x[0],E[1],x[1]]):E):0!==x.length?(x[0]+=c,x[1]+=c,x):[]}}return[]}function El(e,t,r,n){var i=e*e,o=-2*t,s=r*e+t*t-4*n,a=i*n-r*t*e+r*r,u=gl.computeRealRoots(1,o,s,a);if(u.length>0){var c,l,h,p,f,d,A=u[0],g=t-A,_=g*g,m=e/2,y=g/2,E=_-4*n,x=_+4*Math.abs(n),C=i-4*A,b=i+4*Math.abs(A);if(A<0||E*b<C*x){var I=Math.sqrt(C);c=I/2,l=0===I?0:(e*y-r)/I}else{var v=Math.sqrt(E);c=0===v?0:(e*y-r)/v,l=v/2}0===m&&0===c?(h=0,p=0):zn.sign(m)===zn.sign(c)?p=A/(h=m+c):h=A/(p=m-c),0===y&&0===l?(f=0,d=0):zn.sign(y)===zn.sign(l)?d=n/(f=y+l):f=n/(d=y-l);var T=dl.computeRealRoots(1,h,f),R=dl.computeRealRoots(1,p,d);if(0!==T.length)return 0!==R.length?T[1]<=R[0]?[T[0],T[1],R[0],R[1]]:R[1]<=T[0]?[R[0],R[1],T[0],T[1]]:T[0]>=R[0]&&T[1]<=R[1]?[R[0],T[0],T[1],R[1]]:R[0]>=T[0]&&R[1]<=T[1]?[T[0],R[0],R[1],T[1]]:T[0]>R[0]&&T[0]<R[1]?[R[0],T[0],R[1],T[1]]:[T[0],R[0],T[1],R[1]]:T;if(0!==R.length)return R}return[]}function xl(e,t){t=qn.clone(Qn(t,qn.ZERO)),qn.equals(t,qn.ZERO)||qn.normalize(t,t),this.origin=qn.clone(Qn(e,qn.ZERO)),this.direction=t}ml.computeDiscriminant=function(e,t,r,n,i){if("number"!=typeof e)throw new Ln("a is a required number.");if("number"!=typeof t)throw new Ln("b is a required number.");if("number"!=typeof r)throw new Ln("c is a required number.");if("number"!=typeof n)throw new Ln("d is a required number.");if("number"!=typeof i)throw new Ln("e is a required number.");var o=e*e,s=t*t,a=s*t,u=r*r,c=u*r,l=n*n,h=l*n,p=i*i;return s*u*l-4*a*h-4*e*c*l+18*e*t*r*h-27*o*l*l+256*(o*e)*(p*i)+i*(18*a*r*n-4*s*c+16*e*u*u-80*e*t*u*n-6*e*s*l+144*o*r*l)+p*(144*e*s*r-27*s*s-128*o*u-192*o*t*n)},ml.computeRealRoots=function(e,t,r,n,i){if("number"!=typeof e)throw new Ln("a is a required number.");if("number"!=typeof t)throw new Ln("b is a required number.");if("number"!=typeof r)throw new Ln("c is a required number.");if("number"!=typeof n)throw new Ln("d is a required number.");if("number"!=typeof i)throw new Ln("e is a required number.");if(Math.abs(e)<zn.EPSILON15)return gl.computeRealRoots(t,r,n,i);var o=t/e,s=r/e,a=n/e,u=i/e,c=o<0?1:0;switch(c+=s<0?c+1:c,c+=a<0?c+1:c,c+=u<0?c+1:c){case 0:case 3:case 4:case 6:case 7:case 9:case 10:case 12:case 13:case 14:case 15:return yl(o,s,a,u);case 1:case 2:case 5:case 8:case 11:return El(o,s,a,u);default:return}},xl.clone=function(e,t){if(Nn(e))return Nn(t)?(t.origin=qn.clone(e.origin),t.direction=qn.clone(e.direction),t):new xl(e.origin,e.direction)},xl.getPoint=function(e,t,r){return Un.typeOf.object("ray",e),Un.typeOf.number("t",t),Nn(r)||(r=new qn),r=qn.multiplyByScalar(e.direction,t,r),qn.add(e.origin,r,r)},xl.transform=function(e,t,r){return Un.typeOf.object("ray",e),Un.typeOf.object("matrix",t),Un.typeOf.object("result",r),la.multiplyByPoint(t,e.origin,r.origin),la.multiplyByPointAsVector(t,e.direction,r.direction),r};var Cl={rayPlane:function(e,t,r){if(!Nn(e))throw new Ln("ray is required.");if(!Nn(t))throw new Ln("plane is required.");Nn(r)||(r=new qn);var n=e.origin,i=e.direction,o=t.normal,s=qn.dot(o,i);if(!(Math.abs(s)<zn.EPSILON15)){var a=(-t.distance-qn.dot(o,n))/s;if(!(a<0))return r=qn.multiplyByScalar(i,a,r),qn.add(n,r,r)}}},bl=new qn,Il=new qn,vl=new qn,Tl=new qn,Rl=new qn;Cl.rayTriangleParametric=function(e,t,r,n,i){if(!Nn(e))throw new Ln("ray is required.");if(!Nn(t))throw new Ln("p0 is required.");if(!Nn(r))throw new Ln("p1 is required.");if(!Nn(n))throw new Ln("p2 is required.");i=Qn(i,!1);var o,s,a,u,c,l=e.origin,h=e.direction,p=qn.subtract(r,t,bl),f=qn.subtract(n,t,Il),d=qn.cross(h,f,vl),A=qn.dot(p,d);if(i){if(A<zn.EPSILON6)return;if(o=qn.subtract(l,t,Tl),(a=qn.dot(o,d))<0||a>A)return;if(s=qn.cross(o,p,Rl),(u=qn.dot(h,s))<0||a+u>A)return;c=qn.dot(f,s)/A}else{if(Math.abs(A)<zn.EPSILON6)return;var g=1/A;if(o=qn.subtract(l,t,Tl),(a=qn.dot(o,d)*g)<0||a>1)return;if(s=qn.cross(o,p,Rl),(u=qn.dot(h,s)*g)<0||a+u>1)return;c=qn.dot(f,s)*g}return c},Cl.rayTriangle=function(e,t,r,n,i,o){var s=Cl.rayTriangleParametric(e,t,r,n,i);if(Nn(s)&&!(s<0))return Nn(o)||(o=new qn),qn.multiplyByScalar(e.direction,s,o),qn.add(e.origin,o,o)};var Sl=new xl;Cl.lineSegmentTriangle=function(e,t,r,n,i,o,s){if(!Nn(e))throw new Ln("v0 is required.");if(!Nn(t))throw new Ln("v1 is required.");if(!Nn(r))throw new Ln("p0 is required.");if(!Nn(n))throw new Ln("p1 is required.");if(!Nn(i))throw new Ln("p2 is required.");var a=Sl;qn.clone(e,a.origin),qn.subtract(t,e,a.direction),qn.normalize(a.direction,a.direction);var u=Cl.rayTriangleParametric(a,r,n,i,o);if(!(!Nn(u)||u<0||u>qn.distance(e,t)))return Nn(s)||(s=new qn),qn.multiplyByScalar(a.direction,u,s),qn.add(a.origin,s,s)};var Ml={root0:0,root1:0};function wl(e,t,r){Nn(r)||(r=new Ic);var n=e.origin,i=e.direction,o=t.center,s=t.radius*t.radius,a=qn.subtract(n,o,vl),u=function(e,t,r,n){var i=t*t-4*e*r;if(!(i<0)){if(i>0){var o=1/(2*e),s=Math.sqrt(i),a=(-t+s)*o,u=(-t-s)*o;return a<u?(n.root0=a,n.root1=u):(n.root0=u,n.root1=a),n}var c=-t/(2*e);if(0!==c)return n.root0=n.root1=c,n}}(qn.dot(i,i),2*qn.dot(i,a),qn.magnitudeSquared(a)-s,Ml);if(Nn(u))return r.start=u.root0,r.stop=u.root1,r}Cl.raySphere=function(e,t,r){if(!Nn(e))throw new Ln("ray is required.");if(!Nn(t))throw new Ln("sphere is required.");if(Nn(r=wl(e,t,r))&&!(r.stop<0))return r.start=Math.max(r.start,0),r};var Bl=new xl;Cl.lineSegmentSphere=function(e,t,r,n){if(!Nn(e))throw new Ln("p0 is required.");if(!Nn(t))throw new Ln("p1 is required.");if(!Nn(r))throw new Ln("sphere is required.");var i=Bl;qn.clone(e,i.origin);var o=qn.subtract(t,e,i.direction),s=qn.magnitude(o);if(qn.normalize(o,o),!(!Nn(n=wl(i,r,n))||n.stop<0||n.start>s))return n.start=Math.max(n.start,0),n.stop=Math.min(n.stop,s),n};var Ol=new qn,Dl=new qn;function Fl(e,t,r){var n=e+t;return zn.sign(e)!==zn.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<r?0:n}Cl.rayEllipsoid=function(e,t){if(!Nn(e))throw new Ln("ray is required.");if(!Nn(t))throw new Ln("ellipsoid is required.");var r,n,i,o,s,a=t.oneOverRadii,u=qn.multiplyComponents(a,e.origin,Ol),c=qn.multiplyComponents(a,e.direction,Dl),l=qn.magnitudeSquared(u),h=qn.dot(u,c);if(l>1){if(h>=0)return;var p=h*h;if(r=l-1,p<(i=(n=qn.magnitudeSquared(c))*r))return;if(p>i){o=h*h-i;var f=(s=-h+Math.sqrt(o))/n,d=r/s;return f<d?new Ic(f,d):{start:d,stop:f}}var A=Math.sqrt(r/n);return new Ic(A,A)}return l<1?(r=l-1,o=h*h-(i=(n=qn.magnitudeSquared(c))*r),new Ic(0,(s=-h+Math.sqrt(o))/n)):h<0?new Ic(0,-h/(n=qn.magnitudeSquared(c))):void 0};var Pl=new qn,Nl=new qn,Ll=new qn,Ul=new qn,Gl=new qn,Ql=new ea,kl=new ea,zl=new ea,jl=new ea,Hl=new ea,ql=new ea,Vl=new ea,Yl=new qn,Xl=new qn,Wl=new ni;Cl.grazingAltitudeLocation=function(e,t){if(!Nn(e))throw new Ln("ray is required.");if(!Nn(t))throw new Ln("ellipsoid is required.");var r=e.origin,n=e.direction;if(!qn.equals(r,qn.ZERO)){var i=t.geodeticSurfaceNormal(r,Pl);if(qn.dot(n,i)>=0)return r}var o=Nn(this.rayEllipsoid(e,t)),s=t.transformPositionToScaledSpace(n,Pl),a=qn.normalize(s,s),u=qn.mostOrthogonalAxis(s,Ul),c=qn.normalize(qn.cross(u,a,Nl),Nl),l=qn.normalize(qn.cross(a,c,Ll),Ll),h=Ql;h[0]=a.x,h[1]=a.y,h[2]=a.z,h[3]=c.x,h[4]=c.y,h[5]=c.z,h[6]=l.x,h[7]=l.y,h[8]=l.z;var p=ea.transpose(h,kl),f=ea.fromScale(t.radii,zl),d=ea.fromScale(t.oneOverRadii,jl),A=Hl;A[0]=0,A[1]=-n.z,A[2]=n.y,A[3]=n.z,A[4]=0,A[5]=-n.x,A[6]=-n.y,A[7]=n.x,A[8]=0;var g,_,m=ea.multiply(ea.multiply(p,d,ql),A,ql),y=ea.multiply(ea.multiply(m,f,Vl),h,Vl),E=ea.multiplyByVector(m,r,Gl),x=function(e,t,r,n,i){var o,s=n*n,a=i*i,u=(e[ea.COLUMN1ROW1]-e[ea.COLUMN2ROW2])*a,c=i*(n*Fl(e[ea.COLUMN1ROW0],e[ea.COLUMN0ROW1],zn.EPSILON15)+t.y),l=e[ea.COLUMN0ROW0]*s+e[ea.COLUMN2ROW2]*a+n*t.x+r,h=a*Fl(e[ea.COLUMN2ROW1],e[ea.COLUMN1ROW2],zn.EPSILON15),p=i*(n*Fl(e[ea.COLUMN2ROW0],e[ea.COLUMN0ROW2])+t.z),f=[];if(0===p&&0===h){if(0===(o=dl.computeRealRoots(u,c,l)).length)return f;var d=o[0],A=Math.sqrt(Math.max(1-d*d,0));if(f.push(new qn(n,i*d,i*-A)),f.push(new qn(n,i*d,i*A)),2===o.length){var g=o[1],_=Math.sqrt(Math.max(1-g*g,0));f.push(new qn(n,i*g,i*-_)),f.push(new qn(n,i*g,i*_))}return f}var m=p*p,y=h*h,E=p*h,x=u*u+y,C=2*(c*u+E),b=2*l*u+c*c-y+m,I=2*(l*c-E),v=l*l-m;if(0===x&&0===C&&0===b&&0===I)return f;var T=(o=ml.computeRealRoots(x,C,b,I,v)).length;if(0===T)return f;for(var R=0;R<T;++R){var S=o[R],M=S*S,w=Math.max(1-M,0),B=Math.sqrt(w),O=(zn.sign(u)===zn.sign(l)?Fl(u*M+l,c*S,zn.EPSILON12):zn.sign(l)===zn.sign(c*S)?Fl(u*M,c*S+l,zn.EPSILON12):Fl(u*M+c*S,l,zn.EPSILON12))*Fl(h*S,p,zn.EPSILON15);O<0?f.push(new qn(n,i*S,i*B)):O>0?f.push(new qn(n,i*S,i*-B)):0!==B?(f.push(new qn(n,i*S,i*-B)),f.push(new qn(n,i*S,i*B)),++R):f.push(new qn(n,i*S,i*B))}return f}(y,qn.negate(E,Pl),0,0,1),C=x.length;if(C>0){for(var b=qn.clone(qn.ZERO,Xl),I=Number.NEGATIVE_INFINITY,v=0;v<C;++v){g=ea.multiplyByVector(f,ea.multiplyByVector(h,x[v],Yl),Yl);var T=qn.normalize(qn.subtract(g,r,Ul),Ul),R=qn.dot(T,n);R>I&&(I=R,b=qn.clone(g,b))}var S=t.cartesianToCartographic(b,Wl);return I=zn.clamp(I,0,1),_=qn.magnitude(qn.subtract(b,r,Ul))*Math.sqrt(1-I*I),_=o?-_:_,S.height=_,t.cartographicToCartesian(S,new qn)}};var Kl=new qn;function $l(e,t){if(Un.typeOf.object("normal",e),!zn.equalsEpsilon(qn.magnitude(e),1,zn.EPSILON6))throw new Ln("normal must be normalized.");Un.typeOf.number("distance",t),this.normal=qn.clone(e),this.distance=t}Cl.lineSegmentPlane=function(e,t,r,n){if(!Nn(e))throw new Ln("endPoint0 is required.");if(!Nn(t))throw new Ln("endPoint1 is required.");if(!Nn(r))throw new Ln("plane is required.");Nn(n)||(n=new qn);var i=qn.subtract(t,e,Kl),o=r.normal,s=qn.dot(o,i);if(!(Math.abs(s)<zn.EPSILON6)){var a=qn.dot(o,e),u=-(r.distance+a)/s;if(!(u<0||u>1))return qn.multiplyByScalar(i,u,n),qn.add(e,n,n),n}},Cl.trianglePlaneIntersection=function(e,t,r,n){if(!(Nn(e)&&Nn(t)&&Nn(r)&&Nn(n)))throw new Ln("p0, p1, p2, and plane are required.");var i,o,s=n.normal,a=n.distance,u=qn.dot(s,e)+a<0,c=qn.dot(s,t)+a<0,l=qn.dot(s,r)+a<0,h=0;if(h+=u?1:0,h+=c?1:0,1!==(h+=l?1:0)&&2!==h||(i=new qn,o=new qn),1===h){if(u)return Cl.lineSegmentPlane(e,t,n,i),Cl.lineSegmentPlane(e,r,n,o),{positions:[e,t,r,i,o],indices:[0,3,4,1,2,4,1,4,3]};if(c)return Cl.lineSegmentPlane(t,r,n,i),Cl.lineSegmentPlane(t,e,n,o),{positions:[e,t,r,i,o],indices:[1,3,4,2,0,4,2,4,3]};if(l)return Cl.lineSegmentPlane(r,e,n,i),Cl.lineSegmentPlane(r,t,n,o),{positions:[e,t,r,i,o],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===h){if(!u)return Cl.lineSegmentPlane(t,e,n,i),Cl.lineSegmentPlane(r,e,n,o),{positions:[e,t,r,i,o],indices:[1,2,4,1,4,3,0,3,4]};if(!c)return Cl.lineSegmentPlane(r,t,n,i),Cl.lineSegmentPlane(e,t,n,o),{positions:[e,t,r,i,o],indices:[2,0,4,2,4,3,1,3,4]};if(!l)return Cl.lineSegmentPlane(e,r,n,i),Cl.lineSegmentPlane(t,r,n,o),{positions:[e,t,r,i,o],indices:[0,1,4,0,4,3,2,3,4]}}},$l.fromPointNormal=function(e,t,r){if(Un.typeOf.object("point",e),Un.typeOf.object("normal",t),!zn.equalsEpsilon(qn.magnitude(t),1,zn.EPSILON6))throw new Ln("normal must be normalized.");var n=-qn.dot(t,e);return Nn(r)?(qn.clone(t,r.normal),r.distance=n,r):new $l(t,n)};var Jl=new qn;$l.fromCartesian4=function(e,t){Un.typeOf.object("coefficients",e);var r=qn.fromCartesian4(e,Jl),n=e.w;if(!zn.equalsEpsilon(qn.magnitude(r),1,zn.EPSILON6))throw new Ln("normal must be normalized.");return Nn(t)?(qn.clone(r,t.normal),t.distance=n,t):new $l(r,n)},$l.getPointDistance=function(e,t){return Un.typeOf.object("plane",e),Un.typeOf.object("point",t),qn.dot(e.normal,t)+e.distance};var Zl=new qn;$l.projectPointOntoPlane=function(e,t,r){Un.typeOf.object("plane",e),Un.typeOf.object("point",t),Nn(r)||(r=new qn);var n=$l.getPointDistance(e,t),i=qn.multiplyByScalar(e.normal,n,Zl);return qn.subtract(t,i,r)};var eh=new qn;$l.transform=function(e,t,r){return Un.typeOf.object("plane",e),Un.typeOf.object("transform",t),la.multiplyByPointAsVector(t,e.normal,Jl),qn.normalize(Jl,Jl),qn.multiplyByScalar(e.normal,-e.distance,eh),la.multiplyByPoint(t,eh,eh),$l.fromPointNormal(eh,Jl,r)},$l.clone=function(e,t){return Un.typeOf.object("plane",e),Nn(t)?(qn.clone(e.normal,t.normal),t.distance=e.distance,t):new $l(e.normal,e.distance)},$l.equals=function(e,t){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),e.distance===t.distance&&qn.equals(e.normal,t.normal)},$l.ORIGIN_XY_PLANE=Object.freeze(new $l(qn.UNIT_Z,0)),$l.ORIGIN_YZ_PLANE=Object.freeze(new $l(qn.UNIT_X,0)),$l.ORIGIN_ZX_PLANE=Object.freeze(new $l(qn.UNIT_Y,0));var th=new gi;function rh(e,t){if(Un.defined("origin",e),!Nn(e=(t=Qn(t,Os.WGS84)).scaleToGeodeticSurface(e)))throw new Ln("origin must not be at the center of the ellipsoid.");var r=Ou.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=qn.fromCartesian4(la.getColumn(r,0,th)),this._yAxis=qn.fromCartesian4(la.getColumn(r,1,th));var n=qn.fromCartesian4(la.getColumn(r,2,th));this._plane=$l.fromPointNormal(e,n)}Object.defineProperties(rh.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var nh=new pl;rh.fromPoints=function(e,t){return Un.defined("cartesians",e),new rh(pl.fromPoints(e,nh).center,t)};var ih=new xl,oh=new qn;rh.prototype.projectPointOntoPlane=function(e,t){Un.defined("cartesian",e);var r=ih;r.origin=e,qn.normalize(e,r.direction);var n=Cl.rayPlane(r,this._plane,oh);if(Nn(n)||(qn.negate(r.direction,r.direction),n=Cl.rayPlane(r,this._plane,oh)),Nn(n)){var i=qn.subtract(n,this._origin,n),o=qn.dot(this._xAxis,i),s=qn.dot(this._yAxis,i);return Nn(t)?(t.x=o,t.y=s,t):new li(o,s)}},rh.prototype.projectPointsOntoPlane=function(e,t){Un.defined("cartesians",e),Nn(t)||(t=[]);for(var r=0,n=e.length,i=0;i<n;i++){var o=this.projectPointOntoPlane(e[i],t[r]);Nn(o)&&(t[r]=o,r++)}return t.length=r,t},rh.prototype.projectPointToNearestOnPlane=function(e,t){Un.defined("cartesian",e),Nn(t)||(t=new li);var r=ih;r.origin=e,qn.clone(this._plane.normal,r.direction);var n=Cl.rayPlane(r,this._plane,oh);Nn(n)||(qn.negate(r.direction,r.direction),n=Cl.rayPlane(r,this._plane,oh));var i=qn.subtract(n,this._origin,n),o=qn.dot(this._xAxis,i),s=qn.dot(this._yAxis,i);return t.x=o,t.y=s,t},rh.prototype.projectPointsToNearestOnPlane=function(e,t){Un.defined("cartesians",e),Nn(t)||(t=[]);var r=e.length;t.length=r;for(var n=0;n<r;n++)t[n]=this.projectPointToNearestOnPlane(e[n],t[n]);return t};var sh=new qn;function ah(e,t,r=2){const n=t&&t.length,i=n?t[0]*r:e.length;let o=uh(e,0,i,r,!0);const s=[];if(!o||o.next===o.prev)return s;let a,u,c;if(n&&(o=function(e,t,r,n){const i=[];for(let r=0,o=t.length;r<o;r++){const s=uh(e,t[r]*n,r<o-1?t[r+1]*n:e.length,n,!1);s===s.next&&(s.steiner=!0),i.push(yh(s))}i.sort(Ah);for(let e=0;e<i.length;e++)r=gh(i[e],r);return r}(e,t,o,r)),e.length>80*r){a=1/0,u=1/0;let t=-1/0,n=-1/0;for(let o=r;o<i;o+=r){const r=e[o],i=e[o+1];r<a&&(a=r),i<u&&(u=i),r>t&&(t=r),i>n&&(n=i)}c=Math.max(t-a,n-u),c=0!==c?32767/c:0}return lh(o,s,r,a,u,c,0),s}function uh(e,t,r,n,i){let o;if(i===function(e,t,r,n){let i=0;for(let o=t,s=r-n;o<r;o+=n)i+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return i}(e,t,r,n)>0)for(let i=t;i<r;i+=n)o=wh(i/n|0,e[i],e[i+1],o);else for(let i=r-n;i>=t;i-=n)o=wh(i/n|0,e[i],e[i+1],o);return o&&Ih(o,o.next)&&(Bh(o),o=o.next),o}function ch(e,t){if(!e)return e;t||(t=e);let r,n=e;do{if(r=!1,n.steiner||!Ih(n,n.next)&&0!==bh(n.prev,n,n.next))n=n.next;else{if(Bh(n),n=t=n.prev,n===n.next)break;r=!0}}while(r||n!==t);return t}function lh(e,t,r,n,i,o,s){if(!e)return;!s&&o&&function(e,t,r,n){let i=e;do{0===i.z&&(i.z=mh(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r=1;do{let n,i=e;e=null;let o=null;for(t=0;i;){t++;let s=i,a=0;for(let e=0;e<r&&(a++,s=s.nextZ,s);e++);let u=r;for(;a>0||u>0&&s;)0!==a&&(0===u||!s||i.z<=s.z)?(n=i,i=i.nextZ,a--):(n=s,s=s.nextZ,u--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;i=s}o.nextZ=null,r*=2}while(t>1)}(i)}(e,n,i,o);let a=e;for(;e.prev!==e.next;){const u=e.prev,c=e.next;if(o?ph(e,n,i,o):hh(e))t.push(u.i,e.i,c.i),Bh(e),e=c.next,a=c.next;else if((e=c)===a){s?1===s?lh(e=fh(ch(e),t),t,r,n,i,o,2):2===s&&dh(e,t,r,n,i,o):lh(ch(e),t,r,n,i,o,1);break}}}function hh(e){const t=e.prev,r=e,n=e.next;if(bh(t,r,n)>=0)return!1;const i=t.x,o=r.x,s=n.x,a=t.y,u=r.y,c=n.y,l=Math.min(i,o,s),h=Math.min(a,u,c),p=Math.max(i,o,s),f=Math.max(a,u,c);let d=n.next;for(;d!==t;){if(d.x>=l&&d.x<=p&&d.y>=h&&d.y<=f&&xh(i,a,o,u,s,c,d.x,d.y)&&bh(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function ph(e,t,r,n){const i=e.prev,o=e,s=e.next;if(bh(i,o,s)>=0)return!1;const a=i.x,u=o.x,c=s.x,l=i.y,h=o.y,p=s.y,f=Math.min(a,u,c),d=Math.min(l,h,p),A=Math.max(a,u,c),g=Math.max(l,h,p),_=mh(f,d,t,r,n),m=mh(A,g,t,r,n);let y=e.prevZ,E=e.nextZ;for(;y&&y.z>=_&&E&&E.z<=m;){if(y.x>=f&&y.x<=A&&y.y>=d&&y.y<=g&&y!==i&&y!==s&&xh(a,l,u,h,c,p,y.x,y.y)&&bh(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,E.x>=f&&E.x<=A&&E.y>=d&&E.y<=g&&E!==i&&E!==s&&xh(a,l,u,h,c,p,E.x,E.y)&&bh(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;y&&y.z>=_;){if(y.x>=f&&y.x<=A&&y.y>=d&&y.y<=g&&y!==i&&y!==s&&xh(a,l,u,h,c,p,y.x,y.y)&&bh(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;E&&E.z<=m;){if(E.x>=f&&E.x<=A&&E.y>=d&&E.y<=g&&E!==i&&E!==s&&xh(a,l,u,h,c,p,E.x,E.y)&&bh(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function fh(e,t){let r=e;do{const n=r.prev,i=r.next.next;!Ih(n,i)&&vh(n,r,r.next,i)&&Sh(n,i)&&Sh(i,n)&&(t.push(n.i,r.i,i.i),Bh(r),Bh(r.next),r=e=i),r=r.next}while(r!==e);return ch(r)}function dh(e,t,r,n,i,o){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&Ch(s,e)){let a=Mh(s,e);return s=ch(s,s.next),a=ch(a,a.next),lh(s,t,r,n,i,o,0),void lh(a,t,r,n,i,o,0)}e=e.next}s=s.next}while(s!==e)}function Ah(e,t){let r=e.x-t.x;if(0===r&&(r=e.y-t.y,0===r)){r=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return r}function gh(e,t){const r=function(e,t){let r=t;const n=e.x,i=e.y;let o,s=-1/0;if(Ih(e,r))return r;do{if(Ih(e,r.next))return r.next;if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){const e=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=n&&e>s&&(s=e,o=r.x<r.next.x?r:r.next,e===n))return o}r=r.next}while(r!==t);if(!o)return null;const a=o,u=o.x,c=o.y;let l=1/0;r=o;do{if(n>=r.x&&r.x>=u&&n!==r.x&&Eh(i<c?n:s,i,u,c,i<c?s:n,i,r.x,r.y)){const t=Math.abs(i-r.y)/(n-r.x);Sh(r,e)&&(t<l||t===l&&(r.x>o.x||r.x===o.x&&_h(o,r)))&&(o=r,l=t)}r=r.next}while(r!==a);return o}(e,t);if(!r)return t;const n=Mh(r,e);return ch(n,n.next),ch(r,r.next)}function _h(e,t){return bh(e.prev,e,t.prev)<0&&bh(t.next,e,e.next)<0}function mh(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function yh(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Eh(e,t,r,n,i,o,s,a){return(i-s)*(t-a)>=(e-s)*(o-a)&&(e-s)*(n-a)>=(r-s)*(t-a)&&(r-s)*(o-a)>=(i-s)*(n-a)}function xh(e,t,r,n,i,o,s,a){return!(e===s&&t===a)&&Eh(e,t,r,n,i,o,s,a)}function Ch(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&vh(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(Sh(e,t)&&Sh(t,e)&&function(e,t){let r=e,n=!1;const i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(bh(e.prev,e,t.prev)||bh(e,t.prev,t))||Ih(e,t)&&bh(e.prev,e,e.next)>0&&bh(t.prev,t,t.next)>0)}function bh(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ih(e,t){return e.x===t.x&&e.y===t.y}function vh(e,t,r,n){const i=Rh(bh(e,t,r)),o=Rh(bh(e,t,n)),s=Rh(bh(r,n,e)),a=Rh(bh(r,n,t));return i!==o&&s!==a||(!(0!==i||!Th(e,r,t))||(!(0!==o||!Th(e,n,t))||(!(0!==s||!Th(r,e,n))||!(0!==a||!Th(r,t,n)))))}function Th(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Rh(e){return e>0?1:e<0?-1:0}function Sh(e,t){return bh(e.prev,e,e.next)<0?bh(e,t,e.next)>=0&&bh(e,e.prev,t)>=0:bh(e,t,e.prev)<0||bh(e,e.next,t)<0}function Mh(e,t){const r=Oh(e.i,e.x,e.y),n=Oh(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function wh(e,t,r,n){const i=Oh(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Bh(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Oh(e,t,r){return{i:e,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}rh.prototype.projectPointOntoEllipsoid=function(e,t){Un.defined("cartesian",e),Nn(t)||(t=new qn);var r=this._ellipsoid,n=this._origin,i=this._xAxis,o=this._yAxis,s=sh;return qn.multiplyByScalar(i,e.x,s),t=qn.add(n,s,t),qn.multiplyByScalar(o,e.y,s),qn.add(t,s,t),r.scaleToGeocentricSurface(t,t),t},rh.prototype.projectPointsOntoEllipsoid=function(e,t){Un.defined("cartesians",e);var r=e.length;Nn(t)?t.length=r:t=new Array(r);for(var n=0;n<r;++n)t[n]=this.projectPointOntoEllipsoid(e[n],t[n]);return t};var Dh=Object.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Fh={BYTE:Dh.BYTE,UNSIGNED_BYTE:Dh.UNSIGNED_BYTE,SHORT:Dh.SHORT,UNSIGNED_SHORT:Dh.UNSIGNED_SHORT,INT:Dh.INT,UNSIGNED_INT:Dh.UNSIGNED_INT,FLOAT:Dh.FLOAT,DOUBLE:Dh.DOUBLE,getSizeInBytes:function(e){if(!Nn(e))throw new Ln("value is required.");switch(e){case Fh.BYTE:return Int8Array.BYTES_PER_ELEMENT;case Fh.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Fh.SHORT:return Int16Array.BYTES_PER_ELEMENT;case Fh.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Fh.INT:return Int32Array.BYTES_PER_ELEMENT;case Fh.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Fh.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case Fh.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new Ln("componentDatatype is not a valid value.")}},fromTypedArray:function(e){return e instanceof Int8Array?Fh.BYTE:e instanceof Uint8Array?Fh.UNSIGNED_BYTE:e instanceof Int16Array?Fh.SHORT:e instanceof Uint16Array?Fh.UNSIGNED_SHORT:e instanceof Int32Array?Fh.INT:e instanceof Uint32Array?Fh.UNSIGNED_INT:e instanceof Float32Array?Fh.FLOAT:e instanceof Float64Array?Fh.DOUBLE:void 0},validate:function(e){return Nn(e)&&(e===Fh.BYTE||e===Fh.UNSIGNED_BYTE||e===Fh.SHORT||e===Fh.UNSIGNED_SHORT||e===Fh.INT||e===Fh.UNSIGNED_INT||e===Fh.FLOAT||e===Fh.DOUBLE)},createTypedArray:function(e,t){if(!Nn(e))throw new Ln("componentDatatype is required.");if(!Nn(t))throw new Ln("valuesOrLength is required.");switch(e){case Fh.BYTE:return new Int8Array(t);case Fh.UNSIGNED_BYTE:return new Uint8Array(t);case Fh.SHORT:return new Int16Array(t);case Fh.UNSIGNED_SHORT:return new Uint16Array(t);case Fh.INT:return new Int32Array(t);case Fh.UNSIGNED_INT:return new Uint32Array(t);case Fh.FLOAT:return new Float32Array(t);case Fh.DOUBLE:return new Float64Array(t);default:throw new Ln("componentDatatype is not a valid value.")}},createArrayBufferView:function(e,t,r,n){if(!Nn(e))throw new Ln("componentDatatype is required.");if(!Nn(t))throw new Ln("buffer is required.");switch(r=Qn(r,0),n=Qn(n,(t.byteLength-r)/Fh.getSizeInBytes(e)),e){case Fh.BYTE:return new Int8Array(t,r,n);case Fh.UNSIGNED_BYTE:return new Uint8Array(t,r,n);case Fh.SHORT:return new Int16Array(t,r,n);case Fh.UNSIGNED_SHORT:return new Uint16Array(t,r,n);case Fh.INT:return new Int32Array(t,r,n);case Fh.UNSIGNED_INT:return new Uint32Array(t,r,n);case Fh.FLOAT:return new Float32Array(t,r,n);case Fh.DOUBLE:return new Float64Array(t,r,n);default:throw new Ln("componentDatatype is not a valid value.")}},fromName:function(e){switch(e){case"BYTE":return Fh.BYTE;case"UNSIGNED_BYTE":return Fh.UNSIGNED_BYTE;case"SHORT":return Fh.SHORT;case"UNSIGNED_SHORT":return Fh.UNSIGNED_SHORT;case"INT":return Fh.INT;case"UNSIGNED_INT":return Fh.UNSIGNED_INT;case"FLOAT":return Fh.FLOAT;case"DOUBLE":return Fh.DOUBLE;default:throw new Ln("name is not a valid value.")}}},Ph=Object.freeze(Fh);function Nh(e,t,r){if(0===e)return t*r;var n=e*e,i=n*n,o=i*n,s=o*n,a=s*n,u=a*n,c=r;return t*((1-n/4-3*i/64-5*o/256-175*s/16384-441*a/65536-4851*u/1048576)*c-(3*n/8+3*i/32+45*o/1024+105*s/4096+2205*a/131072+6237*u/524288)*Math.sin(2*c)+(15*i/256+45*o/1024+525*s/16384+1575*a/65536+155925*u/8388608)*Math.sin(4*c)-(35*o/3072+175*s/12288+3675*a/262144+13475*u/1048576)*Math.sin(6*c)+(315*s/131072+2205*a/524288+43659*u/8388608)*Math.sin(8*c)-(693*a/1310720+6237*u/5242880)*Math.sin(10*c)+1001*u/8388608*Math.sin(12*c))}function Lh(e,t){if(0===e)return Math.log(Math.tan(.5*(zn.PI_OVER_TWO+t)));var r=e*Math.sin(t);return Math.log(Math.tan(.5*(zn.PI_OVER_TWO+t)))-e/2*Math.log((1+r)/(1-r))}var Uh=new qn,Gh=new qn;function Qh(e,t,r,n){var i=qn.normalize(n.cartographicToCartesian(t,Gh),Uh),o=qn.normalize(n.cartographicToCartesian(r,Gh),Gh);Un.typeOf.number.greaterThanOrEquals("value",Math.abs(Math.abs(qn.angleBetween(i,o))-Math.PI),.0125);var s=n.maximumRadius,a=n.minimumRadius,u=s*s,c=a*a;e._ellipticitySquared=(u-c)/u,e._ellipticity=Math.sqrt(e._ellipticitySquared),e._start=ni.clone(t,e._start),e._start.height=0,e._end=ni.clone(r,e._end),e._end.height=0,e._heading=function(e,t,r,n,i){var o=Lh(e._ellipticity,r),s=Lh(e._ellipticity,i);return Math.atan2(zn.negativePiToPi(n-t),s-o)}(e,t.longitude,t.latitude,r.longitude,r.latitude),e._distance=function(e,t,r,n,i,o,s){var a=e._heading,u=o-n,c=0;if(zn.equalsEpsilon(Math.abs(a),zn.PI_OVER_TWO,zn.EPSILON8))if(t===r)c=t*Math.cos(i)*zn.negativePiToPi(u);else{var l=Math.sin(i);c=t*Math.cos(i)*zn.negativePiToPi(u)/Math.sqrt(1-e._ellipticitySquared*l*l)}else{var h=Nh(e._ellipticity,t,i);c=(Nh(e._ellipticity,t,s)-h)/Math.cos(a)}return Math.abs(c)}(e,n.maximumRadius,n.minimumRadius,t.longitude,t.latitude,r.longitude,r.latitude)}function kh(e,t,r,n,i,o){var s,a,u,c=i*i;if(Math.abs(zn.PI_OVER_TWO-Math.abs(t))>zn.EPSILON8){a=function(e,t,r){var n=e/r;if(0===t)return n;var i=n*n,o=i*n,s=o*n,a=t*t,u=a*a,c=u*a,l=c*a,h=l*a,p=h*a,f=Math.sin(2*n),d=Math.cos(2*n),A=Math.sin(4*n),g=Math.cos(4*n),_=Math.sin(6*n),m=Math.cos(6*n),y=Math.sin(8*n),E=Math.cos(8*n),x=Math.sin(10*n);return n+n*a/4+7*n*u/64+15*n*c/256+579*n*l/16384+1515*n*h/65536+16837*n*p/1048576+(3*n*u/16+45*n*c/256-n*(32*i-561)*l/4096-n*(232*i-1677)*h/16384+n*(399985-90560*i+512*s)*p/5242880)*d+(21*n*c/256+483*n*l/4096-n*(224*i-1969)*h/16384-n*(33152*i-112599)*p/1048576)*g+(151*n*l/4096+4681*n*h/65536+1479*n*p/16384-453*o*p/32768)*m+(1097*n*h/65536+42783*n*p/1048576)*E+8011*n*p/1048576*Math.cos(10*n)+(3*a/8+3*u/16+213*c/2048-3*i*c/64+255*l/4096-33*i*l/512+20861*h/524288-33*i*h/512+s*h/1024+28273*p/1048576-471*i*p/8192+9*s*p/4096)*f+(21*u/256+21*c/256+533*l/8192-21*i*l/512+197*h/4096-315*i*h/4096+584039*p/16777216-12517*i*p/131072+7*s*p/2048)*A+(151*c/6144+151*l/4096+5019*h/131072-453*i*h/16384+26965*p/786432-8607*i*p/131072)*_+(1097*l/131072+1097*h/65536+225797*p/10485760-1097*i*p/65536)*y+(8011*h/2621440+8011*p/1048576)*x+293393*p/251658240*Math.sin(12*n)}(Nh(i,n,e.latitude)+r*Math.cos(t),i,n);var l=Lh(i,e.latitude),h=Lh(i,a);u=Math.tan(t)*(h-l),s=zn.negativePiToPi(e.longitude+u)}else{var p;if(a=e.latitude,0===i)p=n*Math.cos(e.latitude);else{var f=Math.sin(e.latitude);p=n*Math.cos(e.latitude)/Math.sqrt(1-c*f*f)}u=r/p,s=t>0?zn.negativePiToPi(e.longitude+u):zn.negativePiToPi(e.longitude-u)}return Nn(o)?(o.longitude=s,o.latitude=a,o.height=0,o):new ni(s,a,0)}function zh(e,t,r){var n=Qn(r,Os.WGS84);this._ellipsoid=n,this._start=new ni,this._end=new ni,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,Nn(e)&&Nn(t)&&Qh(this,e,t,n)}Object.defineProperties(zh.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return Un.defined("distance",this._distance),this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return Un.defined("distance",this._distance),this._heading}}}),zh.fromStartHeadingDistance=function(e,t,r,n,i){Un.defined("start",e),Un.defined("heading",t),Un.defined("distance",r),Un.typeOf.number.greaterThan("distance",r,0);var o=Qn(n,Os.WGS84),s=o.maximumRadius,a=o.minimumRadius,u=s*s,c=a*a,l=Math.sqrt((u-c)/u),h=kh(e,t=zn.negativePiToPi(t),r,o.maximumRadius,l);return!Nn(i)||Nn(n)&&!n.equals(i.ellipsoid)?new zh(e,h,o):(i.setEndPoints(e,h),i)},zh.prototype.setEndPoints=function(e,t){Un.defined("start",e),Un.defined("end",t),Qh(this,e,t,this._ellipsoid)},zh.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(e*this._distance,t)},zh.prototype.interpolateUsingSurfaceDistance=function(e,t){if(Un.typeOf.number("distance",e),!Nn(this._distance)||0===this._distance)throw new Ln("EllipsoidRhumbLine must have distinct start and end set.");return kh(this._start,this._heading,e,this._ellipsoid.maximumRadius,this._ellipticity,t)},zh.prototype.findIntersectionWithLongitude=function(e,t){if(Un.typeOf.number("intersectionLongitude",e),!Nn(this._distance)||0===this._distance)throw new Ln("EllipsoidRhumbLine must have distinct start and end set.");var r=this._ellipticity,n=this._heading,i=Math.abs(n),o=this._start;if(e=zn.negativePiToPi(e),zn.equalsEpsilon(Math.abs(e),Math.PI,zn.EPSILON14)&&(e=zn.sign(o.longitude)*Math.PI),Nn(t)||(t=new ni),Math.abs(zn.PI_OVER_TWO-i)<=zn.EPSILON8)return t.longitude=e,t.latitude=o.latitude,t.height=0,t;if(zn.equalsEpsilon(Math.abs(zn.PI_OVER_TWO-i),zn.PI_OVER_TWO,zn.EPSILON8)){if(zn.equalsEpsilon(e,o.longitude,zn.EPSILON12))return;return t.longitude=e,t.latitude=zn.PI_OVER_TWO*zn.sign(zn.PI_OVER_TWO-n),t.height=0,t}var s,a=o.latitude,u=r*Math.sin(a),c=Math.tan(.5*(zn.PI_OVER_TWO+a))*Math.exp((e-o.longitude)/Math.tan(n)),l=(1+u)/(1-u),h=o.latitude;do{s=h;var p=r*Math.sin(s),f=(1+p)/(1-p);h=2*Math.atan(c*Math.pow(f/l,r/2))-zn.PI_OVER_TWO}while(!zn.equalsEpsilon(h,s,zn.EPSILON12));return t.longitude=e,t.latitude=h,t.height=0,t},zh.prototype.findIntersectionWithLatitude=function(e,t){if(Un.typeOf.number("intersectionLatitude",e),!Nn(this._distance)||0===this._distance)throw new Ln("EllipsoidRhumbLine must have distinct start and end set.");var r=this._ellipticity,n=this._heading,i=this._start;if(!zn.equalsEpsilon(Math.abs(n),zn.PI_OVER_TWO,zn.EPSILON8)){var o=Lh(r,i.latitude),s=Lh(r,e),a=Math.tan(n)*(s-o),u=zn.negativePiToPi(i.longitude+a);return Nn(t)?(t.longitude=u,t.latitude=e,t.height=0,t):new ni(u,e,0)}};function jh(e,t,r,n){this[0]=Qn(e,0),this[1]=Qn(r,0),this[2]=Qn(t,0),this[3]=Qn(n,0)}Object.freeze({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3}),jh.packedLength=4,jh.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t},jh.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new jh),r[0]=e[t++],r[1]=e[t++],r[2]=e[t++],r[3]=e[t++],r},jh.clone=function(e,t){if(Nn(e))return Nn(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new jh(e[0],e[2],e[1],e[3])},jh.fromArray=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new jh),r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],r},jh.fromColumnMajorArray=function(e,t){return Un.defined("values",e),jh.clone(e,t)},jh.fromRowMajorArray=function(e,t){return Un.defined("values",e),Nn(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new jh(e[0],e[1],e[2],e[3])},jh.fromScale=function(e,t){return Un.typeOf.object("scale",e),Nn(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new jh(e.x,0,0,e.y)},jh.fromUniformScale=function(e,t){return Un.typeOf.number("scale",e),Nn(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new jh(e,0,0,e)},jh.fromRotation=function(e,t){Un.typeOf.number("angle",e);var r=Math.cos(e),n=Math.sin(e);return Nn(t)?(t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t):new jh(r,-n,n,r)},jh.toArray=function(e,t){return Un.typeOf.object("matrix",e),Nn(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},jh.getElementIndex=function(e,t){return Un.typeOf.number.greaterThanOrEquals("row",t,0),Un.typeOf.number.lessThanOrEquals("row",t,1),Un.typeOf.number.greaterThanOrEquals("column",e,0),Un.typeOf.number.lessThanOrEquals("column",e,1),2*e+t},jh.getColumn=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,1),Un.typeOf.object("result",r);var n=2*t,i=e[n],o=e[n+1];return r.x=i,r.y=o,r},jh.setColumn=function(e,t,r,n){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,1),Un.typeOf.object("cartesian",r),Un.typeOf.object("result",n);var i=2*t;return(n=jh.clone(e,n))[i]=r.x,n[i+1]=r.y,n},jh.getRow=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,1),Un.typeOf.object("result",r);var n=e[t],i=e[t+2];return r.x=n,r.y=i,r},jh.setRow=function(e,t,r,n){return Un.typeOf.object("matrix",e),Un.typeOf.number.greaterThanOrEquals("index",t,0),Un.typeOf.number.lessThanOrEquals("index",t,1),Un.typeOf.object("cartesian",r),Un.typeOf.object("result",n),(n=jh.clone(e,n))[t]=r.x,n[t+2]=r.y,n};var Hh=new li;jh.getScale=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t.x=li.magnitude(li.fromElements(e[0],e[1],Hh)),t.y=li.magnitude(li.fromElements(e[2],e[3],Hh)),t};var qh=new li;jh.getMaximumScale=function(e){return jh.getScale(e,qh),li.maximumComponent(qh)},jh.multiply=function(e,t,r){Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r);var n=e[0]*t[0]+e[2]*t[1],i=e[0]*t[2]+e[2]*t[3],o=e[1]*t[0]+e[3]*t[1],s=e[1]*t[2]+e[3]*t[3];return r[0]=n,r[1]=o,r[2]=i,r[3]=s,r},jh.add=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r},jh.subtract=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r},jh.multiplyByVector=function(e,t,r){Un.typeOf.object("matrix",e),Un.typeOf.object("cartesian",t),Un.typeOf.object("result",r);var n=e[0]*t.x+e[2]*t.y,i=e[1]*t.x+e[3]*t.y;return r.x=n,r.y=i,r},jh.multiplyByScalar=function(e,t,r){return Un.typeOf.object("matrix",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r},jh.multiplyByScale=function(e,t,r){return Un.typeOf.object("matrix",e),Un.typeOf.object("scale",t),Un.typeOf.object("result",r),r[0]=e[0]*t.x,r[1]=e[1]*t.x,r[2]=e[2]*t.y,r[3]=e[3]*t.y,r},jh.negate=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},jh.transpose=function(e,t){Un.typeOf.object("matrix",e),Un.typeOf.object("result",t);var r=e[0],n=e[2],i=e[1],o=e[3];return t[0]=r,t[1]=n,t[2]=i,t[3]=o,t},jh.abs=function(e,t){return Un.typeOf.object("matrix",e),Un.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},jh.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},jh.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]},jh.equalsEpsilon=function(e,t,r){return Un.typeOf.number("epsilon",r),e===t||Nn(e)&&Nn(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r},jh.IDENTITY=Object.freeze(new jh(1,0,0,1)),jh.ZERO=Object.freeze(new jh(0,0,0,0)),jh.COLUMN0ROW0=0,jh.COLUMN0ROW1=1,jh.COLUMN1ROW0=2,jh.COLUMN1ROW1=3,Object.defineProperties(jh.prototype,{length:{get:function(){return jh.packedLength}}}),jh.prototype.clone=function(e){return jh.clone(this,e)},jh.prototype.equals=function(e){return jh.equals(this,e)},jh.prototype.equalsEpsilon=function(e,t){return jh.equalsEpsilon(this,e,t)},jh.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n("+this[1]+", "+this[3]+")"};var Vh={POINTS:Dh.POINTS,LINES:Dh.LINES,LINE_LOOP:Dh.LINE_LOOP,LINE_STRIP:Dh.LINE_STRIP,TRIANGLES:Dh.TRIANGLES,TRIANGLE_STRIP:Dh.TRIANGLE_STRIP,TRIANGLE_FAN:Dh.TRIANGLE_FAN,isLines:function(e){return e===Vh.LINES||e===Vh.LINE_LOOP||e===Vh.LINE_STRIP},isTriangles:function(e){return e===Vh.TRIANGLES||e===Vh.TRIANGLE_STRIP||e===Vh.TRIANGLE_FAN},validate:function(e){return e===Vh.POINTS||e===Vh.LINES||e===Vh.LINE_LOOP||e===Vh.LINE_STRIP||e===Vh.TRIANGLES||e===Vh.TRIANGLE_STRIP||e===Vh.TRIANGLE_FAN}},Yh=Object.freeze(Vh);new ni,new qn,new la,new ni,new ni,new ni,new li,new li,new li,new li,new li,new li,new qn,new tu,new la,new jh;var Xh={CLOCKWISE:Dh.CW,COUNTER_CLOCKWISE:Dh.CCW,NONE:Dh.NONE,validate:function(e){return e===Xh.CLOCKWISE||e===Xh.COUNTER_CLOCKWISE}},Wh=Object.freeze(Xh);new qn,new qn,new qn,new qn,new qn,new qn,new qn,new qn,new qn,new ni,new ni,new ni,new ni,qn.packedLength,ea.packedLength,new qn,new qn,new qn,new qn,new qn,new qn,new ea,new ea,new ea,new qn,new qn,new qn,new qn,new qn,new ni,new qn,new ni,new ni,new ni,new ni,new ni,new qn,new qn,new qn,new qn,new qn,new li,new li,new li,new li,new li,new qn,new qn,new qn,new qn,new li,new qn,new qn,new qn,new $l(qn.UNIT_X,0),new qn,new qn,new qn,new qn,new qn,new qn,new qn,new Sc,new gi;var Kh=[];Kh.push(new li),Kh.push(new li),Kh.push(new li),Kh.push(new li),Kh.push(new li),Kh.push(new li),new ni,new qn,new qn,new qn,new qn;const $h=Math.PI/180,Jh=180/Math.PI;function Zh(e){return e*$h}function ep(e){return e*Jh}function tp(e,t,r){return Math.min(r,Math.max(t,e))}function rp(e,t,r){const n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function np(e){const t=[];for(const r in e)t.push(e[r]);return t}function ip(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}!function(){const e=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),t=e(this,(function(){return t.toString().search("(((.+)+)+)+$").toString().constructor(t).search("(((.+)+)+)+$")}));t()}();let op=1;function sp(e,t){return-1!==e.indexOf(t,e.length-t.length)}function ap(e,t,r){const n={};for(const i in e)n[i]=t.call(r||this,e[i],i,e);return n}function up(e){return Array.isArray(e)?e.map(up):"object"==typeof e&&e?ap(e,up):e}const cp={};function lp(e){cp[e]||("undefined"!=typeof console&&console.warn(e),cp[e]=!0)}function hp(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function pp(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function fp(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,r,n,i)=>{const o=n||i;return t[r]=!o||o.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t}let dp=new ni;function Ap(e,t,r,n,i){dp=function(e,t,r,n){const i=Ec-r,o=1<<n.z,s=(t/Ec+n.x)/o,a=(i/Ec+n.y)/o;let u=e.toLngLat(s,a);return dp=ni.fromDegrees(u.lng,u.lat,0,dp),dp}(e,t,r,n),i&&(dp.height=i(dp));var o=ni.toCartesian(dp);return(e.sceneMode==_c.COLUMBUS_VIEW||e.sceneMode==_c.SCENE2D)&&(o=Ou.convertToColumbusCartesian(o)),o}const gp=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),_p=gp(void 0,(function(){return _p.toString().search("(((.+)+)+)+$").toString().constructor(_p).search("(((.+)+)+)+$")}));_p();const mp="mapbox-tiles";let yp;function Ep(e,t,r){if(!window.caches)return;const n={status:t.status,statusText:t.statusText,headers:new window.Headers};t.headers.forEach(((e,t)=>n.headers.set(t,e)));const i=fp(t.headers.get("Cache-Control")||"");if(i["no-store"])return;i["max-age"]&&n.headers.set("Expires",new Date(r+1e3*i["max-age"]).toUTCString());new Date(n.headers.get("Expires")).getTime()-r<42e4||function(e,t){if(void 0===yp)try{new Response(new ReadableStream),yp=!0}catch(e){yp=!1}yp?t(e.body):e.blob().then(t)}(t,(t=>{const r=new window.Response(t,n);window.caches.open(mp).then((t=>t.put(xp(e.url),r)))}))}function xp(e){const t=e.indexOf("?");return t<0?e:e.slice(0,t)}const Cp=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),bp=Cp(void 0,(function(){return bp.toString().search("(((.+)+)+)+$").toString().constructor(bp).search("(((.+)+)+)+$")}));bp();"function"==typeof Object.freeze&&Object.freeze({Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"});class Ip extends Error{constructor(e,t,r){super(e),this.status=t,this.url=r,this.name=this.constructor.name,this.message=e}toString(){return this.name+": "+this.message+" ("+this.status+"): "+this.url}}const vp=pp()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href;const Tp=function(e,t){const r=pp()?self:window;if(n=e.url,!(/^file:/.test(n)||/^file:/.test(vp())&&!/^\w+:/.test(n))){if(r.fetch&&r.Request&&r.AbortController&&r.Request.prototype.hasOwnProperty("signal"))return function(e,t){const r=pp()?self:window,n=new r.AbortController,i=new r.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:vp(),signal:n.signal});let o=!1,s=!1;"json"===e.type&&i.headers.set("Accept","application/json");const a=(n,o,a)=>{if(s)return;if(n&&"SecurityError"!==n.message&&lp(n),o&&a)return u(o);const c=Date.now();r.fetch(i).then((r=>r.ok?u(r,null,c):t(new Ip(r.statusText,r.status,e.url)))).catch((e=>{20!==e.code&&t(new Error(e.message))}))},u=(r,n,a)=>{("arrayBuffer"===e.type?r.arrayBuffer():"json"===e.type?r.json():r.text()).then((e=>{s||(n&&a&&Ep(i,n,a),o=!0,t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((e=>t(new Error(e.message))))};return a(null,null),{cancel:()=>{s=!0,o||n.abort()}}}(e,t);if(pp()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t)}var n;return function(e,t){const r=new((pp()?self:window).XMLHttpRequest);r.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(r.responseType="arraybuffer");for(const t in e.headers)r.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=()=>{t(new Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){let n=r.response;if("json"===e.type)try{n=JSON.parse(r.response)}catch(e){return t(e)}t(null,n,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else t(new Ip(r.statusText,r.status,e.url))},r.send(e.body),{cancel:()=>r.abort()}}(e,t)},Rp={};function Sp(e,t,r={}){const n=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),i=n(this,(function(){return i.toString().search("(((.+)+)+)+$").toString().constructor(i).search("(((.+)+)+)+$")}));i(),Rp[t],Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Rp[t]={klass:e,omit:r.omit||[]}}Sp(Object,"Object"),n.serialize=function(e,t){const r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},n.deserialize=function(e){return new n(e.buffer)},Object.defineProperty(n,"name",{value:"Grid"}),Sp(n,"Grid"),Sp(y,"Color"),Sp(Error,"Error"),Sp(Ip,"AJAXError"),Sp(ne,"ResolvedImage"),Sp(wn,"StylePropertyFunction"),Sp(In,"StyleExpression",{omit:["_evaluator"]}),Sp(Sn,"ZoomDependentExpression"),Sp(Rn,"ZoomConstantExpression"),Sp(Ue,"CompoundExpression",{omit:["_evaluate"]});for(const e in qr)Rp[qr[e]._classRegistryKey]||Sp(qr[e],"Expression"+e);function Mp(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function wp(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Mp(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){const r=e;return t&&t.push(r.buffer),r}if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){const r=[];for(const n of e)r.push(wp(n,t));return r}if("object"==typeof e){const r=e.constructor,n=r._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class "+n);Rp[n];const i=r.serialize?r.serialize(e,t):{};if(r.serialize)t&&t[t.length-1];else{for(const r in e){if(!e.hasOwnProperty(r))continue;if(Rp[n].omit.indexOf(r)>=0)continue;const o=e[r];i[r]=wp(o,t)}e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(i.$name=n),i}throw new Error("can't serialize object of type "+typeof e)}function Bp(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Mp(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(Bp);if("object"==typeof e){const t=e.$name||"Object",{klass:r}=Rp[t];if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);const n=Object.create(r.prototype);for(const t of Object.keys(e)){if("$name"===t)continue;const r=e[t];n[t]=Bp(r)}return n}throw new Error("can't deserialize object of type "+typeof e)}var Op,Dp=(Op=!0,function(e,t){var r=Op?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Op=!1,r}),Fp=Dp(void 0,(function(){return Fp.toString().search("(((.+)+)+)+$").toString().constructor(Fp).search("(((.+)+)+)+$")}));function Pp(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}Fp(),Pp.prototype.trigger=function(){!this._triggered&&(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))};const Np=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Lp=Np(void 0,(function(){return Lp.toString().search("(((.+)+)+)+$").toString().constructor(Lp).search("(((.+)+)+)+$")}));function Up(e,t,r){var n;this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},n=this,["receive","process"].forEach((function(e){n[e]&&(n[e]=n[e].bind(n))})),this.invoker=new Pp(this.process),this.target.addEventListener("message",this.receive,!1)}function Gp(e,t,r){!(r[e]&&-1!==r[e].indexOf(t))&&(r[e]=r[e]||[],r[e].push(t))}function Qp(e,t,r){if(r&&r[e]){var n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}Lp(),Up.prototype.send=function(e,t,r,n){const i=++Up.taskId;r&&(this.callbacks[i]=r);const o=[];return this.target.postMessage({id:i,type:e,hasCallback:!!r,targetMapId:n,sourceMapId:this.mapId,data:wp(t,o)},o),{cancel:()=>{r&&delete this.callbacks[i],this.target.postMessage({id:i,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}},Up.prototype.receive=function(e){const t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];const e=this.cancelCallbacks[r];delete this.cancelCallbacks[r],e&&e()}else this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()},Up.prototype.process=function(){if(!this.taskQueue.length)return;const e=this.taskQueue.shift(),t=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t)if("<response>"===t.type){const r=this.callbacks[e];delete this.callbacks[e],r&&(t.error?r(Bp(t.error)):r(null,Bp(t.data)))}else{let r=!1;const n=t.hasCallback?(t,n)=>{r=!0,delete this.cancelCallbacks[e];const i=[];this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?wp(t):null,data:wp(n,i)},i)}:e=>{r=!0};let i=null;const o=Bp(t.data);if(this.parent[t.type])i=this.parent[t.type](t.sourceMapId,o,n);else if(this.parent.getWorkerSource){const e=t.type.split(".");i=this.parent.getWorkerSource(t.sourceMapId,e[0],o.source)[e[1]](o,n)}else n(new Error("Could not find function "+t.type));!r&&i&&i.cancel&&(this.cancelCallbacks[e]=i.cancel)}},Up.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)},Up.taskId=0;var kp=function(e,t){void 0===t&&(t={}),ip(this,t),this.type=e},zp=function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));function i(t,r){void 0===r&&(r={}),e.call(this,"error",ip({error:t},r))}return n(),e&&(i.__proto__=e),i.prototype=Object.create(e&&e.prototype),i.prototype.constructor=i,i}(kp),jp=function(){};jp.prototype.on=function(e,t){return this._listeners=this._listeners||{},Gp(e,t,this._listeners),this},jp.prototype.off=function(e,t){return Qp(e,t,this._listeners),Qp(e,t,this._oneTimeListeners),this},jp.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},Gp(e,t,this._oneTimeListeners),this},jp.prototype.fire=function(e,t){"string"==typeof e&&(e=new kp(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var n=0,i=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];n<i.length;n+=1){i[n].call(this,e)}for(var o=0,s=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];o<s.length;o+=1){var a=s[o];Qp(r,a,this._oneTimeListeners),a.call(this,e)}var u=this._eventedParent;u&&(ip(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),u.fire(e))}else e instanceof zp&&console.error(e.error);return this},jp.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},jp.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Hp,qp=(Hp=!0,function(e,t){var r=Hp?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Hp=!1,r}),Vp=qp(void 0,(function(){return Vp.toString().search("(((.+)+)+)+$").toString().constructor(Vp).search("(((.+)+)+)+$")}));Vp();var Yp=function(){this.first=!0};Yp.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Xp,Wp=(Xp=!0,function(e,t){var r=Xp?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Xp=!1,r}),Kp=Wp(void 0,(function(){return Kp.toString().search("(((.+)+)+)+$").toString().constructor(Kp).search("(((.+)+)+)+$")}));Kp();var $p=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Yp,this.transition={})};$p.prototype.isSupportedScript=function(e){return!1},$p.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},$p.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};const Jp=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Zp=Jp(void 0,(function(){return Zp.toString().search("(((.+)+)+)+$").toString().constructor(Zp).search("(((.+)+)+)+$")}));Zp();class ef{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(dn(e))return new wn(e,t);if(vn(e)){const r=Mn(e,t);if("error"===r.result)throw new Error(r.value.map((e=>e.key+": "+e.message)).join(", "));return r.value}{let r=e;return"string"==typeof e&&"color"===t.type&&(r=y.parse(e)),{kind:"constant",evaluate:()=>r}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}class tf{constructor(e){this.property=e,this.value=new ef(e,void 0)}transitioned(e,t){return new nf(this.property,this.value,t,ip({},e.transition,this.transition),e.now)}untransitioned(){return new nf(this.property,this.value,null,{},0)}}class rf{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return up(this._values[e].value.value)}setValue(e,t){!this._values.hasOwnProperty(e)&&(this._values[e]=new tf(this._values[e].property)),this._values[e].value=new ef(this._values[e].property,null===t?void 0:up(t))}getTransition(e){return up(this._values[e].transition)}setTransition(e,t){!this._values.hasOwnProperty(e)&&(this._values[e]=new tf(this._values[e].property)),this._values[e].transition=up(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r);const n=this.getTransition(t);void 0!==n&&(e[t+"-transition"]=n)}return e}transitioned(e,t){const r=new of(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){const e=new of(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class nf{constructor(e,t,r,n,i){const o=n.delay||0,s=n.duration||0;i=i||0,this.property=e,this.value=t,this.begin=i+o,this.end=this.begin+s,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){const n=e.now||0,i=this.value.possiblyEvaluate(e,t,r),o=this.prior;if(o){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return o.possiblyEvaluate(e,t,r);{const s=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,r),i,function(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}(s))}}return i}}class of{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){const n=new uf(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class sf{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return up(this._values[e].value)}setValue(e,t){this._values[e]=new ef(this._values[e].property,null===t?void 0:up(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){const n=new uf(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}}class af{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}}class uf{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class cf{constructor(e){this.specification=e}possiblyEvaluate(e,t){return e.expression.evaluate(t)}interpolate(e,t,r){const n=Ft[this.specification.type];return n?n(e,t,r):e}}class lf{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return"constant"===e.expression.kind||"camera"===e.expression.kind?new af(this,{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)},t):new af(this,e.expression,t)}interpolate(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new af(this,{kind:"constant",value:void 0},e.parameters);const n=Ft[this.specification.type];return n?new af(this,{kind:"constant",value:n(e.value.value,t.value.value,r)},e.parameters):e}evaluate(e,t,r,n,i,o){return"constant"===e.kind?e.value:e.evaluate(t,r,n,i,o)}}class hf{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}}class pf{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const t=new $p(0,{});for(const r in e){const n=e[r];n.specification.overridable&&this.overridableProperties.push(r);const i=this.defaultPropertyValues[r]=new ef(n,void 0),o=this.defaultTransitionablePropertyValues[r]=new tf(n);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate(t)}}}Sp(lf,"DataDrivenProperty"),Sp(cf,"DataConstantProperty"),Sp(hf,"ColorRampProperty");var ff,df=(ff=!0,function(e,t){var r=ff?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return ff=!1,r}),Af=df(void 0,(function(){return Af.toString().search("(((.+)+)+)+$").toString().constructor(Af).search("(((.+)+)+)+$")}));function gf(e,t){return 256*(e=tp(Math.floor(e),0,255))+(t=tp(Math.floor(t),0,255))}Af();const _f=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),mf=_f(void 0,(function(){return mf.toString().search("(((.+)+)+)+$").toString().constructor(mf).search("(((.+)+)+)+$")}));mf();const yf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ef{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class xf{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return this.isTransferred,e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.isTransferred,this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Cf(e,t=1){let r=0,n=0;return{members:e.map((e=>{!e.name||e.name.length;const i=(a=e.type,yf[a].BYTES_PER_ELEMENT),o=r=bf(r,Math.max(t,i)),s=e.components||1;var a;return n=Math.max(n,i),r+=i*s,{name:e.name,type:e.type,components:s,offset:o}})),size:bf(r,Math.max(n,t)),alignment:t}}function bf(e,t){return Math.ceil(e/t)*t}const If=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),vf=If(void 0,(function(){return vf.toString().search("(((.+)+)+)+$").toString().constructor(vf).search("(((.+)+)+)+$")}));vf();class Tf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e}}Tf.prototype.bytesPerElement=4,Sp(Tf,"StructArrayLayout2i4");class Rf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,e}}Rf.prototype.bytesPerElement=6,Sp(Rf,"StructArrayLayout3i6");class Sf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=4*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=n,this.int16[o+3]=i,e}}Sf.prototype.bytesPerElement=8,Sp(Sf,"StructArrayLayout4i8");class Mf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o,s)}emplace(e,t,r,n,i,o,s,a){const u=6*e,c=12*e,l=3*e;return this.int16[u+0]=t,this.int16[u+1]=r,this.uint8[c+4]=n,this.uint8[c+5]=i,this.uint8[c+6]=o,this.uint8[c+7]=s,this.float32[l+2]=a,e}}Mf.prototype.bytesPerElement=12,Sp(Mf,"StructArrayLayout2i4ub1f12");class wf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=4*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.float32[o+3]=i,e}}wf.prototype.bytesPerElement=16,Sp(wf,"StructArrayLayout4f16");class Bf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i)}emplace(e,t,r,n,i,o){const s=6*e,a=3*e;return this.uint16[s+0]=t,this.uint16[s+1]=r,this.uint16[s+2]=n,this.uint16[s+3]=i,this.float32[a+2]=o,e}}Bf.prototype.bytesPerElement=12,Sp(Bf,"StructArrayLayout4ui1f12");class Of extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=4*e;return this.uint16[o+0]=t,this.uint16[o+1]=r,this.uint16[o+2]=n,this.uint16[o+3]=i,e}}Of.prototype.bytesPerElement=8,Sp(Of,"StructArrayLayout4ui8");class Df extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,n,i,o,s,a)}emplace(e,t,r,n,i,o,s,a,u){const c=14*e,l=7*e;return this.int16[c+0]=t,this.int16[c+1]=r,this.float32[l+1]=n,this.float32[l+2]=i,this.float32[l+3]=o,this.float32[l+4]=s,this.float32[l+5]=a,this.float32[l+6]=u,e}}Df.prototype.bytesPerElement=28,Sp(Df,"StructArrayLayout2i6f28");class Ff extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,s){const a=6*e;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=n,this.int16[a+3]=i,this.int16[a+4]=o,this.int16[a+5]=s,e}}Ff.prototype.bytesPerElement=12,Sp(Ff,"StructArrayLayout6i12");class Pf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s,a,u,c,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,t,r,n,i,o,s,a,u,c,l,h)}emplace(e,t,r,n,i,o,s,a,u,c,l,h,p){const f=12*e;return this.int16[f+0]=t,this.int16[f+1]=r,this.int16[f+2]=n,this.int16[f+3]=i,this.uint16[f+4]=o,this.uint16[f+5]=s,this.uint16[f+6]=a,this.uint16[f+7]=u,this.int16[f+8]=c,this.int16[f+9]=l,this.int16[f+10]=h,this.int16[f+11]=p,e}}Pf.prototype.bytesPerElement=24,Sp(Pf,"StructArrayLayout4i4ui4i24");class Nf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_){const m=this.length;return this.resize(m+1),this.emplace(m,e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_)}emplace(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m){const y=24*e,E=12*e;return this.int16[y+0]=t,this.int16[y+1]=r,this.int16[y+2]=n,this.int16[y+3]=i,this.uint16[y+4]=o,this.uint16[y+5]=s,this.uint16[y+6]=a,this.uint16[y+7]=u,this.int16[y+8]=c,this.int16[y+9]=l,this.int16[y+10]=h,this.int16[y+11]=p,this.float32[E+6]=f,this.float32[E+7]=d,this.float32[E+8]=A,this.float32[E+9]=g,this.float32[E+10]=_,this.float32[E+11]=m,e}}Nf.prototype.bytesPerElement=48,Sp(Nf,"StructArrayLayout4i4ui4i6f48");class Lf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,s){const a=10*e,u=5*e;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=n,this.float32[u+2]=i,this.float32[u+3]=o,this.float32[u+4]=s,e}}Lf.prototype.bytesPerElement=20,Sp(Lf,"StructArrayLayout3i3f20");class Uf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){const r=1*e;return this.uint32[r+0]=t,e}}Uf.prototype.bytesPerElement=4,Sp(Uf,"StructArrayLayout1ul4");class Gf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A){const g=this.length;return this.resize(g+1),this.emplace(g,e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A)}emplace(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g){const _=26*e,m=13*e;return this.int16[_+0]=t,this.int16[_+1]=r,this.int16[_+2]=n,this.int16[_+3]=i,this.int16[_+4]=o,this.float32[m+3]=s,this.float32[m+4]=a,this.float32[m+5]=u,this.float32[m+6]=c,this.int16[_+14]=l,this.uint32[m+8]=h,this.uint16[_+18]=p,this.uint16[_+19]=f,this.float32[m+10]=d,this.float32[m+11]=A,this.float32[m+12]=g,e}}Gf.prototype.bytesPerElement=52,Sp(Gf,"StructArrayLayout5i4f1i1ul2ui3f52");class Qf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o,s)}emplace(e,t,r,n,i,o,s,a){const u=8*e;return this.int16[u+0]=t,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+4]=i,this.int16[u+5]=o,this.int16[u+6]=s,this.int16[u+7]=a,e}}Qf.prototype.bytesPerElement=16,Sp(Qf,"StructArrayLayout3i2i2i16");class kf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i)}emplace(e,t,r,n,i,o){const s=4*e,a=8*e;return this.float32[s+0]=t,this.float32[s+1]=r,this.float32[s+2]=n,this.int16[a+6]=i,this.int16[a+7]=o,e}}kf.prototype.bytesPerElement=16,Sp(kf,"StructArrayLayout2f1f2i16");class zf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=12*e,s=3*e;return this.uint8[o+0]=t,this.uint8[o+1]=r,this.float32[s+1]=n,this.float32[s+2]=i,e}}zf.prototype.bytesPerElement=12,Sp(zf,"StructArrayLayout2ub2f12");class jf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}jf.prototype.bytesPerElement=12,Sp(jf,"StructArrayLayout3f12");class Hf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,this.uint16[i+2]=n,e}get(e){const t=3*e;return[this.uint16[t+0],this.uint16[t+1],this.uint16[t+2]]}}Hf.prototype.bytesPerElement=6,Sp(Hf,"StructArrayLayout3ui6");class qf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint32[i+0]=t,this.uint32[i+1]=r,this.uint32[i+2]=n,e}copyFrom3ui6(e){if(!(e instanceof Hf))throw new Error("expect array to be type of StructArrayLayout3ui6");this.clear();for(let t=0;t<e.length;t++){let r=e.get(t);this.emplaceBack(r[0],r[1],r[2])}}}qf.prototype.bytesPerElement=12,Sp(qf,"StructArrayLayout3ul12");class Vf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E){const x=this.length;return this.resize(x+1),this.emplace(x,e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E)}emplace(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E,x){const C=30*e,b=15*e,I=60*e;return this.int16[C+0]=t,this.int16[C+1]=r,this.int16[C+2]=n,this.float32[b+2]=i,this.float32[b+3]=o,this.uint16[C+8]=s,this.uint16[C+9]=a,this.uint32[b+5]=u,this.uint32[b+6]=c,this.uint32[b+7]=l,this.uint16[C+16]=h,this.uint16[C+17]=p,this.uint16[C+18]=f,this.float32[b+10]=d,this.float32[b+11]=A,this.uint8[I+48]=g,this.uint8[I+49]=_,this.uint8[I+50]=m,this.uint32[b+13]=y,this.int16[C+28]=E,this.uint8[I+58]=x,e}}Vf.prototype.bytesPerElement=60,Sp(Vf,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Yf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E,x,C,b,I,v,T,R,S,M){const w=this.length;return this.resize(w+1),this.emplace(w,e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E,x,C,b,I,v,T,R,S,M)}emplace(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E,x,C,b,I,v,T,R,S,M,w){const B=38*e,O=19*e;return this.int16[B+0]=t,this.int16[B+1]=r,this.int16[B+2]=n,this.float32[O+2]=i,this.float32[O+3]=o,this.int16[B+8]=s,this.int16[B+9]=a,this.int16[B+10]=u,this.int16[B+11]=c,this.int16[B+12]=l,this.int16[B+13]=h,this.uint16[B+14]=p,this.uint16[B+15]=f,this.uint16[B+16]=d,this.uint16[B+17]=A,this.uint16[B+18]=g,this.uint16[B+19]=_,this.uint16[B+20]=m,this.uint16[B+21]=y,this.uint16[B+22]=E,this.uint16[B+23]=x,this.uint16[B+24]=C,this.uint16[B+25]=b,this.uint16[B+26]=I,this.uint16[B+27]=v,this.uint16[B+28]=T,this.uint32[O+15]=R,this.float32[O+16]=S,this.float32[O+17]=M,this.float32[O+18]=w,e}}Yf.prototype.bytesPerElement=76,Sp(Yf,"StructArrayLayout3i2f6i15ui1ul3f76");class Xf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){const r=1*e;return this.float32[r+0]=t,e}}Xf.prototype.bytesPerElement=4,Sp(Xf,"StructArrayLayout1f4");class Wf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i)}emplace(e,t,r,n,i,o){const s=5*e;return this.float32[s+0]=t,this.float32[s+1]=r,this.float32[s+2]=n,this.float32[s+3]=i,this.float32[s+4]=o,e}}Wf.prototype.bytesPerElement=20,Sp(Wf,"StructArrayLayout5f20");class Kf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,s){const a=6*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,this.float32[a+3]=i,this.float32[a+4]=o,this.float32[a+5]=s,e}}Kf.prototype.bytesPerElement=24,Sp(Kf,"StructArrayLayout6f24");class $f extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s,a,u){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,i,o,s,a,u)}emplace(e,t,r,n,i,o,s,a,u,c){const l=9*e;return this.float32[l+0]=t,this.float32[l+1]=r,this.float32[l+2]=n,this.float32[l+3]=i,this.float32[l+4]=o,this.float32[l+5]=s,this.float32[l+6]=a,this.float32[l+7]=u,this.float32[l+8]=c,e}}$f.prototype.bytesPerElement=36,Sp($f,"StructArrayLayout9f36");class Jf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,s,a,u,c){const l=this.length;return this.resize(l+1),this.emplace(l,e,t,r,n,i,o,s,a,u,c)}emplace(e,t,r,n,i,o,s,a,u,c,l){const h=10*e;return this.float32[h+0]=t,this.float32[h+1]=r,this.float32[h+2]=n,this.float32[h+3]=i,this.float32[h+4]=o,this.float32[h+5]=s,this.float32[h+6]=a,this.float32[h+7]=u,this.float32[h+8]=c,this.float32[h+9]=l,e}}Jf.prototype.bytesPerElement=40,Sp(Jf,"StructArrayLayout10f40");class Zf extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=3*e,s=6*e;return this.uint32[o+0]=t,this.uint16[s+2]=r,this.uint16[s+3]=n,this.uint16[s+4]=i,e}}Zf.prototype.bytesPerElement=12,Sp(Zf,"StructArrayLayout1ul3ui12");class ed extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}get(e){const t=2*e;return[this.uint16[t+0],this.uint16[t+1]]}}ed.prototype.bytesPerElement=4,Sp(ed,"StructArrayLayout2ui4");class td extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.uint32[n+0]=t,this.uint32[n+1]=r,e}copyFrom2ui4(e){if(!(e instanceof ed))throw new Error("expect array to be type of StructArrayLayout2ui4");this.clear();for(let t=0;t<e.length;t++){let r=e.get(t);this.emplaceBack(r[0],r[1])}}}td.prototype.bytesPerElement=8,Sp(td,"StructArrayLayout2ul8");class rd extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){const r=1*e;return this.uint16[r+0]=t,e}}rd.prototype.bytesPerElement=2,Sp(rd,"StructArrayLayout1ui2");class nd extends xf{constructor(){super()}_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e}}nd.prototype.bytesPerElement=8,Sp(nd,"StructArrayLayout2f8");class id extends Ef{constructor(e,t){super(e,t)}get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}get ecefX(){return this._structArray.float32[this._pos4+10]}get ecefY(){return this._structArray.float32[this._pos4+11]}get ecefZ(){return this._structArray.float32[this._pos4+12]}}id.prototype.size=52;class od extends Gf{constructor(){super()}get(e){return new id(this,e)}}Sp(od,"CollisionBoxArray");class sd extends Ef{constructor(e,t){super(e,t)}get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}sd.prototype.size=60;class ad extends Vf{constructor(){super()}get(e){return new sd(this,e)}}Sp(ad,"PlacedSymbolArray");class ud extends Ef{constructor(e,t){super(e,t)}get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ud.prototype.size=76;class cd extends Yf{constructor(){super()}get(e){return new ud(this,e)}}Sp(cd,"SymbolInstanceArray");class ld extends Xf{constructor(){super()}getoffsetX(e){return this.float32[1*e+0]}}Sp(ld,"GlyphOffsetArray");class hd extends Tf{constructor(){super()}getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Sp(hd,"SymbolLineVertexArray");class pd extends Ef{constructor(e,t){super(e,t)}get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}pd.prototype.size=12;class fd extends Zf{constructor(){super()}get(e){return new pd(this,e)}}Sp(fd,"FeatureIndexArray");class dd extends ed{constructor(){super()}geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Sp(dd,"FillExtrusionCentroidArray");class Ad extends Ef{constructor(e,t){super(e,t)}get lng(){return this._structArray.float32[this._pos4]}get lat(){return this._structArray.float32[this._pos4+1]}get height(){return this._structArray.float32[this._pos4+2]}get quads(){return this._structArray.float32[this._pos4+3]}set height(e){this._structArray.float32[this._pos4+2]=e}}Ad.prototype.size=16;class gd extends wf{constructor(){super()}get(e){return new Ad(this,e)}}Sp(gd,"LngLatHeightQuadArray");const _d=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),md=_d(void 0,(function(){return md.toString().search("(((.+)+)+)+$").toString().constructor(md).search("(((.+)+)+)+$")}));md();const yd=Cf([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ed=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),xd=Ed(void 0,(function(){return xd.toString().search("(((.+)+)+)+$").toString().constructor(xd).search("(((.+)+)+)+$")}));xd();const Cd=Cf([{name:"a_dash",components:4,type:"Uint16"}]);var bd,Id=(bd=!0,function(e,t){var r=bd?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return bd=!1,r}),vd=Id(void 0,(function(){return vd.toString().search("(((.+)+)+)+$").toString().constructor(vd).search("(((.+)+)+)+$")}));vd();var Td=function(){this.ids=[],this.positions=[],this.indexed=!1};function Rd(e,t,r,n){if(!(r>=n)){for(var i=e[r+n>>1],o=r-1,s=n+1;;){do{o++}while(e[o]<i);do{s--}while(e[s]>i);if(o>=s)break;Sd(e,o,s),Sd(t,3*o,3*s),Sd(t,3*o+1,3*s+1),Sd(t,3*o+2,3*s+2)}Rd(e,t,r,s),Rd(e,t,s+1,n)}}function Sd(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}Td.prototype.add=function(e,t,r,n){this.ids.push(e),this.positions.push(t,r,n)},Td.prototype.getPositions=function(e){for(var t=0,r=this.ids.length-1;t<r;){var n=t+r>>1;this.ids[n]>=e?r=n:t=n+1}for(var i=[];this.ids[t]===e;){var o=this.positions[3*t],s=this.positions[3*t+1],a=this.positions[3*t+2];i.push({index:o,start:s,end:a}),t++}return i},Td.serialize=function(e,t){var r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return Rd(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}},Td.deserialize=function(e){var t=new Td;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t},Sp(Td,"FeaturePositionMap");var Md={UNSIGNED_BYTE:Dh.UNSIGNED_BYTE,UNSIGNED_SHORT:Dh.UNSIGNED_SHORT,UNSIGNED_INT:Dh.UNSIGNED_INT,getSizeInBytes:function(e){switch(e){case Md.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Md.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Md.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}throw new Ln("indexDatatype is required and must be a valid IndexDatatype constant.")},fromSizeInBytes:function(e){switch(e){case 2:return Md.UNSIGNED_SHORT;case 4:return Md.UNSIGNED_INT;case 1:return Md.UNSIGNED_BYTE;default:throw new Ln("Size in bytes cannot be mapped to an IndexDatatype")}},validate:function(e){return Nn(e)&&(e===Md.UNSIGNED_BYTE||e===Md.UNSIGNED_SHORT||e===Md.UNSIGNED_INT)},createTypedArray:function(e,t){if(!Nn(e))throw new Ln("numberOfVertices is required.");return e>=zn.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)},createTypedArrayFromArrayBuffer:function(e,t,r,n){if(!Nn(e))throw new Ln("numberOfVertices is required.");if(!Nn(t))throw new Ln("sourceArray is required.");if(!Nn(r))throw new Ln("byteOffset is required.");return e>=zn.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,r,n):new Uint16Array(t,r,n)},fromTypedArray:function(e){if(e instanceof Uint8Array)return Md.UNSIGNED_BYTE;if(e instanceof Uint16Array)return Md.UNSIGNED_SHORT;if(e instanceof Uint32Array)return Md.UNSIGNED_INT;throw new Ln("array must be a Uint8Array, Uint16Array, or Uint32Array.")}},wd=Object.freeze(Md),Bd={STREAM_DRAW:Dh.STREAM_DRAW,STATIC_DRAW:Dh.STATIC_DRAW,DYNAMIC_DRAW:Dh.DYNAMIC_DRAW,validate:function(e){return e===Bd.STREAM_DRAW||e===Bd.STATIC_DRAW||e===Bd.DYNAMIC_DRAW}};function Od(){return!0}function Dd(e,t){function r(){throw new Ln(t)}for(var n in t=Qn(t,"This object was destroyed, i.e., destroy() was called."),e)"function"==typeof e[n]&&(e[n]=r);e.isDestroyed=Od}const Fd=0,Pd=1;function Nd(e){if(e=Qn(e,Qn.EMPTY_OBJECT),Un.defined("options.context",e.context),!Nn(e.typedArray)&&!Nn(e.sizeInBytes))throw new Ln("Either options.sizeInBytes or options.typedArray is required.");if(Nn(e.typedArray)&&Nn(e.sizeInBytes))throw new Ln("Cannot pass in both options.sizeInBytes and options.typedArray.");if(Nn(e.typedArray)&&(Un.typeOf.object("options.typedArray",e.typedArray),Un.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),!Bd.validate(e.usage))throw new Ln("usage is invalid.");var t=e.context._gl,r=e.bufferTarget,n=e.typedArray,i=e.sizeInBytes,o=e.usage,s=Nn(n);s&&(i=n.byteLength),Un.typeOf.number.greaterThan("sizeInBytes",i,0);var a=t.createBuffer();t.bindBuffer(r,a),t.bufferData(r,s?n:i,o),t.bindBuffer(r,null),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=r,this._sizeInBytes=i,this._usage=o,this._buffer=a,this.context=e.context,e.context.memorySize+=i,this._ownerName=e.owner,this.context.memoryAnalyzer.allocateGPUMemory(Pd,e.owner,i)}Object.defineProperties(Nd.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),Nd.prototype._getBuffer=function(){return this._buffer},Nd.prototype.copyFromArrayView=function(e,t){t=Qn(t,0),Un.defined("arrayView",e),Un.typeOf.number.lessThanOrEquals("offsetInBytes + arrayView.byteLength",t+e.byteLength,this._sizeInBytes);var r=this._gl,n=this._bufferTarget;r.bindBuffer(n,this._buffer),r.bufferSubData(n,t,e),r.bindBuffer(n,null)},Nd.prototype.copyFromBuffer=function(e,t,r,n){if(!this._webgl2)throw new Ln("A WebGL 2 context is required.");if(!Nn(e))throw new Ln("readBuffer must be defined.");if(!Nn(n)||n<=0)throw new Ln("sizeInBytes must be defined and be greater than zero.");if(!Nn(t)||t<0||t+n>e.sizeInBytes)throw new Ln("readOffset must be greater than or equal to zero and readOffset + sizeInBytes must be less than of equal to readBuffer.sizeInBytes.");if(!Nn(r)||r<0||r+n>this._sizeInBytes)throw new Ln("writeOffset must be greater than or equal to zero and writeOffset + sizeInBytes must be less than of equal to this.sizeInBytes.");if(this._buffer===e.buffer&&(r>=t&&r<t+n||t>r&&t<r+n))throw new Ln("When readBuffer is equal to this, the ranges [readOffset + sizeInBytes) and [writeOffset, writeOffset + sizeInBytes) must not overlap.");if(this._bufferTarget===Dh.ELEMENT_ARRAY_BUFFER&&e.bufferTarget!==Dh.ELEMENT_ARRAY_BUFFER||this._bufferTarget!==Dh.ELEMENT_ARRAY_BUFFER&&e.bufferTarget===Dh.ELEMENT_ARRAY_BUFFER)throw new Ln("Can not copy an index buffer into another buffer type.");var i=Dh.COPY_READ_BUFFER,o=Dh.COPY_WRITE_BUFFER,s=this._gl;s.bindBuffer(o,this._buffer),s.bindBuffer(i,e.buffer),s.copyBufferSubData(i,o,t,r,n),s.bindBuffer(o,null),s.bindBuffer(i,null)},Nd.prototype.getBufferData=function(e,t,r,n){if(t=Qn(t,0),r=Qn(r,0),!this._webgl2)throw new Ln("A WebGL 2 context is required.");if(!Nn(e))throw new Ln("arrayView is required.");var i,o,s=e.byteLength;if(Nn(n)?(i=n,Nn(s)?o=1:(s=e.length,o=e.BYTES_PER_ELEMENT)):Nn(s)?(i=s-r,o=1):(i=(s=e.length)-r,o=e.BYTES_PER_ELEMENT),r<0||r>s)throw new Ln("destinationOffset must be greater than zero and less than the arrayView length.");if(r+i>s)throw new Ln("destinationOffset + length must be less than or equal to the arrayViewLength.");if(t<0||t>this._sizeInBytes)throw new Ln("sourceOffset must be greater than zero and less than the buffers size.");if(t+i*o>this._sizeInBytes)throw new Ln("sourceOffset + length must be less than the buffers size.");var a=this._gl,u=Dh.COPY_READ_BUFFER;a.bindBuffer(u,this._buffer),a.getBufferSubData(u,t,e,r,n),a.bindBuffer(u,null)},Nd.prototype.isDestroyed=function(){return!1},Nd.prototype.destroy=function(){return!this.context._contextWasLost&&this._gl.deleteBuffer(this._buffer),this.context.memorySize-=this.sizeInBytes,this.context.memoryAnalyzer.releaseGPUMemory(Pd,this._ownerName,this.sizeInBytes),Dd(this)};var Ld,Ud=(Ld=!0,function(e,t){var r=Ld?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Ld=!1,r}),Gd=Ud(void 0,(function(){return Gd.toString().search("(((.+)+)+)+$").toString().constructor(Gd).search("(((.+)+)+)+$")}));function Qd(){}Gd(),Qd.ALPHA_DISABLE=0,Qd.ALPHA_ADD=1,Qd.ALPHA_COMBINE=2,Qd.ALPHA_SUBTRACT=3,Qd.ALPHA_MULTIPLY=4,Qd.ALPHA_MAXIMIZED=5,Qd.ALPHA_ONEONE=6,Qd.ALPHA_PREMULTIPLIED=7,Qd.ALPHA_PREMULTIPLIED_PORTERDUFF=8,Qd.ALPHA_INTERPOLATE=9,Qd.ALPHA_SCREENMODE=10,Qd.ALPHA_ONEONE_ONEONE=11,Qd.ALPHA_ALPHATOCOLOR=12,Qd.ALPHA_REVERSEONEMINUS=13,Qd.ALPHA_SRC_DSTONEMINUSSRCALPHA=14,Qd.ALPHA_ONEONE_ONEZERO=15,Qd.ALPHA_EXCLUSION=16,Qd.ALPHA_LAYER_ACCUMULATE=17,Qd.ALPHA_EQUATION_ADD=0,Qd.ALPHA_EQUATION_SUBSTRACT=1,Qd.ALPHA_EQUATION_REVERSE_SUBTRACT=2,Qd.ALPHA_EQUATION_MAX=3,Qd.ALPHA_EQUATION_MIN=4,Qd.ALPHA_EQUATION_DARKEN=5,Qd.DELAYLOADSTATE_NONE=0,Qd.DELAYLOADSTATE_LOADED=1,Qd.DELAYLOADSTATE_LOADING=2,Qd.DELAYLOADSTATE_NOTLOADED=4,Qd.NEVER=512,Qd.ALWAYS=519,Qd.LESS=513,Qd.EQUAL=514,Qd.LEQUAL=515,Qd.GREATER=516,Qd.GEQUAL=518,Qd.NOTEQUAL=517,Qd.KEEP=7680,Qd.ZERO=0,Qd.REPLACE=7681,Qd.INCR=7682,Qd.DECR=7683,Qd.INVERT=5386,Qd.INCR_WRAP=34055,Qd.DECR_WRAP=34056,Qd.FRONT=0,Qd.BACK=1,Qd.TEXTURE_CLAMP_ADDRESSMODE=0,Qd.TEXTURE_WRAP_ADDRESSMODE=1,Qd.TEXTURE_MIRROR_ADDRESSMODE=2,Qd.TEXTURE_CREATIONFLAG_STORAGE=1,Qd.TEXTUREFORMAT_ALPHA=0,Qd.TEXTUREFORMAT_LUMINANCE=1,Qd.TEXTUREFORMAT_LUMINANCE_ALPHA=2,Qd.TEXTUREFORMAT_RGB=4,Qd.TEXTUREFORMAT_RGBA=5,Qd.TEXTUREFORMAT_RED=6,Qd.TEXTUREFORMAT_R=6,Qd.TEXTUREFORMAT_RG=7,Qd.TEXTUREFORMAT_RED_INTEGER=8,Qd.TEXTUREFORMAT_R_INTEGER=8,Qd.TEXTUREFORMAT_RG_INTEGER=9,Qd.TEXTUREFORMAT_RGB_INTEGER=10,Qd.TEXTUREFORMAT_RGBA_INTEGER=11,Qd.TEXTUREFORMAT_BGRA=12,Qd.TEXTUREFORMAT_DEPTH24_STENCIL8=13,Qd.TEXTUREFORMAT_DEPTH32_FLOAT=14,Qd.TEXTUREFORMAT_DEPTH16=15,Qd.TEXTUREFORMAT_DEPTH24=16,Qd.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8=17,Qd.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8=18,Qd.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM=36492,Qd.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_BPTC_UNORM=36493,Qd.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT=36495,Qd.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_SIGNED_FLOAT=36494,Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5=33779,Qd.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919,Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3=33778,Qd.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918,Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1=33777,Qd.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1=33776,Qd.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917,Qd.TEXTUREFORMAT_COMPRESSED_SRGB_S3TC_DXT1_EXT=35916,Qd.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4=37808,Qd.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840,Qd.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL=36196,Qd.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2=37492,Qd.TEXTUREFORMAT_COMPRESSED_SRGB8_ETC2=37493,Qd.TEXTUREFORMAT_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494,Qd.TEXTUREFORMAT_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495,Qd.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC=37496,Qd.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497,Qd.TEXTURETYPE_UNSIGNED_BYTE=0,Qd.TEXTURETYPE_UNSIGNED_INT=0,Qd.TEXTURETYPE_FLOAT=1,Qd.TEXTURETYPE_HALF_FLOAT=2,Qd.TEXTURETYPE_BYTE=3,Qd.TEXTURETYPE_SHORT=4,Qd.TEXTURETYPE_UNSIGNED_SHORT=5,Qd.TEXTURETYPE_INT=6,Qd.TEXTURETYPE_UNSIGNED_INTEGER=7,Qd.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,Qd.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,Qd.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,Qd.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,Qd.TEXTURETYPE_UNSIGNED_INT_24_8=12,Qd.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,Qd.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,Qd.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,Qd.TEXTURETYPE_UNDEFINED=16,Qd.TEXTURE_NEAREST_SAMPLINGMODE=1,Qd.TEXTURE_NEAREST_NEAREST=1,Qd.TEXTURE_BILINEAR_SAMPLINGMODE=2,Qd.TEXTURE_LINEAR_LINEAR=2,Qd.TEXTURE_TRILINEAR_SAMPLINGMODE=3,Qd.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,Qd.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,Qd.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,Qd.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,Qd.TEXTURE_NEAREST_LINEAR=7,Qd.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,Qd.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,Qd.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,Qd.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,Qd.TEXTURE_LINEAR_NEAREST=12,Qd.TEXTURE_EXPLICIT_MODE=0,Qd.TEXTURE_SPHERICAL_MODE=1,Qd.TEXTURE_PLANAR_MODE=2,Qd.TEXTURE_CUBIC_MODE=3,Qd.TEXTURE_PROJECTION_MODE=4,Qd.TEXTURE_SKYBOX_MODE=5,Qd.TEXTURE_INVCUBIC_MODE=6,Qd.TEXTURE_EQUIRECTANGULAR_MODE=7,Qd.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,Qd.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,Qd.TEXTURE_FILTERING_QUALITY_OFFLINE=4096,Qd.TEXTURE_FILTERING_QUALITY_HIGH=64,Qd.TEXTURE_FILTERING_QUALITY_MEDIUM=16,Qd.TEXTURE_FILTERING_QUALITY_LOW=8,Qd.SCALEMODE_FLOOR=1,Qd.SCALEMODE_NEAREST=2,Qd.SCALEMODE_CEILING=3,Qd.MATERIAL_TextureDirtyFlag=1,Qd.MATERIAL_LightDirtyFlag=2,Qd.MATERIAL_FresnelDirtyFlag=4,Qd.MATERIAL_AttributesDirtyFlag=8,Qd.MATERIAL_MiscDirtyFlag=16,Qd.MATERIAL_PrePassDirtyFlag=32,Qd.MATERIAL_AllDirtyFlag=63,Qd.MATERIAL_TriangleFillMode=0,Qd.MATERIAL_WireFrameFillMode=1,Qd.MATERIAL_PointFillMode=2,Qd.MATERIAL_PointListDrawMode=3,Qd.MATERIAL_LineListDrawMode=4,Qd.MATERIAL_LineLoopDrawMode=5,Qd.MATERIAL_LineStripDrawMode=6,Qd.MATERIAL_TriangleStripDrawMode=7,Qd.MATERIAL_TriangleFanDrawMode=8,Qd.MATERIAL_ClockWiseSideOrientation=0,Qd.MATERIAL_CounterClockWiseSideOrientation=1,Qd.ACTION_NothingTrigger=0,Qd.ACTION_OnPickTrigger=1,Qd.ACTION_OnLeftPickTrigger=2,Qd.ACTION_OnRightPickTrigger=3,Qd.ACTION_OnCenterPickTrigger=4,Qd.ACTION_OnPickDownTrigger=5,Qd.ACTION_OnDoublePickTrigger=6,Qd.ACTION_OnPickUpTrigger=7,Qd.ACTION_OnPickOutTrigger=16,Qd.ACTION_OnLongPressTrigger=8,Qd.ACTION_OnPointerOverTrigger=9,Qd.ACTION_OnPointerOutTrigger=10,Qd.ACTION_OnEveryFrameTrigger=11,Qd.ACTION_OnIntersectionEnterTrigger=12,Qd.ACTION_OnIntersectionExitTrigger=13,Qd.ACTION_OnKeyDownTrigger=14,Qd.ACTION_OnKeyUpTrigger=15,Qd.PARTICLES_BILLBOARDMODE_Y=2,Qd.PARTICLES_BILLBOARDMODE_ALL=7,Qd.PARTICLES_BILLBOARDMODE_STRETCHED=8,Qd.MESHES_CULLINGSTRATEGY_STANDARD=0,Qd.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,Qd.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,Qd.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,Qd.SCENELOADER_NO_LOGGING=0,Qd.SCENELOADER_MINIMAL_LOGGING=1,Qd.SCENELOADER_SUMMARY_LOGGING=2,Qd.SCENELOADER_DETAILED_LOGGING=3,Qd.PREPASS_IRRADIANCE_TEXTURE_TYPE=0,Qd.PREPASS_POSITION_TEXTURE_TYPE=1,Qd.PREPASS_VELOCITY_TEXTURE_TYPE=2,Qd.PREPASS_REFLECTIVITY_TEXTURE_TYPE=3,Qd.PREPASS_COLOR_TEXTURE_TYPE=4,Qd.PREPASS_DEPTH_TEXTURE_TYPE=5,Qd.PREPASS_NORMAL_TEXTURE_TYPE=6,Qd.PREPASS_ALBEDO_SQRT_TEXTURE_TYPE=7,Qd.BUFFER_CREATIONFLAG_READ=1,Qd.BUFFER_CREATIONFLAG_WRITE=2,Qd.BUFFER_CREATIONFLAG_READWRITE=3,Qd.BUFFER_CREATIONFLAG_UNIFORM=4,Qd.BUFFER_CREATIONFLAG_VERTEX=8,Qd.BUFFER_CREATIONFLAG_INDEX=16,Qd.BUFFER_CREATIONFLAG_STORAGE=32,Qd.RENDERPASS_MAIN=0,Qd.INPUT_ALT_KEY=18,Qd.INPUT_CTRL_KEY=17,Qd.INPUT_META_KEY1=91,Qd.INPUT_META_KEY2=92,Qd.INPUT_META_KEY3=93,Qd.INPUT_SHIFT_KEY=16,Qd.SNAPSHOTRENDERING_STANDARD=0,Qd.SNAPSHOTRENDERING_FAST=1,Qd.PERSPECTIVE_CAMERA=0,Qd.ORTHOGRAPHIC_CAMERA=1,Qd.FOVMODE_VERTICAL_FIXED=0,Qd.FOVMODE_HORIZONTAL_FIXED=1,Qd.RIG_MODE_NONE=0,Qd.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,Qd.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,Qd.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,Qd.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,Qd.RIG_MODE_STEREOSCOPIC_INTERLACED=14,Qd.RIG_MODE_VR=20,Qd.RIG_MODE_WEBVR=21,Qd.RIG_MODE_CUSTOM=22,Qd.MAX_SUPPORTED_UV_SETS=6,Qd.GL_ALPHA_EQUATION_ADD=32774,Qd.GL_ALPHA_EQUATION_MIN=32775,Qd.GL_ALPHA_EQUATION_MAX=32776,Qd.GL_ALPHA_EQUATION_SUBTRACT=32778,Qd.GL_ALPHA_EQUATION_REVERSE_SUBTRACT=32779,Qd.GL_ALPHA_FUNCTION_SRC=768,Qd.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_COLOR=769,Qd.GL_ALPHA_FUNCTION_SRC_ALPHA=770,Qd.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_ALPHA=771,Qd.GL_ALPHA_FUNCTION_DST_ALPHA=772,Qd.GL_ALPHA_FUNCTION_ONE_MINUS_DST_ALPHA=773,Qd.GL_ALPHA_FUNCTION_DST_COLOR=774,Qd.GL_ALPHA_FUNCTION_ONE_MINUS_DST_COLOR=775,Qd.GL_ALPHA_FUNCTION_SRC_ALPHA_SATURATED=776,Qd.GL_ALPHA_FUNCTION_CONSTANT_COLOR=32769,Qd.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_COLOR=32770,Qd.GL_ALPHA_FUNCTION_CONSTANT_ALPHA=32771,Qd.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_ALPHA=32772,Qd.SnippetUrl="";var kd,zd=(kd=!0,function(e,t){var r=kd?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return kd=!1,r}),jd=zd(void 0,(function(){return jd.toString().search("(((.+)+)+)+$").toString().constructor(jd).search("(((.+)+)+)+$")}));function Hd(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=Hd._Counter++}jd(),Object.defineProperty(Hd.prototype,"underlyingResource",{get:function(){return null},enumerable:!1,configurable:!0}),Hd._Counter=0;var qd,Vd=(qd=!0,function(e,t){var r=qd?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return qd=!1,r}),Yd=Vd(void 0,(function(){return Yd.toString().search("(((.+)+)+)+$").toString().constructor(Yd).search("(((.+)+)+)+$")}));function Xd(e,t,r,n,i,o,s,a){void 0===n&&(n=0),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),this._isAlreadyOwned=!1,e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=r,this._instanced=o,this._divisor=a||1,t instanceof Hd?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=s?n:n*Float32Array.BYTES_PER_ELEMENT,!i&&this.create()}function Wd(e,t,r,n,i,o,s,a,u,c,l,h,p,f){if(void 0===l&&(l=!1),void 0===h&&(h=!1),void 0===p&&(p=1),void 0===f&&(f=!1),t instanceof Xd?(this._buffer=t,this._ownsBuffer=f):(this._buffer=new Xd(e,t,n,o,i,s,h),this._ownsBuffer=!0),this.uniqueId=Wd._Counter++,this._kind=r,null==c){var d=this.getData();this.type=Wd.FLOAT,d instanceof Int8Array?this.type=Wd.BYTE:d instanceof Uint8Array?this.type=Wd.UNSIGNED_BYTE:d instanceof Int16Array?this.type=Wd.SHORT:d instanceof Uint16Array?this.type=Wd.UNSIGNED_SHORT:d instanceof Int32Array?this.type=Wd.INT:d instanceof Uint32Array&&(this.type=Wd.UNSIGNED_INT)}else this.type=c;var A=Wd.GetTypeByteLength(this.type);h?(this._size=u||(o?o/A:Wd.DeduceStride(r)),this.byteStride=o||this._buffer.byteStride||this._size*A,this.byteOffset=a||0):(this._size=u||o||Wd.DeduceStride(r),this.byteStride=o?o*A:this._buffer.byteStride||this._size*A,this.byteOffset=(a||0)*A),this.normalized=l,this._instanced=void 0!==s&&s,this._instanceDivisor=s?p:0,this._computeHashCode()}Yd(),Xd.prototype.createVertexBuffer=function(e,t,r,n,i,o,s){void 0===o&&(o=!1);var a=o?t:t*Float32Array.BYTES_PER_ELEMENT,u=n?o?n:n*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new Wd(this._engine,this,e,this._updatable,!0,u,void 0===i?this._instanced:i,a,r,void 0,void 0,!0,this._divisor||s)},Xd.prototype.isUpdatable=function(){return this._updatable},Xd.prototype.getData=function(){return this._data},Xd.prototype.getBuffer=function(){return this._buffer},Xd.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},Xd.prototype.create=function(e){void 0===e&&(e=null),!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))},Xd.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},Xd.prototype.update=function(e){this.create(e)},Xd.prototype.updateDirectly=function(e,t,r,n){void 0===n&&(n=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,n?t:t*Float32Array.BYTES_PER_ELEMENT,r?r*this.byteStride:void 0),this._data=0===t&&void 0===r?e:null)},Xd.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)},Xd.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)},Object.defineProperty(Wd.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(e){this._instanceDivisor=e,this._instanced=0!=e,this._computeHashCode()},enumerable:!1,configurable:!0}),Wd.prototype._computeHashCode=function(){this.hashCode=(this.type-5120|0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)},Wd.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},Wd.prototype.getKind=function(){return this._kind},Wd.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},Wd.prototype.getData=function(){return this._buffer.getData()},Wd.prototype.getFloatData=function(e,t){var r=this.getData();if(!r)return null;var n=this.getSize()*Wd.GetTypeByteLength(this.type),i=e*this.getSize();if(this.type!==Wd.FLOAT||this.byteStride!==n){var o=new Float32Array(i);return this.forEach(i,(function(e,t){return o[t]=e})),o}if(!(r instanceof Array||r instanceof Float32Array)||0!==this.byteOffset||r.length!==i){if(r instanceof Array){var s=this.byteOffset/4;return r.slice(s,s+i)}if(r instanceof ArrayBuffer)return new Float32Array(r,this.byteOffset,i);s=r.byteOffset+this.byteOffset;if(t){var a=new Float32Array(i),u=new Float32Array(r.buffer,s,i);return a.set(u),a}var c=s%4;return c&&(s=Math.max(0,s-c)),new Float32Array(r.buffer,s,i)}return t?r.slice():r},Wd.prototype.getBuffer=function(){return this._buffer.getBuffer()},Wd.prototype.getStrideSize=function(){return this.byteStride/Wd.GetTypeByteLength(this.type)},Wd.prototype.getOffset=function(){return this.byteOffset/Wd.GetTypeByteLength(this.type)},Wd.prototype.getSize=function(e){return void 0===e&&(e=!1),e?this._size*Wd.GetTypeByteLength(this.type):this._size},Wd.prototype.getIsInstanced=function(){return this._instanced},Wd.prototype.getInstanceDivisor=function(){return this._instanceDivisor},Wd.prototype.create=function(e){this._buffer.create(e)},Wd.prototype.update=function(e){this._buffer.update(e)},Wd.prototype.updateDirectly=function(e,t,r){void 0===r&&(r=!1),this._buffer.updateDirectly(e,t,void 0,r)},Wd.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},Wd.prototype.forEach=function(e,t){Wd.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,e,this.normalized,t)},Wd.DeduceStride=function(e){switch(e){case Wd.UVKind:case Wd.UV2Kind:case Wd.UV3Kind:case Wd.UV4Kind:case Wd.UV5Kind:case Wd.UV6Kind:return 2;case Wd.NormalKind:case Wd.PositionKind:return 3;case Wd.ColorKind:case Wd.MatricesIndicesKind:case Wd.MatricesIndicesExtraKind:case Wd.MatricesWeightsKind:case Wd.MatricesWeightsExtraKind:case Wd.TangentKind:return 4;default:throw new Error("Invalid kind '"+e+"'")}},Wd.GetTypeByteLength=function(e){switch(e){case Wd.BYTE:case Wd.UNSIGNED_BYTE:return 1;case Wd.SHORT:case Wd.UNSIGNED_SHORT:return 2;case Wd.INT:case Wd.UNSIGNED_INT:case Wd.FLOAT:return 4;default:throw new Error("Invalid type '".concat(e,"'"))}},Wd.ForEach=function(e,t,r,n,i,o,s,a){if(e instanceof Array)for(var u=t/4,c=r/4,l=0;l<o;l+=n){for(var h=0;h<n;h++)a(e[u+h],l+h);u+=c}else{var p=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),f=Wd.GetTypeByteLength(i);for(l=0;l<o;l+=n){var d=t;for(h=0;h<n;h++){a(Wd._GetFloatValue(p,i,d,s),l+h),d+=f}t+=r}}},Wd._GetFloatValue=function(e,t,r,n){switch(t){case Wd.BYTE:var i=e.getInt8(r);return n&&(i=Math.max(i/127,-1)),i;case Wd.UNSIGNED_BYTE:i=e.getUint8(r);return n&&(i/=255),i;case Wd.SHORT:i=e.getInt16(r,!0);return n&&(i=Math.max(i/32767,-1)),i;case Wd.UNSIGNED_SHORT:i=e.getUint16(r,!0);return n&&(i/=65535),i;case Wd.INT:return e.getInt32(r,!0);case Wd.UNSIGNED_INT:return e.getUint32(r,!0);case Wd.FLOAT:return e.getFloat32(r,!0);default:throw new Error("Invalid component type ".concat(t))}},Wd._Counter=0,Wd.BYTE=5120,Wd.UNSIGNED_BYTE=5121,Wd.SHORT=5122,Wd.UNSIGNED_SHORT=5123,Wd.INT=5124,Wd.UNSIGNED_INT=5125,Wd.FLOAT=5126,Wd.PositionKind="position",Wd.NormalKind="normal",Wd.TangentKind="tangent",Wd.UVKind="uv",Wd.UV2Kind="uv2",Wd.UV3Kind="uv3",Wd.UV4Kind="uv4",Wd.UV5Kind="uv5",Wd.UV6Kind="uv6",Wd.ColorKind="color",Wd.ColorInstanceKind="instanceColor",Wd.MatricesIndicesKind="matricesIndices",Wd.MatricesWeightsKind="matricesWeights",Wd.MatricesIndicesExtraKind="matricesIndicesExtra",Wd.MatricesWeightsExtraKind="matricesWeightsExtra";var Kd,$d=(Kd=!0,function(e,t){var r=Kd?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Kd=!1,r}),Jd=$d(void 0,(function(){return Jd.toString().search("(((.+)+)+)+$").toString().constructor(Jd).search("(((.+)+)+)+$")}));function Zd(e,t,r){void 0===r&&(r=Qd.BUFFER_CREATIONFLAG_READWRITE),this._engine=e,this._engine._storageBuffers.push(this),this._create(t,r)}function eA(e){var t=(e=Qn(e,Qn.EMPTY_OBJECT)).context,r=e.bufferTarget,n=e.typedArray,i=e.sizeInBytes,o=e.usage,s=Nn(n);s?i=n.byteLength:n=new Uint8Array(i);var a=Qd.BUFFER_CREATIONFLAG_STORAGE;Nn(o)&&(o==Bd.STREAM_DRAW||o==Bd.STATIC_DRAW?a|=Qd.BUFFER_CREATIONFLAG_WRITE:o==Bd.DYNAMIC_DRAW&&(a|=Qd.BUFFER_CREATIONFLAG_READWRITE)),Nn(r)?r==Dh.ELEMENT_ARRAY_BUFFER?(n instanceof Uint8Array&&(e.indexDatatype==wd.UNSIGNED_INT?n=new Uint32Array(n.buffer,n.byteOffset,n.byteLength/4):e.indexDatatype==wd.UNSIGNED_SHORT&&(n=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2))),this._dataBuffer=t.engine.createIndexBuffer(n)):r==Dh.ARRAY_BUFFER?(this._dataBuffer=new Xd(t.engine,n,!0),this._dataBuffer._data=null):console.log("BufferGPU not supported bufferTarget"):(this._dataBuffer=new Zd(t.engine,i,a),s&&this._dataBuffer.update(n,0,i)),this._bufferTarget=r,this._sizeInBytes=i,this._usage=o,this.context=e.context,e.context.memorySize+=i,this._ownerName=e.owner,this.context.memoryAnalyzer.allocateGPUMemory(Pd,e.owner,i)}function tA(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function rA(e){if(e=Qn(e,Qn.EMPTY_OBJECT),Un.defined("options.context",e.context),!Nn(e.typedArray)&&!Nn(e.sizeInBytes))throw new Ln("Either options.sizeInBytes or options.typedArray is required.");if(Nn(e.typedArray)&&Nn(e.sizeInBytes))throw new Ln("Cannot pass in both options.sizeInBytes and options.typedArray.");Nn(e.typedArray)&&(Un.typeOf.object("options.typedArray",e.typedArray),Un.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),this._id=tA(),e.context.webgpu?this._inner=new eA(e):this._inner=new Nd(e),this.vertexArrayDestroyable=!0}function nA(e,t,r,n){this.x=Qn(e,0),this.y=Qn(t,0),this.width=Qn(r,0),this.height=Qn(n,0)}Jd(),Zd.prototype._create=function(e,t){this._bufferSize=e,this._creationFlags=t,this._buffer=this._engine.createStorageBuffer(e,t)},Zd.prototype._rebuild=function(){this._create(this._bufferSize,this._creationFlags)},Zd.prototype.getBuffer=function(){return this._buffer},Zd.prototype.update=function(e,t,r){this._buffer&&this._engine.updateStorageBuffer(this._buffer,e,t,r)},Zd.prototype.read=function(e,t,r){return this._engine.readFromStorageBuffer(this._buffer,e,t,r)},Zd.prototype.dispose=function(){var e=this._engine._storageBuffers,t=e.indexOf(this);-1!==t&&(e[t]=e[e.length-1],e.pop()),this._engine._releaseBuffer(this._buffer),this._buffer=null},Object.defineProperties(eA.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}},dataBuffer:{get:function(){return this._dataBuffer}}}),eA.prototype._getBuffer=function(){return console.log("BufferGPU.prototype._getBuffer"),this._dataBuffer},eA.prototype.copyFromArrayView=function(e,t){this._bufferTarget===Dh.ELEMENT_ARRAY_BUFFER?this.context.engine.updateDynamicIndexBuffer(this._dataBuffer,e):this._dataBuffer.updateDirectly(e,t,null,!0)},eA.prototype.copyFromBuffer=function(e,t,r,n){console.log("BufferGPU.prototype.copyFromBuffer")},eA.prototype.getBufferData=function(e,t,r,n){console.log("BufferGPU.prototype.getBufferData")},eA.prototype.isDestroyed=function(){return!1},eA.prototype.destroy=function(){return this._bufferTarget!==Dh.ELEMENT_ARRAY_BUFFER?this._dataBuffer.dispose():this.context._engine._releaseBuffer(this._dataBuffer),this.context.memorySize-=this.sizeInBytes,this.context.memoryAnalyzer.releaseGPUMemory(Pd,this._ownerName,this.sizeInBytes),Dd(this)},rA.createVertexBuffer=function(e){return Un.defined("options.context",e.context),new rA({context:e.context,bufferTarget:Dh.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage,owner:e.owner})},rA.createIndexBuffer=function(e){if(Un.defined("options.context",e.context),!wd.validate(e.indexDatatype))throw new Ln("Invalid indexDatatype.");if(e.indexDatatype===wd.UNSIGNED_INT&&!e.context.elementIndexUint)throw new Ln("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.");var t=e.context,r=e.indexDatatype,n=wd.getSizeInBytes(r),i=new rA({context:t,bufferTarget:Dh.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage,indexDatatype:r,owner:e.owner}),o=i.sizeInBytes/n;return Object.defineProperties(i,{indexDatatype:{get:function(){return r}},bytesPerIndex:{get:function(){return n}},numberOfIndices:{get:function(){return o}}}),i},Object.defineProperties(rA.prototype,{sizeInBytes:{get:function(){return this._inner.sizeInBytes}},usage:{get:function(){return this._inner.usage}},bufferTarget:{get:function(){return this._inner._bufferTarget}},buffer:{get:function(){return this._inner._buffer}}}),rA.prototype._getBuffer=function(){return this._inner._getBuffer()},rA.prototype.copyFromArrayView=function(e,t){this._inner.copyFromArrayView(e,t)},rA.prototype.copyFromBuffer=function(e,t,r,n){this._inner.copyFromBuffer(e,t,r,n)},rA.prototype.getBufferData=function(e,t,r,n){this._inner.getBufferData(e,t,r,n)},rA.prototype.isDestroyed=function(){return!1},rA.prototype.destroy=function(){return this._inner.destroy(),Dd(this)},nA.packedLength=4,nA.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e.x,t[r++]=e.y,t[r++]=e.width,t[r]=e.height,t},nA.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new nA),r.x=e[t++],r.y=e[t++],r.width=e[t++],r.height=e[t],r},nA.fromPoints=function(e,t){if(Nn(t)||(t=new nA),!Nn(e)||0===e.length)return t.x=0,t.y=0,t.width=0,t.height=0,t;for(var r=e.length,n=e[0].x,i=e[0].y,o=e[0].x,s=e[0].y,a=1;a<r;a++){var u=e[a],c=u.x,l=u.y;n=Math.min(c,n),o=Math.max(c,o),i=Math.min(l,i),s=Math.max(l,s)}return t.x=n,t.y=i,t.width=o-n,t.height=s-i,t};var iA,oA,sA,aA=new Bu,uA=new ni,cA=new ni;function lA(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}function hA(e,t,r,n){this.red=Qn(e,1),this.green=Qn(t,1),this.blue=Qn(r,1),this.alpha=Qn(n,1)}nA.fromRectangle=function(e,t,r){if(Nn(r)||(r=new nA),!Nn(e))return r.x=0,r.y=0,r.width=0,r.height=0,r;var n=(t=Qn(t,aA)).project(vc.southwest(e,uA)),i=t.project(vc.northeast(e,cA));return li.subtract(i,n,i),r.x=n.x,r.y=n.y,r.width=i.x,r.height=i.y,r},nA.clone=function(e,t){if(Nn(e))return Nn(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new nA(e.x,e.y,e.width,e.height)},nA.union=function(e,t,r){Un.typeOf.object("left",e),Un.typeOf.object("right",t),Nn(r)||(r=new nA);var n=Math.min(e.x,t.x),i=Math.min(e.y,t.y),o=Math.max(e.x+e.width,t.x+t.width),s=Math.max(e.y+e.height,t.y+t.height);return r.x=n,r.y=i,r.width=o-n,r.height=s-i,r},nA.expand=function(e,t,r){Un.typeOf.object("rectangle",e),Un.typeOf.object("point",t),r=nA.clone(e,r);var n=t.x-r.x,i=t.y-r.y;return n>r.width?r.width=n:n<0&&(r.width-=n,r.x=t.x),i>r.height?r.height=i:i<0&&(r.height-=i,r.y=t.y),r},nA.intersect=function(e,t){Un.typeOf.object("left",e),Un.typeOf.object("right",t);var r=e.x,n=e.y,i=t.x,o=t.y;return r>i+t.width||r+e.width<i||n+e.height<o||n>o+t.height?bc.OUTSIDE:bc.INTERSECTING},nA.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},nA.prototype.clone=function(e){return nA.clone(this,e)},nA.prototype.intersect=function(e){return nA.intersect(this,e)},nA.prototype.equals=function(e){return nA.equals(this,e)},hA.fromCartesian4=function(e,t){return Un.typeOf.object("cartesian",e),Nn(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new hA(e.x,e.y,e.z,e.w)},hA.fromBytes=function(e,t,r,n,i){return e=hA.byteToFloat(Qn(e,255)),t=hA.byteToFloat(Qn(t,255)),r=hA.byteToFloat(Qn(r,255)),n=hA.byteToFloat(Qn(n,255)),Nn(i)?(i.red=e,i.green=t,i.blue=r,i.alpha=n,i):new hA(e,t,r,n)},hA.fromAlpha=function(e,t,r){return Un.typeOf.object("color",e),Un.typeOf.number("alpha",t),Nn(r)?(r.red=e.red,r.green=e.green,r.blue=e.blue,r.alpha=t,r):new hA(e.red,e.green,e.blue,t)},eu.supportsTypedArrays()&&(iA=new ArrayBuffer(4),oA=new Uint32Array(iA),sA=new Uint8Array(iA)),hA.fromRgba=function(e,t){return oA[0]=e,hA.fromBytes(sA[0],sA[1],sA[2],sA[3],t)},hA.byteToRgba=function(e,t,r,n){return sA[0]=e,sA[1]=t,sA[2]=r,sA[3]=n,oA[0]},hA.fromHsl=function(e,t,r,n,i){e=Qn(e,0)%1,t=Qn(t,0),r=Qn(r,0),n=Qn(n,1);var o=r,s=r,a=r;if(0!==t){var u,c=2*r-(u=r<.5?r*(1+t):r+t-r*t);o=lA(c,u,e+1/3),s=lA(c,u,e),a=lA(c,u,e-1/3)}return Nn(i)?(i.red=o,i.green=s,i.blue=a,i.alpha=n,i):new hA(o,s,a,n)},hA.fromRandom=function(e,t){var r=(e=Qn(e,Qn.EMPTY_OBJECT)).red;if(!Nn(r)){var n=Qn(e.minimumRed,0),i=Qn(e.maximumRed,1);Un.typeOf.number.lessThanOrEquals("minimumRed",n,i),r=n+zn.nextRandomNumber()*(i-n)}var o=e.green;if(!Nn(o)){var s=Qn(e.minimumGreen,0),a=Qn(e.maximumGreen,1);Un.typeOf.number.lessThanOrEquals("minimumGreen",s,a),o=s+zn.nextRandomNumber()*(a-s)}var u=e.blue;if(!Nn(u)){var c=Qn(e.minimumBlue,0),l=Qn(e.maximumBlue,1);Un.typeOf.number.lessThanOrEquals("minimumBlue",c,l),u=c+zn.nextRandomNumber()*(l-c)}var h=e.alpha;if(!Nn(h)){var p=Qn(e.minimumAlpha,0),f=Qn(e.maximumAlpha,1);Un.typeOf.number.lessThanOrEquals("minumumAlpha",p,f),h=p+zn.nextRandomNumber()*(f-p)}return Nn(t)?(t.red=r,t.green=o,t.blue=u,t.alpha=h,t):new hA(r,o,u,h)};var pA=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,fA=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,dA=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,AA=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;hA.fromCssColorString=function(e,t){Un.typeOf.string("color",e),Nn(t)||(t=new hA);var r=hA[e.toUpperCase()];if(Nn(r))return hA.clone(r,t),t;var n=pA.exec(e);return null!==n?(t.red=parseInt(n[1],16)/15,t.green=parseInt(n[2],16)/15,t.blue=parseInt(n[3],16)/15,t.alpha=1,t):null!==(n=fA.exec(e))?(t.red=parseInt(n[1],16)/255,t.green=parseInt(n[2],16)/255,t.blue=parseInt(n[3],16)/255,t.alpha=1,t):null!==(n=dA.exec(e))?(t.red=parseFloat(n[1])/("%"===n[1].substr(-1)?100:255),t.green=parseFloat(n[2])/("%"===n[2].substr(-1)?100:255),t.blue=parseFloat(n[3])/("%"===n[3].substr(-1)?100:255),t.alpha=parseFloat(Qn(n[4],"1.0")),t):null!==(n=AA.exec(e))?hA.fromHsl(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,parseFloat(Qn(n[4],"1.0")),t):t=void 0},hA.packedLength=4,hA.pack=function(e,t,r){return Un.typeOf.object("value",e),Un.defined("array",t),r=Qn(r,0),t[r++]=e.red,t[r++]=e.green,t[r++]=e.blue,t[r]=e.alpha,t},hA.unpack=function(e,t,r){return Un.defined("array",e),t=Qn(t,0),Nn(r)||(r=new hA),r.red=e[t++],r.green=e[t++],r.blue=e[t++],r.alpha=e[t],r},hA.byteToFloat=function(e){return e/255},hA.floatToByte=function(e){return 1===e?255:256*e|0},hA.clone=function(e,t){if(Nn(e))return Nn(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new hA(e.red,e.green,e.blue,e.alpha)},hA.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},hA.equalsArray=function(e,t,r){return e.red===t[r]&&e.green===t[r+1]&&e.blue===t[r+2]&&e.alpha===t[r+3]},hA.prototype.clone=function(e){return hA.clone(this,e)},hA.prototype.equals=function(e){return hA.equals(this,e)},hA.prototype.equalsEpsilon=function(e,t){return this===e||Nn(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},hA.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"},hA.prototype.toCssColorString=function(){var e=hA.floatToByte(this.red),t=hA.floatToByte(this.green),r=hA.floatToByte(this.blue);return 1===this.alpha?"rgb("+e+","+t+","+r+")":"rgba("+e+","+t+","+r+","+this.alpha+")"},hA.prototype.toBytes=function(e){var t=hA.floatToByte(this.red),r=hA.floatToByte(this.green),n=hA.floatToByte(this.blue),i=hA.floatToByte(this.alpha);return Nn(e)?(e[0]=t,e[1]=r,e[2]=n,e[3]=i,e):[t,r,n,i]},hA.prototype.toRgba=function(){return sA[0]=hA.floatToByte(this.red),sA[1]=hA.floatToByte(this.green),sA[2]=hA.floatToByte(this.blue),sA[3]=hA.floatToByte(this.alpha),oA[0]},hA.prototype.brighten=function(e,t){return Un.typeOf.number("magnitude",e),Un.typeOf.number.greaterThanOrEquals("magnitude",e,0),Un.typeOf.object("result",t),e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},hA.prototype.darken=function(e,t){return Un.typeOf.number("magnitude",e),Un.typeOf.number.greaterThanOrEquals("magnitude",e,0),Un.typeOf.object("result",t),e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},hA.prototype.withAlpha=function(e,t){return hA.fromAlpha(this,e,t)},hA.add=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.red=e.red+t.red,r.green=e.green+t.green,r.blue=e.blue+t.blue,r.alpha=e.alpha+t.alpha,r},hA.subtract=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.red=e.red-t.red,r.green=e.green-t.green,r.blue=e.blue-t.blue,r.alpha=e.alpha-t.alpha,r},hA.multiply=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.red=e.red*t.red,r.green=e.green*t.green,r.blue=e.blue*t.blue,r.alpha=e.alpha*t.alpha,r},hA.divide=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.red=e.red/t.red,r.green=e.green/t.green,r.blue=e.blue/t.blue,r.alpha=e.alpha/t.alpha,r},hA.mod=function(e,t,r){return Un.typeOf.object("left",e),Un.typeOf.object("right",t),Un.typeOf.object("result",r),r.red=e.red%t.red,r.green=e.green%t.green,r.blue=e.blue%t.blue,r.alpha=e.alpha%t.alpha,r},hA.lerp=function(e,t,r,n){return Un.typeOf.object("start",e),Un.typeOf.object("end",t),Un.typeOf.number("t",r),Un.typeOf.object("result",n),n.red=zn.lerp(e.red,t.red,r),n.green=zn.lerp(e.green,t.green,r),n.blue=zn.lerp(e.blue,t.blue,r),n.alpha=zn.lerp(e.alpha,t.alpha,r),n},hA.multiplyByScalar=function(e,t,r){return Un.typeOf.object("color",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.red=e.red*t,r.green=e.green*t,r.blue=e.blue*t,r.alpha=e.alpha*t,r},hA.divideByScalar=function(e,t,r){return Un.typeOf.object("color",e),Un.typeOf.number("scalar",t),Un.typeOf.object("result",r),r.red=e.red/t,r.green=e.green/t,r.blue=e.blue/t,r.alpha=e.alpha/t,r},hA.ALICEBLUE=Object.freeze(hA.fromCssColorString("#F0F8FF")),hA.ANTIQUEWHITE=Object.freeze(hA.fromCssColorString("#FAEBD7")),hA.AQUA=Object.freeze(hA.fromCssColorString("#00FFFF")),hA.AQUAMARINE=Object.freeze(hA.fromCssColorString("#7FFFD4")),hA.AZURE=Object.freeze(hA.fromCssColorString("#F0FFFF")),hA.BEIGE=Object.freeze(hA.fromCssColorString("#F5F5DC")),hA.BISQUE=Object.freeze(hA.fromCssColorString("#FFE4C4")),hA.BLACK=Object.freeze(hA.fromCssColorString("#000000")),hA.BLANCHEDALMOND=Object.freeze(hA.fromCssColorString("#FFEBCD")),hA.BLUE=Object.freeze(hA.fromCssColorString("#0000FF")),hA.BLUEVIOLET=Object.freeze(hA.fromCssColorString("#8A2BE2")),hA.BROWN=Object.freeze(hA.fromCssColorString("#A52A2A")),hA.BURLYWOOD=Object.freeze(hA.fromCssColorString("#DEB887")),hA.CADETBLUE=Object.freeze(hA.fromCssColorString("#5F9EA0")),hA.CHARTREUSE=Object.freeze(hA.fromCssColorString("#7FFF00")),hA.CHOCOLATE=Object.freeze(hA.fromCssColorString("#D2691E")),hA.CORAL=Object.freeze(hA.fromCssColorString("#FF7F50")),hA.CORNFLOWERBLUE=Object.freeze(hA.fromCssColorString("#6495ED")),hA.CORNSILK=Object.freeze(hA.fromCssColorString("#FFF8DC")),hA.CRIMSON=Object.freeze(hA.fromCssColorString("#DC143C")),hA.CYAN=Object.freeze(hA.fromCssColorString("#00FFFF")),hA.DARKBLUE=Object.freeze(hA.fromCssColorString("#00008B")),hA.DARKCYAN=Object.freeze(hA.fromCssColorString("#008B8B")),hA.DARKGOLDENROD=Object.freeze(hA.fromCssColorString("#B8860B")),hA.DARKGRAY=Object.freeze(hA.fromCssColorString("#A9A9A9")),hA.DARKGREEN=Object.freeze(hA.fromCssColorString("#006400")),hA.DARKGREY=hA.DARKGRAY,hA.DARKKHAKI=Object.freeze(hA.fromCssColorString("#BDB76B")),hA.DARKMAGENTA=Object.freeze(hA.fromCssColorString("#8B008B")),hA.DARKOLIVEGREEN=Object.freeze(hA.fromCssColorString("#556B2F")),hA.DARKORANGE=Object.freeze(hA.fromCssColorString("#FF8C00")),hA.DARKORCHID=Object.freeze(hA.fromCssColorString("#9932CC")),hA.DARKRED=Object.freeze(hA.fromCssColorString("#8B0000")),hA.DARKSALMON=Object.freeze(hA.fromCssColorString("#E9967A")),hA.DARKSEAGREEN=Object.freeze(hA.fromCssColorString("#8FBC8F")),hA.DARKSLATEBLUE=Object.freeze(hA.fromCssColorString("#483D8B")),hA.DARKSLATEGRAY=Object.freeze(hA.fromCssColorString("#2F4F4F")),hA.DARKSLATEGREY=hA.DARKSLATEGRAY,hA.DARKTURQUOISE=Object.freeze(hA.fromCssColorString("#00CED1")),hA.DARKVIOLET=Object.freeze(hA.fromCssColorString("#9400D3")),hA.DEEPPINK=Object.freeze(hA.fromCssColorString("#FF1493")),hA.DEEPSKYBLUE=Object.freeze(hA.fromCssColorString("#00BFFF")),hA.DIMGRAY=Object.freeze(hA.fromCssColorString("#696969")),hA.DIMGREY=hA.DIMGRAY,hA.DODGERBLUE=Object.freeze(hA.fromCssColorString("#1E90FF")),hA.FIREBRICK=Object.freeze(hA.fromCssColorString("#B22222")),hA.FLORALWHITE=Object.freeze(hA.fromCssColorString("#FFFAF0")),hA.FORESTGREEN=Object.freeze(hA.fromCssColorString("#228B22")),hA.FUCHSIA=Object.freeze(hA.fromCssColorString("#FF00FF")),hA.GAINSBORO=Object.freeze(hA.fromCssColorString("#DCDCDC")),hA.GHOSTWHITE=Object.freeze(hA.fromCssColorString("#F8F8FF")),hA.GOLD=Object.freeze(hA.fromCssColorString("#FFD700")),hA.GOLDENROD=Object.freeze(hA.fromCssColorString("#DAA520")),hA.GRAY=Object.freeze(hA.fromCssColorString("#808080")),hA.GREEN=Object.freeze(hA.fromCssColorString("#008000")),hA.GREENYELLOW=Object.freeze(hA.fromCssColorString("#ADFF2F")),hA.GREY=hA.GRAY,hA.HONEYDEW=Object.freeze(hA.fromCssColorString("#F0FFF0")),hA.HOTPINK=Object.freeze(hA.fromCssColorString("#FF69B4")),hA.INDIANRED=Object.freeze(hA.fromCssColorString("#CD5C5C")),hA.INDIGO=Object.freeze(hA.fromCssColorString("#4B0082")),hA.IVORY=Object.freeze(hA.fromCssColorString("#FFFFF0")),hA.KHAKI=Object.freeze(hA.fromCssColorString("#F0E68C")),hA.LAVENDER=Object.freeze(hA.fromCssColorString("#E6E6FA")),hA.LAVENDAR_BLUSH=Object.freeze(hA.fromCssColorString("#FFF0F5")),hA.LAWNGREEN=Object.freeze(hA.fromCssColorString("#7CFC00")),hA.LEMONCHIFFON=Object.freeze(hA.fromCssColorString("#FFFACD")),hA.LIGHTBLUE=Object.freeze(hA.fromCssColorString("#ADD8E6")),hA.LIGHTCORAL=Object.freeze(hA.fromCssColorString("#F08080")),hA.LIGHTCYAN=Object.freeze(hA.fromCssColorString("#E0FFFF")),hA.LIGHTGOLDENRODYELLOW=Object.freeze(hA.fromCssColorString("#FAFAD2")),hA.LIGHTGRAY=Object.freeze(hA.fromCssColorString("#D3D3D3")),hA.LIGHTGREEN=Object.freeze(hA.fromCssColorString("#90EE90")),hA.LIGHTGREY=hA.LIGHTGRAY,hA.LIGHTPINK=Object.freeze(hA.fromCssColorString("#FFB6C1")),hA.LIGHTSEAGREEN=Object.freeze(hA.fromCssColorString("#20B2AA")),hA.LIGHTSKYBLUE=Object.freeze(hA.fromCssColorString("#87CEFA")),hA.LIGHTSLATEGRAY=Object.freeze(hA.fromCssColorString("#778899")),hA.LIGHTSLATEGREY=hA.LIGHTSLATEGRAY,hA.LIGHTSTEELBLUE=Object.freeze(hA.fromCssColorString("#B0C4DE")),hA.LIGHTYELLOW=Object.freeze(hA.fromCssColorString("#FFFFE0")),hA.LIME=Object.freeze(hA.fromCssColorString("#00FF00")),hA.LIMEGREEN=Object.freeze(hA.fromCssColorString("#32CD32")),hA.LINEN=Object.freeze(hA.fromCssColorString("#FAF0E6")),hA.MAGENTA=Object.freeze(hA.fromCssColorString("#FF00FF")),hA.MAROON=Object.freeze(hA.fromCssColorString("#800000")),hA.MEDIUMAQUAMARINE=Object.freeze(hA.fromCssColorString("#66CDAA")),hA.MEDIUMBLUE=Object.freeze(hA.fromCssColorString("#0000CD")),hA.MEDIUMORCHID=Object.freeze(hA.fromCssColorString("#BA55D3")),hA.MEDIUMPURPLE=Object.freeze(hA.fromCssColorString("#9370DB")),hA.MEDIUMSEAGREEN=Object.freeze(hA.fromCssColorString("#3CB371")),hA.MEDIUMSLATEBLUE=Object.freeze(hA.fromCssColorString("#7B68EE")),hA.MEDIUMSPRINGGREEN=Object.freeze(hA.fromCssColorString("#00FA9A")),hA.MEDIUMTURQUOISE=Object.freeze(hA.fromCssColorString("#48D1CC")),hA.MEDIUMVIOLETRED=Object.freeze(hA.fromCssColorString("#C71585")),hA.MIDNIGHTBLUE=Object.freeze(hA.fromCssColorString("#191970")),hA.MINTCREAM=Object.freeze(hA.fromCssColorString("#F5FFFA")),hA.MISTYROSE=Object.freeze(hA.fromCssColorString("#FFE4E1")),hA.MOCCASIN=Object.freeze(hA.fromCssColorString("#FFE4B5")),hA.NAVAJOWHITE=Object.freeze(hA.fromCssColorString("#FFDEAD")),hA.NAVY=Object.freeze(hA.fromCssColorString("#000080")),hA.OLDLACE=Object.freeze(hA.fromCssColorString("#FDF5E6")),hA.OLIVE=Object.freeze(hA.fromCssColorString("#808000")),hA.OLIVEDRAB=Object.freeze(hA.fromCssColorString("#6B8E23")),hA.ORANGE=Object.freeze(hA.fromCssColorString("#FFA500")),hA.ORANGERED=Object.freeze(hA.fromCssColorString("#FF4500")),hA.ORCHID=Object.freeze(hA.fromCssColorString("#DA70D6")),hA.PALEGOLDENROD=Object.freeze(hA.fromCssColorString("#EEE8AA")),hA.PALEGREEN=Object.freeze(hA.fromCssColorString("#98FB98")),hA.PALETURQUOISE=Object.freeze(hA.fromCssColorString("#AFEEEE")),hA.PALEVIOLETRED=Object.freeze(hA.fromCssColorString("#DB7093")),hA.PAPAYAWHIP=Object.freeze(hA.fromCssColorString("#FFEFD5")),hA.PEACHPUFF=Object.freeze(hA.fromCssColorString("#FFDAB9")),hA.PERU=Object.freeze(hA.fromCssColorString("#CD853F")),hA.PINK=Object.freeze(hA.fromCssColorString("#FFC0CB")),hA.PLUM=Object.freeze(hA.fromCssColorString("#DDA0DD")),hA.POWDERBLUE=Object.freeze(hA.fromCssColorString("#B0E0E6")),hA.PURPLE=Object.freeze(hA.fromCssColorString("#800080")),hA.RED=Object.freeze(hA.fromCssColorString("#FF0000")),hA.ROSYBROWN=Object.freeze(hA.fromCssColorString("#BC8F8F")),hA.ROYALBLUE=Object.freeze(hA.fromCssColorString("#4169E1")),hA.SADDLEBROWN=Object.freeze(hA.fromCssColorString("#8B4513")),hA.SALMON=Object.freeze(hA.fromCssColorString("#FA8072")),hA.SANDYBROWN=Object.freeze(hA.fromCssColorString("#F4A460")),hA.SEAGREEN=Object.freeze(hA.fromCssColorString("#2E8B57")),hA.SEASHELL=Object.freeze(hA.fromCssColorString("#FFF5EE")),hA.SIENNA=Object.freeze(hA.fromCssColorString("#A0522D")),hA.SILVER=Object.freeze(hA.fromCssColorString("#C0C0C0")),hA.SKYBLUE=Object.freeze(hA.fromCssColorString("#87CEEB")),hA.SLATEBLUE=Object.freeze(hA.fromCssColorString("#6A5ACD")),hA.SLATEGRAY=Object.freeze(hA.fromCssColorString("#708090")),hA.SLATEGREY=hA.SLATEGRAY,hA.SNOW=Object.freeze(hA.fromCssColorString("#FFFAFA")),hA.SPRINGGREEN=Object.freeze(hA.fromCssColorString("#00FF7F")),hA.STEELBLUE=Object.freeze(hA.fromCssColorString("#4682B4")),hA.TAN=Object.freeze(hA.fromCssColorString("#D2B48C")),hA.TEAL=Object.freeze(hA.fromCssColorString("#008080")),hA.THISTLE=Object.freeze(hA.fromCssColorString("#D8BFD8")),hA.TOMATO=Object.freeze(hA.fromCssColorString("#FF6347")),hA.TURQUOISE=Object.freeze(hA.fromCssColorString("#40E0D0")),hA.VIOLET=Object.freeze(hA.fromCssColorString("#EE82EE")),hA.WHEAT=Object.freeze(hA.fromCssColorString("#F5DEB3")),hA.WHITE=Object.freeze(hA.fromCssColorString("#FFFFFF")),hA.WHITESMOKE=Object.freeze(hA.fromCssColorString("#F5F5F5")),hA.YELLOW=Object.freeze(hA.fromCssColorString("#FFFF00")),hA.YELLOWGREEN=Object.freeze(hA.fromCssColorString("#9ACD32")),hA.TRANSPARENT=Object.freeze(new hA(0,0,0,0));var gA={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:10,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_highpFloatSupported:!1,_highpIntSupported:!1,_uniformBufferOffsetAlignment:256,_maxUniformBufferBinding:36,_maxArrayTextureLayers:256,_disjointTimerQuery:!1};function _A(e){if("object"!=typeof e||null===e)return e;for(var t,r=Object.keys(e),n=0;n<r.length;n++)t=r[n],e.hasOwnProperty(t)&&"_applyFunctions"!==t&&(e[t]=_A(e[t]));return Object.freeze(e)}Object.defineProperties(gA,{maximumCombinedTextureImageUnits:{get:function(){return gA._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return gA._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return gA._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return gA._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return gA._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return gA._maximumTextureSize}},maximumVaryingVectors:{get:function(){return gA._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return gA._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return gA._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return gA._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return gA._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return gA._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return gA._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return gA._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return gA._maximumViewportWidth}},maximumViewportHeight:{get:function(){return gA._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return gA._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return gA._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return gA._maximumColorAttachments}},highpFloatSupported:{get:function(){return gA._highpFloatSupported}},highpIntSupported:{get:function(){return gA._highpIntSupported}},uniformBufferOffsetAlignment:{get:function(){return gA._uniformBufferOffsetAlignment}},maxUniformBufferBinding:{get:function(){return gA._maxUniformBufferBinding}},maxArrayTextureLayers:{get:function(){return gA._maxArrayTextureLayers}},disjointTimerQuery:{get:function(){return gA._disjointTimerQuery}}});var mA,yA=(mA=!0,function(e,t){var r=mA?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return mA=!1,r}),EA=yA(void 0,(function(){return EA.toString().search("(((.+)+)+)+$").toString().constructor(EA).search("(((.+)+)+)+$")}));function xA(){this.reset()}EA(),xA.prototype.reset=function(){this.enabled=!1,this.mask=255,this.funcRef=1,this.funcMask=255,this.frontFunc=xA.ALWAYS,this.backFunc=xA.ALWAYS,this.frontOpStencilFail=xA.KEEP,this.backOpStencilFail=xA.KEEP,this.frontOpDepthFail=xA.KEEP,this.backOpDepthFail=xA.KEEP,this.frontOpStencilDepthPass=xA.REPLACE,this.backOpStencilDepthPass=xA.REPLACE},Object.defineProperty(xA.prototype,"frontStencilFunc",{get:function(){return this.frontFunc},set:function(e){this.frontFunc=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"backStencilFunc",{get:function(){return this.backFunc},set:function(e){this.backFunc=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"stencilFuncRef",{get:function(){return this.funcRef},set:function(e){this.funcRef=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"stencilFuncMask",{get:function(){return this.funcMask},set:function(e){this.funcMask=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"frontStencilOpStencilFail",{get:function(){return this.frontOpStencilFail},set:function(e){this.frontOpStencilFail=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"backStencilOpStencilFail",{get:function(){return this.backOpStencilFail},set:function(e){this.backOpStencilFail=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"frontStencilOpDepthFail",{get:function(){return this.frontOpDepthFail},set:function(e){this.frontOpDepthFail=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"backStencilOpDepthFail",{get:function(){return this.backOpDepthFail},set:function(e){this.backOpDepthFail=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"frontStencilOpStencilDepthPass",{get:function(){return this.frontOpStencilDepthPass},set:function(e){this.frontOpStencilDepthPass=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"backStencilOpStencilDepthPass",{get:function(){return this.backOpStencilDepthPass},set:function(e){this.backOpStencilDepthPass=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"stencilMask",{get:function(){return this.mask},set:function(e){this.mask=e},enumerable:!1,configurable:!0}),Object.defineProperty(xA.prototype,"stencilTest",{get:function(){return this.enabled},set:function(e){this.enabled=e},enumerable:!1,configurable:!0}),xA.ALWAYS=Qd.ALWAYS,xA.KEEP=Qd.KEEP,xA.REPLACE=Qd.REPLACE,xA.FRONT=Qd.FRONT,xA.BACK=Qd.BACK;var CA={UNSIGNED_BYTE:Dh.UNSIGNED_BYTE,UNSIGNED_SHORT:Dh.UNSIGNED_SHORT,UNSIGNED_INT:Dh.UNSIGNED_INT,FLOAT:Dh.FLOAT,HALF_FLOAT:Dh.HALF_FLOAT_OES,UNSIGNED_INT_24_8:Dh.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:Dh.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:Dh.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:Dh.UNSIGNED_SHORT_5_6_5,isPacked:function(e){return e===CA.UNSIGNED_INT_24_8||e===CA.UNSIGNED_SHORT_4_4_4_4||e===CA.UNSIGNED_SHORT_5_5_5_1||e===CA.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(e){switch(e){case CA.UNSIGNED_BYTE:return 1;case CA.UNSIGNED_SHORT:case CA.UNSIGNED_SHORT_4_4_4_4:case CA.UNSIGNED_SHORT_5_5_5_1:case CA.UNSIGNED_SHORT_5_6_5:case Dh.HALF_FLOAT:case Dh.HALF_FLOAT_OES:return 2;case CA.UNSIGNED_INT:case CA.FLOAT:case CA.UNSIGNED_INT_24_8:return 4}},validate:function(e){return e===CA.UNSIGNED_BYTE||e===CA.UNSIGNED_SHORT||e===CA.UNSIGNED_INT||e===CA.FLOAT||e===Dh.HALF_FLOAT||e===Dh.HALF_FLOAT_OES||e===CA.UNSIGNED_INT_24_8||e===CA.UNSIGNED_SHORT_4_4_4_4||e===CA.UNSIGNED_SHORT_5_5_5_1||e===CA.UNSIGNED_SHORT_5_6_5},toWebGLConstant:function(e,t){switch(e){case CA.UNSIGNED_BYTE:return Dh.UNSIGNED_BYTE;case CA.UNSIGNED_SHORT:return Dh.UNSIGNED_SHORT;case CA.UNSIGNED_INT:return Dh.UNSIGNED_INT;case CA.FLOAT:return Dh.FLOAT;case CA.HALF_FLOAT:return t.webgl2?Dh.HALF_FLOAT:Dh.HALF_FLOAT_OES;case CA.UNSIGNED_INT_24_8:return Dh.UNSIGNED_INT_24_8;case CA.UNSIGNED_SHORT_4_4_4_4:return Dh.UNSIGNED_SHORT_4_4_4_4;case CA.UNSIGNED_SHORT_5_5_5_1:return Dh.UNSIGNED_SHORT_5_5_5_1;case CA.UNSIGNED_SHORT_5_6_5:return CA.UNSIGNED_SHORT_5_6_5}}},bA={DEPTH_COMPONENT:Dh.DEPTH_COMPONENT,DEPTH_COMPONENT16:Dh.DEPTH_COMPONENT16,DEPTH_COMPONENT32F:Dh.DEPTH_COMPONENT32F,DEPTH_STENCIL:Dh.DEPTH_STENCIL,ALPHA:Dh.ALPHA,RGB:Dh.RGB,RGBA:Dh.RGBA,LUMINANCE:Dh.LUMINANCE,LUMINANCE_ALPHA:Dh.LUMINANCE_ALPHA,RGB_DXT1:Dh.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:Dh.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:Dh.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:Dh.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:Dh.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:Dh.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:Dh.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:Dh.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGBA_ASTC:Dh.COMPRESSED_RGBA_ASTC_4x4_WEBGL,RGB_ETC1:Dh.COMPRESSED_RGB_ETC1_WEBGL,RED_INTEGER:Dh.RED_INTEGER,RED:Dh.RED,RGB8_ETC2:Dh.COMPRESSED_RGB8_ETC2,RGBA8_ETC2_EAC:Dh.COMPRESSED_RGBA8_ETC2_EAC,RGBA_BC7:Dh.COMPRESSED_RGBA_BPTC_UNORM,componentsLength:function(e){switch(e){case bA.RGB:return 3;case bA.RGBA:return 4;case bA.LUMINANCE_ALPHA:return 2;case bA.ALPHA:case bA.LUMINANCE:case bA.RED:case bA.RED_INTEGER:default:return 1}},validate:function(e){return e===bA.DEPTH_COMPONENT||e===bA.DEPTH_COMPONENT16||e===bA.DEPTH_COMPONENT32F||e===bA.DEPTH_STENCIL||e===bA.ALPHA||e===bA.RED||e===bA.RED_INTEGER||e===bA.RGB||e===bA.RGBA||e===bA.LUMINANCE||e===bA.LUMINANCE_ALPHA||e===bA.RGB_DXT1||e===bA.RGBA_DXT1||e===bA.RGBA_DXT3||e===bA.RGBA_DXT5||e===bA.RGB_PVRTC_4BPPV1||e===bA.RGB_PVRTC_2BPPV1||e===bA.RGBA_PVRTC_4BPPV1||e===bA.RGBA_PVRTC_2BPPV1||e===bA.RGBA_ASTC||e===bA.RGB_ETC1||e===bA.RGB8_ETC2||e===bA.RGBA8_ETC2_EAC||e===bA.RGBA_BC7},isColorFormat:function(e){return e===bA.ALPHA||e===bA.RED||e===bA.RED_INTEGER||e===bA.RGB||e===bA.RGBA||e===bA.LUMINANCE||e===bA.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===bA.DEPTH_COMPONENT||e===bA.DEPTH_COMPONENT16||e===bA.DEPTH_COMPONENT32F||e===bA.DEPTH_STENCIL},isCompressedFormat:function(e){return e===bA.RGB_DXT1||e===bA.RGBA_DXT1||e===bA.RGBA_DXT3||e===bA.RGBA_DXT5||e===bA.RGB_PVRTC_4BPPV1||e===bA.RGB_PVRTC_2BPPV1||e===bA.RGBA_PVRTC_4BPPV1||e===bA.RGBA_PVRTC_2BPPV1||e===bA.RGBA_ASTC||e===bA.RGB_ETC1||e===bA.RGB8_ETC2||e===bA.RGBA8_ETC2_EAC||e===bA.RGBA_BC7},isDXTFormat:function(e){return e===bA.RGB_DXT1||e===bA.RGBA_DXT1||e===bA.RGBA_DXT3||e===bA.RGBA_DXT5},isPVRTCFormat:function(e){return e===bA.RGB_PVRTC_4BPPV1||e===bA.RGB_PVRTC_2BPPV1||e===bA.RGBA_PVRTC_4BPPV1||e===bA.RGBA_PVRTC_2BPPV1},isETC1Format:function(e){return e===bA.RGB_ETC1},compressedTextureSizeInBytes:function(e,t,r,n){var i=Nn(n)?n:1;switch(e){case bA.RGB_DXT1:case bA.RGBA_DXT1:case bA.RGB_ETC1:case bA.RGB8_ETC2:return Math.floor((t+3)/4)*Math.floor((r+3)/4)*8*i;case bA.RGBA_DXT3:case bA.RGBA_DXT5:case bA.RGBA_ASTC:case bA.RGBA8_ETC2_EAC:return Math.floor((t+3)/4)*Math.floor((r+3)/4)*16*i;case bA.RGB_PVRTC_4BPPV1:case bA.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(r,8)*4+7)/8)*i;case bA.RGB_PVRTC_2BPPV1:case bA.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(r,8)*2+7)/8)*i;case bA.RGBA_BC7:return Math.ceil(t/4)*Math.ceil(r/4)*16;default:return 0}},textureSizeInBytes:function(e,t,r,n,i){var o=Nn(i)?i:1,s=bA.componentsLength(e);return CA.isPacked(t)&&(s=1),s*CA.sizeInBytes(t)*r*n*o},alignmentInBytes:function(e,t,r){var n=bA.textureSizeInBytes(e,t,r,1)%4;return 0===n?4:2===n?2:1},createTypedArray:function(e,t,r,n){var i=CA.sizeInBytes(t);return new(i===Uint8Array.BYTES_PER_ELEMENT?Uint8Array:i===Uint16Array.BYTES_PER_ELEMENT?Uint16Array:i===Float32Array.BYTES_PER_ELEMENT&&t===CA.FLOAT?Float32Array:Uint32Array)(bA.componentsLength(e)*r*n)},flipY:function(e,t,r,n,i){if(1===i)return e;for(var o=bA.createTypedArray(t,r,n,i),s=bA.componentsLength(t),a=n*s,u=0;u<i;++u)for(var c=u*n*s,l=(i-u-1)*n*s,h=0;h<a;++h)o[l+h]=e[c+h];return o},RGBToRGBA:function(e,t,r,n){for(var i=bA.createTypedArray(bA.RGBA,t,r,n),o=e.length/3,s=0;s<o;s++)i[4*s]=e[3*s],i[4*s+1]=e[3*s+1],i[4*s+2]=e[3*s+2];return i},LUMINANCE_ALPHAToRGBA:function(e,t,r,n){for(var i=bA.createTypedArray(bA.RGBA,t,r,n),o=e.length/2,s=0;s<o;s++)i[4*s]=e[2*s],i[4*s+1]=0,i[4*s+2]=0,i[4*s+3]=e[2*s+1];return i},toInternalFormat:function(e,t,r){if(!r.webgl2)return e;if(e===bA.DEPTH_STENCIL)return Dh.DEPTH24_STENCIL8;if(e===bA.DEPTH_COMPONENT){if(t===CA.UNSIGNED_SHORT)return Dh.DEPTH_COMPONENT16;if(t===CA.UNSIGNED_INT)return Dh.DEPTH_COMPONENT24;if(t===CA.FLOAT)return Dh.DEPTH_COMPONENT32F}if(e===bA.DEPTH_COMPONENT16)return Dh.DEPTH_COMPONENT16;if(e===bA.DEPTH_COMPONENT32F)return Dh.DEPTH_COMPONENT32F;if(t===CA.UNSIGNED_BYTE)switch(e){case bA.RGBA:return Dh.RGBA8;case bA.RGB:return Dh.RGB8;case bA.RED:return Dh.R8}if(t===CA.FLOAT)switch(e){case bA.RGBA:return Dh.RGBA32F;case bA.RGB:return Dh.RGB32F;case bA.RG:return Dh.RG32F;case bA.RED:return Dh.R32F}if(t===CA.HALF_FLOAT)switch(e){case bA.RGBA:return Dh.RGBA16F;case bA.RGB:return Dh.RGB16F;case bA.RG:return Dh.RG16F;case bA.RED:return Dh.R16F}return e}},IA=Object.freeze(bA),vA={CLAMP_TO_EDGE:Dh.CLAMP_TO_EDGE,REPEAT:Dh.REPEAT,MIRRORED_REPEAT:Dh.MIRRORED_REPEAT,validate:function(e){return e===vA.CLAMP_TO_EDGE||e===vA.REPEAT||e===vA.MIRRORED_REPEAT}},TA=Object.freeze(vA),RA={NEAREST:Dh.NEAREST,LINEAR:Dh.LINEAR,validate:function(e){return e===RA.NEAREST||e===RA.LINEAR}},SA=Object.freeze(RA),MA={NEAREST:Dh.NEAREST,LINEAR:Dh.LINEAR,NEAREST_MIPMAP_NEAREST:Dh.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:Dh.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:Dh.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:Dh.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===MA.NEAREST||e===MA.LINEAR||e===MA.NEAREST_MIPMAP_NEAREST||e===MA.LINEAR_MIPMAP_NEAREST||e===MA.NEAREST_MIPMAP_LINEAR||e===MA.LINEAR_MIPMAP_LINEAR}},wA=Object.freeze(MA);function BA(){}function OA(){}BA.toPixelFormat=function(e){switch(e){case IA.RED:return Qd.TEXTUREFORMAT_RED;case IA.RED_INTEGER:return Qd.TEXTUREFORMAT_RED_INTEGER;case IA.RGB:return Qd.TEXTUREFORMAT_RGB;case IA.RGBA:return Qd.TEXTUREFORMAT_RGBA;case IA.LUMINANCE_ALPHA:return Qd.TEXTUREFORMAT_LUMINANCE_ALPHA;case IA.ALPHA:return Qd.TEXTUREFORMAT_ALPHA;case IA.LUMINANCE:return Qd.TEXTUREFORMAT_LUMINANCE;case IA.DEPTH_COMPONENT16:return Qd.TEXTUREFORMAT_DEPTH16;case IA.DEPTH_COMPONENT:return Qd.TEXTUREFORMAT_DEPTH24;case IA.DEPTH_COMPONENT32F:return Qd.TEXTUREFORMAT_DEPTH32_FLOAT;case IA.DEPTH_STENCIL:return Qd.TEXTUREFORMAT_DEPTH24_STENCIL8;case IA.RGBA_DXT1:return Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1;case IA.RGBA_DXT3:return Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3;case IA.RGBA_DXT5:return Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5;case IA.RGB_DXT1:return Qd.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1;case IA.RGBA_PVRTC_2BPPV1:case IA.RGBA_PVRTC_4BPPV1:case IA.RGB_ETC1:case IA.RGB_PVRTC_2BPPV1:case IA.RGB_PVRTC_4BPPV1:default:return 1}},BA.toPixelType=function(e){switch(e){case CA.FLOAT:return Qd.TEXTURETYPE_FLOAT;case CA.HALF_FLOAT:return Qd.TEXTURETYPE_HALF_FLOAT;case CA.UNSIGNED_BYTE:return Qd.TEXTURETYPE_UNSIGNED_BYTE;case CA.UNSIGNED_INT:return Qd.TEXTURETYPE_UNSIGNED_INT;case CA.UNSIGNED_INT_24_8:return Qd.TEXTURETYPE_UNSIGNED_INT_24_8;case CA.UNSIGNED_SHORT:return Qd.TEXTURETYPE_UNSIGNED_SHORT;case CA.UNSIGNED_SHORT_4_4_4_4:return Qd.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4;case CA.UNSIGNED_SHORT_5_5_5_1:return Qd.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1;case CA.UNSIGNED_SHORT_5_6_5:return Qd.TEXTURETYPE_UNSIGNED_SHORT_5_6_5;default:return Qd.TEXTURETYPE_UNDEFINED}},BA.toSamplerMode=function(e,t){var r=e==CA.FLOAT||e==CA.HALF_FLOAT;if(t.magnificationFilter==SA.NEAREST){if(t.minificationFilter==wA.NEAREST)return Qd.TEXTURE_NEAREST_SAMPLINGMODE;if(t.minificationFilter==wA.LINEAR)return Qd.TEXTURE_NEAREST_SAMPLINGMODE;if(t.minificationFilter==wA.NEAREST_MIPMAP_NEAREST)return Qd.TEXTURE_NEAREST_SAMPLINGMODE;if(t.minificationFilter==wA.LINEAR_MIPMAP_NEAREST)return Qd.TEXTURE_NEAREST_SAMPLINGMODE}else{if(t.magnificationFilter!=SA.LINEAR)return console.log("EnumConvertor.toSamplerMode unsupported type"),Qd.TEXTURE_NEAREST_SAMPLINGMODE;if(t.minificationFilter==wA.NEAREST)return r?Qd.TEXTURE_NEAREST_SAMPLINGMODE:Qd.TEXTURE_BILINEAR_SAMPLINGMODE;if(t.minificationFilter==wA.LINEAR)return r?Qd.TEXTURE_NEAREST_SAMPLINGMODE:Qd.TEXTURE_BILINEAR_SAMPLINGMODE;if(t.minificationFilter==wA.NEAREST_MIPMAP_NEAREST)return r?Qd.TEXTURE_NEAREST_SAMPLINGMODE:Qd.TEXTURE_BILINEAR_SAMPLINGMODE;if(t.minificationFilter==wA.LINEAR_MIPMAP_NEAREST)return r?Qd.TEXTURE_NEAREST_SAMPLINGMODE:Qd.TEXTURE_BILINEAR_SAMPLINGMODE;if(t.minificationFilter==wA.LINEAR_MIPMAP_LINEAR)return r?Qd.TEXTURE_NEAREST_SAMPLINGMODE:Qd.TEXTURE_LINEAR_LINEAR_MIPLINEAR}},BA.toAddressMode=function(e){switch(e){case TA.CLAMP_TO_EDGE:return Qd.TEXTURE_CLAMP_ADDRESSMODE;case TA.REPEAT:return Qd.TEXTURE_WRAP_ADDRESSMODE;case TA.MIRRORED_REPEAT:return Qd.TEXTURE_MIRROR_ADDRESSMODE;default:return Qd.TEXTURE_CLAMP_ADDRESSMODE}},BA.toFillMode=function(e){switch(e){case Yh.TRIANGLES:return Qd.MATERIAL_TriangleFillMode;case Yh.POINTS:return Qd.MATERIAL_PointFillMode;case Yh.LINES:return Qd.MATERIAL_WireFrameFillMode;case Yh.LINE_STRIP:return Qd.MATERIAL_LineStripDrawMode;default:return console.log("EnumConvertor.toFillMode unsupported type"),Qd.MATERIAL_TriangleFillMode}},BA.toCullFace=function(e){switch(e){case Dh.FRONT:return 2;case Dh.BACK:default:return 1}},BA.toFrontFace=function(e,t){switch(e){case Dh.CCW:return t?2:1;case Dh.CW:return t?1:2;default:return 1}},BA.toVertexBufferDataType=function(e){switch(e){case Ph.BYTE:return Wd.BYTE;case Ph.UNSIGNED_BYTE:return Wd.UNSIGNED_BYTE;case Ph.SHORT:return Wd.SHORT;case Ph.UNSIGNED_SHORT:return Wd.UNSIGNED_SHORT;case Ph.INT:return Wd.INT;case Ph.UNSIGNED_INT:return Wd.UNSIGNED_INT;case Ph.FLOAT:return Wd.FLOAT;default:throw console.log("EnumConvertor.toVertexBufferDataType unsupported type"),new Ln("componentDatatype is not a valid value.")}},OA.applyFrontFace=function(e,t,r){e._depthCullingState.frontFace=BA.toFrontFace(t.frontFace,r)},OA.applyCull=function(e,t){var r=t.cull;r.enabled?(e._depthCullingState.cull=!0,e._depthCullingState.cullFace=BA.toCullFace(r.face)):(e._depthCullingState.cull=!1,e._depthCullingState.cullFace=0)},OA.applyLineWidth=function(e,t){},OA.applyPolygonOffset=function(e,t){var r=t.polygonOffset;r.enabled?(e.setZOffset(r.factor),e.setZOffsetUnits(r.units)):(e.setZOffset(0),e.setZOffsetUnits(0))},OA.applyScissorTest=function(e,t,r){var n=t.scissorTest;if(Nn(r.scissorTest)?r.scissorTest.enabled:n.enabled){var i=Nn(r.scissorTest)?r.scissorTest.rectangle:n.rectangle;e.enableScissor(i.x,i.y,i.width,i.height)}else e.disableScissor()},OA.applyDepthRange=function(e,t){},OA.applyDepthTest=function(e,t){var r=t.depthTest,n=r.enabled;e.setDepthBuffer(n),n&&e.setDepthFunction(r.func)},OA.applyColorMask=function(e,t){var r=t.colorMask;e.setColorWrite(r.red)},OA.applyDepthMask=function(e,t){e.setDepthWrite(t.depthMask)},OA.applyStencilMask=function(e,t){var r=t.stencilMask;r<0&&(r=255),e.setStencilMask(r)},OA.applyBlendingColor=function(e,t){e.setAlphaConstants(t.red,t.green,t.blue,t.alpha)},OA.applyBlending=function(e,t,r){var n=t.blending;(Nn(r.blendingEnabled)?r.blendingEnabled:n.enabled)?(OA.applyBlendingColor(e,n.color),e._alphaState.setAlphaEquationParameters(n.equationRgb,n.equationAlpha),e._alphaState.setAlphaBlendFunctionParameters(n.functionSourceRgb,n.functionDestinationRgb,n.functionSourceAlpha,n.functionDestinationAlpha),e._alphaState.alphaBlend=!0):e.setAlphaMode(Qd.ALPHA_DISABLE)},OA.applyStencilTest=function(e,t){var r=t.stencilTest,n=r.enabled;if(e.setStencilBuffer(n),n){var i=r.frontFunction,o=r.backFunction,s=r.reference,a=r.mask;e.setStencilFunction(xA.FRONT,i);var u=r.frontOperation;e.setStencilOperationFail(xA.FRONT,u.fail),e.setStencilOperationDepthFail(xA.FRONT,u.zFail),e.setStencilOperationPass(xA.FRONT,u.zPass),e.setStencilFunction(xA.BACK,o);var c=r.backOperation;e.setStencilOperationFail(xA.BACK,c.fail),e.setStencilOperationDepthFail(xA.BACK,c.zFail),e.setStencilOperationPass(xA.BACK,c.zPass),e.setStencilFunctionReference(s),e.setStencilFunctionMask(a)}},OA.applySampleCoverage=function(e,t){};var DA=new nA;function FA(){}function PA(e,t,r){r?e.enable(t):e.disable(t)}OA.applyViewport=function(e,t,r,n,i){var o=Qn(t.viewport,r.viewport);Nn(o)||((o=DA).width=r.context.drawingBufferWidth,o.height=r.context.drawingBufferHeight);var s=Qn(n,r.context.drawingBufferWidth),a=Qn(i,r.context.drawingBufferHeight);r.context.uniformState.viewport=o;var u={x:o.x/s,y:o.y/a,width:o.width/s,height:o.height/a};e.setViewport(u,n,i)},FA.applyFrontFace=function(e,t,r){e.frontFace(t.frontFace)},FA.applyCull=function(e,t){var r=t.cull,n=r.enabled;PA(e,e.CULL_FACE,n),n&&e.cullFace(r.face)},FA.applyLineWidth=function(e,t){e.lineWidth(t.lineWidth)},FA.applyPolygonOffset=function(e,t){var r=t.polygonOffset,n=r.enabled;PA(e,e.POLYGON_OFFSET_FILL,n),n&&e.polygonOffset(r.factor,r.units)},FA.applyScissorTest=function(e,t,r){var n=t.scissorTest,i=Nn(r.scissorTest)?r.scissorTest.enabled:n.enabled;if(PA(e,e.SCISSOR_TEST,i),i){var o=Nn(r.scissorTest)?r.scissorTest.rectangle:n.rectangle;e.scissor(o.x,o.y,o.width,o.height)}},FA.applyDepthRange=function(e,t){var r=t.depthRange;e.depthRange(r.near,r.far)},FA.applyDepthTest=function(e,t){var r=t.depthTest,n=r.enabled;PA(e,e.DEPTH_TEST,n),n&&e.depthFunc(r.func)},FA.applyColorMask=function(e,t){var r=t.colorMask;e.colorMask(r.red,r.green,r.blue,r.alpha)},FA.applyDepthMask=function(e,t){e.depthMask(t.depthMask)},FA.applyStencilMask=function(e,t){e.stencilMask(t.stencilMask)},FA.applyBlendingColor=function(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)},FA.applyBlending=function(e,t,r){var n=t.blending,i=Nn(r.blendingEnabled)?r.blendingEnabled:n.enabled;PA(e,e.BLEND,i),i&&(FA.applyBlendingColor(e,n.color),e.blendEquationSeparate(n.equationRgb,n.equationAlpha),e.blendFuncSeparate(n.functionSourceRgb,n.functionDestinationRgb,n.functionSourceAlpha,n.functionDestinationAlpha))},FA.applyStencilTest=function(e,t){var r=t.stencilTest,n=r.enabled;if(PA(e,e.STENCIL_TEST,n),n){var i=r.frontFunction,o=r.backFunction,s=r.reference,a=r.mask;e.stencilFunc(i,s,a),e.stencilFuncSeparate(e.BACK,o,s,a),e.stencilFuncSeparate(e.FRONT,i,s,a);var u=r.frontOperation,c=u.fail,l=u.zFail,h=u.zPass;e.stencilOpSeparate(e.FRONT,c,l,h);var p=r.backOperation,f=p.fail,d=p.zFail,A=p.zPass;e.stencilOpSeparate(e.BACK,f,d,A)}},FA.applySampleCoverage=function(e,t){var r=t.sampleCoverage,n=r.enabled;PA(e,e.SAMPLE_COVERAGE,n),n&&e.sampleCoverage(r.value,r.invert)};var NA=new nA;function LA(e){return e===Dh.FUNC_ADD||e===Dh.FUNC_SUBTRACT||e===Dh.FUNC_REVERSE_SUBTRACT||e===Dh.MIN||e===Dh.MAX}function UA(e){return e===Dh.ZERO||e===Dh.ONE||e===Dh.SRC_COLOR||e===Dh.ONE_MINUS_SRC_COLOR||e===Dh.DST_COLOR||e===Dh.ONE_MINUS_DST_COLOR||e===Dh.SRC_ALPHA||e===Dh.ONE_MINUS_SRC_ALPHA||e===Dh.DST_ALPHA||e===Dh.ONE_MINUS_DST_ALPHA||e===Dh.CONSTANT_COLOR||e===Dh.ONE_MINUS_CONSTANT_COLOR||e===Dh.CONSTANT_ALPHA||e===Dh.ONE_MINUS_CONSTANT_ALPHA||e===Dh.SRC_ALPHA_SATURATE}function GA(e){return e===Dh.NEVER||e===Dh.LESS||e===Dh.EQUAL||e===Dh.LEQUAL||e===Dh.GREATER||e===Dh.NOTEQUAL||e===Dh.GEQUAL||e===Dh.ALWAYS}function QA(e){return e===Dh.ZERO||e===Dh.KEEP||e===Dh.REPLACE||e===Dh.INCR||e===Dh.DECR||e===Dh.INVERT||e===Dh.INCR_WRAP||e===Dh.DECR_WRAP}function kA(e){var t,r,n=Qn(e,{}),i=Qn(n.cull,{}),o=Qn(n.polygonOffset,{}),s=Qn(n.scissorTest,{}),a=Qn(s.rectangle,{}),u=Qn(n.depthRange,{}),c=Qn(n.depthTest,{}),l=Qn(n.colorMask,{}),h=Qn(n.blending,{}),p=Qn(h.color,{}),f=Qn(n.stencilTest,{}),d=Qn(f.frontOperation,{}),A=Qn(f.backOperation,{}),g=Qn(n.sampleCoverage,{}),_=n.viewport;if(this.frontFace=Qn(n.frontFace,Wh.COUNTER_CLOCKWISE),this.cull={enabled:Qn(i.enabled,!1),face:Qn(i.face,Dh.BACK)},this.lineWidth=Qn(n.lineWidth,1),this.polygonOffset={enabled:Qn(o.enabled,!1),factor:Qn(o.factor,0),units:Qn(o.units,0)},this.scissorTest={enabled:Qn(s.enabled,!1),rectangle:nA.clone(a)},this.depthRange={near:Qn(u.near,0),far:Qn(u.far,1)},this.depthTest={enabled:Qn(c.enabled,!1),func:Qn(c.func,Dh.LESS)},this.colorMask={red:Qn(l.red,!0),green:Qn(l.green,!0),blue:Qn(l.blue,!0),alpha:Qn(l.alpha,!0)},this.depthMask=Qn(n.depthMask,!0),this.stencilMask=Qn(n.stencilMask,65535),this.blending={enabled:Qn(h.enabled,!1),color:new hA(Qn(p.red,0),Qn(p.green,0),Qn(p.blue,0),Qn(p.alpha,0)),equationRgb:Qn(h.equationRgb,Dh.FUNC_ADD),equationAlpha:Qn(h.equationAlpha,Dh.FUNC_ADD),functionSourceRgb:Qn(h.functionSourceRgb,Dh.ONE),functionSourceAlpha:Qn(h.functionSourceAlpha,Dh.ONE),functionDestinationRgb:Qn(h.functionDestinationRgb,Dh.ZERO),functionDestinationAlpha:Qn(h.functionDestinationAlpha,Dh.ZERO)},this.stencilTest={enabled:Qn(f.enabled,!1),frontFunction:Qn(f.frontFunction,Dh.ALWAYS),backFunction:Qn(f.backFunction,Dh.ALWAYS),reference:Qn(f.reference,0),mask:Qn(f.mask,65535),frontOperation:{fail:Qn(d.fail,Dh.KEEP),zFail:Qn(d.zFail,Dh.KEEP),zPass:Qn(d.zPass,Dh.KEEP)},backOperation:{fail:Qn(A.fail,Dh.KEEP),zFail:Qn(A.zFail,Dh.KEEP),zPass:Qn(A.zPass,Dh.KEEP)}},this.sampleCoverage={enabled:Qn(g.enabled,!1),value:Qn(g.value,1),invert:Qn(g.invert,!1)},this.viewport=Nn(_)?new nA(_.x,_.y,_.width,_.height):void 0,this.lineWidth<gA.minimumAliasedLineWidth||this.lineWidth>gA.maximumAliasedLineWidth)throw new Ln("renderState.lineWidth is out of range.  Check minimumAliasedLineWidth and maximumAliasedLineWidth.");if(!Wh.validate(this.frontFace))throw new Ln("Invalid renderState.frontFace.");if((t=this.cull.face)!==Dh.FRONT&&t!==Dh.BACK&&t!==Dh.FRONT_AND_BACK)throw new Ln("Invalid renderState.cull.face.");if(this.scissorTest.rectangle.width<0||this.scissorTest.rectangle.height<0)throw new Ln("renderState.scissorTest.rectangle.width and renderState.scissorTest.rectangle.height must be greater than or equal to zero.");if(this.depthRange.near>this.depthRange.far)throw new Ln("renderState.depthRange.near can not be greater than renderState.depthRange.far.");if(this.depthRange.near<0)throw new Ln("renderState.depthRange.near must be greater than or equal to zero.");if(this.depthRange.far>1)throw new Ln("renderState.depthRange.far must be less than or equal to one.");if((r=this.depthTest.func)!==Dh.NEVER&&r!==Dh.LESS&&r!==Dh.EQUAL&&r!==Dh.LEQUAL&&r!==Dh.GREATER&&r!==Dh.NOTEQUAL&&r!==Dh.GEQUAL&&r!==Dh.ALWAYS)throw new Ln("Invalid renderState.depthTest.func.");if(this.blending.color.red<0||this.blending.color.red>1||this.blending.color.green<0||this.blending.color.green>1||this.blending.color.blue<0||this.blending.color.blue>1||this.blending.color.alpha<0||this.blending.color.alpha>1)throw new Ln("renderState.blending.color components must be greater than or equal to zero and less than or equal to one.");if(!LA(this.blending.equationRgb))throw new Ln("Invalid renderState.blending.equationRgb.");if(!LA(this.blending.equationAlpha))throw new Ln("Invalid renderState.blending.equationAlpha.");if(!UA(this.blending.functionSourceRgb))throw new Ln("Invalid renderState.blending.functionSourceRgb.");if(!UA(this.blending.functionSourceAlpha))throw new Ln("Invalid renderState.blending.functionSourceAlpha.");if(!UA(this.blending.functionDestinationRgb))throw new Ln("Invalid renderState.blending.functionDestinationRgb.");if(!UA(this.blending.functionDestinationAlpha))throw new Ln("Invalid renderState.blending.functionDestinationAlpha.");if(!GA(this.stencilTest.frontFunction))throw new Ln("Invalid renderState.stencilTest.frontFunction.");if(!GA(this.stencilTest.backFunction))throw new Ln("Invalid renderState.stencilTest.backFunction.");if(!QA(this.stencilTest.frontOperation.fail))throw new Ln("Invalid renderState.stencilTest.frontOperation.fail.");if(!QA(this.stencilTest.frontOperation.zFail))throw new Ln("Invalid renderState.stencilTest.frontOperation.zFail.");if(!QA(this.stencilTest.frontOperation.zPass))throw new Ln("Invalid renderState.stencilTest.frontOperation.zPass.");if(!QA(this.stencilTest.backOperation.fail))throw new Ln("Invalid renderState.stencilTest.backOperation.fail.");if(!QA(this.stencilTest.backOperation.zFail))throw new Ln("Invalid renderState.stencilTest.backOperation.zFail.");if(!QA(this.stencilTest.backOperation.zPass))throw new Ln("Invalid renderState.stencilTest.backOperation.zPass.");if(Nn(this.viewport)){if(this.viewport.width<0)throw new Ln("renderState.viewport.width must be greater than or equal to zero.");if(this.viewport.height<0)throw new Ln("renderState.viewport.height must be greater than or equal to zero.");if(this.viewport.width>gA.maximumViewportWidth)throw new Ln("renderState.viewport.width must be less than or equal to the maximum viewport width ("+gA.maximumViewportWidth.toString()+").  Check maximumViewportWidth.");if(this.viewport.height>gA.maximumViewportHeight)throw new Ln("renderState.viewport.height must be less than or equal to the maximum viewport height ("+gA.maximumViewportHeight.toString()+").  Check maximumViewportHeight.")}this.id=0,this._applyFunctions=[]}FA.applyViewport=function(e,t,r,n,i){var o=Qn(t.viewport,r.viewport);Nn(o)||((o=NA).width=r.context.drawingBufferWidth,o.height=r.context.drawingBufferHeight),r.context.uniformState.viewport=o,e.viewport(o.x,o.y,o.width,o.height)};var zA=0,jA={};function HA(e,t,r){(e?OA:FA).applyFrontFace(t,r)}function qA(e,t,r){(e?OA:FA).applyCull(t,r)}function VA(e,t,r){(e?OA:FA).applyLineWidth(t,r)}function YA(e,t,r){(e?OA:FA).applyPolygonOffset(t,r)}function XA(e,t,r){(e?OA:FA).applyDepthRange(t,r)}function WA(e,t,r){(e?OA:FA).applyDepthTest(t,r)}function KA(e,t,r){(e?OA:FA).applyColorMask(t,r)}function $A(e,t,r){(e?OA:FA).applyDepthMask(t,r)}function JA(e,t,r){(e?OA:FA).applyStencilMask(t,r)}function ZA(e,t,r){(e?OA:FA).applyStencilTest(t,r)}function eg(e,t,r){(e?OA:FA).applySampleCoverage(t,r)}kA.fromCache=function(e){var t=JSON.stringify(e),r=jA[t];if(Nn(r))return++r.referenceCount,r.state;var n=new kA(e),i=JSON.stringify(n);return Nn(r=jA[i])||(n.id=zA++,r={referenceCount:0,state:n=_A(n)},jA[i]=r),++r.referenceCount,jA[t]={referenceCount:1,state:r.state},r.state},kA.removeFromCache=function(e){var t=new kA(e),r=JSON.stringify(t),n=jA[r],i=JSON.stringify(e),o=jA[i];Nn(o)&&(--o.referenceCount,0===o.referenceCount&&(delete jA[i],Nn(n)&&--n.referenceCount)),Nn(n)&&0===n.referenceCount&&delete jA[r]},kA.getCache=function(){return jA},kA.clearCache=function(){jA={}},kA.apply=function(e,t,r){const n=Nn(e.name)?OA:FA;n.applyFrontFace(e,t),n.applyCull(e,t),n.applyLineWidth(e,t),n.applyPolygonOffset(e,t),n.applyDepthRange(e,t),n.applyDepthTest(e,t),n.applyColorMask(e,t),n.applyDepthMask(e,t),n.applyStencilMask(e,t),n.applyStencilTest(e,t),n.applySampleCoverage(e,t),n.applyScissorTest(e,t,r),n.applyBlending(e,t,r),n.applyViewport(e,t,r)},kA.partialApply=function(e,t,r,n,i,o,s,a,u,c,l){const h=Nn(e.name),p=h?OA:FA;if(t!==r){var f=r._applyFunctions[t.id];Nn(f)||(f=function(e,t){var r=[];return e.frontFace!==t.frontFace&&r.push(HA),e.cull.enabled===t.cull.enabled&&e.cull.face===t.cull.face||r.push(qA),e.lineWidth!==t.lineWidth&&r.push(VA),e.polygonOffset.enabled===t.polygonOffset.enabled&&e.polygonOffset.factor===t.polygonOffset.factor&&e.polygonOffset.units===t.polygonOffset.units||r.push(YA),e.depthRange.near===t.depthRange.near&&e.depthRange.far===t.depthRange.far||r.push(XA),e.depthTest.enabled===t.depthTest.enabled&&e.depthTest.func===t.depthTest.func||r.push(WA),e.colorMask.red===t.colorMask.red&&e.colorMask.green===t.colorMask.green&&e.colorMask.blue===t.colorMask.blue&&e.colorMask.alpha===t.colorMask.alpha||r.push(KA),e.depthMask!==t.depthMask&&r.push($A),e.stencilMask!==t.stencilMask&&r.push(JA),e.stencilTest.enabled===t.stencilTest.enabled&&e.stencilTest.frontFunction===t.stencilTest.frontFunction&&e.stencilTest.backFunction===t.stencilTest.backFunction&&e.stencilTest.reference===t.stencilTest.reference&&e.stencilTest.mask===t.stencilTest.mask&&e.stencilTest.frontOperation.fail===t.stencilTest.frontOperation.fail&&e.stencilTest.frontOperation.zFail===t.stencilTest.frontOperation.zFail&&e.stencilTest.backOperation.fail===t.stencilTest.backOperation.fail&&e.stencilTest.backOperation.zFail===t.stencilTest.backOperation.zFail&&e.stencilTest.backOperation.zPass===t.stencilTest.backOperation.zPass||r.push(ZA),e.sampleCoverage.enabled===t.sampleCoverage.enabled&&e.sampleCoverage.value===t.sampleCoverage.value&&e.sampleCoverage.invert===t.sampleCoverage.invert||r.push(eg),r}(t,r),r._applyFunctions[t.id]=f);for(var d=f.length,A=0;A<d;++A)f[A](h,e,r)}((Nn(n.scissorTest)?n.scissorTest:t.scissorTest)!==(Nn(i.scissorTest)?i.scissorTest:r.scissorTest)||a)&&p.applyScissorTest(e,r,i);var g=Nn(n.blendingEnabled)?n.blendingEnabled:t.blending.enabled,_=Nn(i.blendingEnabled)?i.blendingEnabled:r.blending.enabled;(g!==_||_&&t.blending!==r.blending)&&p.applyBlending(e,r,i),t===r&&n===i&&n.context===i.context&&o===s||p.applyViewport(e,r,i,u,c)},kA.getState=function(e){if(!Nn(e))throw new Ln("renderState is required.");return{frontFace:e.frontFace,cull:{enabled:e.cull.enabled,face:e.cull.face},lineWidth:e.lineWidth,polygonOffset:{enabled:e.polygonOffset.enabled,factor:e.polygonOffset.factor,units:e.polygonOffset.units},scissorTest:{enabled:e.scissorTest.enabled,rectangle:nA.clone(e.scissorTest.rectangle)},depthRange:{near:e.depthRange.near,far:e.depthRange.far},depthTest:{enabled:e.depthTest.enabled,func:e.depthTest.func},colorMask:{red:e.colorMask.red,green:e.colorMask.green,blue:e.colorMask.blue,alpha:e.colorMask.alpha},depthMask:e.depthMask,stencilMask:e.stencilMask,blending:{enabled:e.blending.enabled,color:hA.clone(e.blending.color),equationRgb:e.blending.equationRgb,equationAlpha:e.blending.equationAlpha,functionSourceRgb:e.blending.functionSourceRgb,functionSourceAlpha:e.blending.functionSourceAlpha,functionDestinationRgb:e.blending.functionDestinationRgb,functionDestinationAlpha:e.blending.functionDestinationAlpha},stencilTest:{enabled:e.stencilTest.enabled,frontFunction:e.stencilTest.frontFunction,backFunction:e.stencilTest.backFunction,reference:e.stencilTest.reference,mask:e.stencilTest.mask,frontOperation:{fail:e.stencilTest.frontOperation.fail,zFail:e.stencilTest.frontOperation.zFail,zPass:e.stencilTest.frontOperation.zPass},backOperation:{fail:e.stencilTest.backOperation.fail,zFail:e.stencilTest.backOperation.zFail,zPass:e.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:e.sampleCoverage.enabled,value:e.sampleCoverage.value,invert:e.sampleCoverage.invert},viewport:Nn(e.viewport)?nA.clone(e.viewport):void 0}};var tg,rg={ADD:Dh.FUNC_ADD,SUBTRACT:Dh.FUNC_SUBTRACT,REVERSE_SUBTRACT:Dh.FUNC_REVERSE_SUBTRACT,MIN:Dh.MIN,MAX:Dh.MAX},ng=Object.freeze(rg),ig={ZERO:Dh.ZERO,ONE:Dh.ONE,SOURCE_COLOR:Dh.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:Dh.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:Dh.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:Dh.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:Dh.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:Dh.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:Dh.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:Dh.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:Dh.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:Dh.ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:Dh.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:Dh.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:Dh.SRC_ALPHA_SATURATE},og=Object.freeze(ig),sg={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:ng.ADD,equationAlpha:ng.ADD,functionSourceRgb:og.SOURCE_ALPHA,functionSourceAlpha:og.ONE,functionDestinationRgb:og.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:og.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:ng.ADD,equationAlpha:ng.ADD,functionSourceRgb:og.ONE,functionSourceAlpha:og.ONE,functionDestinationRgb:og.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:og.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:ng.ADD,equationAlpha:ng.ADD,functionSourceRgb:og.SOURCE_ALPHA,functionSourceAlpha:og.ONE,functionDestinationRgb:og.ONE,functionDestinationAlpha:og.ONE})},ag=Object.freeze(sg),ug=(tg=!0,function(e,t){var r=tg?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return tg=!1,r}),cg=ug(void 0,(function(){return cg.toString().search("(((.+)+)+)+$").toString().constructor(cg).search("(((.+)+)+)+$")}));function lg(){}cg(),lg.toVertexBuffer=function(e,t,r,n){var i=rA.createVertexBuffer({context:e,typedArray:t.arrayBuffer,usage:n?Bd.DYNAMIC_DRAW:Bd.STATIC_DRAW,owner:"MVT"});return i.vertexArrayDestroyable=!1,i.bytesPerElement=t.bytesPerElement,i.length=t.length,i.attributes=r,i.itemSize=t.bytesPerElement,i.dynamicDraw=n,!n&&t.destroy(),i},lg.toIndexBuffer=function(e,t,r){var n=rA.createIndexBuffer({context:e,typedArray:t.arrayBuffer,usage:Bd.STATIC_DRAW,indexDatatype:void 0!==t.uint16?wd.UNSIGNED_SHORT:wd.UNSIGNED_INT,owner:"MVT"});return n.vertexArrayDestroyable=!1,n.dynamicDraw=r,!n.dynamicDraw&&t.destroy(),n},lg.toRenderState=function(e,t,r,n){var i=ag.DISABLED;e.blendFunction[0]==Dh.ONE&&e.blendFunction[1]==Dh.ONE_MINUS_SRC_ALPHA&&(i={enabled:!0,equationRgb:ng.ADD,equationAlpha:ng.ADD,functionSourceRgb:og.ONE,functionSourceAlpha:og.ONE,functionDestinationRgb:og.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:og.ONE_MINUS_SOURCE_ALPHA});var o=!1;o=!(r.test.func===Dh.ALWAYS&&!r.mask);var s={frontFace:n.frontFace,cull:{enabled:n.enable,face:n.mode},depthRange:{near:t.range[0],far:t.range[1]},depthTest:{enabled:t.func!==Dh.ALWAYS,func:t.func},depthMask:t.mask,colorMask:{red:e.mask[0],green:e.mask[1],blue:e.mask[2],alpha:e.mask[3]},stencilMask:r.mask,stencilTest:{enabled:o,frontFunction:r.test.func,backFunction:r.test.func,reference:r.ref,mask:r.test.mask,frontOperation:{fail:r.fail,zFail:r.depthFail,zPass:r.pass},backOperation:{fail:r.fail,zFail:r.depthFail,zPass:r.pass}},blending:i};return kA.fromCache(s)},lg.toComponentDatatype=function(e){switch(e){case"Int8":return Ph.BYTE;case"Uint8":return Ph.UNSIGNED_BYTE;case"Int16":return Ph.SHORT;case"Uint16":return Ph.UNSIGNED_SHORT;case"Int32":return Ph.INT;case"Uint32":return Ph.UNSIGNED_INT;default:return Ph.FLOAT}},lg.mbxAttributeToCesiumVertexArrtribute=function(e,t,r,n){var i=this.toComponentDatatype(e.type);Ph.getSizeInBytes(i);var o=e.strideInBytes||t.bytesPerElement,s=e.offset+o*(n||0);return{name:e.name,index:r,vertexBuffer:t,componentsPerAttribute:e.components,componentDatatype:i,offsetInBytes:s,strideInBytes:o,normalize:!1}},lg.copyFromArrayView=function(e,t,r){e.copyFromArrayView(t,r)};const hg=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),pg=hg(void 0,(function(){return pg.toString().search("(((.+)+)+)+$").toString().constructor(pg).search("(((.+)+)+)+$")}));pg();class fg{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,t){return!this.location&&!this.initialized&&(this.location=this.gl.getUniformLocation(e,t),this.initialized=!0),!!this.location}set(e,t,r){}}class dg extends fg{constructor(e){super(e),this.current=0}set(e,t,r){this.fetchUniformLocation(e,t)&&this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Ag extends fg{constructor(e){super(e),this.current=[0,0,0,0]}set(e,t,r){this.fetchUniformLocation(e,t)&&(r[0]!==this.current[0]||r[1]!==this.current[1]||r[2]!==this.current[2]||r[3]!==this.current[3])&&(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class gg extends fg{constructor(e){super(e),this.current=y.transparent}set(e,t,r){this.fetchUniformLocation(e,t)&&(r.r!==this.current.r||r.g!==this.current.g||r.b!==this.current.b||r.a!==this.current.a)&&(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const _g=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),mg=_g(void 0,(function(){return mg.toString().search("(((.+)+)+)+$").toString().constructor(mg).search("(((.+)+)+)+$")}));mg();var yg=new gi;function Eg(e){return[gf(255*e.r,255*e.g),gf(255*e.b,255*e.a)]}class xg{constructor(e,t,r){this.value=e,this.uniformNames=t.map((e=>"u_"+e)),this.type=r}setUniform(e,t,r,n,i){t.set(e,i,n.constantOr(this.value))}getBinding(e,t){return"color"===this.type?new gg(e):new dg(e)}setUniformMap(e,t,r,n,i){var o=this;e[t]=function(){var e=n.get(r).constantOr(o.value);return"color"===o.type&&(e.red=e.r,e.green=e.g,e.blue=e.b,e.alpha=e.a),e}}}class Cg{constructor(e,t){this.uniformNames=t.map((e=>"u_"+e)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,t,r,n,i){const o="u_pattern"===i||"u_dash"===i?this.pattern:"u_pixel_ratio"===i?this.pixelRatio:null;o&&t.set(e,i,o)}getBinding(e,t){return"u_pattern"===t||"u_dash"===t?new Ag(e):new dg(e)}setUniformMap(e,t,r,n,i){if("u_pattern"===t||"u_dash"===t){const r=this.pattern;e[t]=function(){return yg.x=r[0],yg.y=r[1],yg.z=r[2],yg.w=r[3],yg}}else if("u_pixel_ratio"===t){const r=this.pixelRatio;e[t]=function(){return r}}}}class bg{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:"a_"+e,type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new n}populatePaintArray(e,t,r,n,i,o){const s=this.paintVertexArray.length,a=this.expression.evaluate(new $p(0),t,{},i,n,o);this.paintVertexArray.resize(e),this._setPaintValue(s,e,a)}updatePaintArray(e,t,r,n,i){const o=this.expression.evaluate({zoom:0},r,n,void 0,i);this._setPaintValue(e,t,o)}_setPaintValue(e,t,r){if("color"===this.type){const n=Eg(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.copy(this.paintVertexArray):this.paintVertexBuffer=lg.toVertexBuffer(e,this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ig{constructor(e,t,r,n,i,o){this.expression=e,this.uniformNames=t.map((e=>"u_"+e+"_t")),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:"a_"+e,type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(e,t,r,n,i,o){const s=this.expression.evaluate(new $p(this.zoom),t,{},i,n,o),a=this.expression.evaluate(new $p(this.zoom+1),t,{},i,n,o),u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(u,e,s,a)}updatePaintArray(e,t,r,n,i){const o=this.expression.evaluate({zoom:this.zoom},r,n,void 0,i),s=this.expression.evaluate({zoom:this.zoom+1},r,n,void 0,i);this._setPaintValue(e,t,o,s)}_setPaintValue(e,t,r,n){if("color"===this.type){const i=Eg(r),o=Eg(n);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1],o[0],o[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.copyFromArrayView(this.paintVertexArray.arrayBuffer):this.paintVertexBuffer=lg.toVertexBuffer(e,this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t,r,n,i){const o=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,s=tp(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(e,i,s)}setUniformMap(e,t,r,n,i){const o=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,s=tp(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);e[t]=function(){return s}}getBinding(e,t){return new dg(e)}}class vg{constructor(e,t,r,n,i){this.expression=e,this.layerId=i,this.paintVertexAttributes=("array"===r?Cd:yd).members;for(let e=0;e<t.length;++e);this.paintVertexArray=new n}populatePaintArray(e,t,r){const n=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,n,i,o){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],o)}_setPaintValues(e,t,r,n){if(!n||!r)return;const i=n[r];if(!i)return;const{tl:o,br:s,pixelRatio:a}=i;for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,o[0],o[1],s[0],s[1],a)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=lg.toVertexBuffer(e,this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Tg{constructor(e,t,r){this.binders={},this._buffers=[];const n=[];if(e)for(const s in e.paint._values){if(r&&!r(s))continue;const a=e.paint.get(s);if(!(a instanceof af&&on(a.property.specification)))continue;const u=(i=s,o=e.type,Sg[i]||[i.replace(o+"-","").replace(/-/g,"_")]),c=a.value,l=a.property.specification.type,h=!!a.property.useIntegerZoom,p="line-dasharray"===s||s.endsWith("pattern"),f="line-dasharray"===s&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==c.kind||f)if("source"===c.kind||f||p){const t=Bg(s,l,"source");this.binders[s]=p?new vg(c,u,l,t,e.id):new bg(c,u,l,t),n.push("/a_"+s)}else{const e=Bg(s,l,"composite");this.binders[s]=new Ig(c,u,l,h,t,e),n.push("/z_"+s)}else this.binders[s]=p?new Cg(c.value,u):new xg(c.value,u,l),n.push("/u_"+s)}var i,o;this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof bg||t instanceof Ig?t.maxValue:0}populatePaintArrays(e,t,r,n,i,o){for(const s in this.binders){const a=this.binders[s];(a instanceof bg||a instanceof Ig||a instanceof vg)&&a.populatePaintArray(e,t,r,n,i,o)}}setConstantPatternPositions(e){for(const t in this.binders){const r=this.binders[t];r instanceof Cg&&r.setConstantPatternPositions(e)}}updatePaintArrays(e,t,r,n,i,o){let s=!1;for(const a in e){const u=t.getPositions(a);for(const t of u){const u=r.feature(t.index);for(const r in this.binders){const c=this.binders[r];if((c instanceof bg||c instanceof Ig||c instanceof vg)&&!0===c.expression.isStateDependent){const l=n.paint.get(r);c.expression=l.value,c.updatePaintArray(t.start,t.end,u,e[a],i,o),s=!0}}}}return s}defines(){const e=[];for(const t in this.binders){const r=this.binders[t];(r instanceof xg||r instanceof Cg)&&e.push(...r.uniformNames.map((e=>"HAS_UNIFORM_"+e)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof bg||r instanceof Ig||r instanceof vg)for(let t=0;t<r.paintVertexAttributes.length;t++)e.push(r.paintVertexAttributes[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof xg||r instanceof Cg||r instanceof Ig)for(const t of r.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const t=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof xg||n instanceof Cg||n instanceof Ig)for(const i of n.uniformNames)t.push({name:i,property:r,binding:n.getBinding(e,i)})}return t}setUniforms(e,t,r,n,i){for(const{name:t,property:o,binding:s}of r)this.binders[o].setUniform(e,s,i,n.get(o),t)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const t=this.binders[e];(t instanceof bg||t instanceof Ig||t instanceof vg)&&t.paintVertexBuffer&&this._buffers.push(t.paintVertexBuffer)}}upload(e){for(const t in this.binders){const r=this.binders[t];(r instanceof bg||r instanceof Ig||r instanceof vg)&&r.upload(e)}this.updatePaintBuffers()}getAttributeLocation(){for(var e=0,t={},r=0;r<this.layoutAttributes.length;r++){t[this.layoutAttributes[r].name]=r,e++}for(var n=this.getPaintVertexBuffers(),i=0;n&&i<n.length;i++)for(var o=n[i],s=0;s<o.attributes.length;s++){t[o.attributes[s].name]=e++}return t}getUniformMaps(e,t,r,n){for(var i in this.binders){var o=this.binders[i];if(o.uniformNames)for(var s=0,a=o.uniformNames;s<a.length;s+=1){var u=a[s];e[u]&&o.setUniformMap(r,u,i,t,{zoom:n})}}for(var c in e)!r[c]&&c.endsWith("_t")&&(r[c]=function(){return 0});return r}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof bg||t instanceof Ig||t instanceof vg)&&t.destroy()}}}class Rg{constructor(e,t,r,n){this.programConfigurations={};for(const i of t)this.programConfigurations[i.id]=new Tg(i,r,n),this.programConfigurations[i.id].layoutAttributes=e;this.needsUpload=!1,this._featureMap=new Td,this._bufferOffset=0}populatePaintArrays(e,t,r,n,i,o,s){for(const r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(e,t,n,i,o,s);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n,i){for(const o of r)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,t,o,n,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Sg={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};const Mg={"line-pattern":{source:Bf,composite:Bf},"fill-pattern":{source:Bf,composite:Bf},"fill-extrusion-pattern":{source:Bf,composite:Bf},"line-dasharray":{source:Of,composite:Of}},wg={color:{source:nd,composite:wf},number:{source:Xf,composite:nd}};function Bg(e,t,r){const n=Mg[e];return n&&n[r]||wg[t][r]}Sp(xg,"ConstantBinder"),Sp(Cg,"PatternConstantBinder"),Sp(bg,"SourceExpressionBinder"),Sp(vg,"PatternCompositeBinder"),Sp(Ig,"CompositeExpressionBinder"),Sp(Tg,"ProgramConfiguration",{omit:["_buffers"]}),Sp(Rg,"ProgramConfigurationSet");const Og=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Dg=Og(void 0,(function(){return Dg.toString().search("(((.+)+)+)+$").toString().constructor(Dg).search("(((.+)+)+)+$")}));function Fg(e){if(Array.isArray(e))return e.map(Fg);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=Fg(e[r]);return t}return(t=e)instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t;var t}Dg();var Pg,Ng=(Pg=!0,function(e,t){var r=Pg?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Pg=!1,r}),Lg=Ng(void 0,(function(){return Lg.toString().search("(((.+)+)+)+$").toString().constructor(Lg).search("(((.+)+)+)+$")}));Lg();var Ug={$version:8,$root:{version:{required:!0,type:"enum",values:[8],doc:"Style specification version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:""},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:'Default bearing, in degrees. The bearing is the compass direction that is "up"; for example, a bearing of 90° orients the map so that east is up. This value will be used only if the map has not been positioned by other means (e.g. map options or user interaction).',example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface, for a look straight down at the map, while a greater value like 60 looks ahead towards the horizon. The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},light:{type:"light",doc:"The global light source.",example:{anchor:"viewport",color:"white",intensity:.4}},terrain:{type:"terrain",doc:"A global modifier that elevates layers and markers based on a DEM data source."},fog:{type:"fog",doc:"A global effect that fades layers and markers based on their distance to the camera. The fog can be used to approximate the effect of atmosphere on distant objects and enhance the depth perception of the map when used with terrain or 3D features. Note: fog is renamed to atmosphere in the Android and iOS SDKs and planned to be changed in GL-JS v.3.0.0."},sources:{required:!0,type:"sources",doc:"Data source specifications."},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended. This property is required if any layer uses the `background-pattern`, `fill-pattern`, `line-pattern`, `fill-extrusion-pattern`, or `icon-image` properties. The URL must be absolute, containing the [scheme, authority and path components]."},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. The URL must include `{fontstack}` and `{range}` tokens. This property is required if any layer uses the `text-field` layout property. The URL must be absolute, containing the [scheme, authority and path components]."},transition:{type:"transition",doc:"A global transition definition to use as a default across properties, to be used for timing transitions between one value and the next when no property-specific transition is set. Collision-based symbol fading is controlled independently of the style's `transition` property.",example:{duration:300,delay:0}},projection:{type:"projection",doc:"The projection the map should be rendered in. Supported projections are Mercator, Globe, Albers, Equal Earth, Equirectangular (WGS84), Lambert conformal conic, Natural Earth, and Winkel Tripel. Terrain, sky and fog are supported by only Mercator and globe. CustomLayerInterface is not supported outside of Mercator.",example:{name:"albers",center:[-154,50],parallels:[55,65]}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array."}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For image and video sources, a URL must be provided. For GeoJSON sources, a URL or inline GeoJSON must be provided."}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{doc:"A vector tile source."}},doc:"The type of the source."},url:{type:"string",doc:""},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:""},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`. If specified as a string for a vector tile source, the same property is used across all its source layers. If specified as an object only specified source layers will have id overriden, others will fallback to original feature id"},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},source_raster:{type:{required:!0,type:"enum",values:{raster:{doc:"A raster tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:""},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{doc:"A RGB-encoded raster DEM source"}},doc:"The type of the source."},url:{type:"string",doc:""},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:""},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{doc:"A GeoJSON data source."}},doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:18,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},buffer:{type:"number",default:128,maximum:512,minimum:0,doc:"Size of the tile buffer on each side. A value of 0 produces no buffer. A value of 512 produces a buffer as wide as the tile itself. Larger values produce fewer rendering artifacts near tile edges and slower performance."},filter:{type:"*",doc:"An expression for filtering features prior to processing them for rendering."},tolerance:{type:"number",default:.375,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:""},clusterRadius:{type:"number",default:50,minimum:0,doc:"Radius of each cluster if clustering is enabled. A value of 512 indicates a radius equal to the width of a tile."},clusterMaxZoom:{type:"number",doc:"Max zoom on which to cluster points if clustering is enabled. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered). Clusters are re-evaluated at integer zoom levels so setting clusterMaxZoom to 14 means the clusters will be displayed until z15."},clusterMinPoints:{type:"number",doc:"Minimum number of points necessary to form a cluster if clustering is enabled. Defaults to `2`."},clusterProperties:{type:"*",doc:'An object defining custom properties on the generated clusters if clustering is enabled, aggregating values from clustered points. Has the form `{"property_name": [operator, map_expression]}`. `operator` is any expression function that accepts at least 2 operands (e.g. `"+"` or `"max"`) — it accumulates the property value from clusters/points the cluster contains; `map_expression` produces the value of a single point.\n\nExample: `{"sum": ["+", ["get", "scalerank"]]}`.\n\nFor more advanced use cases, in place of `operator`, you can use a custom reduce expression that references a special `["accumulated"]` value, e.g.:\n`{"sum": [["+", ["accumulated"], ["get", "sum"]], ["get", "scalerank"]]}`'},lineMetrics:{type:"boolean",default:!1,doc:"Whether to calculate line distance metrics. This is required for line layers that specify `line-gradient` values."},generateId:{type:"boolean",default:!1,doc:"Whether to generate ids for the geojson features. When enabled, the `feature.id` property will be auto assigned based on its index in the `features` array, over-writing any previous values."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`."}},source_video:{type:{required:!0,type:"enum",values:{video:{doc:"A video data source."}},doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_image:{type:{required:!0,type:"enum",values:{image:{doc:"An image data source."}},doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image."},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},layer:{id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:{fill:{doc:"A filled polygon with an optional stroked border.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},line:{doc:"A stroked line.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},symbol:{doc:"An icon or a text label.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},circle:{doc:"A filled circle.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},heatmap:{doc:"A heatmap.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"fill-extrusion":{doc:"An extruded (3D) polygon.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},raster:{doc:"Raster map textures such as satellite imagery.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},background:{doc:"The background color or pattern of the map.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},sky:{doc:"A spherical dome around the map that is always rendered behind all other layers.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},doc:"Rendering type of this layer.",required:!0},metadata:{type:"*",doc:""},source:{type:"string",doc:"Name of a source description to be used for this layer. Required for all layer types except `background`."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required for vector tile sources; prohibited for all other source types, including GeoJSON sources."},minzoom:{type:"number",minimum:0,maximum:24,doc:"The minimum zoom level for the layer. At zoom levels less than the minzoom, the layer will be hidden."},maxzoom:{type:"number",minimum:0,maximum:24,doc:"The maximum zoom level for the layer. At zoom levels equal to or greater than the maxzoom, the layer will be hidden."},filter:{type:"filter",doc:'An expression specifying conditions on source features. Only features that match the filter are displayed. Zoom expressions in filters are only evaluated at integer zoom levels. The `["feature-state", ...]` expression is not supported in filter expressions.  The `["pitch"]` and `["distance-from-center"]` expressions are supported only for filter expressions on the symbol layer.'},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"},"data-driven styling":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},"property-type":"constant"},"fill-extrusion-edge-radius":{type:"number",private:!0,default:0,minimum:0,maximum:1,doc:"Radius of a fill extrusion edge in meters. If not zero, rounds extrusion edges for a smoother appearance.","sdk-support":{"basic functionality":{js:"v2.10.0",android:"10.7.0",ios:"10.7.0"}},"property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{doc:"A cap with a squared-off end which is drawn to the exact endpoint of the line."},round:{doc:"A cap with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},square:{doc:"A cap with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."}},default:"butt",doc:"The display of line endings.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{doc:"A join with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."},round:{doc:"A join with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},miter:{doc:"A join with a sharp, angled corner which is drawn with the outer sides beyond the endpoint of the path until they meet."}},default:"miter",doc:"The display of lines when joining.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{doc:"The label is placed at the point where the geometry is located."},line:{doc:"The label is placed along the line of the geometry. Can only be used on `LineString` and `Polygon` geometries."},"line-center":{doc:"The label is placed at the center of the line of the geometry. Can only be used on `LineString` and `Polygon` geometries. Note that a single feature in a vector tile may contain multiple line geometries."},"line-direction":{doc:"The label is placed in the order defined by the vector data. "}},default:"point",doc:"Label placement relative to its geometry.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`line-center` value":{js:"0.47.0",android:"6.4.0",ios:"4.3.0",macos:"0.10.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,doc:"","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with lower sort keys are drawn and placed first.  When `icon-allow-overlap` or `text-allow-overlap` is `false`, features with a lower sort key will have priority during placement. When `icon-allow-overlap` or `text-allow-overlap` is set to `true`, features with a higher sort key will overlap over features with a lower sort key.","sdk-support":{"basic functionality":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"},"data-driven styling":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},"viewport-y":{doc:"Sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},source:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, no sorting is applied; symbols are rendered in the same order as the source data."}},default:"auto",doc:"Determines whether overlapping symbols in the same layer are rendered in the order that they appear in the data source or by their y-position relative to the viewport. To control the order and prioritization of symbols otherwise, use `symbol-sort-key`.","sdk-support":{"basic functionality":{js:"0.49.0",android:"6.6.0",ios:"4.5.0",macos:"0.12.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns icons east-west. When `symbol-placement` is set to `line` or `line-center`, aligns icon x-axes with the line."},viewport:{doc:"Produces icons whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",doc:"Scales the original size of the icon by the provided factor. The new pixel size of the image will be the original pixel size multiplied by `icon-size`. 1 is the original size; 3 triples the size of the image.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{doc:"The icon is displayed at its intrinsic aspect ratio."},width:{doc:"The icon is scaled in the x-dimension to fit the width of the text."},height:{doc:"The icon is scaled in the y-dimension to fit the height of the text."},both:{doc:"The icon is scaled in both x- and y-dimensions."}},default:"none",doc:"Scales the icon to fit around the associated text.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"stretchable icons":{js:"1.6.0",android:"9.2.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",doc:"Size of the additional area added to dimensions determined by `icon-text-fit`, in clockwise order: top, right, bottom, left.",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",doc:"Name of image in sprite to use for drawing an image background.",tokens:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up. Each component is multiplied by the value of `icon-size` to obtain the final offset in pixels. When combined with `icon-rotate` the offset will be as if the rotated direction was up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{doc:"The center of the icon is placed closest to the anchor."},left:{doc:"The left side of the icon is placed closest to the anchor."},right:{doc:"The right side of the icon is placed closest to the anchor."},top:{doc:"The top of the icon is placed closest to the anchor."},bottom:{doc:"The bottom of the icon is placed closest to the anchor."},"top-left":{doc:"The top left corner of the icon is placed closest to the anchor."},"top-right":{doc:"The top right corner of the icon is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the icon is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the icon is placed closest to the anchor."}},default:"center",doc:"Part of the icon placed closest to the anchor.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{doc:"The icon is aligned to the plane of the map."},viewport:{doc:"The icon is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `icon-rotation-alignment`."}},default:"auto",doc:"Orientation of icon when map is pitched.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{doc:"The text is aligned to the plane of the map."},viewport:{doc:"The text is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `text-rotation-alignment`."}},default:"auto",doc:"Orientation of text when map is pitched.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns text east-west. When `symbol-placement` is set to `line` or `line-center`, aligns text x-axes with the line."},viewport:{doc:"Produces glyphs whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of the individual glyphs forming the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"ignore-line-rotation":{type:"boolean",values:{true:{doc:"this style is active only if text is alongline, true means not allow line rotation"},false:{doc:"this style is active only if text is alongline, false means allow line rotation"}},default:!1,doc:"In combination with `text-rotation-alignment`, determines the rotation behavior of all glyphs forming the text.",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,doc:"Value to use for a text label. If a plain `string` is provided, it will be treated as a `formatted` with default/inherited formatting options. SDF images are not supported in formatted text and will be ignored.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",doc:"Font size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",doc:"The maximum line width for text wrapping.",requires:["text-field",{"symbol-placement":["point"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",doc:"Text leading value for multi-line text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0",android:"10.0.0",ios:"10.0.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",doc:"Text tracking amount.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{doc:"The text is aligned towards the anchor position."},left:{doc:"The text is aligned to the left."},center:{doc:"The text is centered."},right:{doc:"The text is aligned to the right."}},default:"center",doc:"Text justification options.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},auto:{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,doc:"Radial offset of text, in the direction of the symbol's anchor. Useful in combination with `text-variable-anchor`, which defaults to using the two-dimensional `text-offset` if present.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"},"data-driven styling":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},requires:["text-field",{"symbol-placement":["point"]}],doc:"To increase the chance of placing high-priority labels on the map, you can provide an array of `text-anchor` locations: the renderer will attempt to place the label at each location, in order, before moving onto the next label. Use `text-justify: auto` to choose justification based on anchor position. To apply an offset, use the `text-radial-offset` or the two-dimensional `text-offset`.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field",{"!":"text-variable-anchor"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{doc:"If a text's language supports horizontal writing mode, symbols would be laid out horizontally."},vertical:{doc:"If a text's language supports vertical writing mode, symbols would be laid out vertically."}},doc:"The property allows control over a symbol's orientation. Note that the property values act as a hint, so that a symbol whose language doesn’t support the provided orientation will be laid out in its natural orientation. Example: English point symbol will be rendered horizontally even if array value contains single 'vertical' enum value. For symbol with point placement, the order of elements in an array define priority order for the placement of an orientation variant. For symbol with line placement, the default text writing mode is either ['horizontal', 'vertical'] or ['vertical', 'horizontal'], the order doesn't affect the placement.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"1.3.0",android:"8.3.0",ios:"5.3.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the text clockwise.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{doc:"The text is not altered."},uppercase:{doc:"Forces all letters to be displayed in uppercase."},lowercase:{doc:"Forces all letters to be displayed in lowercase."}},default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up. If used with text-variable-anchor, input values will be taken as absolute values. Offsets along the x- and y-axis will be applied automatically based on the anchor position.",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},filter:{type:"array",value:"*",doc:"A filter selects specific features from a layer."},filter_symbol:{type:"boolean",doc:'Expression which determines whether or not to display a symbol. Symbols support dynamic filtering, meaning this expression can use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",doc:'Expression which determines whether or not to display a polygon. Fill layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",doc:'Expression which determines whether or not to display a Polygon or LineString. Line layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",doc:'Expression which determines whether or not to display a circle. Circle layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",doc:'Expression which determines whether or not to display a Polygon. Fill-extrusion layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",doc:'Expression used to determine whether a point is being displayed or not. Heatmap layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{doc:'`["==", key, value]` equality: `feature[key] = value`'},"!=":{doc:'`["!=", key, value]` inequality: `feature[key] ≠ value`'},">":{doc:'`[">", key, value]` greater than: `feature[key] > value`'},">=":{doc:'`[">=", key, value]` greater than or equal: `feature[key] ≥ value`'},"<":{doc:'`["<", key, value]` less than: `feature[key] < value`'},"<=":{doc:'`["<=", key, value]` less than or equal: `feature[key] ≤ value`'},in:{doc:'`["in", key, v0, ..., vn]` set inclusion: `feature[key] ∈ {v0, ..., vn}`'},"!in":{doc:'`["!in", key, v0, ..., vn]` set exclusion: `feature[key] ∉ {v0, ..., vn}`'},all:{doc:'`["all", f0, ..., fn]` logical `AND`: `f0 ∧ ... ∧ fn`'},any:{doc:'`["any", f0, ..., fn]` logical `OR`: `f0 ∨ ... ∨ fn`'},none:{doc:'`["none", f0, ..., fn]` logical `NOR`: `¬f0 ∧ ... ∧ ¬fn`'},has:{doc:'`["has", key]` `feature[key]` exists'},"!has":{doc:'`["!has", key]` `feature[key]` does not exist'},within:{doc:'`["within", object]` feature geometry is within object geometry'}},doc:"The filter operator."},geometry_type:{type:"enum",values:{Point:{doc:"Filter to point geometries."},LineString:{doc:"Filter to line geometries."},Polygon:{doc:"Filter to polygon geometries."}},doc:"The geometry type for the filter to select."},function:{expression:{type:"expression",doc:"An expression."},stops:{type:"array",doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."},property:{type:"string",doc:"The name of a feature property to use as the function input.",default:"$zoom"},type:{type:"enum",values:{identity:{doc:"Return the input value as the output value."},exponential:{doc:"Generate an output by interpolating between stops just less than and just greater than the function input."},interval:{doc:"Return the output value of the stop just less than the function input."},categorical:{doc:"Return the output value of the stop equal to the function input."}},doc:"The interpolation strategy to use in function evaluation.",default:"exponential"},colorSpace:{type:"enum",values:{rgb:{doc:"Use the RGB color space to interpolate color values"},lab:{doc:"Use the LAB color space to interpolate color values."},hcl:{doc:"Use the HCL color space to interpolate color values, interpolating the Hue, Chroma, and Luminance channels individually."}},doc:"The color space in which colors interpolated. Interpolating colors in perceptual color spaces like LAB and HCL tend to produce color ramps that look more consistent and produce colors that can be differentiated more easily than those interpolated in RGB space.",default:"rgb"},default:{type:"*",required:!1,doc:"A value to serve as a fallback function result when a value isn't otherwise available. It is used in the following circumstances:\n* In categorical functions, when the feature value does not match any of the stop domain values.\n* In property and zoom-and-property functions, when a feature does not contain a value for the specified property.\n* In identity functions, when the feature value is not valid for the style property (for example, if the function is being used for a `circle-color` property but the feature property value is not a string or not a valid color).\n* In interval or exponential property and zoom-and-property functions, when the feature value is not numeric.\nIf no default is provided, the style property's default is used in these circumstances."}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2,doc:"Zoom level and value pair."},expression:{type:"array",value:"*",minimum:1,doc:"An expression defines a function that can be used for data-driven style properties or feature filters."},expression_name:{doc:"",type:"enum",values:{let:{doc:'Binds expressions to named variables, which can then be referenced in the result expression using ["var", "variable_name"].',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},var:{doc:'References variable bound using "let".',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},literal:{doc:"Provides a literal array or object value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},array:{doc:"Asserts that the input is an array (optionally with a specific item type and length).  If, when the input expression is evaluated, it is not of the asserted type, then this assertion will cause the whole expression to be aborted.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},at:{doc:"Retrieves an item from an array.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},in:{doc:"Determines whether an item exists in an array or a substring exists in a string. In the specific case when the second and third arguments are string literals, you must wrap at least one of them in a [`literal`](#types-literal) expression to hint correct interpretation to the [type system](#type-system).",group:"Lookup","sdk-support":{"basic functionality":{js:"1.6.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"index-of":{doc:"Returns the first position at which an item can be found in an array or a substring can be found in a string, or `-1` if the input cannot be found. Accepts an optional index from where to begin the search.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0",android:"10.0.0",ios:"10.0.0"}}},slice:{doc:"Returns an item from an array or a substring from a string from a specified start index, or between a start index and an end index if set. The return value is inclusive of the start index but not of the end index.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0",android:"10.0.0",ios:"10.0.0"}}},case:{doc:"Selects the first output whose corresponding test condition evaluates to true, or the fallback value otherwise.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},match:{doc:'Selects the output for which the label value matches the input value, or the fallback value if no match is found. The input can be any expression (for example, `["get", "building_type"]`). Each label must be unique, and must be either:\n - a single literal value; or\n - an array of literal values, the values of which must be all strings or all numbers (for example `[100, 101]` or `["c", "b"]`).\n\nThe input matches if any of the values in the array matches using strict equality, similar to the `"in"` operator.\nIf the input type does not match the type of the labels, the result will be the fallback value.',group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},coalesce:{doc:"Evaluates each expression in turn until the first valid value is obtained. Invalid values are `null` and [`'image'`](#types-image) expressions that are unavailable in the style. If all values are invalid, `coalesce` returns the first value listed.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},step:{doc:'Produces discrete, stepped results by evaluating a piecewise-constant function defined by pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. Returns the output value of the stop just less than the input, or the first output if the input is less than the first stop.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},interpolate:{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. The output type must be `number`, `array<number>`, or `color`.\n\nInterpolation types:\n- `["linear"]`: Interpolates linearly between the pair of stops just less than and just greater than the input.\n- `["exponential", base]`: Interpolates exponentially between the stops just less than and just greater than the input. `base` controls the rate at which the output increases: higher values make the output increase more towards the high end of the range. With values close to 1 the output increases linearly.\n- `["cubic-bezier", x1, y1, x2, y2]`: Interpolates using the cubic bezier curve defined by the given control points.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"interpolate-hcl":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the Hue-Chroma-Luminance color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},"interpolate-lab":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the CIELAB color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},ln2:{doc:"Returns mathematical constant ln(2).",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pi:{doc:"Returns the mathematical constant pi.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},e:{doc:"Returns the mathematical constant e.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},typeof:{doc:"Returns a string describing the type of the given value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},string:{doc:"Asserts that the input value is a string. If multiple values are provided, each one is evaluated in order until a string is obtained. If none of the inputs are strings, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},number:{doc:"Asserts that the input value is a number. If multiple values are provided, each one is evaluated in order until a number is obtained. If none of the inputs are numbers, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},boolean:{doc:"Asserts that the input value is a boolean. If multiple values are provided, each one is evaluated in order until a boolean is obtained. If none of the inputs are booleans, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},object:{doc:"Asserts that the input value is an object. If multiple values are provided, each one is evaluated in order until an object is obtained. If none of the inputs are objects, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},collator:{doc:"Returns a `collator` for use in locale-dependent comparison operations. The `case-sensitive` and `diacritic-sensitive` options default to `false`. The `locale` argument specifies the IETF language tag of the locale to use. If none is provided, the default locale is used. If the requested locale is not available, the `collator` will use a system-defined fallback locale. Use `resolved-locale` to test the results of locale fallback behavior.",group:"Types","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},format:{doc:'Returns a `formatted` string for displaying mixed-format text in the `text-field` property. The input may contain a string literal or expression, including an [`\'image\'`](#types-image) expression. Strings may be followed by a style override object that supports the following properties:\n- `"text-font"`: Overrides the font stack specified by the root layout property.\n- `"text-color"`: Overrides the color specified by the root paint property.\n- `"font-scale"`: Applies a scaling factor on `text-size` as specified by the root layout property.',group:"Types","sdk-support":{"basic functionality":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-font":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"font-scale":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-color":{js:"1.3.0",android:"7.3.0",ios:"4.10.0",macos:"0.14.0"},image:{js:"1.6.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},image:{doc:"",group:"Types","sdk-support":{"basic functionality":{js:"1.4.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},"number-format":{doc:"Converts the input number into a string representation using the providing formatting rules. If set, the `locale` argument specifies the locale to use, as a BCP 47 language tag. If set, the `currency` argument specifies an ISO 4217 code to use for currency-style formatting. If set, the `unit` argument specifies a [simple ECMAScript unit] to use for unit-style formatting. If set, the `min-fraction-digits` and `max-fraction-digits` arguments specify the minimum and maximum number of fractional digits to include.",group:"Types","sdk-support":{"basic functionality":{js:"0.54.0",android:"8.4.0",ios:"5.4.0",macos:"0.15.0"}}},"to-string":{doc:'Converts the input value to a string. If the input is `null`, the result is `""`. If the input is a [`boolean`](#types-boolean), the result is `"true"` or `"false"`. If the input is a number, it is converted to a string as specified by the ["NumberToString" algorithm] of the ECMAScript Language Specification. If the input is a [`color`](#color), it is converted to a string of the form `"rgba(r,g,b,a)"`, where `r`, `g`, and `b` are numerals ranging from 0 to 255, and `a` ranges from 0 to 1. If the input is an [`\'image\'`](#types-image) expression, `\'to-string\'` returns the image name. Otherwise, the input is converted to a string in the format specified by the [`JSON.stringify`] function of the ECMAScript Language Specification.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-number":{doc:'Converts the input value to a number, if possible. If the input is `null` or `false`, the result is 0. If the input is `true`, the result is 1. If the input is a string, it is converted to a number as specified by the ["ToNumber Applied to the String Type" algorithm] of the ECMAScript Language Specification. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-boolean":{doc:"Converts the input value to a boolean. The result is `false` when then input is an empty string, 0, `false`, `null`, or `NaN`; otherwise it is `true`.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-rgba":{doc:"Returns a four-element array containing the input color's red, green, blue, and alpha components, in that order.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-color":{doc:"Converts the input value to a color. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgb:{doc:"Creates a color value from red, green, and blue components, which must range between 0 and 255, and an alpha component of 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgba:{doc:"Creates a color value from red, green, blue components, which must range between 0 and 255, and an alpha component which must range between 0 and 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},get:{doc:"Retrieves a property value from the current feature's properties, or from another object if a second argument is provided. Returns `null` if the requested property is missing.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},has:{doc:"Tests for the presence of an property value in the current feature's properties, or from another object if a second argument is provided.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},length:{doc:"Returns the length of an array or string.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},properties:{doc:'Returns the feature properties object.  Note that in some cases, it may be more efficient to use `["get", "property_name"]` directly.',group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"feature-state":{doc:"Retrieves a property value from the current feature's state. Returns `null` if the requested property is not present on the feature's state. A feature's state is not part of the GeoJSON or vector tile data, and must be set programmatically on each feature. Features are identified by their `id` attribute, which must be an integer or a string that can be cast to an integer. Note that [\"feature-state\"] can only be used with paint properties that support data-driven styling.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.46.0",android:"10.0.0",ios:"10.0.0"}}},"geometry-type":{doc:"Returns the feature's geometry type: `Point`, `LineString` or `Polygon`. `Multi*` feature types return the singular forms.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},id:{doc:"Returns the feature's id, if it has one.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},zoom:{doc:'Returns the current zoom level.  Note that in style layout and paint properties, ["zoom"] may only appear as the input to a top-level "step" or "interpolate" expression.',group:"Camera","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pitch:{doc:'Returns the current pitch in degrees. `["pitch"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0",android:"10.9.0",ios:"10.9.0"}}},"distance-from-center":{doc:'Returns the distance of a `symbol` instance from the center of the map. The distance is measured in pixels divided by the height of the map container. It measures 0 at the center, decreases towards the camera and increase away from the camera. For example, if the height of the map is 1000px, a value of -1 means 1000px away from the center towards the camera, and a value of 1 means a distance of 1000px away from the camera from the center. `["distance-from-center"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0",android:"10.9.0",ios:"10.9.0"}}},"heatmap-density":{doc:"Returns the kernel density estimation of a pixel in a heatmap layer, which is a relative measure of how many data points are crowded around a particular pixel. Can only be used in the `heatmap-color` property.",group:"Heatmap","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"line-progress":{doc:"Returns the progress along a gradient line. Can only be used in the `line-gradient` property.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.6.0",macos:"0.12.0"}}},"sky-radial-progress":{doc:"Returns the distance of a point on the sky from the sun position. Returns 0 at sun position and 1 when the distance reaches `sky-gradient-radius`. Can only be used in the `sky-gradient` property.",group:"sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},accumulated:{doc:"Returns the value of a cluster property accumulated so far. Can only be used in the `clusterProperties` option of a clustered GeoJSON source.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.53.0",android:"8.4.0",ios:"5.5.0",macos:"0.15.0"}}},"+":{doc:"Returns the sum of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"*":{doc:"Returns the product of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"-":{doc:"For two inputs, returns the result of subtracting the second input from the first. For a single input, returns the result of subtracting it from 0.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"/":{doc:"Returns the result of floating point division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"%":{doc:"Returns the remainder after integer division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"^":{doc:"Returns the result of raising the first input to the power specified by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sqrt:{doc:"Returns the square root of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log10:{doc:"Returns the base-ten logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ln:{doc:"Returns the natural logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log2:{doc:"Returns the base-two logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sin:{doc:"Returns the sine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},cos:{doc:"Returns the cosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},tan:{doc:"Returns the tangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},asin:{doc:"Returns the arcsine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},acos:{doc:"Returns the arccosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},atan:{doc:"Returns the arctangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},min:{doc:"Returns the minimum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},max:{doc:"Returns the maximum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},round:{doc:'Rounds the input to the nearest integer. Halfway values are rounded away from zero. For example, `["round", -1.5]` evaluates to -2.',group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},abs:{doc:"Returns the absolute value of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ceil:{doc:"Returns the smallest integer that is greater than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},floor:{doc:"Returns the largest integer that is less than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},distance:{doc:"Returns the shortest distance in meters between the evaluated feature and the input geometry. The input value can be a valid GeoJSON of type `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Distance values returned may vary in precision due to loss in precision from encoding geometries, particularly below zoom level 13.",group:"Math","sdk-support":{"basic functionality":{android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}}},"==":{doc:"Returns `true` if the input values are equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"!=":{doc:"Returns `true` if the input values are not equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">":{doc:"Returns `true` if the first input is strictly greater than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<":{doc:"Returns `true` if the first input is strictly less than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">=":{doc:"Returns `true` if the first input is greater than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<=":{doc:"Returns `true` if the first input is less than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},all:{doc:"Returns `true` if all the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `false`, the result is `false` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},any:{doc:"Returns `true` if any of the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `true`, the result is `true` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"!":{doc:"Logical negation. Returns `true` if the input is `false`, and `false` if the input is `true`.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},within:{doc:"Returns `true` if the evaluated feature is fully contained inside a boundary of the input geometry, `false` otherwise. The input value can be a valid GeoJSON of type `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Supported features for evaluation:\n- `Point`: Returns `false` if a point is on the boundary or falls outside the boundary.\n- `LineString`: Returns `false` if any part of a line falls outside the boundary, the line intersects the boundary, or a line's endpoint is on the boundary.",group:"Decision","sdk-support":{"basic functionality":{js:"1.9.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"is-supported-script":{doc:"",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.6.0",ios:"4.1.0",macos:"0.8.0"}}},upcase:{doc:"Returns the input string converted to uppercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},downcase:{doc:"Returns the input string converted to lowercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},concat:{doc:"Returns a `string` consisting of the concatenation of the inputs. Each input is converted to a string as if by `to-string`.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"resolved-locale":{doc:"Returns the IETF language tag of the locale being used by the provided `collator`. This can be used to determine the default system locale, or to determine if a requested locale was successfully loaded.",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"The start and end distance range in which fog fades from fully transparent to fully opaque. The distance to the point at the center of the map is defined as zero, so that negative range values are closer to the camera, and positive values are farther away.",example:[.5,10],"sdk-support":{"basic functionality":{js:"2.3.0",android:"10.6.0",ios:"10.6.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the atmosphere region immediately below the horizon and within the `range` and above the horizon and within `horizon-blend`. Using opacity is recommended only for smoothly transitioning fog on/off as anything less than 100% opacity results in more tiles loaded and drawn.","sdk-support":{"basic functionality":{js:"2.3.0",android:"10.6.0",ios:"10.6.0"}}},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the atmosphere region above the horizon, `high-color` extends further above the horizon than the `color` property and its spread can be controlled with `horizon-blend`. The opacity can be set to `0` to remove the high atmosphere color contribution.","sdk-support":{"basic functionality":{js:"2.9.0",android:"10.6.0",ios:"10.6.0"}}},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the region above the horizon and after the end of the `horizon-blend` contribution. The opacity can be set to `0` to have a transparent background.","sdk-support":{"basic functionality":{js:"2.9.0",android:"10.6.0",ios:"10.6.0"}}},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Horizon blend applies a smooth fade from the color of the atmosphere to the color of space. A value of zero leaves a sharp transition from atmosphere to space. Increasing the value blends the color of atmosphere into increasingly high angles of the sky.","sdk-support":{"basic functionality":{js:"2.3.0",android:"10.6.0",ios:"10.6.0"}}},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"A value controlling the star intensity where `0` will show no stars and `1` will show stars at their maximum intensity.","sdk-support":{"basic functionality":{js:"2.9.0",android:"10.6.0",ios:"10.6.0"}}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{doc:"The position of the light source is aligned to the rotation of the map."},viewport:{doc:"The position of the light source is aligned to the rotation of the viewport."}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},doc:"Whether extruded geometries are lit relative to the map or viewport.",example:"map","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"Position of the light source relative to lit (extruded) geometries, in [r radial coordinate, a azimuthal angle, p polar angle] where r indicates the distance from the center of the base of an object to its light, a indicates the position of the light relative to 0° (0° when `light.anchor` is set to `viewport` corresponds to the top of the viewport, or 0° when `light.anchor` is set to `map` corresponds to due north, and degrees proceed clockwise), and p indicates the height of the light (from 0°, directly above, to 180°, directly below).",example:[1.5,90,80],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Color tint for lighting extruded geometries.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Intensity of lighting (on a scale from 0 to 1). Higher numbers will present as more extreme contrast.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}}},projection:{name:{type:"enum",values:{albers:{doc:"An Albers equal-area projection centered on the continental United States. You can configure the projection for a different region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},equalEarth:{doc:"An Equal Earth projection."},equirectangular:{doc:"An Equirectangular projection. This projection is very similar to the Plate Carrée projection."},lambertConformalConic:{doc:"A Lambert conformal conic projection. You can configure the projection for a region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},mercator:{doc:"The Mercator projection is the default projection."},naturalEarth:{doc:"A Natural Earth projection."},winkelTripel:{doc:"A Winkel Tripel projection."},globe:{doc:"A globe projection."}},default:"mercator",doc:"The name of the projection to be used for rendering the map.",required:!0,"sdk-support":{"basic functionality":{js:"2.6.0"}}},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,doc:"The reference longitude and latitude of the projection. `center` takes the form of [lng, lat]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic). All other projections are centered on [0, 0].",example:[-96,37.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,doc:"The standard parallels of the projection, denoting the desired latitude range with minimal distortion. `parallels` takes the form of [lat0, lat1]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic).",example:[29.5,45.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}}},terrain:{source:{type:"string",doc:"Name of a source of `raster_dem` type to be used for terrain elevation.",required:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Exaggerates the elevation of the terrain by multiplying the data from the DEM with this value.",requires:["source"],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,doc:"Whether or not the fill should be antialiased.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill layer. In contrast to the `fill-color`, this value will also affect the 1px stroke around the fill, if the stroke is used.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",doc:"The color of the filled part of this layer. This color can be specified as `rgba` with an alpha component and the color's opacity will not affect the opacity of the 1px stroke, if it is used.",transition:!0,requires:[{"!":"fill-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{doc:"The fill is translated relative to the map."},viewport:{doc:"The fill is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-translate`.",default:"map",requires:["fill-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!1,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill extrusion layer. This is rendered on a per-layer, not per-feature, basis, and data-driven styling is not available.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",doc:"The base color of the extruded fill. The extrusion's surfaces will be shaded differently based on this color in combination with the root `light` settings. If this color is specified as `rgba` with an alpha component, the alpha component will be ignored; use `fill-extrusion-opacity` to set layer opacity.",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up (on the flat plane), respectively.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{doc:"The fill extrusion is translated relative to the map."},viewport:{doc:"The fill extrusion is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-extrusion-translate`.",default:"map",requires:["fill-extrusion-translate"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!1,doc:"Name of image in sprite to use for drawing images on extruded fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude this layer.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude the base of this layer. Must be less than or equal to `fill-extrusion-height`.",transition:!0,requires:["fill-extrusion-height"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,doc:"Whether to apply a vertical gradient to the sides of a fill-extrusion layer. If true, sides will be shaded slightly darker farther down.",transition:!1,"sdk-support":{"basic functionality":{js:"0.50.0",android:"7.0.0",ios:"4.7.0",macos:"0.13.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant",type:"number",private:!0,default:0,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Controls the intensity of shading near ground and concave angles between walls. Default value 0.0 disables ambient occlusion and values around 0.3 provide the most plausible results for buildings.","sdk-support":{"basic functionality":{js:"2.10.0",android:"10.7.0",ios:"10.7.0"}}},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant",type:"number",private:!0,default:3,minimum:0,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Shades area near ground and concave angles between walls where the radius defines only vertical impact. Default value 3.0 corresponds to height of one floor and brings the most plausible results for buildings.",requires:["fill-extrusion-edge-radius"],"sdk-support":{"basic functionality":{js:"2.10.0",android:"10.7.0",ios:"10.7.0"}}},"fill-extrusion-rounded-roof":{type:"boolean",default:!0,doc:"Indicates whether top edges should be rounded when fill-extrusion-edge-radius has a value greater than 0. If false, rounded edges are only applied to the sides. Default is true.",requires:["fill-extrusion-edge-radius"],transition:!1,"sdk-support":{"basic functionality":{js:"2.15.0",android:"10.10.0",ios:"10.10.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.23.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{doc:"The line is translated relative to the map."},viewport:{doc:"The line is translated relative to the viewport."}},doc:"Controls the frame of reference for `line-translate`.",default:"map",requires:["line-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",doc:"Stroke thickness.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,doc:"The line's offset. For linear features, a positive value offsets the line to the right, relative to the direction of the line, and a negative value to the left. For polygon features, a positive value results in an inset, and a negative value results in an outset.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.12.1",android:"3.0.0",ios:"3.1.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width. Note that GeoJSON sources with `lineMetrics: true` specified won't render dashed lines to the expected scale. Also note that zoom-dependent expressions will be evaluated only at integer zoom levels.",minimum:0,transition:!1,units:"line widths",requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{type:"resolvedImage",transition:!1,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{type:"color",doc:'Defines a gradient with which to color a line feature. Can only be used with GeoJSON sources that specify `"lineMetrics": true`.',transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],"sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.4.0",macos:"0.11.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",doc:"The line part between [trim-start, trim-end] will be marked as transparent to make a route vanishing effect. The line trim-off offset is based on the whole line range [0.0, 1.0].",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"sdk-support":{"basic functionality":{js:"2.9.0",android:"10.5.0",ios:"10.5.0",macos:"10.5.0"}},"property-type":"constant"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",doc:"Circle radius.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",doc:"The fill color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{doc:"The circle is translated relative to the map."},viewport:{doc:"The circle is translated relative to the viewport."}},doc:"Controls the frame of reference for `circle-translate`.",default:"map",requires:["circle-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{doc:"Circles are scaled according to their apparent distance to the camera."},viewport:{doc:"Circles are not scaled."}},default:"map",doc:"Controls the scaling behavior of the circle when the map is pitched.","sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{doc:"The circle is aligned to the plane of the map."},viewport:{doc:"The circle is aligned to the plane of the viewport."}},default:"viewport",doc:"Orientation of circle when map is pitched.","sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The width of the circle's stroke. Strokes are placed outside of the `circle-radius`.","sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",doc:"The stroke color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",doc:"The opacity of the circle's stroke.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",doc:"Radius of influence of one heatmap point in pixels. Increasing the value makes the heatmap smoother, but less detailed. `queryRenderedFeatures` on heatmap layers will return points within this radius.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,doc:"A measure of how much an individual point contributes to the heatmap. A value of 10 would be equivalent to having 10 points of weight 1 in the same spot. Especially useful when combined with clustering.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,doc:"Similar to `heatmap-weight` but controls the intensity of the heatmap globally. Primarily used for adjusting the heatmap based on zoom level.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],doc:'Defines the color of each pixel based on its density value in a heatmap.  Should be an expression that uses `["heatmap-density"]` as input.',transition:!1,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",doc:"The global opacity at which the heatmap layer will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#ffffff",transition:!0,doc:"",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{doc:"Icons are translated relative to the map."},viewport:{doc:"Icons are translated relative to the viewport."}},doc:"Controls the frame of reference for `icon-translate`.",default:"map",requires:["icon-image","icon-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{doc:"The text is translated relative to the map."},viewport:{doc:"The text is translated relative to the viewport."}},doc:"Controls the frame of reference for `text-translate`.",default:"map",requires:["text-field","text-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",doc:"The resampling/interpolation method to use for overscaling, also known as texture magnification filter",values:{linear:{doc:"(Bi)linear filtering interpolates pixel values using the weighted average of the four closest original source pixels creating a smooth but blurry look when overscaled"},nearest:{doc:"Nearest neighbor filtering interpolates pixel values using the nearest original source pixel creating a sharp but pixelated look when overscaled"}},default:"linear","sdk-support":{"basic functionality":{js:"0.47.0",android:"6.3.0",ios:"4.2.0",macos:"0.9.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,doc:"The direction of the light source used to generate the hillshading with 0 as the top of the viewport if `hillshade-illumination-anchor` is set to `viewport` and due north if `hillshade-illumination-anchor` is set to `map`.",transition:!1,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{doc:"The hillshade illumination is relative to the north direction."},viewport:{doc:"The hillshade illumination is relative to the top of the viewport."}},default:"viewport",doc:"Direction of light source when map is rotated.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",doc:"Intensity of the hillshade",default:.5,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",doc:"The shading color of areas that face away from the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",doc:"The shading color of areas that faces towards the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",doc:"The shading color used to accentuate rugged terrain like sharp cliffs and gorges.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",transition:!0,requires:[{"!":"background-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!1,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{doc:"Renders the sky with a gradient that can be configured with `sky-gradient-radius` and `sky-gradient`."},atmosphere:{doc:"Renders the sky with a simulated atmospheric scattering algorithm, the sun direction can be attached to the light position or explicitly set through `sky-atmosphere-sun`."}},default:"atmosphere",doc:"The type of the sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the sun center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the sun relative to 0° north, where degrees proceed clockwise. The polar angle indicates the height of the sun, where 0° is directly above, at zenith, and 90° at the horizon. When this property is ommitted, the sun center is directly inherited from the light position.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,doc:"Intensity of the sun as a light source in the atmosphere (on a scale from 0 to a 100). Setting higher values will brighten up the sky.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the gradient center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the gradient center relative to 0° north, where degrees proceed clockwise. The polar angle indicates the height of the gradient center, where 0° is directly above, at zenith, and 90° at the horizon.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,doc:"The angular distance (measured in degrees) from `sky-gradient-center` up to which the gradient extends. A value of 180 causes the gradient to wrap around to the opposite direction from `sky-gradient-center`.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],doc:"Defines a radial color gradient with which to color the sky. The color values can be interpolated with an expression using `sky-radial-progress`. The range [0, 1] for the interpolant covers a radial distance (in degrees) of [0, `sky-gradient-radius`] centered at the position specified by `sky-gradient-center`.",transition:!1,requires:[{"sky-type":"gradient"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",doc:"A color applied to the atmosphere sun halo. The alpha channel describes how strongly the sun halo is represented in an atmosphere sky layer.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",doc:"A color used to tweak the main atmospheric scattering coefficients. Using white applies the default coefficients giving the natural blue color to the atmosphere. This color affects how heavily the corresponding wavelength is represented during scattering. The alpha channel describes the density of the atmosphere, with 1 maximum density and 0 no density.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire sky layer.",transition:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}},"property-type":{"data-driven":{type:"property-type",doc:"Property is interpolable and can be represented using a property expression."},"color-ramp":{type:"property-type",doc:"Property should be specified using a color ramp from which the output color can be sampled based on a property calculation."},"data-constant":{type:"property-type",doc:"Property is interpolable but cannot be represented using a property expression."},constant:{type:"property-type",doc:"Property is constant across all zoom levels and property values."}},promoteId:{"*":{type:"string",doc:"A name of a feature property to use as ID for feature state."}}};const Gg=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Qg=Gg(void 0,(function(){return Qg.toString().search("(((.+)+)+)+$").toString().constructor(Qg).search("(((.+)+)+)+$")}));function kg(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!kg(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function zg(e,t="fill"){if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};!kg(e)&&(e=Wg(e));const r=e;let n=!0;try{n=function(e){if(!qg(e))return e;let t=Fg(e);return Hg(t),t=jg(t),t}(r)}catch(e){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nFilter Expression:\n"+JSON.stringify(r,null,2)+"\n        ")}const i=Ug["filter_"+t],o=Tn(n,i);let s=null;if("error"===o.result)throw new Error(o.value.map((e=>e.key+": "+e.message)).join(", "));s=(e,t,r)=>o.value.evaluate(e,t,{},r);let a=null,u=null;if(n!==r){const e=Tn(r,i);if("error"===e.result)throw new Error(e.value.map((e=>e.key+": "+e.message)).join(", "));a=(t,r,n,i,o)=>e.value.evaluate(t,r,{},n,void 0,void 0,i,o),u=!lt(e.value.expression)}return{filter:s,dynamicFilter:a||void 0,needGeometry:Xg(n),needFeature:!!u}}function jg(e){if(!Array.isArray(e))return e;const t=function(e){if(Vg.has(e[0]))for(let t=1;t<e.length;t++){if(qg(e[t]))return!0}return e}(e);return!0===t?t:t.map((e=>jg(e)))}function Hg(e){let t=!1;const r=[];if("case"===e[0]){for(let n=1;n<e.length-1;n+=2)t=t||qg(e[n]),r.push(e[n+1]);r.push(e[e.length-1])}else if("match"===e[0]){t=t||qg(e[1]);for(let t=2;t<e.length-1;t+=2)r.push(e[t+1]);r.push(e[e.length-1])}else if("step"===e[0]){t=t||qg(e[1]);for(let t=1;t<e.length-1;t+=2)r.push(e[t+1])}t&&(e.length=0,e.push("any",...r));for(let t=1;t<e.length;t++)Hg(e[t])}function qg(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let t=1;t<e.length;t++){if(qg(e[t]))return!0}return!1}Qg();const Vg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Yg(e,t){return e<t?-1:e>t?1:0}function Xg(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(let t=1;t<e.length;t++)if(Xg(e[t]))return!0;return!1}function Wg(e){if(!e)return!0;const t=e[0];if(e.length<=1)return"any"!==t;var r;return"=="===t?Kg(e[1],e[2],"=="):"!="===t?Zg(Kg(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Kg(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(Wg))):"all"===t?["all"].concat(e.slice(1).map(Wg)):"none"===t?["all"].concat(e.slice(1).map(Wg).map(Zg)):"in"===t?$g(e[1],e.slice(2)):"!in"===t?Zg($g(e[1],e.slice(2))):"has"===t?Jg(e[1]):"!has"===t?Zg(Jg(e[1])):"within"!==t||e}function Kg(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function $g(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(Yg)]]:["filter-in-small",e,["literal",t]]}}function Jg(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Zg(e){return["!",e]}const e_=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),t_=e_(void 0,(function(){return t_.toString().search("(((.+)+)+)+$").toString().constructor(t_).search("(((.+)+)+)+$")}));t_();const r_="-transition";class n_ extends jp{constructor(e,t,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new sf(t.layout)),t.paint)){this._transitionablePaint=new rf(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new uf(t.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,r){"visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t}getPaintProperty(e){return sp(e,r_)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(sp(e,r_))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const r=this._transitionablePaint._values[e],n=r.value.isDataDriven(),i=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const o=this._transitionablePaint._values[e].value,s=o.isDataDriven(),a=sp(e,"pattern")||"line-dasharray"===e;return s||n||a||this._handleOverridablePaintPropertyUpdate(e,i,o)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||(!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility)}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),function(e,t,r){const n={};for(const i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n}(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,r,n,i={}){return!0}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof af&&on(t.property.specification)&&(("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent))return!0}return!1}compileFilter(){!this._filterCompiled&&(this._featureFilter=zg(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const i_=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),o_=i_(void 0,(function(){return o_.toString().search("(((.+)+)+)+$").toString().constructor(o_).search("(((.+)+)+)+$")}));o_();const s_=Cf([{name:"a_pos",components:2,type:"Int16"},{name:"a_ecef_pos_high",components:3,type:"Float32"},{name:"a_ecef_pos_low",components:3,type:"Float32"}],4);var a_,u_=(a_=!0,function(e,t){var r=a_?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return a_=!1,r}),c_=u_(void 0,(function(){return c_.toString().search("(((.+)+)+)+$").toString().constructor(c_).search("(((.+)+)+)+$")}));c_();var l_=function(e){void 0===e&&(e=[]),this.segments=e};l_.prototype.prepareSegment=function(e,t,r,n){var i=this.segments[this.segments.length-1];return(!i||i.vertexLength+e>l_.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n)&&(i={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==n&&(i.sortKey=n),this.segments.push(i)),i},l_.prototype.get=function(){return this.segments},l_.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var n in r.cesiumVaos)r.cesiumVaos[n].destroy()}},l_.simpleSegment=function(e,t,r,n){return new l_([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},cesiumVaos:{},drawCommands:{},sortKey:0}])},l_.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Sp(l_,"SegmentVector");var h_,p_=(h_=!0,function(e,t){var r=h_?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return h_=!1,r}),f_=p_(void 0,(function(){return f_.toString().search("(((.+)+)+)+$").toString().constructor(f_).search("(((.+)+)+)+$")}));function d_(e,t,r){return Math.min(r,Math.max(t,e))}f_();var A_=function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));return n(),{min:-1*Math.pow(2,e-1),max:Math.pow(2,e-1)-1}}(15);function g_(e,t=!0){for(var r=Ec/e.extent,n=e.loadGeometry(),i=0;i<n.length;i++)for(var o=n[i],s=0;s<o.length;s++){var a=o[s];a.x=Math.round(a.x*r),a.y=t?Ec-Math.round(a.y*r):Math.round(a.y*r),(a.x<A_.min||a.x>A_.max||a.y<A_.min||a.y>A_.max)&&(a.x=d_(a.x,A_.min,A_.max),a.y=d_(a.y,A_.min,A_.max))}return n}var __,m_=(__=!0,function(e,t){var r=__?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return __=!1,r}),y_=m_(void 0,(function(){return y_.toString().search("(((.+)+)+)+$").toString().constructor(y_).search("(((.+)+)+)+$")}));function E_(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?g_(e):[]}}function x_(){this.high=qn.clone(qn.ZERO),this.low=qn.clone(qn.ZERO)}y_(),x_.encode=function(e,t){var r;return Un.typeOf.number("value",e),Nn(t)||(t={high:0,low:0}),e>=0?(r=65536*Math.floor(e/65536),t.high=r,t.low=e-r):(r=65536*Math.floor(-e/65536),t.high=-r,t.low=e+r),t};var C_={high:0,low:0};x_.fromCartesian=function(e,t){Un.typeOf.object("cartesian",e),Nn(t)||(t=new x_);var r=t.high,n=t.low;return x_.encode(e.x,C_),r.x=C_.high,n.x=C_.low,x_.encode(e.y,C_),r.y=C_.high,n.y=C_.low,x_.encode(e.z,C_),r.z=C_.high,n.z=C_.low,t};var b_=new x_;x_.writeElements=function(e,t,r){Un.defined("cartesianArray",t),Un.typeOf.number("index",r),Un.typeOf.number.greaterThanOrEquals("index",r,0),x_.fromCartesian(e,b_);var n=b_.high,i=b_.low;t[r]=n.x,t[r+1]=n.y,t[r+2]=n.z,t[r+3]=i.x,t[r+4]=i.y,t[r+5]=i.z};const I_=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),v_=I_(void 0,(function(){return v_.toString().search("(((.+)+)+)+$").toString().constructor(v_).search("(((.+)+)+)+$")}));function T_(e,t,r,n,i,o,s){e.emplaceBack(2*t+(n+1)/2,2*r+(i+1)/2,o.x,o.y,o.z,s.x,s.y,s.z)}v_();class R_{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Df,this.indexArray=new Hf,this.segments=new l_,this.programConfigurations=new Rg(s_.members,e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r,n){const i=this.layers[0],o=[];let s=null;"circle"===i.type&&(s=i.layout.get("circle-sort-key"));for(const{feature:t,id:n,index:i,sourceLayerIndex:u}of e){const e=this.layers[0]._featureFilter.needGeometry,c=E_(t,e);var a=new $p(this.zoom);if(!this.layers[0]._featureFilter.filter(a,c,r))continue;const l=s?s.evaluate(c,{},r):void 0,h={id:n,properties:t.properties,type:t.type,sourceLayerIndex:u,index:i,geometry:e?c.geometry:g_(t,r),patterns:{},sortKey:l};o.push(h)}s&&o.sort(((e,t)=>e.sortKey-t.sortKey));for(const n of o){const{geometry:i,index:o,sourceLayerIndex:s}=n,a=e[o].feature;this.addFeature(n,i,o,t.availableImages,r,null,t.crs),t.featureIndex.insert(a,i,o,s,this.index)}}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){!this.uploaded&&(this.layoutVertexBuffer=lg.toVertexBuffer(e,this.layoutVertexArray,s_.members),this.indexBuffer=lg.toIndexBuffer(e,this.indexArray),this.globeExtVertexArray&&this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=lg.toVertexBuffer(e,this.globeExtVertexArray,circleGlobeAttributesExt.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,t,r,n,i,o,s){for(const r of t)for(const t of r){const r=t.x,n=t.y;if(r<0||r>=Ec||n<0||n>=Ec)continue;const o=Ap(s,r,n,i),a=x_.fromCartesian(o),u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),c=u.vertexLength;T_(this.layoutVertexArray,r,n,-1,-1,a.high,a.low),T_(this.layoutVertexArray,r,n,1,-1,a.high,a.low),T_(this.layoutVertexArray,r,n,1,1,a.high,a.low),T_(this.layoutVertexArray,r,n,-1,1,a.high,a.low),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+2,c+3),u.vertexLength+=4,u.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n,i)}}Sp(R_,"CircleBucket",{omit:["layers"]});const S_=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),M_=S_(void 0,(function(){return M_.toString().search("(((.+)+)+)+$").toString().constructor(M_).search("(((.+)+)+)+$")}));function w_(e,t){for(let r=0;r<e.length;r++)if(L_(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(L_(e,t[r]))return!0;return!!D_(e,t)}function B_(e,t){if(1===e.length)return N_(t,e[0]);for(let r=0;r<t.length;r++){const n=t[r];for(let t=0;t<n.length;t++)if(L_(e,n[t]))return!0}for(let r=0;r<e.length;r++)if(N_(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(D_(e,t[r]))return!0;return!1}function O_(e,t,r){if(e.length>1){if(D_(e,t))return!0;for(let n=0;n<t.length;n++)if(F_(t[n],e,r))return!0}for(let n=0;n<e.length;n++)if(F_(e[n],t,r))return!0;return!1}function D_(e,t){if(0===e.length||0===t.length)return!1;for(let s=0;s<e.length-1;s++){const a=e[s],u=e[s+1];for(let e=0;e<t.length-1;e++){const s=t[e],c=t[e+1];if(n=u,hp(r=a,i=s,o=c)!==hp(n,i,o)&&hp(r,n,i)!==hp(r,n,o))return!0}}var r,n,i,o;return!1}function F_(e,t,r){const n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(let r=1;r<t.length;r++){if(P_(e,t[r-1],t[r])<n)return!0}return!1}function P_(e,t,r){const n=t.distSqr(r);if(0===n)return e.distSqr(t);const i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return i<0?e.distSqr(t):i>1?e.distSqr(r):e.distSqr(r.sub(t)._mult(i)._add(t))}function N_(e,t){let r,n,i,o=!1;for(let s=0;s<e.length;s++){r=e[s];for(let e=0,s=r.length-1;e<r.length;s=e++)n=r[e],i=r[s],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(o=!o)}return o}function L_(e,t){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){const o=e[n],s=e[i];o.y>t.y!=s.y>t.y&&t.x<(s.x-o.x)*(t.y-o.y)/(s.y-o.y)+o.x&&(r=!r)}return r}function U_(e,t,r){const n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;const o=hp(e,t,r[0]);return o!==hp(e,t,r[1])||o!==hp(e,t,r[2])||o!==hp(e,t,r[3])}M_();const G_=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Q_=G_(void 0,(function(){return Q_.toString().search("(((.+)+)+)+$").toString().constructor(Q_).search("(((.+)+)+)+$")}));function k_(e,t,r){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function z_(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function j_(e,t,r,n,i){if(!t[0]&&!t[1])return e;const o=Pn.convert(t)._mult(i);"viewport"===r&&o._rotate(-n);const s=[];for(let t=0;t<e.length;t++){const r=e[t];s.push(r.sub(o))}return s}function H_(e,t,r,n){const i=Pn.convert(e)._mult(n);return"viewport"===t&&i._rotate(-r),i}Q_();const q_=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),V_=q_(void 0,(function(){return V_.toString().search("(((.+)+)+)+$").toString().constructor(V_).search("(((.+)+)+)+$")}));V_();const Y_=new pf({"circle-sort-key":new lf(Ug.layout_circle["circle-sort-key"])});var X_,W_={paint:new pf({"circle-radius":new lf(Ug.paint_circle["circle-radius"]),"circle-color":new lf(Ug.paint_circle["circle-color"]),"circle-blur":new lf(Ug.paint_circle["circle-blur"]),"circle-opacity":new lf(Ug.paint_circle["circle-opacity"]),"circle-translate":new cf(Ug.paint_circle["circle-translate"]),"circle-translate-anchor":new cf(Ug.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new cf(Ug.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new cf(Ug.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new lf(Ug.paint_circle["circle-stroke-width"]),"circle-stroke-color":new lf(Ug.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new lf(Ug.paint_circle["circle-stroke-opacity"])}),layout:Y_},K_=(X_=!0,function(e,t){var r=X_?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return X_=!1,r}),$_=K_(void 0,(function(){return $_.toString().search("(((.+)+)+)+$").toString().constructor($_).search("(((.+)+)+)+$")}));function J_(){}$_();var Z_=1e-6,em="undefined"!=typeof Float32Array?Float32Array:Array,tm=Math.random;var rm=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var nm=Object.freeze({EPSILON:Z_,get ARRAY_TYPE(){return em},RANDOM:tm,setMatrixArrayType:function(e){em=e},toRadian:function(e){return e*rm},equals:function(e,t){return Math.abs(e-t)<=Z_*Math.max(1,Math.abs(e),Math.abs(t))}});function im(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=r[0],u=r[1],c=r[2],l=r[3];return e[0]=n*a+o*u,e[1]=i*a+s*u,e[2]=n*c+o*l,e[3]=i*c+s*l,e}function om(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}var sm=im,am=om,um=Object.freeze({create:function(){var e=new em(4);return em!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},clone:function(e){var t=new em(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},fromValues:function(e,t,r,n){var i=new em(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},set:function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},transpose:function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=r*o-i*n;return s?(s=1/s,e[0]=o*s,e[1]=-n*s,e[2]=-i*s,e[3]=r*s,e):null},adjoint:function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},multiply:im,rotate:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*a,e[1]=i*u+s*a,e[2]=n*-a+o*u,e[3]=i*-a+s*u,e},scale:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=r[0],u=r[1];return e[0]=n*a,e[1]=i*a,e[2]=o*u,e[3]=s*u,e},fromRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},str:function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3])},LDU:function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},subtract:om,exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},equals:function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=t[0],a=t[1],u=t[2],c=t[3];return Math.abs(r-s)<=Z_*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=Z_*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=Z_*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=Z_*Math.max(1,Math.abs(o),Math.abs(c))},multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},mul:sm,sub:am});function cm(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=r[0],l=r[1],h=r[2],p=r[3],f=r[4],d=r[5];return e[0]=n*c+o*l,e[1]=i*c+s*l,e[2]=n*h+o*p,e[3]=i*h+s*p,e[4]=n*f+o*d+a,e[5]=i*f+s*d+u,e}function lm(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}var hm=cm,pm=lm,fm=Object.freeze({create:function(){var e=new em(6);return em!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},clone:function(e){var t=new em(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},fromValues:function(e,t,r,n,i,o){var s=new em(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s},set:function(e,t,r,n,i,o,s){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=s,e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=r*o-n*i;return u?(u=1/u,e[0]=o*u,e[1]=-n*u,e[2]=-i*u,e[3]=r*u,e[4]=(i*a-o*s)*u,e[5]=(n*s-r*a)*u,e):null},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:cm,rotate:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+o*c,e[1]=i*l+s*c,e[2]=n*-c+o*l,e[3]=i*-c+s*l,e[4]=a,e[5]=u,e},scale:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=r[0],l=r[1];return e[0]=n*c,e[1]=i*c,e[2]=o*l,e[3]=s*l,e[4]=a,e[5]=u,e},translate:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=r[0],l=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=n*c+o*l+a,e[5]=i*c+s*l+u,e},fromRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},subtract:lm,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},equals:function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=t[0],c=t[1],l=t[2],h=t[3],p=t[4],f=t[5];return Math.abs(r-u)<=Z_*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=Z_*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-l)<=Z_*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-h)<=Z_*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-p)<=Z_*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-f)<=Z_*Math.max(1,Math.abs(a),Math.abs(f))},mul:hm,sub:pm});function dm(){var e=new em(9);return em!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Am(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],p=r[0],f=r[1],d=r[2],A=r[3],g=r[4],_=r[5],m=r[6],y=r[7],E=r[8];return e[0]=p*n+f*s+d*c,e[1]=p*i+f*a+d*l,e[2]=p*o+f*u+d*h,e[3]=A*n+g*s+_*c,e[4]=A*i+g*a+_*l,e[5]=A*o+g*u+_*h,e[6]=m*n+y*s+E*c,e[7]=m*i+y*a+E*l,e[8]=m*o+y*u+E*h,e}function gm(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}var _m=Am,mm=gm,ym=Object.freeze({create:dm,fromMat4:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},clone:function(e){var t=new em(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromValues:function(e,t,r,n,i,o,s,a,u){var c=new em(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=i,c[5]=o,c[6]=s,c[7]=a,c[8]=u,c},set:function(e,t,r,n,i,o,s,a,u,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=s,e[6]=a,e[7]=u,e[8]=c,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],h=l*s-a*c,p=-l*o+a*u,f=c*o-s*u,d=r*h+n*p+i*f;return d?(d=1/d,e[0]=h*d,e[1]=(-l*n+i*c)*d,e[2]=(a*n-i*s)*d,e[3]=p*d,e[4]=(l*r-i*u)*d,e[5]=(-a*r+i*o)*d,e[6]=f*d,e[7]=(-c*r+n*u)*d,e[8]=(s*r-n*o)*d,e):null},adjoint:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8];return e[0]=s*l-a*c,e[1]=i*c-n*l,e[2]=n*a-i*s,e[3]=a*u-o*l,e[4]=r*l-i*u,e[5]=i*o-r*a,e[6]=o*c-s*u,e[7]=n*u-r*c,e[8]=r*s-n*o,e},determinant:function(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8];return t*(c*o-s*u)+r*(-c*i+s*a)+n*(u*i-o*a)},multiply:Am,translate:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],p=r[0],f=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=u,e[6]=p*n+f*s+c,e[7]=p*i+f*a+l,e[8]=p*o+f*u+h,e},rotate:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],p=Math.sin(r),f=Math.cos(r);return e[0]=f*n+p*s,e[1]=f*i+p*a,e[2]=f*o+p*u,e[3]=f*s-p*n,e[4]=f*a-p*i,e[5]=f*u-p*o,e[6]=c,e[7]=l,e[8]=h,e},scale:function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},fromRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromQuat:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,a=n+n,u=i+i,c=r*s,l=n*s,h=n*a,p=i*s,f=i*a,d=i*u,A=o*s,g=o*a,_=o*u;return e[0]=1-h-d,e[3]=l-_,e[6]=p+g,e[1]=l+_,e[4]=1-c-d,e[7]=f-A,e[2]=p-g,e[5]=f+A,e[8]=1-c-h,e},normalFromMat4:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],h=t[9],p=t[10],f=t[11],d=t[12],A=t[13],g=t[14],_=t[15],m=r*a-n*s,y=r*u-i*s,E=r*c-o*s,x=n*u-i*a,C=n*c-o*a,b=i*c-o*u,I=l*A-h*d,v=l*g-p*d,T=l*_-f*d,R=h*g-p*A,S=h*_-f*A,M=p*_-f*g,w=m*M-y*S+E*R+x*T-C*v+b*I;return w?(w=1/w,e[0]=(a*M-u*S+c*R)*w,e[1]=(u*T-s*M-c*v)*w,e[2]=(s*S-a*T+c*I)*w,e[3]=(i*S-n*M-o*R)*w,e[4]=(r*M-i*T+o*v)*w,e[5]=(n*T-r*S-o*I)*w,e[6]=(A*b-g*C+_*x)*w,e[7]=(g*E-d*b-_*y)*w,e[8]=(d*C-A*E+_*m)*w,e):null},projection:function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},subtract:gm,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},equals:function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=t[0],p=t[1],f=t[2],d=t[3],A=t[4],g=t[5],_=t[6],m=t[7],y=t[8];return Math.abs(r-h)<=Z_*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-p)<=Z_*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(i-f)<=Z_*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-d)<=Z_*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-A)<=Z_*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(a-g)<=Z_*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(u-_)<=Z_*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(c-m)<=Z_*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(l-y)<=Z_*Math.max(1,Math.abs(l),Math.abs(y))},mul:_m,sub:mm});function Em(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function xm(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],p=t[9],f=t[10],d=t[11],A=t[12],g=t[13],_=t[14],m=t[15],y=r[0],E=r[1],x=r[2],C=r[3];return e[0]=y*n+E*a+x*h+C*A,e[1]=y*i+E*u+x*p+C*g,e[2]=y*o+E*c+x*f+C*_,e[3]=y*s+E*l+x*d+C*m,y=r[4],E=r[5],x=r[6],C=r[7],e[4]=y*n+E*a+x*h+C*A,e[5]=y*i+E*u+x*p+C*g,e[6]=y*o+E*c+x*f+C*_,e[7]=y*s+E*l+x*d+C*m,y=r[8],E=r[9],x=r[10],C=r[11],e[8]=y*n+E*a+x*h+C*A,e[9]=y*i+E*u+x*p+C*g,e[10]=y*o+E*c+x*f+C*_,e[11]=y*s+E*l+x*d+C*m,y=r[12],E=r[13],x=r[14],C=r[15],e[12]=y*n+E*a+x*h+C*A,e[13]=y*i+E*u+x*p+C*g,e[14]=y*o+E*c+x*f+C*_,e[15]=y*s+E*l+x*d+C*m,e}function Cm(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=n+n,u=i+i,c=o+o,l=n*a,h=n*u,p=n*c,f=i*u,d=i*c,A=o*c,g=s*a,_=s*u,m=s*c;return e[0]=1-(f+A),e[1]=h+m,e[2]=p-_,e[3]=0,e[4]=h-m,e[5]=1-(l+A),e[6]=d+g,e[7]=0,e[8]=p+_,e[9]=d-g,e[10]=1-(l+f),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function bm(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Im(e,t){var r=t[0],n=t[1],i=t[2],o=t[4],s=t[5],a=t[6],u=t[8],c=t[9],l=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(o,s,a),e[2]=Math.hypot(u,c,l),e}function vm(e,t){var r=new em(3);Im(r,t);var n=1/r[0],i=1/r[1],o=1/r[2],s=t[0]*n,a=t[1]*i,u=t[2]*o,c=t[4]*n,l=t[5]*i,h=t[6]*o,p=t[8]*n,f=t[9]*i,d=t[10]*o,A=s+l+d,g=0;return A>0?(g=2*Math.sqrt(A+1),e[3]=.25*g,e[0]=(h-f)/g,e[1]=(p-u)/g,e[2]=(a-c)/g):s>l&&s>d?(g=2*Math.sqrt(1+s-l-d),e[3]=(h-f)/g,e[0]=.25*g,e[1]=(a+c)/g,e[2]=(p+u)/g):l>d?(g=2*Math.sqrt(1+l-s-d),e[3]=(p-u)/g,e[0]=(a+c)/g,e[1]=.25*g,e[2]=(h+f)/g):(g=2*Math.sqrt(1+d-s-l),e[3]=(a-c)/g,e[0]=(p+u)/g,e[1]=(h+f)/g,e[2]=.25*g),e}function Tm(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}var Rm=xm,Sm=Tm,Mm=Object.freeze({create:function(){var e=new em(16);return em!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},clone:function(e){var t=new em(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A){var g=new em(16);return g[0]=e,g[1]=t,g[2]=r,g[3]=n,g[4]=i,g[5]=o,g[6]=s,g[7]=a,g[8]=u,g[9]=c,g[10]=l,g[11]=h,g[12]=p,g[13]=f,g[14]=d,g[15]=A,g},set:function(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=s,e[6]=a,e[7]=u,e[8]=c,e[9]=l,e[10]=h,e[11]=p,e[12]=f,e[13]=d,e[14]=A,e[15]=g,e},identity:Em,transpose:function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],o=t[6],s=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],h=t[9],p=t[10],f=t[11],d=t[12],A=t[13],g=t[14],_=t[15],m=r*a-n*s,y=r*u-i*s,E=r*c-o*s,x=n*u-i*a,C=n*c-o*a,b=i*c-o*u,I=l*A-h*d,v=l*g-p*d,T=l*_-f*d,R=h*g-p*A,S=h*_-f*A,M=p*_-f*g,w=m*M-y*S+E*R+x*T-C*v+b*I;return w?(w=1/w,e[0]=(a*M-u*S+c*R)*w,e[1]=(i*S-n*M-o*R)*w,e[2]=(A*b-g*C+_*x)*w,e[3]=(p*C-h*b-f*x)*w,e[4]=(u*T-s*M-c*v)*w,e[5]=(r*M-i*T+o*v)*w,e[6]=(g*E-d*b-_*y)*w,e[7]=(l*b-p*E+f*y)*w,e[8]=(s*S-a*T+c*I)*w,e[9]=(n*T-r*S-o*I)*w,e[10]=(d*C-A*E+_*m)*w,e[11]=(h*E-l*C-f*m)*w,e[12]=(a*v-s*R-u*I)*w,e[13]=(r*R-n*v+i*I)*w,e[14]=(A*y-d*x-g*m)*w,e[15]=(l*x-h*y+p*m)*w,e):null},adjoint:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],h=t[9],p=t[10],f=t[11],d=t[12],A=t[13],g=t[14],_=t[15];return e[0]=a*(p*_-f*g)-h*(u*_-c*g)+A*(u*f-c*p),e[1]=-(n*(p*_-f*g)-h*(i*_-o*g)+A*(i*f-o*p)),e[2]=n*(u*_-c*g)-a*(i*_-o*g)+A*(i*c-o*u),e[3]=-(n*(u*f-c*p)-a*(i*f-o*p)+h*(i*c-o*u)),e[4]=-(s*(p*_-f*g)-l*(u*_-c*g)+d*(u*f-c*p)),e[5]=r*(p*_-f*g)-l*(i*_-o*g)+d*(i*f-o*p),e[6]=-(r*(u*_-c*g)-s*(i*_-o*g)+d*(i*c-o*u)),e[7]=r*(u*f-c*p)-s*(i*f-o*p)+l*(i*c-o*u),e[8]=s*(h*_-f*A)-l*(a*_-c*A)+d*(a*f-c*h),e[9]=-(r*(h*_-f*A)-l*(n*_-o*A)+d*(n*f-o*h)),e[10]=r*(a*_-c*A)-s*(n*_-o*A)+d*(n*c-o*a),e[11]=-(r*(a*f-c*h)-s*(n*f-o*h)+l*(n*c-o*a)),e[12]=-(s*(h*g-p*A)-l*(a*g-u*A)+d*(a*p-u*h)),e[13]=r*(h*g-p*A)-l*(n*g-i*A)+d*(n*p-i*h),e[14]=-(r*(a*g-u*A)-s*(n*g-i*A)+d*(n*u-i*a)),e[15]=r*(a*p-u*h)-s*(n*p-i*h)+l*(n*u-i*a),e},determinant:function(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],p=e[11],f=e[12],d=e[13],A=e[14],g=e[15];return(t*s-r*o)*(h*g-p*A)-(t*a-n*o)*(l*g-p*d)+(t*u-i*o)*(l*A-h*d)+(r*a-n*s)*(c*g-p*f)-(r*u-i*s)*(c*A-h*f)+(n*u-i*a)*(c*d-l*f)},multiply:xm,translate:function(e,t,r){var n,i,o,s,a,u,c,l,h,p,f,d,A=r[0],g=r[1],_=r[2];return t===e?(e[12]=t[0]*A+t[4]*g+t[8]*_+t[12],e[13]=t[1]*A+t[5]*g+t[9]*_+t[13],e[14]=t[2]*A+t[6]*g+t[10]*_+t[14],e[15]=t[3]*A+t[7]*g+t[11]*_+t[15]):(n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],p=t[9],f=t[10],d=t[11],e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=u,e[6]=c,e[7]=l,e[8]=h,e[9]=p,e[10]=f,e[11]=d,e[12]=n*A+a*g+h*_+t[12],e[13]=i*A+u*g+p*_+t[13],e[14]=o*A+c*g+f*_+t[14],e[15]=s*A+l*g+d*_+t[15]),e},scale:function(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},rotate:function(e,t,r,n){var i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E,x,C,b,I,v,T,R,S=n[0],M=n[1],w=n[2],B=Math.hypot(S,M,w);return B<Z_?null:(S*=B=1/B,M*=B,w*=B,i=Math.sin(r),s=1-(o=Math.cos(r)),a=t[0],u=t[1],c=t[2],l=t[3],h=t[4],p=t[5],f=t[6],d=t[7],A=t[8],g=t[9],_=t[10],m=t[11],y=S*S*s+o,E=M*S*s+w*i,x=w*S*s-M*i,C=S*M*s-w*i,b=M*M*s+o,I=w*M*s+S*i,v=S*w*s+M*i,T=M*w*s-S*i,R=w*w*s+o,e[0]=a*y+h*E+A*x,e[1]=u*y+p*E+g*x,e[2]=c*y+f*E+_*x,e[3]=l*y+d*E+m*x,e[4]=a*C+h*b+A*I,e[5]=u*C+p*b+g*I,e[6]=c*C+f*b+_*I,e[7]=l*C+d*b+m*I,e[8]=a*v+h*T+A*R,e[9]=u*v+p*T+g*R,e[10]=c*v+f*T+_*R,e[11]=l*v+d*T+m*R,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},rotateX:function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],h=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*n,e[5]=s*i+l*n,e[6]=a*i+h*n,e[7]=u*i+p*n,e[8]=c*i-o*n,e[9]=l*i-s*n,e[10]=h*i-a*n,e[11]=p*i-u*n,e},rotateY:function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],a=t[2],u=t[3],c=t[8],l=t[9],h=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*n,e[1]=s*i-l*n,e[2]=a*i-h*n,e[3]=u*i-p*n,e[8]=o*n+c*i,e[9]=s*n+l*i,e[10]=a*n+h*i,e[11]=u*n+p*i,e},rotateZ:function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],s=t[1],a=t[2],u=t[3],c=t[4],l=t[5],h=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*n,e[1]=s*i+l*n,e[2]=a*i+h*n,e[3]=u*i+p*n,e[4]=c*i-o*n,e[5]=l*i-s*n,e[6]=h*i-a*n,e[7]=p*i-u*n,e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotation:function(e,t,r){var n,i,o,s=r[0],a=r[1],u=r[2],c=Math.hypot(s,a,u);return c<Z_?null:(s*=c=1/c,a*=c,u*=c,n=Math.sin(t),o=1-(i=Math.cos(t)),e[0]=s*s*o+i,e[1]=a*s*o+u*n,e[2]=u*s*o-a*n,e[3]=0,e[4]=s*a*o-u*n,e[5]=a*a*o+i,e[6]=u*a*o+s*n,e[7]=0,e[8]=s*u*o+a*n,e[9]=a*u*o-s*n,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},fromXRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromYRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromZRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotationTranslation:Cm,fromQuat2:function(e,t){var r=new em(3),n=-t[0],i=-t[1],o=-t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=n*n+i*i+o*o+s*s;return h>0?(r[0]=2*(a*s+l*n+u*o-c*i)/h,r[1]=2*(u*s+l*i+c*n-a*o)/h,r[2]=2*(c*s+l*o+a*i-u*n)/h):(r[0]=2*(a*s+l*n+u*o-c*i),r[1]=2*(u*s+l*i+c*n-a*o),r[2]=2*(c*s+l*o+a*i-u*n)),Cm(e,t,r),e},getTranslation:bm,getScaling:Im,getRotation:vm,fromRotationTranslationScale:function(e,t,r,n){var i=t[0],o=t[1],s=t[2],a=t[3],u=i+i,c=o+o,l=s+s,h=i*u,p=i*c,f=i*l,d=o*c,A=o*l,g=s*l,_=a*u,m=a*c,y=a*l,E=n[0],x=n[1],C=n[2];return e[0]=(1-(d+g))*E,e[1]=(p+y)*E,e[2]=(f-m)*E,e[3]=0,e[4]=(p-y)*x,e[5]=(1-(h+g))*x,e[6]=(A+_)*x,e[7]=0,e[8]=(f+m)*C,e[9]=(A-_)*C,e[10]=(1-(h+d))*C,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},fromRotationTranslationScaleOrigin:function(e,t,r,n,i){var o=t[0],s=t[1],a=t[2],u=t[3],c=o+o,l=s+s,h=a+a,p=o*c,f=o*l,d=o*h,A=s*l,g=s*h,_=a*h,m=u*c,y=u*l,E=u*h,x=n[0],C=n[1],b=n[2],I=i[0],v=i[1],T=i[2],R=(1-(A+_))*x,S=(f+E)*x,M=(d-y)*x,w=(f-E)*C,B=(1-(p+_))*C,O=(g+m)*C,D=(d+y)*b,F=(g-m)*b,P=(1-(p+A))*b;return e[0]=R,e[1]=S,e[2]=M,e[3]=0,e[4]=w,e[5]=B,e[6]=O,e[7]=0,e[8]=D,e[9]=F,e[10]=P,e[11]=0,e[12]=r[0]+I-(R*I+w*v+D*T),e[13]=r[1]+v-(S*I+B*v+F*T),e[14]=r[2]+T-(M*I+O*v+P*T),e[15]=1,e},fromQuat:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=r+r,a=n+n,u=i+i,c=r*s,l=n*s,h=n*a,p=i*s,f=i*a,d=i*u,A=o*s,g=o*a,_=o*u;return e[0]=1-h-d,e[1]=l+_,e[2]=p-g,e[3]=0,e[4]=l-_,e[5]=1-c-d,e[6]=f+A,e[7]=0,e[8]=p+g,e[9]=f-A,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},frustum:function(e,t,r,n,i,o,s){var a=1/(r-t),u=1/(i-n),c=1/(o-s);return e[0]=2*o*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(r+t)*a,e[9]=(i+n)*u,e[10]=(s+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*c,e[15]=0,e},perspective:function(e,t,r,n,i){var o,s=1/Math.tan(t/2);return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e},perspectiveFromFieldOfView:function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),u=2/(s+a),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(s-a)*u*.5,e[9]=(i-o)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},ortho:function(e,t,r,n,i,o,s){var a=1/(t-r),u=1/(n-i),c=1/(o-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*a,e[13]=(i+n)*u,e[14]=(s+o)*c,e[15]=1,e},lookAt:function(e,t,r,n){var i,o,s,a,u,c,l,h,p,f,d=t[0],A=t[1],g=t[2],_=n[0],m=n[1],y=n[2],E=r[0],x=r[1],C=r[2];return Math.abs(d-E)<Z_&&Math.abs(A-x)<Z_&&Math.abs(g-C)<Z_?Em(e):(l=d-E,h=A-x,p=g-C,i=m*(p*=f=1/Math.hypot(l,h,p))-y*(h*=f),o=y*(l*=f)-_*p,s=_*h-m*l,(f=Math.hypot(i,o,s))?(i*=f=1/f,o*=f,s*=f):(i=0,o=0,s=0),a=h*s-p*o,u=p*i-l*s,c=l*o-h*i,(f=Math.hypot(a,u,c))?(a*=f=1/f,u*=f,c*=f):(a=0,u=0,c=0),e[0]=i,e[1]=a,e[2]=l,e[3]=0,e[4]=o,e[5]=u,e[6]=h,e[7]=0,e[8]=s,e[9]=c,e[10]=p,e[11]=0,e[12]=-(i*d+o*A+s*g),e[13]=-(a*d+u*A+c*g),e[14]=-(l*d+h*A+p*g),e[15]=1,e)},targetTo:function(e,t,r,n){var i=t[0],o=t[1],s=t[2],a=n[0],u=n[1],c=n[2],l=i-r[0],h=o-r[1],p=s-r[2],f=l*l+h*h+p*p;f>0&&(l*=f=1/Math.sqrt(f),h*=f,p*=f);var d=u*p-c*h,A=c*l-a*p,g=a*h-u*l;return(f=d*d+A*A+g*g)>0&&(d*=f=1/Math.sqrt(f),A*=f,g*=f),e[0]=d,e[1]=A,e[2]=g,e[3]=0,e[4]=h*g-p*A,e[5]=p*d-l*g,e[6]=l*A-h*d,e[7]=0,e[8]=l,e[9]=h,e[10]=p,e[11]=0,e[12]=i,e[13]=o,e[14]=s,e[15]=1,e},str:function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},subtract:Tm,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},equals:function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],p=e[10],f=e[11],d=e[12],A=e[13],g=e[14],_=e[15],m=t[0],y=t[1],E=t[2],x=t[3],C=t[4],b=t[5],I=t[6],v=t[7],T=t[8],R=t[9],S=t[10],M=t[11],w=t[12],B=t[13],O=t[14],D=t[15];return Math.abs(r-m)<=Z_*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(n-y)<=Z_*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-E)<=Z_*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(o-x)<=Z_*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-C)<=Z_*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(a-b)<=Z_*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(u-I)<=Z_*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(c-v)<=Z_*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(l-T)<=Z_*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(h-R)<=Z_*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(p-S)<=Z_*Math.max(1,Math.abs(p),Math.abs(S))&&Math.abs(f-M)<=Z_*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(d-w)<=Z_*Math.max(1,Math.abs(d),Math.abs(w))&&Math.abs(A-B)<=Z_*Math.max(1,Math.abs(A),Math.abs(B))&&Math.abs(g-O)<=Z_*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(_-D)<=Z_*Math.max(1,Math.abs(_),Math.abs(D))},mul:Rm,sub:Sm});function wm(){var e=new em(3);return em!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Bm(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function Om(e,t,r){var n=new em(3);return n[0]=e,n[1]=t,n[2]=r,n}function Dm(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Fm(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function Pm(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Nm(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(r,n,i)}function Lm(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function Um(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function Gm(e,t){var r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function Qm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function km(e,t,r){var n=t[0],i=t[1],o=t[2],s=r[0],a=r[1],u=r[2];return e[0]=i*u-o*a,e[1]=o*s-n*u,e[2]=n*a-i*s,e}var zm,jm=Dm,Hm=Fm,qm=Pm,Vm=Nm,Ym=Lm,Xm=Bm,Wm=Um,Km=(zm=wm(),function(e,t,r,n,i,o){var s,a;for(!t&&(t=3),!r&&(r=0),a=n?Math.min(n*t+r,e.length):e.length,s=r;s<a;s+=t)zm[0]=e[s],zm[1]=e[s+1],zm[2]=e[s+2],i(zm,zm,o),e[s]=zm[0],e[s+1]=zm[1],e[s+2]=zm[2];return e}),$m=Object.freeze({create:wm,clone:function(e){var t=new em(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},length:Bm,fromValues:Om,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},set:function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},subtract:Dm,multiply:Fm,divide:Pm,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},min:function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},max:function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},scale:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},scaleAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},distance:Nm,squaredDistance:Lm,squaredLength:Um,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},normalize:Gm,dot:Qm,cross:km,lerp:function(e,t,r,n){var i=t[0],o=t[1],s=t[2];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=s+n*(r[2]-s),e},hermite:function(e,t,r,n,i,o){var s=o*o,a=s*(2*o-3)+1,u=s*(o-2)+o,c=s*(o-1),l=s*(3-2*o);return e[0]=t[0]*a+r[0]*u+n[0]*c+i[0]*l,e[1]=t[1]*a+r[1]*u+n[1]*c+i[1]*l,e[2]=t[2]*a+r[2]*u+n[2]*c+i[2]*l,e},bezier:function(e,t,r,n,i,o){var s=1-o,a=s*s,u=o*o,c=a*s,l=3*o*a,h=3*u*s,p=u*o;return e[0]=t[0]*c+r[0]*l+n[0]*h+i[0]*p,e[1]=t[1]*c+r[1]*l+n[1]*h+i[1]*p,e[2]=t[2]*c+r[2]*l+n[2]*h+i[2]*p,e},random:function(e,t){t=t||1;var r=2*tm()*Math.PI,n=2*tm()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e},transformMat4:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,e},transformMat3:function(e,t,r){var n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e},transformQuat:function(e,t,r){var n=r[0],i=r[1],o=r[2],s=r[3],a=t[0],u=t[1],c=t[2],l=i*c-o*u,h=o*a-n*c,p=n*u-i*a,f=i*p-o*h,d=o*l-n*p,A=n*h-i*l,g=2*s;return l*=g,h*=g,p*=g,f*=2,d*=2,A*=2,e[0]=a+l+f,e[1]=u+h+d,e[2]=c+p+A,e},rotateX:function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},rotateY:function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},rotateZ:function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},angle:function(e,t){var r=Om(e[0],e[1],e[2]),n=Om(t[0],t[1],t[2]);Gm(r,r),Gm(n,n);var i=Qm(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)},zero:function(e){return e[0]=0,e[1]=0,e[2]=0,e},str:function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},equals:function(e,t){var r=e[0],n=e[1],i=e[2],o=t[0],s=t[1],a=t[2];return Math.abs(r-o)<=Z_*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=Z_*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=Z_*Math.max(1,Math.abs(i),Math.abs(a))},sub:jm,mul:Hm,div:qm,dist:Vm,sqrDist:Ym,len:Xm,sqrLen:Wm,forEach:Km});function Jm(){var e=new em(4);return em!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Zm(e){var t=new em(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function ey(e,t,r,n){var i=new em(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function ty(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function ry(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function ny(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function iy(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function oy(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function sy(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function ay(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function uy(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.hypot(r,n,i,o)}function cy(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o}function ly(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function hy(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function py(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=n*s,e[2]=i*s,e[3]=o*s,e}function fy(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function dy(e,t,r,n){var i=t[0],o=t[1],s=t[2],a=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=s+n*(r[2]-s),e[3]=a+n*(r[3]-a),e}function Ay(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function gy(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=t[0],a=t[1],u=t[2],c=t[3];return Math.abs(r-s)<=Z_*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=Z_*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=Z_*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=Z_*Math.max(1,Math.abs(o),Math.abs(c))}var _y,my=iy,yy=oy,Ey=sy,xy=uy,Cy=cy,by=ly,Iy=hy,vy=(_y=Jm(),function(e,t,r,n,i,o){var s,a;for(!t&&(t=4),!r&&(r=0),a=n?Math.min(n*t+r,e.length):e.length,s=r;s<a;s+=t)_y[0]=e[s],_y[1]=e[s+1],_y[2]=e[s+2],_y[3]=e[s+3],i(_y,_y,o),e[s]=_y[0],e[s+1]=_y[1],e[s+2]=_y[2],e[s+3]=_y[3];return e}),Ty=Object.freeze({create:Jm,clone:Zm,fromValues:ey,copy:ty,set:ry,add:ny,subtract:iy,multiply:oy,divide:sy,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},min:function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},max:function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:ay,scaleAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},distance:uy,squaredDistance:cy,length:ly,squaredLength:hy,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},normalize:py,dot:fy,cross:function(e,t,r,n){var i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],s=r[0]*n[3]-r[3]*n[0],a=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],l=t[0],h=t[1],p=t[2],f=t[3];return e[0]=h*c-p*u+f*a,e[1]=-l*c+p*s-f*o,e[2]=l*u-h*s+f*i,e[3]=-l*a+h*o-p*i,e},lerp:dy,random:function(e,t){var r,n,i,o,s,a;t=t||1;do{s=(r=2*tm()-1)*r+(n=2*tm()-1)*n}while(s>=1);do{a=(i=2*tm()-1)*i+(o=2*tm()-1)*o}while(a>=1);var u=Math.sqrt((1-s)/a);return e[0]=t*r,e[1]=t*n,e[2]=t*i*u,e[3]=t*o*u,e},transformMat4:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,e},transformQuat:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=r[0],a=r[1],u=r[2],c=r[3],l=c*n+a*o-u*i,h=c*i+u*n-s*o,p=c*o+s*i-a*n,f=-s*n-a*i-u*o;return e[0]=l*c+f*-s+h*-u-p*-a,e[1]=h*c+f*-a+p*-s-l*-u,e[2]=p*c+f*-u+l*-a-h*-s,e[3]=t[3],e},zero:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},str:function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},exactEquals:Ay,equals:gy,sub:my,mul:yy,div:Ey,dist:xy,sqrDist:Cy,len:by,sqrLen:Iy,forEach:vy});function Ry(){var e=new em(4);return em!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Sy(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function My(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=r[0],u=r[1],c=r[2],l=r[3];return e[0]=n*l+s*a+i*c-o*u,e[1]=i*l+s*u+o*a-n*c,e[2]=o*l+s*c+n*u-i*a,e[3]=s*l-n*a-i*u-o*c,e}function wy(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(r),u=Math.cos(r);return e[0]=n*u+s*a,e[1]=i*u+o*a,e[2]=o*u-i*a,e[3]=s*u-n*a,e}function By(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(r),u=Math.cos(r);return e[0]=n*u-o*a,e[1]=i*u+s*a,e[2]=o*u+n*a,e[3]=s*u-i*a,e}function Oy(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*a,e[1]=i*u-n*a,e[2]=o*u+s*a,e[3]=s*u-o*a,e}function Dy(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=Math.sqrt(r*r+n*n+i*i),a=Math.exp(o),u=s>0?a*Math.sin(s)/s:0;return e[0]=r*u,e[1]=n*u,e[2]=i*u,e[3]=a*Math.cos(s),e}function Fy(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=Math.sqrt(r*r+n*n+i*i),a=s>0?Math.atan2(s,o)/s:0;return e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=.5*Math.log(r*r+n*n+i*i+o*o),e}function Py(e,t,r,n){var i,o,s,a,u,c=t[0],l=t[1],h=t[2],p=t[3],f=r[0],d=r[1],A=r[2],g=r[3];return(o=c*f+l*d+h*A+p*g)<0&&(o=-o,f=-f,d=-d,A=-A,g=-g),1-o>Z_?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-n)*i)/s,u=Math.sin(n*i)/s):(a=1-n,u=n),e[0]=a*c+u*f,e[1]=a*l+u*d,e[2]=a*h+u*A,e[3]=a*p+u*g,e}function Ny(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*s+s]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*o+s]-t[3*s+o])*r,e[o]=(t[3*o+i]+t[3*i+o])*r,e[s]=(t[3*s+i]+t[3*i+s])*r}return e}var Ly,Uy,Gy,Qy,ky,zy,jy=Zm,Hy=ey,qy=ty,Vy=ry,Yy=ny,Xy=My,Wy=ay,Ky=fy,$y=dy,Jy=ly,Zy=Jy,eE=hy,tE=eE,rE=py,nE=Ay,iE=gy,oE=(Qy=wm(),ky=Om(1,0,0),zy=Om(0,1,0),function(e,t,r){var n=Qm(t,r);return n<-.999999?(km(Qy,ky,t),Xm(Qy)<1e-6&&km(Qy,zy,t),Gm(Qy,Qy),Sy(e,Qy,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(km(Qy,t,r),e[0]=Qy[0],e[1]=Qy[1],e[2]=Qy[2],e[3]=1+n,rE(e,e))}),sE=(Uy=Ry(),Gy=Ry(),function(e,t,r,n,i,o){return Py(Uy,t,i,o),Py(Gy,r,n,o),Py(e,Uy,Gy,2*o*(1-o)),e}),aE=(Ly=dm(),function(e,t,r,n){return Ly[0]=r[0],Ly[3]=r[1],Ly[6]=r[2],Ly[1]=n[0],Ly[4]=n[1],Ly[7]=n[2],Ly[2]=-t[0],Ly[5]=-t[1],Ly[8]=-t[2],rE(e,Ny(e,Ly))}),uE=Object.freeze({create:Ry,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:Sy,getAxisAngle:function(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return n>Z_?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r},getAngle:function(e,t){var r=Ky(e,t);return Math.acos(2*r*r-1)},multiply:My,rotateX:wy,rotateY:By,rotateZ:Oy,calculateW:function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},exp:Dy,ln:Fy,pow:function(e,t,r){return Fy(e,t),Wy(e,e,r),Dy(e,e),e},slerp:Py,random:function(e){var t=tm(),r=tm(),n=tm(),i=Math.sqrt(1-t),o=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*r),e[1]=i*Math.cos(2*Math.PI*r),e[2]=o*Math.sin(2*Math.PI*n),e[3]=o*Math.cos(2*Math.PI*n),e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=r*r+n*n+i*i+o*o,a=s?1/s:0;return e[0]=-r*a,e[1]=-n*a,e[2]=-i*a,e[3]=o*a,e},conjugate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},fromMat3:Ny,fromEuler:function(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var o=Math.sin(t),s=Math.cos(t),a=Math.sin(r),u=Math.cos(r),c=Math.sin(n),l=Math.cos(n);return e[0]=o*u*l-s*a*c,e[1]=s*a*l+o*u*c,e[2]=s*u*c-o*a*l,e[3]=s*u*l+o*a*c,e},str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},clone:jy,fromValues:Hy,copy:qy,set:Vy,add:Yy,mul:Xy,scale:Wy,dot:Ky,lerp:$y,length:Jy,len:Zy,squaredLength:eE,sqrLen:tE,normalize:rE,exactEquals:nE,equals:iE,rotationTo:oE,sqlerp:sE,setAxes:aE});function cE(e,t,r){var n=.5*r[0],i=.5*r[1],o=.5*r[2],s=t[0],a=t[1],u=t[2],c=t[3];return e[0]=s,e[1]=a,e[2]=u,e[3]=c,e[4]=n*c+i*u-o*a,e[5]=i*c+o*s-n*u,e[6]=o*c+n*a-i*s,e[7]=-n*s-i*a-o*u,e}function lE(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}var hE=qy;var pE=qy;function fE(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=r[4],u=r[5],c=r[6],l=r[7],h=t[4],p=t[5],f=t[6],d=t[7],A=r[0],g=r[1],_=r[2],m=r[3];return e[0]=n*m+s*A+i*_-o*g,e[1]=i*m+s*g+o*A-n*_,e[2]=o*m+s*_+n*g-i*A,e[3]=s*m-n*A-i*g-o*_,e[4]=n*l+s*a+i*c-o*u+h*m+d*A+p*_-f*g,e[5]=i*l+s*u+o*a-n*c+p*m+d*g+f*A-h*_,e[6]=o*l+s*c+n*u-i*a+f*m+d*_+h*g-p*A,e[7]=s*l-n*a-i*u-o*c+d*m-h*A-p*g-f*_,e}var dE=fE;var AE=Ky;var gE=Jy,_E=gE,mE=eE,yE=mE;var EE=Object.freeze({create:function(){var e=new em(8);return em!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},clone:function(e){var t=new em(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},fromValues:function(e,t,r,n,i,o,s,a){var u=new em(8);return u[0]=e,u[1]=t,u[2]=r,u[3]=n,u[4]=i,u[5]=o,u[6]=s,u[7]=a,u},fromRotationTranslationValues:function(e,t,r,n,i,o,s){var a=new em(8);a[0]=e,a[1]=t,a[2]=r,a[3]=n;var u=.5*i,c=.5*o,l=.5*s;return a[4]=u*n+c*r-l*t,a[5]=c*n+l*e-u*r,a[6]=l*n+u*t-c*e,a[7]=-u*e-c*t-l*r,a},fromRotationTranslation:cE,fromTranslation:function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},fromRotation:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},fromMat4:function(e,t){var r=Ry();vm(r,t);var n=new em(3);return bm(n,t),cE(e,r,n),e},copy:lE,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},set:function(e,t,r,n,i,o,s,a,u){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=s,e[6]=a,e[7]=u,e},getReal:hE,getDual:function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},setReal:pE,setDual:function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},getTranslation:function(e,t){var r=t[4],n=t[5],i=t[6],o=t[7],s=-t[0],a=-t[1],u=-t[2],c=t[3];return e[0]=2*(r*c+o*s+n*u-i*a),e[1]=2*(n*c+o*a+i*s-r*u),e[2]=2*(i*c+o*u+r*a-n*s),e},translate:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=.5*r[0],u=.5*r[1],c=.5*r[2],l=t[4],h=t[5],p=t[6],f=t[7];return e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=s*a+i*c-o*u+l,e[5]=s*u+o*a-n*c+h,e[6]=s*c+n*u-i*a+p,e[7]=-n*a-i*u-o*c+f,e},rotateX:function(e,t,r){var n=-t[0],i=-t[1],o=-t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=a*s+l*n+u*o-c*i,p=u*s+l*i+c*n-a*o,f=c*s+l*o+a*i-u*n,d=l*s-a*n-u*i-c*o;return wy(e,t,r),n=e[0],i=e[1],o=e[2],s=e[3],e[4]=h*s+d*n+p*o-f*i,e[5]=p*s+d*i+f*n-h*o,e[6]=f*s+d*o+h*i-p*n,e[7]=d*s-h*n-p*i-f*o,e},rotateY:function(e,t,r){var n=-t[0],i=-t[1],o=-t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=a*s+l*n+u*o-c*i,p=u*s+l*i+c*n-a*o,f=c*s+l*o+a*i-u*n,d=l*s-a*n-u*i-c*o;return By(e,t,r),n=e[0],i=e[1],o=e[2],s=e[3],e[4]=h*s+d*n+p*o-f*i,e[5]=p*s+d*i+f*n-h*o,e[6]=f*s+d*o+h*i-p*n,e[7]=d*s-h*n-p*i-f*o,e},rotateZ:function(e,t,r){var n=-t[0],i=-t[1],o=-t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=a*s+l*n+u*o-c*i,p=u*s+l*i+c*n-a*o,f=c*s+l*o+a*i-u*n,d=l*s-a*n-u*i-c*o;return Oy(e,t,r),n=e[0],i=e[1],o=e[2],s=e[3],e[4]=h*s+d*n+p*o-f*i,e[5]=p*s+d*i+f*n-h*o,e[6]=f*s+d*o+h*i-p*n,e[7]=d*s-h*n-p*i-f*o,e},rotateByQuatAppend:function(e,t,r){var n=r[0],i=r[1],o=r[2],s=r[3],a=t[0],u=t[1],c=t[2],l=t[3];return e[0]=a*s+l*n+u*o-c*i,e[1]=u*s+l*i+c*n-a*o,e[2]=c*s+l*o+a*i-u*n,e[3]=l*s-a*n-u*i-c*o,a=t[4],u=t[5],c=t[6],l=t[7],e[4]=a*s+l*n+u*o-c*i,e[5]=u*s+l*i+c*n-a*o,e[6]=c*s+l*o+a*i-u*n,e[7]=l*s-a*n-u*i-c*o,e},rotateByQuatPrepend:function(e,t,r){var n=t[0],i=t[1],o=t[2],s=t[3],a=r[0],u=r[1],c=r[2],l=r[3];return e[0]=n*l+s*a+i*c-o*u,e[1]=i*l+s*u+o*a-n*c,e[2]=o*l+s*c+n*u-i*a,e[3]=s*l-n*a-i*u-o*c,a=r[4],u=r[5],c=r[6],l=r[7],e[4]=n*l+s*a+i*c-o*u,e[5]=i*l+s*u+o*a-n*c,e[6]=o*l+s*c+n*u-i*a,e[7]=s*l-n*a-i*u-o*c,e},rotateAroundAxis:function(e,t,r,n){if(Math.abs(n)<Z_)return lE(e,t);var i=Math.hypot(r[0],r[1],r[2]);n*=.5;var o=Math.sin(n),s=o*r[0]/i,a=o*r[1]/i,u=o*r[2]/i,c=Math.cos(n),l=t[0],h=t[1],p=t[2],f=t[3];e[0]=l*c+f*s+h*u-p*a,e[1]=h*c+f*a+p*s-l*u,e[2]=p*c+f*u+l*a-h*s,e[3]=f*c-l*s-h*a-p*u;var d=t[4],A=t[5],g=t[6],_=t[7];return e[4]=d*c+_*s+A*u-g*a,e[5]=A*c+_*a+g*s-d*u,e[6]=g*c+_*u+d*a-A*s,e[7]=_*c-d*s-A*a-g*u,e},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e},multiply:fE,mul:dE,scale:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e},dot:AE,lerp:function(e,t,r,n){var i=1-n;return AE(t,r)<0&&(n=-n),e[0]=t[0]*i+r[0]*n,e[1]=t[1]*i+r[1]*n,e[2]=t[2]*i+r[2]*n,e[3]=t[3]*i+r[3]*n,e[4]=t[4]*i+r[4]*n,e[5]=t[5]*i+r[5]*n,e[6]=t[6]*i+r[6]*n,e[7]=t[7]*i+r[7]*n,e},invert:function(e,t){var r=mE(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e},conjugate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},length:gE,len:_E,squaredLength:mE,sqrLen:yE,normalize:function(e,t){var r=mE(t);if(r>0){r=Math.sqrt(r);var n=t[0]/r,i=t[1]/r,o=t[2]/r,s=t[3]/r,a=t[4],u=t[5],c=t[6],l=t[7],h=n*a+i*u+o*c+s*l;e[0]=n,e[1]=i,e[2]=o,e[3]=s,e[4]=(a-n*h)/r,e[5]=(u-i*h)/r,e[6]=(c-o*h)/r,e[7]=(l-s*h)/r}return e},str:function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},equals:function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=t[0],h=t[1],p=t[2],f=t[3],d=t[4],A=t[5],g=t[6],_=t[7];return Math.abs(r-l)<=Z_*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-h)<=Z_*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-p)<=Z_*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-f)<=Z_*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-d)<=Z_*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-A)<=Z_*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(u-g)<=Z_*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-_)<=Z_*Math.max(1,Math.abs(c),Math.abs(_))}});function xE(){var e=new em(2);return em!=Float32Array&&(e[0]=0,e[1]=0),e}function CE(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function bE(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function IE(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function vE(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)}function TE(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function RE(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function SE(e){var t=e[0],r=e[1];return t*t+r*r}var ME,wE=RE,BE=CE,OE=bE,DE=IE,FE=vE,PE=TE,NE=SE,LE=(ME=xE(),function(e,t,r,n,i,o){var s,a;for(!t&&(t=2),!r&&(r=0),a=n?Math.min(n*t+r,e.length):e.length,s=r;s<a;s+=t)ME[0]=e[s],ME[1]=e[s+1],i(ME,ME,o),e[s]=ME[0],e[s+1]=ME[1];return e}),UE=Object.freeze({create:xE,clone:function(e){var t=new em(2);return t[0]=e[0],t[1]=e[1],t},fromValues:function(e,t){var r=new em(2);return r[0]=e,r[1]=t,r},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,r){return e[0]=t,e[1]=r,e},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},subtract:CE,multiply:bE,divide:IE,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},min:function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},max:function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},scale:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},scaleAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},distance:vE,squaredDistance:TE,length:RE,squaredLength:SE,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},normalize:function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},cross:function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},lerp:function(e,t,r,n){var i=t[0],o=t[1];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e},random:function(e,t){t=t||1;var r=2*tm()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},transformMat2:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},transformMat2d:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e},transformMat3:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},transformMat4:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},rotate:function(e,t,r,n){var i=t[0]-r[0],o=t[1]-r[1],s=Math.sin(n),a=Math.cos(n);return e[0]=i*a-o*s+r[0],e[1]=i*s+o*a+r[1],e},angle:function(e,t){var r=e[0],n=e[1],i=t[0],o=t[1],s=r*r+n*n;s>0&&(s=1/Math.sqrt(s));var a=i*i+o*o;a>0&&(a=1/Math.sqrt(a));var u=(r*i+n*o)*s*a;return u>1?0:u<-1?Math.PI:Math.acos(u)},zero:function(e){return e[0]=0,e[1]=0,e},str:function(e){return"vec2("+e[0]+", "+e[1]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]},equals:function(e,t){var r=e[0],n=e[1],i=t[0],o=t[1];return Math.abs(r-i)<=Z_*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=Z_*Math.max(1,Math.abs(n),Math.abs(o))},len:wE,sub:BE,mul:OE,div:DE,dist:FE,sqrDist:PE,sqrLen:NE,forEach:LE});J_.glMatrix=nm,J_.mat2=um,J_.mat2d=fm,J_.mat3=ym,J_.mat4=Mm,J_.quat=uE,J_.quat2=EE,J_.vec2=UE,J_.vec3=$m,J_.vec4=Ty;const GE=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),QE=GE(void 0,(function(){return QE.toString().search("(((.+)+)+)+$").toString().constructor(QE).search("(((.+)+)+)+$")}));QE();const kE=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),zE=kE(void 0,(function(){return zE.toString().search("(((.+)+)+)+$").toString().constructor(zE).search("(((.+)+)+)+$")}));zE();class jE{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof XE?new XE(e.lng,e.lat):XE.convert(e),this}setSouthWest(e){return this._sw=e instanceof XE?new XE(e.lng,e.lat):XE.convert(e),this}extend(e){const t=this._sw,r=this._ne;let n,i;if(e instanceof XE)n=e,i=e;else{if(!(e instanceof jE))return Array.isArray(e)?e.every(Array.isArray)?this.extend(jE.convert(e)):this.extend(XE.convert(e)):this;if(n=e._sw,i=e._ne,!n||!i)return this}return t||r?(t.lng=Math.min(n.lng,t.lng),t.lat=Math.min(n.lat,t.lat),r.lng=Math.max(i.lng,r.lng),r.lat=Math.max(i.lat,r.lat)):(this._sw=new XE(n.lng,n.lat),this._ne=new XE(i.lng,i.lat)),this}getCenter(){return new XE((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new XE(this.getWest(),this.getNorth())}getSouthEast(){return new XE(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:t,lat:r}=XE.convert(e),n=this._sw.lat<=r&&r<=this._ne.lat;let i=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=t&&t>=this._ne.lng),n&&i}static convert(e){return!e||e instanceof jE?e:new jE(e)}}const HE=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),qE=HE(void 0,(function(){return qE.toString().search("(((.+)+)+)+$").toString().constructor(qE).search("(((.+)+)+)+$")}));qE();const VE=6371008.8,YE=2*Math.PI*VE;class XE{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");this.lng=+e,this.lat=+t,this.lat>90||this.lat}wrap(){return new XE(rp(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat("+this.lng+", "+this.lat+")"}distanceTo(e){const t=Math.PI/180,r=this.lat*t,n=e.lat*t,i=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return VE*Math.acos(Math.min(i,1))}toBounds(e=0){const t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new jE(new XE(this.lng-r,this.lat-t),new XE(this.lng+r,this.lat+t))}static convert(e){if(e instanceof XE)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new XE(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new XE(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const WE=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),KE=WE(void 0,(function(){return KE.toString().search("(((.+)+)+)+$").toString().constructor(KE).search("(((.+)+)+)+$")}));function $E(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function JE(e,t){return e/(r=t,YE*Math.cos(r*Math.PI/180));var r}function ZE(e){return 360*e-180}function ex(e){const t=180-360*e;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}KE();const tx=85.051129,rx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),nx=rx(void 0,(function(){return nx.toString().search("(((.+)+)+)+$").toString().constructor(nx).search("(((.+)+)+)+$")}));nx();var ix=new la,ox=new qn;function sx(e,t,r,n){const i=Ap(e.crs,t,r,n),o=[0,0,0,1];J_.vec4.transformMat4(o,[i.x,i.y,i.z,1],e.sceneViewProjMatrix);const s=o[3];o[0]/=s,o[1]/=s,o[2]/=s;var a=new qn(o[0],o[1],o[2]),u={x:0,y:0,width:e.width,height:e.height},c=la.computeViewportTransformation(u,0,1,ix),l=la.multiplyByPoint(c,a,ox);return new Pn(l.x,l.y)}function ax(e,t,r,n,i,o,s,a,u){if(o&&e.queryGeometry.isAboveHorizon)return!1;o&&(u*=e.pixelToTileUnitsFactor);const c=e.tileID.canonical;r.projection.upVectorScale(c,r.center.lat,r.worldSize).metersToTile;for(const i of t)for(const t of i){const i=t.add(a),f=0,d=o?i:sx(r,i.x,i.y,c),A=o?e.tilespaceRays.map((e=>lx(e,f))):e.tilespaceGeometry.map((e=>sx(r,e.x,e.y,c))),g=J_.vec4.transformMat4([],[d.x,d.y,0,1],n);if(!s&&o&&(u*=g[3]/r.cameraToCenterDistance),o){const e=ex((t.y/Ec+c.y)/(1<<c.z));u/=r.projection.pixelsPerMeter(e,1)/JE(1,e)}if(p=u,L_(l=A,h=d)||F_(h,l,p))return!0}var l,h,p;return!1}const ux=J_.vec3.fromValues(0,0,0),cx=J_.vec3.fromValues(0,0,1);function lx(e,t){const r=J_.vec3.create();return ux[2]=t,e.intersectsPlane(ux,cx,r),new Pn(r[0],r[1])}const hx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),px=hx(void 0,(function(){return px.toString().search("(((.+)+)+)+$").toString().constructor(px).search("(((.+)+)+)+$")}));px();var fx={paint:new pf({"heatmap-radius":new lf(Ug.paint_heatmap["heatmap-radius"]),"heatmap-weight":new lf(Ug.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new cf(Ug.paint_heatmap["heatmap-intensity"]),"heatmap-color":new hf(Ug.paint_heatmap["heatmap-color"]),"heatmap-opacity":new cf(Ug.paint_heatmap["heatmap-opacity"])})};const dx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Ax=dx(void 0,(function(){return Ax.toString().search("(((.+)+)+)+$").toString().constructor(Ax).search("(((.+)+)+)+$")}));function gx(e,{width:t,height:r},n,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==t*r*n)throw new RangeError("mismatched image size")}else i=new Uint8Array(t*r*n);return e.width=t,e.height=r,e.data=i,e}function _x(e,t,r){const{width:n,height:i}=t;n===e.width&&i===e.height||(mx(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,i)},r),e.width=n,e.height=i,e.data=t.data)}function mx(e,t,r,n,i,o){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const s=e.data,a=t.data;for(let u=0;u<i.height;u++){const c=((r.y+u)*e.width+r.x)*o,l=((n.y+u)*t.width+n.x)*o;for(let e=0;e<i.width*o;e++)a[l+e]=s[c+e]}return t}Ax();class yx{constructor(e,t){gx(this,e,1,t)}resize(e){_x(this,new yx(e),1)}clone(){return new yx({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){mx(e,t,r,n,i,1)}}class Ex{constructor(e,t){gx(this,e,4,t)}resize(e){_x(this,new Ex(e),4)}replace(e,t){t?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new Ex({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){mx(e,t,r,n,i,4)}}Sp(yx,"AlphaImage"),Sp(Ex,"RGBAImage");const xx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Cx=xx(void 0,(function(){return Cx.toString().search("(((.+)+)+)+$").toString().constructor(Cx).search("(((.+)+)+)+$")}));function bx(e){const t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new Ex({width:r,height:n});var o;o=r,Math.log(o)/Math.LN2%1!=0&&console.log("renderColorRamp width must be isPowerOfTwo.");const s=(r,n,o)=>{t[e.evaluationKey]=o;const s=e.expression.evaluate(evaluationGlobal);i.data[r+n+0]=Math.floor(255*s.r/s.a),i.data[r+n+1]=Math.floor(255*s.g/s.a),i.data[r+n+2]=Math.floor(255*s.b/s.a),i.data[r+n+3]=Math.floor(255*s.a)};if(e.clips)for(let t=0,i=0;t<n;++t,i+=4*r)for(let n=0,o=0;n<r;n++,o+=4){const a=n/(r-1),{start:u,end:c}=e.clips[t];s(i,o,u*(1-a)+c*a)}else for(let e=0,t=0;e<r;e++,t+=4){s(0,t,e/(r-1))}return i}Cx();const Ix=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),vx=Ix(void 0,(function(){return vx.toString().search("(((.+)+)+)+$").toString().constructor(vx).search("(((.+)+)+)+$")}));vx();const Tx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Rx=Tx(void 0,(function(){return Rx.toString().search("(((.+)+)+)+$").toString().constructor(Rx).search("(((.+)+)+)+$")}));Rx();const Sx=Cf([{name:"a_pos",components:2,type:"Int16"}],4).members;function Mx(e,t,r,n,i){wx(e,t,r||0,n||e.length-1,i||Ox)}function wx(e,t,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,s=t-r+1,a=Math.log(o),u=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*u*(o-u)/o)*(s-o/2<0?-1:1);wx(e,t,Math.max(r,Math.floor(t-s*u/o+c)),Math.min(n,Math.floor(t+(o-s)*u/o+c)),i)}var l=e[t],h=r,p=n;for(Bx(e,r,t),i(e[n],l)>0&&Bx(e,r,n);h<p;){for(Bx(e,h,p),h++,p--;i(e[h],l)<0;)h++;for(;i(e[p],l)>0;)p--}0===i(e[r],l)?Bx(e,r,p):Bx(e,++p,n),p<=t&&(r=p+1),t<=p&&(n=p-1)}}function Bx(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Ox(e,t){return e<t?-1:e>t?1:0}var Dx,Fx=(Dx=!0,function(e,t){var r=Dx?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Dx=!1,r}),Px=Fx(void 0,(function(){return Px.toString().search("(((.+)+)+)+$").toString().constructor(Px).search("(((.+)+)+)+$")}));function Nx(e){for(var t=0,r=0,n=e.length,i=n-1,o=void 0,s=void 0;r<n;i=r++)o=e[r],t+=((s=e[i]).x-o.x)*(o.y+s.y);return t}function Lx(e,t){var r=e.length;if(r<=1)return[e];for(var n,i,o=[],s=0;s<r;s++){var a=Nx(e[s]);0!==a&&(e[s].area=Math.abs(a),void 0===i&&(i=a<0),i===a<0?(n&&o.push(n),n=[e[s]]):n.push(e[s]))}if(n&&o.push(n),t>1)for(var u=0;u<o.length;u++)o[u].length<=t||(Mx(o[u],t,1,o[u].length-1,Ux),o[u]=o[u].slice(0,t));return o}function Ux(e,t){return t.area-e.area}Px();const Gx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Qx=Gx(void 0,(function(){return Qx.toString().search("(((.+)+)+)+$").toString().constructor(Qx).search("(((.+)+)+)+$")}));function kx(e,t,r){const n=r.patternDependencies;let i=!1;for(const r of t){const t=r.paint.get(e+"-pattern");!t.isConstant()&&(i=!0);const o=t.constantOr(null);o&&(i=!0,n[o]=!0)}return i}function zx(e,t,r,n,i){const o=i.patternDependencies;for(const s of t){const t=s.paint.get(e+"-pattern").value;if("constant"!==t.kind){let e=t.evaluate({zoom:n},r,{},i.availableImages);e=e&&e.name?e.name:e,o[e]=!0,r.patterns[s.id]=e}}return r}Qx();const jx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Hx=jx(void 0,(function(){return Hx.toString().search("(((.+)+)+)+$").toString().constructor(Hx).search("(((.+)+)+)+$")}));Hx();class qx{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Tf,this.indexArray=new Hf,this.indexArray2=new ed,this.programConfigurations=new Rg(Sx,e.layers,e.zoom),this.segments=new l_,this.segments2=new l_,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.projection=e.projection}populate(e,t,r,n){this.hasPattern=kx("fill",this.layers,t);const i=this.layers[0].layout.get("fill-sort-key"),o=[];for(const{feature:n,id:s,index:a,sourceLayerIndex:u}of e){const e=this.layers[0]._featureFilter.needGeometry,c=E_(n,e);if(!this.layers[0]._featureFilter.filter(new $p(this.zoom),c,r))continue;const l=i?i.evaluate(c,{},r,t.availableImages):void 0,h={id:s,properties:n.properties,type:n.type,sourceLayerIndex:u,index:a,geometry:e?c.geometry:g_(n,r),patterns:{},sortKey:l};o.push(h)}i&&o.sort(((e,t)=>e.sortKey-t.sortKey));for(const n of o){const{geometry:i,index:o,sourceLayerIndex:s}=n;if(this.hasPattern){const e=zx("fill",this.layers,n,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(n,i,o,r,{},t.availableImages);const a=e[o].feature;t.featureIndex.insert(a,i,o,s,this.index)}}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r,n)}addFeatures(e,t,r,n,i){for(const e of this.patternFeatures)this.addFeature(e,e.geometry,e.index,t,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){if(!this.uploaded){if(null==this.layoutVertexArray)return;this.layoutVertexArray.length>0&&(this.layoutVertexBuffer=lg.toVertexBuffer(e,this.layoutVertexArray,Sx),this.indexArray.length>0&&(this.indexBuffer=lg.toIndexBuffer(e,this.indexArray)),this.indexArray2.length>0&&(this.indexBuffer2=lg.toIndexBuffer(e,this.indexArray2)))}this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&!this.layoutVertexBuffer.isDestroyed()&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,i,o){for(const e of Lx(t,500)){let t=0;for(const r of e)t+=r.length;const r=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),n=r.vertexLength,i=[],o=[];for(const t of e){if(0===t.length)continue;if(t!==e[0]&&o.push(i.length/2),t.length>l_.MAX_VERTEX_ARRAY_LENGTH&&this.indexArray instanceof Hf){let e=this.indexArray,t=this.indexArray2;this.indexArray=new qf,this.indexArray2=new td,this.indexArray.copyFrom3ui6(e),this.indexArray2.copyFrom2ui4(t)}const r=this.segments2.prepareSegment(t.length,this.layoutVertexArray,this.indexArray2),n=r.vertexLength;this.layoutVertexArray.emplaceBack(t[0].x,t[0].y),this.indexArray2.emplaceBack(n+t.length-1,n),i.push(t[0].x),i.push(t[0].y);for(let e=1;e<t.length;e++)this.layoutVertexArray.emplaceBack(t[e].x,t[e].y),this.indexArray2.emplaceBack(n+e-1,n+e),i.push(t[e].x),i.push(t[e].y);r.vertexLength+=t.length,r.primitiveLength+=t.length}const s=ah(i,o);for(let e=0;e<s.length;e+=3)this.indexArray.emplaceBack(n+s[e],n+s[e+1],n+s[e+2]);r.vertexLength+=t,r.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,o,n)}}Sp(qx,"FillBucket",{omit:["layers","patternFeatures"]});const Vx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Yx=Vx(void 0,(function(){return Yx.toString().search("(((.+)+)+)+$").toString().constructor(Yx).search("(((.+)+)+)+$")}));Yx();const Xx=new pf({"fill-sort-key":new lf(Ug.layout_fill["fill-sort-key"])});var Wx={paint:new pf({"fill-antialias":new cf(Ug.paint_fill["fill-antialias"]),"fill-opacity":new lf(Ug.paint_fill["fill-opacity"]),"fill-color":new lf(Ug.paint_fill["fill-color"]),"fill-outline-color":new lf(Ug.paint_fill["fill-outline-color"]),"fill-translate":new cf(Ug.paint_fill["fill-translate"]),"fill-translate-anchor":new cf(Ug.paint_fill["fill-translate-anchor"]),"fill-pattern":new lf(Ug.paint_fill["fill-pattern"])}),layout:Xx};const Kx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),$x=Kx(void 0,(function(){return $x.toString().search("(((.+)+)+)+$").toString().constructor($x).search("(((.+)+)+)+$")}));$x();const Jx=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Zx=Jx(void 0,(function(){return Zx.toString().search("(((.+)+)+)+$").toString().constructor(Zx).search("(((.+)+)+)+$")}));Zx();const eC=Cf([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),tC=Cf([{name:"a_centroid_pos",components:2,type:"Uint16"}]),rC=Cf([{name:"a_ecef_pos_high",components:3,type:"Float32"},{name:"a_ecef_pos_low",components:3,type:"Float32"},{name:"a_pos_normal_3",components:3,type:"Float32"}]),nC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),iC=nC(void 0,(function(){return iC.toString().search("(((.+)+)+)+$").toString().constructor(iC).search("(((.+)+)+)+$")}));iC();const oC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),sC=oC(void 0,(function(){return sC.toString().search("(((.+)+)+)+$").toString().constructor(sC).search("(((.+)+)+)+$")}));sC();let aC=new qn;const uC=["Unknown","Point","LineString","Polygon"],cC=Math.pow(2,13);function lC(e,t,r,n,i,o,s,a){e.emplaceBack((t<<1)+s,(r<<1)+o,(Math.floor(n*cC)<<1)+i,Math.round(a))}function hC(e,t,r,n){e.emplaceBack(t.x,t.y,t.z,r.x,r.y,r.z,n.x,n.y,n.z)}class pC{constructor(){this.acc=new Pn(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Pn(e.x,e.y),this.max=new Pn(e.x,e.y))}append(e,t){this.currentPolyCount.edges++,this.acc._add(e);const r=this.min,n=this.max;e.x<r.x?r.x=e.x:e.x>n.x&&(n.x=e.x),e.y<r.y?r.y=e.y:e.y>n.y&&(n.y=e.y),((0===e.x||e.x===Ec)&&e.x===t.x)!=((0===e.y||e.y===Ec)&&e.y===t.y)&&this.processBorderOverlap(e,t),t.x<0!=e.x<0&&this.addBorderIntersection(0,Dt(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>Ec!=e.x>Ec&&this.addBorderIntersection(1,Dt(t.y,e.y,(Ec-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,Dt(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>Ec!=e.y>Ec&&this.addBorderIntersection(3,Dt(t.x,e.x,(Ec-t.y)/(e.y-t.y)))}addBorderIntersection(e,t){!this.borders&&(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const r=this.borders[e];t<r[0]&&(r[0]=t),t>r[1]&&(r[1]=t)}processBorderOverlap(e,t){if(e.x===t.x){if(e.y===t.y)return;const r=0===e.x?0:1;this.addBorderIntersection(r,t.y),this.addBorderIntersection(r,e.y)}else{const r=0===e.y?2:3;this.addBorderIntersection(r,t.x),this.addBorderIntersection(r,e.x)}}centroid(){const e=this.polyCount.reduce(((e,t)=>e+t.edges),0);return 0!==e?this.acc.div(e)._round():new Pn(0,0)}span(){return new Pn(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((e,t)=>e+ +(t[0]!==Number.MAX_VALUE)),0)}}class fC{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Sf,this.centroidVertexArray=new dd,this.indexArray=new Hf,this.programConfigurations=new Rg(eC.members,e.layers,e.zoom),this.segments=new l_,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.enableTerrain=e.enableTerrain}populate(e,t,r,n){this.features=[],this.hasPattern=kx("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(e){const t=40075017,r=e.y/(1<<e.z),n=Math.exp(Math.PI*(1-2*r));return 2*t*n/(n*n+1)/Ec/(1<<e.z)}(r),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:i,id:o,index:s,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,u=E_(i,e);if(!this.layers[0]._featureFilter.filter(new $p(this.zoom),u,r))continue;const c={id:o,sourceLayerIndex:a,index:s,geometry:e?u.geometry:g_(i,r),properties:i.properties,type:i.type,patterns:{}},l=this.layoutVertexArray.length;this.hasPattern?this.features.push(zx("fill-extrusion",this.layers,c,this.zoom,t)):this.addFeature(c,c.geometry,s,r,{},t.availableImages,n,t.crs),t.featureIndex.insert(i,c.geometry,s,a,this.index,l)}this.sortBorders()}addFeatures(e,t,r,n,i){for(const o of this.features){const{geometry:s}=o;this.addFeature(o,s,o.index,t,r,n,i,e.crs)}this.sortBorders()}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){if(!this.uploaded){if(null==this.layoutVertexArray)return;this.layoutVertexArray.length>0&&(this.layoutVertexBuffer=lg.toVertexBuffer(e,this.layoutVertexArray,eC.members),this.indexArray.length>0&&(this.indexBuffer=lg.toIndexBuffer(e,this.indexArray)),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=lg.toVertexBuffer(e,this.layoutVertexExtArray,rC.members,!0)))}this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=lg.toVertexBuffer(this.centroidVertexArray,tC.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&!this.layoutVertexBuffer.isDestroyed()&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n,i,o,s,a){const u=[new Pn(0,0),new Pn(Ec,Ec)];s.projection;const c=this.enableTerrain?new pC:null,l="Polygon"===uC[e.type];!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new $f);const h=Lx(t,500);for(let e=h.length-1;e>=0;e--){const t=h[e];(0===t.length||((p=t[0]).every((e=>e.x<=0))||p.every((e=>e.x>=Ec))||p.every((e=>e.y<=0))||p.every((e=>e.y>=Ec))))&&h.splice(e,1)}var p;let f;f=[];for(const e of h)f.push({polygon:e,bounds:u});const d=l?this.edgeRadius:0;for(const{polygon:e,bounds:t}of f){let r=0,i=0;for(const t of e)l&&!t[0].equals(t[t.length-1])&&t.push(t[0]),i+=l?t.length-1:t.length;const o=this.segments.prepareSegment((l?5:4)*i,this.layoutVertexArray,this.indexArray);if(l){const t=[],i=[];r=o.vertexLength;for(const r of e){let s,u;r.length&&r!==e[0]&&i.push(t.length/2);{const e=r[0];s=r[1].sub(e)._perp()._unit()}for(let e=1;e<r.length;e++){const i=r[e],c=r[e===r.length-1?1:e+1];let{x:l,y:h}=i;if(d){u=c.sub(i)._perp()._unit();const e=s.add(u)._unit(),t=s.x*e.x+s.y*e.y,r=d*Math.min(4,1/t);l+=r*e.x,h+=r*e.y,s=u}lC(this.layoutVertexArray,l,h,0,0,1,1,0),o.vertexLength++,t.push(i.x,i.y);const p=this.layoutVertexExtArray,f=Ap(a,l,h,n),A=x_.fromCartesian(f);Os.WGS84.geodeticSurfaceNormal(f,aC),hC(p,A.high,A.low,aC)}}const s=ah(t,i);for(let e=0;e<s.length;e+=3)this.indexArray.emplaceBack(r+s[e],r+s[e+2],r+s[e+1]),o.primitiveLength++}for(const i of e){c&&i.length&&c.startRing(i[0]);let e,s,u,h=i.length>4&&mC(i[i.length-2],i[0],i[1]),p=d?AC(i[i.length-2],i[0],i[1],d):0;{const e=i[0];s=i[1].sub(e)._perp()._unit()}let f=!0;for(let A=1,g=0;A<i.length;A++){let _=i[A-1],m=i[A];const y=i[A===i.length-1?1:A+1];if(c&&l&&c.currentPolyCount.top++,_C(m,_,t)){d&&(s=y.sub(m)._perp()._unit(),f=!f);continue}c&&c.append(m,_);const E=m.sub(_)._perp(),x=E.x/(Math.abs(E.x)+Math.abs(E.y)),C=E.y>0?1:0,b=_.dist(m);if(g+b>32768&&(g=0),d){u=y.sub(m)._perp()._unit();let e=gC(_,m,y,dC(s,u),d);isNaN(e)&&(e=0);const t=m.sub(_)._unit();_=_.add(t.mult(p))._round(),m=m.add(t.mult(-e))._round(),p=e,s=u}const I=o.vertexLength,v=i.length>4&&mC(_,m,y);let T=yC(g,h,f);if(lC(this.layoutVertexArray,_.x,_.y,x,C,0,0,T),lC(this.layoutVertexArray,_.x,_.y,x,C,0,1,T),g+=b,T=yC(g,v,!f),h=v,lC(this.layoutVertexArray,m.x,m.y,x,C,0,0,T),lC(this.layoutVertexArray,m.x,m.y,x,C,0,1,T),o.vertexLength+=4,this.indexArray.emplaceBack(I+0,I+1,I+2),this.indexArray.emplaceBack(I+1,I+3,I+2),o.primitiveLength+=2,d){const n=r+(1===A?i.length-2:A-2),s=1===A?r:n+1;if(this.indexArray.emplaceBack(I+1,n,I+3),this.indexArray.emplaceBack(n,s,I+3),o.primitiveLength+=2,void 0===e&&(e=I),!_C(y,i[A],t)){const t=A===i.length-1?e:o.vertexLength;this.indexArray.emplaceBack(I+2,I+3,t),this.indexArray.emplaceBack(I+3,t+1,t),this.indexArray.emplaceBack(I+3,s,t+1),o.primitiveLength+=3}f=!f}const R=this.layoutVertexExtArray,S=Ap(a,_.x,_.y,n),M=Ap(a,m.x,m.y,n),w=x_.fromCartesian(S);Os.WGS84.geodeticSurfaceNormal(S,aC),hC(R,w.high,w.low,aC),hC(R,w.high,w.low,aC);const B=x_.fromCartesian(M);Os.WGS84.geodeticSurfaceNormal(M,aC),hC(R,B.high,B.low,aC),hC(R,B.high,B.low,aC)}l&&(r+=i.length-1)}}if(c&&c.polyCount.length>0){if(c.borders){c.vertexArrayOffset=this.centroidVertexArray.length;const e=c.borders,t=this.featuresOnBorder.push(c)-1;for(let r=0;r<4;r++)e[r][0]!==Number.MAX_VALUE&&this.borders[r].push(t)}this.encodeCentroid(c.borders?void 0:c.centroid(),c)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,o,n)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort(((t,r)=>this.featuresOnBorder[t].borders[e][0]-this.featuresOnBorder[r].borders[e][0]))}encodeCentroid(e,t,r=!0){let n,i;if(e)if(0!==e.y){const r=t.span()._mult(this.tileToMeter);n=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(r.x/10)),i=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(r.y/10))}else n=Math.ceil(7*(e.x+450)),i=0;else n=0,i=+r;let o=r?this.centroidVertexArray.length:t.vertexArrayOffset;for(const e of t.polyCount){r&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*e.edges+e.top);for(let t=0;t<e.top;t++)this.centroidVertexArray.emplace(o++,n,i);for(let t=0;t<2*e.edges;t++)this.centroidVertexArray.emplace(o++,0,i),this.centroidVertexArray.emplace(o++,n,i)}}}function dC(e,t){const r=e.add(t)._unit();return e.x*r.x+e.y*r.y}function AC(e,t,r,n){const i=t.sub(e)._perp()._unit(),o=r.sub(t)._perp()._unit();return gC(e,t,r,dC(i,o),n)}function gC(e,t,r,n,i){const o=Math.sqrt(1-n*n);return Math.min(e.dist(t)/3,t.dist(r)/3,i*o/n)}function _C(e,t,r){return e.x<r[0].x&&t.x<r[0].x||e.x>r[1].x&&t.x>r[1].x||e.y<r[0].y&&t.y<r[0].y||e.y>r[1].y&&t.y>r[1].y}function mC(e,t,r){if(e.x<0||e.x>=Ec||t.x<0||t.x>=Ec||r.x<0||r.x>=Ec)return!1;const n=r.sub(t),i=n.perp(),o=e.sub(t),s=(n.x*o.x+n.y*o.y)/Math.sqrt((n.x*n.x+n.y*n.y)*(o.x*o.x+o.y*o.y)),a=i.x*o.x+i.y*o.y;return s>-.866&&a<0}function yC(e,t,r){const n=t?2|e:-3&e;return r?1|n:-2&n}Sp(fC,"FillExtrusionBucket",{omit:["layers","features"]}),Sp(pC,"PartMetadata");const EC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),xC=EC(void 0,(function(){return xC.toString().search("(((.+)+)+)+$").toString().constructor(xC).search("(((.+)+)+)+$")}));xC();const CC=new pf({"fill-extrusion-edge-radius":new cf(Ug["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var bC={paint:new pf({"fill-extrusion-opacity":new cf(Ug["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new lf(Ug["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new cf(Ug["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new cf(Ug["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lf(Ug["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new lf(Ug["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new lf(Ug["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new cf(Ug["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new cf(Ug["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new cf(Ug["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new cf(Ug["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:CC};const IC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),vC=IC(void 0,(function(){return vC.toString().search("(((.+)+)+)+$").toString().constructor(vC).search("(((.+)+)+)+$")}));vC();class TC extends Pn{constructor(e,t,r){super(e,t),this.z=r}}function RC(e,t){return e.x*t.x+e.y*t.y}function SC(e,t){if(1===e.length){let r=0;const n=t[r++];let i;for(;!i||n.equals(i);)if(i=t[r++],!i)return 1/0;for(;r<t.length;r++){const o=t[r],s=e[0],a=i.sub(n),u=o.sub(n),c=s.sub(n),l=RC(a,a),h=RC(a,u),p=RC(u,u),f=RC(c,a),d=RC(c,u),A=l*p-h*h,g=(p*f-h*d)/A,_=(l*d-h*f)/A,m=1-g-_,y=n.z*m+i.z*g+o.z*_;if(isFinite(y))return y}return 1/0}{let e=1/0;for(const r of t)e=Math.min(e,r.z);return e}}const MC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),wC=MC(void 0,(function(){return wC.toString().search("(((.+)+)+)+$").toString().constructor(wC).search("(((.+)+)+)+$")}));wC();const BC=Cf([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4).members,OC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),DC=OC(void 0,(function(){return DC.toString().search("(((.+)+)+)+$").toString().constructor(DC).search("(((.+)+)+)+$")}));DC();const FC=Cf([{name:"a_packed",components:4,type:"Float32"}]).members,PC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),NC=PC(void 0,(function(){return NC.toString().search("(((.+)+)+)+$").toString().constructor(NC).search("(((.+)+)+)+$")}));NC();const LC=["Unknown","Point","LineString","Polygon"],UC=Math.cos(Math.PI/180*37.5);class GC{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new Mf,this.layoutVertexArray2=new wf,this.indexArray=new Hf,this.programConfigurations=new Rg(BC,e.layers,e.zoom),this.segments=new l_,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r,n){this.hasPattern=kx("line",this.layers,t);const i=this.layers[0].layout.get("line-sort-key"),o=[];for(const{feature:t,id:n,index:s,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,u=E_(t,e);if(!this.layers[0]._featureFilter.filter(new $p(this.zoom),u,r))continue;const c=i?i.evaluate(u,{},r):void 0,l={id:n,properties:t.properties,type:t.type,sourceLayerIndex:a,index:s,geometry:e?u.geometry:g_(t),patterns:{},sortKey:c};o.push(l)}i&&o.sort(((e,t)=>e.sortKey-t.sortKey));const{lineAtlas:s,featureIndex:a}=t,u=this.addConstantDashes(s);for(const n of o){const{geometry:i,index:o,sourceLayerIndex:c}=n;if(u&&this.addFeatureDashes(n,s),this.hasPattern){const e=zx("line",this.layers,n,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(n,i,o,r,s.positions,t.availableImages);const l=e[o].feature;a.insert(l,i,o,c,this.index)}}addConstantDashes(e){let t=!1;for(const r of this.layers){const n=r.paint.get("line-dasharray").value,i=r.layout.get("line-cap").value;if("constant"!==n.kind||"constant"!==i.kind)t=!0;else{const t=i.value,r=n.value;if(!r)continue;e.addDash(r,t)}}return t}addFeatureDashes(e,t){const r=this.zoom;for(const n of this.layers){const i=n.paint.get("line-dasharray").value,o=n.layout.get("line-cap").value;if("constant"===i.kind&&"constant"===o.kind)continue;let s,a;if("constant"===i.kind){if(s=i.value,!s)continue}else s=i.evaluate({zoom:r},e);a="constant"===o.kind?o.value:o.evaluate({zoom:r},e),t.addDash(s,a),e.patterns[n.id]=t.getKey(s,a)}}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r,n)}addFeatures(e,t,r,n,i){for(const e of this.patternFeatures)this.addFeature(e,e.geometry,e.index,t,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){if(!this.uploaded){if(null==this.layoutVertexArray)return;0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=lg.toVertexBuffer(this.layoutVertexArray2,FC)),0!=this.layoutVertexArray.length&&(this.layoutVertexBuffer=lg.toVertexBuffer(e,this.layoutVertexArray,BC),this.indexBuffer=lg.toIndexBuffer(e,this.indexArray))}this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&!this.layoutVertexBuffer.isDestroyed()&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}}addFeature(e,t,r,n,i,o){const s=this.layers[0].layout,a=s.get("line-join").evaluate(e,{}),u=s.get("line-cap").evaluate(e,{}),c=s.get("line-miter-limit"),l=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const r of t)this.addLine(r,e,a,u,c,l);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,o,n)}addLine(e,t,r,n,i,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const s="Polygon"===LC[t.type];let a=e.length;for(;a>=2&&e[a-1].equals(e[a-2]);)a--;let u=0;for(;u<a-1&&e[u].equals(e[u+1]);)u++;if(a<(s?3:2))return;"bevel"===r&&(i=1.05);const c=this.overscaling<=16?122880/(512*this.overscaling):0;if(10*a>l_.MAX_VERTEX_ARRAY_LENGTH&&this.indexArray instanceof Hf){let e=this.indexArray;this.indexArray=new qf,this.indexArray.copyFrom3ui6(e)}const l=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let h,p,f,d,A;this.e1=this.e2=-1,s&&(h=e[a-2],A=e[u].sub(h)._unit()._perp());for(let t=u;t<a;t++){if(f=t===a-1?s?e[u+1]:void 0:e[t+1],f&&e[t].equals(f))continue;A&&(d=A),h&&(p=h),h=e[t],A=f?f.sub(h)._unit()._perp():d,d=d||A;let g=d.add(A);(0!==g.x||0!==g.y)&&g._unit();const _=d.x*A.x+d.y*A.y,m=g.x*A.x+g.y*A.y,y=0!==m?1/m:1/0,E=2*Math.sqrt(2-2*m),x=m<UC&&p&&f,C=d.x*A.y-d.y*A.x>0;if(x&&t>u){const e=h.dist(p);if(e>2*c){const t=h.sub(h.sub(p)._mult(c/e)._round());this.updateDistance(p,t),this.addCurrentVertex(t,d,0,0,l),p=t}}const b=p&&f;let I=b?r:s?"butt":n;if(b&&"round"===I&&(y<o?I="miter":y<=2&&(I="fakeround")),"miter"===I&&y>i&&(I="bevel"),"bevel"===I&&(y>2&&(I="flipbevel"),y<i&&(I="miter")),p&&this.updateDistance(p,h),"miter"===I)g._mult(y),this.addCurrentVertex(h,g,0,0,l);else if("flipbevel"===I){if(y>100)g=A.mult(-1);else{const e=y*d.add(A).mag()/d.sub(A).mag();g._perp()._mult(e*(C?-1:1))}this.addCurrentVertex(h,g,0,0,l),this.addCurrentVertex(h,g.mult(-1),0,0,l)}else if("bevel"===I||"fakeround"===I){const e=-Math.sqrt(y*y-1),t=C?e:0,r=C?0:e;if(p&&this.addCurrentVertex(h,d,t,r,l),"fakeround"===I){const e=Math.round(180*E/Math.PI/20);for(let t=1;t<e;t++){let r=t/e;if(.5!==r){const e=r-.5;r+=r*e*(r-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*e*e+(.848013+_*(.215638*_-1.06021)))}const n=A.sub(d)._mult(r)._add(d)._unit()._mult(C?-1:1);this.addHalfVertex(h,n.x,n.y,!1,C,0,l)}}f&&this.addCurrentVertex(h,A,-t,-r,l)}else if("butt"===I)this.addCurrentVertex(h,g,0,0,l);else if("square"===I){const e=p?1:-1;!p&&this.addCurrentVertex(h,g,e,e,l),this.addCurrentVertex(h,g,0,0,l),p&&this.addCurrentVertex(h,g,e,e,l)}else"round"===I&&(p&&(this.addCurrentVertex(h,d,0,0,l),this.addCurrentVertex(h,d,1,1,l,!0)),f&&(this.addCurrentVertex(h,A,-1,-1,l,!0),this.addCurrentVertex(h,A,0,0,l)));if(x&&t<a-1){const e=h.dist(f);if(e>2*c){const t=h.add(f.sub(h)._mult(c/e)._round());this.updateDistance(h,t),this.addCurrentVertex(t,A,0,0,l),h=t}}}}addCurrentVertex(e,t,r,n,i,o=!1){const s=t.x+t.y*r,a=t.y-t.x*r,u=-t.x+t.y*n,c=-t.y-t.x*n;this.addHalfVertex(e,s,a,o,!1,r,i),this.addHalfVertex(e,u,c,o,!0,-n,i)}addHalfVertex({x:e,y:t},r,n,i,o,s,a){this.layoutVertexArray.emplaceBack((e<<1)+(i?1:0),(t<<1)+(o?1:0),Math.round(63*r)+128,Math.round(63*n)+128,1+(0===s?0:s<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const u=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),a.primitiveLength++),o?this.e2=u:this.e1=u}updateScaledDistance(){if(this.lineClips){const e=this.lineClips.end-this.lineClips.start,t=this.totalDistance/e;this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}Sp(GC,"LineBucket",{omit:["layers","patternFeatures"]});const QC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),kC=QC(void 0,(function(){return kC.toString().search("(((.+)+)+)+$").toString().constructor(kC).search("(((.+)+)+)+$")}));kC();const zC=new pf({"line-cap":new lf(Ug.layout_line["line-cap"]),"line-join":new lf(Ug.layout_line["line-join"]),"line-miter-limit":new cf(Ug.layout_line["line-miter-limit"]),"line-round-limit":new cf(Ug.layout_line["line-round-limit"]),"line-sort-key":new lf(Ug.layout_line["line-sort-key"])});var jC={paint:new pf({"line-opacity":new lf(Ug.paint_line["line-opacity"]),"line-color":new lf(Ug.paint_line["line-color"]),"line-translate":new cf(Ug.paint_line["line-translate"]),"line-translate-anchor":new cf(Ug.paint_line["line-translate-anchor"]),"line-width":new lf(Ug.paint_line["line-width"]),"line-gap-width":new lf(Ug.paint_line["line-gap-width"]),"line-offset":new lf(Ug.paint_line["line-offset"]),"line-blur":new lf(Ug.paint_line["line-blur"]),"line-dasharray":new lf(Ug.paint_line["line-dasharray"]),"line-pattern":new lf(Ug.paint_line["line-pattern"]),"line-gradient":new hf(Ug.paint_line["line-gradient"]),"line-trim-offset":new cf(Ug.paint_line["line-trim-offset"])}),layout:zC};const HC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),qC=HC(void 0,(function(){return qC.toString().search("(((.+)+)+)+$").toString().constructor(qC).search("(((.+)+)+)+$")}));qC();const VC=new class extends lf{possiblyEvaluate(e,t){return t=new $p(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=ip({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}}(jC.paint.properties["line-width"].specification);VC.useIntegerZoom=!0;function YC(e,t){return t>0?t+2*e:e}const XC=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),WC=XC(void 0,(function(){return WC.toString().search("(((.+)+)+)+$").toString().constructor(WC).search("(((.+)+)+)+$")}));WC();const KC=Cf([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$C=Cf([{name:"a_projected_pos",components:4,type:"Float32"},{name:"a_ecef_pos_high",components:3,type:"Float32"},{name:"a_ecef_pos_low",components:3,type:"Float32"}],4);Cf([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const JC=Cf([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ZC=Cf([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Cf([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const eb=Cf([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);Cf([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),Cf([{name:"triangle",components:3,type:"Uint16"}]),Cf([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Cf([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Cf([{type:"Float32",name:"offsetX"}]),Cf([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var tb,rb=(tb=!0,function(e,t){var r=tb?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return tb=!1,r}),nb=rb(void 0,(function(){return nb.toString().search("(((.+)+)+)+$").toString().constructor(nb).search("(((.+)+)+)+$")}));nb();var ib=24;const ob=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),sb=ob(void 0,(function(){return sb.toString().search("(((.+)+)+)+$").toString().constructor(sb).search("(((.+)+)+)+$")}));sb();const ab=128;function ub(e,t){const{expression:r}=t;if("constant"===r.kind){return{kind:"constant",layoutSize:r.evaluate(new $p(e+1))}}if("source"===r.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=r;let i=0;for(;i<t.length&&t[i]<=e;)i++;i=Math.max(0,i-1);let o=i;for(;o<t.length&&t[o]<e+1;)o++;o=Math.min(t.length-1,o);const s=t[i],a=t[o];if("composite"===r.kind)return{kind:"composite",minZoom:s,maxZoom:a,interpolationType:n};return{kind:"camera",minZoom:s,maxZoom:a,minSize:r.evaluate(new $p(s)),maxSize:r.evaluate(new $p(a)),interpolationType:n}}}function cb(e,{uSize:t,uSizeT:r},{lowerSize:n,upperSize:i}){return"source"===e.kind?n/ab:"composite"===e.kind?Dt(n/ab,i/ab,r):t}function lb(e,t){let r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:i,minZoom:o,maxZoom:s}=e,a=i?tp(rr.interpolationFactor(i,t,o,s),0,1):0;"camera"===e.kind?n=Dt(e.minSize,e.maxSize,a):r=a}return{uSizeT:r,uSize:n}}var hb,pb=(hb=!0,function(e,t){var r=hb?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return hb=!1,r}),fb=pb(void 0,(function(){return fb.toString().search("(((.+)+)+)+$").toString().constructor(fb).search("(((.+)+)+)+$")}));function db(e,t,r){return e.sections.forEach((function(e){var n,i,o;e.text=(n=e.text,i=r,"uppercase"===(o=t.layout.get("text-transform").evaluate(i,{}))?n=n.toLocaleUpperCase():"lowercase"===o&&(n=n.toLocaleLowerCase()),n)})),e}fb();var Ab,gb=(Ab=!0,function(e,t){var r=Ab?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Ab=!1,r}),_b=gb(void 0,(function(){return _b.toString().search("(((.+)+)+)+$").toString().constructor(_b).search("(((.+)+)+)+$")}));_b();var mb,yb=(mb=!0,function(e,t){var r=mb?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return mb=!1,r}),Eb=yb(void 0,(function(){return Eb.toString().search("(((.+)+)+)+$").toString().constructor(Eb).search("(((.+)+)+)+$")}));Eb();var xb=function(e){return e>=128&&e<=255},Cb=function(e){return e>=1536&&e<=1791},bb=function(e){return e>=1872&&e<=1919},Ib=function(e){return e>=2208&&e<=2303},vb=function(e){return e>=4352&&e<=4607},Tb=function(e){return e>=5120&&e<=5759},Rb=function(e){return e>=6320&&e<=6399},Sb=function(e){return e>=8192&&e<=8303},Mb=function(e){return e>=8448&&e<=8527},wb=function(e){return e>=8528&&e<=8591},Bb=function(e){return e>=8960&&e<=9215},Ob=function(e){return e>=9216&&e<=9279},Db=function(e){return e>=9280&&e<=9311},Fb=function(e){return e>=9312&&e<=9471},Pb=function(e){return e>=9632&&e<=9727},Nb=function(e){return e>=9728&&e<=9983},Lb=function(e){return e>=11008&&e<=11263},Ub=function(e){return e>=11904&&e<=12031},Gb=function(e){return e>=12032&&e<=12255},Qb=function(e){return e>=12272&&e<=12287},kb=function(e){return e>=12288&&e<=12351},zb=function(e){return e>=12352&&e<=12447},jb=function(e){return e>=12448&&e<=12543},Hb=function(e){return e>=12544&&e<=12591},qb=function(e){return e>=12592&&e<=12687},Vb=function(e){return e>=12688&&e<=12703},Yb=function(e){return e>=12704&&e<=12735},Xb=function(e){return e>=12736&&e<=12783},Wb=function(e){return e>=12784&&e<=12799},Kb=function(e){return e>=12800&&e<=13055},$b=function(e){return e>=13056&&e<=13311},Jb=function(e){return e>=13312&&e<=19903},Zb=function(e){return e>=19904&&e<=19967},eI=function(e){return e>=19968&&e<=40959},tI=function(e){return e>=40960&&e<=42127},rI=function(e){return e>=42128&&e<=42191},nI=function(e){return e>=43360&&e<=43391},iI=function(e){return e>=44032&&e<=55215},oI=function(e){return e>=55216&&e<=55295},sI=function(e){return e>=57344&&e<=63743},aI=function(e){return e>=63744&&e<=64255},uI=function(e){return e>=64336&&e<=65023},cI=function(e){return e>=65040&&e<=65055},lI=function(e){return e>=65072&&e<=65103},hI=function(e){return e>=65104&&e<=65135},pI=function(e){return e>=65136&&e<=65279},fI=function(e){return e>=65280&&e<=65519};const dI=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),AI=dI(void 0,(function(){return AI.toString().search("(((.+)+)+)+$").toString().constructor(AI).search("(((.+)+)+)+$")}));function gI(e){for(const t of e)if(EI(t.charCodeAt(0)))return!0;return!1}function _I(e){for(const t of e)if(!mI(t.charCodeAt(0)))return!1;return!0}function mI(e){return!Cb(e)&&(!bb(e)&&(!Ib(e)&&(!uI(e)&&!pI(e))))}function yI(e){return!(e<11904)&&(!!Yb(e)||(!!Hb(e)||(!!lI(e)||(!!aI(e)||(!!$b(e)||(!!Ub(e)||(!!Xb(e)||(!!kb(e)||(!!Jb(e)||(!!eI(e)||(!!Kb(e)||(!!fI(e)||(!!zb(e)||(!!Qb(e)||(!!Gb(e)||(!!Wb(e)||(!!jb(e)||(!!cI(e)||(!!rI(e)||!!tI(e))))))))))))))))))))}function EI(e){return 746===e||747===e||!(e<4352)&&(!!Yb(e)||(!!Hb(e)||(!(!lI(e)||e>=65097&&e<=65103)||(!!aI(e)||(!!$b(e)||(!!Ub(e)||(!!Xb(e)||(!(!kb(e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||(!!Jb(e)||(!!eI(e)||(!!Kb(e)||(!!qb(e)||(!!nI(e)||(!!oI(e)||(!!vb(e)||(!!iI(e)||(!!zb(e)||(!!Qb(e)||(!!Vb(e)||(!!Gb(e)||(!!Wb(e)||(!(!jb(e)||12540===e)||(!(!fI(e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||(!(!hI(e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||(!!Tb(e)||(!!Rb(e)||(!!cI(e)||(!!Zb(e)||(!!tI(e)||!!rI(e))))))))))))))))))))))))))))))}function xI(e){return!(EI(e)||(t=e,xb(t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Sb(t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Mb(t)||wb(t)||Bb(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ob(t)&&9251!==t||Db(t)||Fb(t)||Pb(t)||Nb(t)&&!(t>=9754&&t<=9759)||Lb(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||kb(t)||jb(t)||sI(t)||lI(t)||hI(t)||fI(t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t));var t}function CI(e){return Cb(e)||bb(e)||Ib(e)||uI(e)||pI(e)}function bI(e){for(const r of e)if((t=r.charCodeAt(0))>=1424&&t<=2303||uI(t)||pI(t))return!0;var t;return!1}AI();const II=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),vI=II(void 0,(function(){return vI.toString().search("(((.+)+)+)+$").toString().constructor(vI).search("(((.+)+)+)+$")}));vI();const TI={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};const RI=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),SI=RI(void 0,(function(){return SI.toString().search("(((.+)+)+)+$").toString().constructor(SI).search("(((.+)+)+)+$")}));SI();const MI=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),wI=MI(void 0,(function(){return wI.toString().search("(((.+)+)+)+$").toString().constructor(wI).search("(((.+)+)+)+$")}));wI();const BI="loading",OI="loaded";let DI="unavailable",FI=null;const PI={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>DI===OI||null!=PI.applyArabicShaping,isLoading:()=>DI===BI,setState(e){DI=e.pluginStatus,FI=e.pluginURL},isParsed:()=>null!=PI.applyArabicShaping,getPluginURL:()=>FI};var NI=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,l=-7,h=r?i-1:0,p=r?-1:1,f=e[t+h];for(h+=p,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=p,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+h],h+=p,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=c}return(f?-1:1)*s*Math.pow(2,o-n)},LI=function(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,d=n?1:-1,A=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+h>=1?p/u:p*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*u-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+f]=255&s,f+=d,s/=256,c-=8);e[r+f-d]|=128*A};function UI(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}UI.Varint=0,UI.Fixed64=1,UI.Bytes=2,UI.Fixed32=5;var GI=4294967296,QI=1/GI;function kI(e){return e.type===UI.Bytes?e.readVarint()+e.pos:e.pos+1}function zI(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function jI(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.ceil(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function HI(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function qI(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function VI(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function YI(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function XI(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function WI(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function KI(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function $I(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function JI(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function ZI(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function ev(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function tv(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}UI.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=ZI(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=tv(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=ZI(this.buf,this.pos)+ZI(this.buf,this.pos+4)*GI;return this.pos+=8,e},readSFixed64:function(){var e=ZI(this.buf,this.pos)+tv(this.buf,this.pos+4)*GI;return this.pos+=8,e},readFloat:function(){var e=NI(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=NI(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,i,o=r.buf;if(i=o[r.pos++],n=(112&i)>>4,i<128)return zI(e,n,t);if(i=o[r.pos++],n|=(127&i)<<3,i<128)return zI(e,n,t);if(i=o[r.pos++],n|=(127&i)<<10,i<128)return zI(e,n,t);if(i=o[r.pos++],n|=(127&i)<<17,i<128)return zI(e,n,t);if(i=o[r.pos++],n|=(127&i)<<24,i<128)return zI(e,n,t);if(i=o[r.pos++],n|=(1&i)<<31,i<128)return zI(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=function(e,t,r){var n="",i=t;for(;i<r;){var o,s,a,u=e[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>r)break;1===l?u<128&&(c=u):2===l?128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&((c=(15&u)<<12|(63&o)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),i+=l}return n}(this.buf,this.pos,e);return this.pos=e,t},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){var r=kI(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){var t=kI(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){var t=kI(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){var t=kI(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){var t=kI(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){var t=kI(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){var t=kI(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){var t=kI(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){var t=kI(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===UI.Varint)for(;this.buf[this.pos++]>127;);else if(t===UI.Bytes)this.pos=this.readVarint()+this.pos;else if(t===UI.Fixed32)this.pos+=4;else{if(t!==UI.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),ev(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),ev(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),ev(this.buf,-1&e,this.pos),ev(this.buf,Math.floor(e*QI),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),ev(this.buf,-1&e,this.pos),ev(this.buf,Math.floor(e*QI),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos]=127&e}(r,0,t),function(e,t){var r=(7&e)<<4;if(t.buf[t.pos++]|=r|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,o=0;o<t.length;o++){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&jI(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),LI(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),LI(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&jI(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,UI.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){this.writeMessage(e,HI,t)},writePackedSVarint:function(e,t){this.writeMessage(e,qI,t)},writePackedBoolean:function(e,t){this.writeMessage(e,XI,t)},writePackedFloat:function(e,t){this.writeMessage(e,VI,t)},writePackedDouble:function(e,t){this.writeMessage(e,YI,t)},writePackedFixed32:function(e,t){this.writeMessage(e,WI,t)},writePackedSFixed32:function(e,t){this.writeMessage(e,KI,t)},writePackedFixed64:function(e,t){this.writeMessage(e,$I,t)},writePackedSFixed64:function(e,t){this.writeMessage(e,JI,t)},writeBytesField:function(e,t){this.writeTag(e,UI.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,UI.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,UI.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,UI.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,UI.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,UI.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,UI.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,UI.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,UI.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,UI.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};const rv=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),nv=rv(void 0,(function(){return nv.toString().search("(((.+)+)+)+$").toString().constructor(nv).search("(((.+)+)+)+$")}));nv();function iv(e){for(var t=0,r=0,n=0,i=e;n<i.length;n+=1){var o=i[n];t+=o.w*o.h,r=Math.max(r,o.w)}e.sort((function(e,t){return t.h-e.h}));for(var s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],a=0,u=0,c=0,l=e;c<l.length;c+=1)for(var h=l[c],p=s.length-1;p>=0;p--){var f=s[p];if(!(h.w>f.w||h.h>f.h)){if(h.x=f.x,h.y=f.y,u=Math.max(u,h.y+h.h),a=Math.max(a,h.x+h.w),h.w===f.w&&h.h===f.h){var d=s.pop();p<s.length&&(s[p]=d)}else h.h===f.h?(f.x+=h.w,f.w-=h.w):h.w===f.w?(f.y+=h.h,f.h-=h.h):(s.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}return{w:a,h:u,fill:t/(a*u)||0}}const ov=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),sv=ov(void 0,(function(){return sv.toString().search("(((.+)+)+)+$").toString().constructor(sv).search("(((.+)+)+)+$")}));sv();class av{constructor(e,{pixelRatio:t,version:r,stretchX:n,stretchY:i,content:o}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=i,this.content=o,this.version=r}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class uv{constructor(e,t){const r={},n={};this.haveRenderCallbacks=[];const i=[];this.addImages(e,r,i),this.addImages(t,n,i);const{w:o,h:s}=iv(i),a=new Ex({width:o||1,height:s||1});for(const t in e){const n=e[t],i=r[t].paddedRect;Ex.copy(n.data,a,{x:0,y:0},{x:i.x+1,y:i.y+1},n.data)}for(const e in t){const r=t[e],i=n[e].paddedRect,o=i.x+1,s=i.y+1,u=r.data.width,c=r.data.height;Ex.copy(r.data,a,{x:0,y:0},{x:o,y:s},r.data),Ex.copy(r.data,a,{x:0,y:c-1},{x:o,y:s-1},{width:u,height:1}),Ex.copy(r.data,a,{x:0,y:0},{x:o,y:s+c},{width:u,height:1}),Ex.copy(r.data,a,{x:u-1,y:0},{x:o-1,y:s},{width:1,height:c}),Ex.copy(r.data,a,{x:0,y:0},{x:o+u,y:s},{width:1,height:c})}this.image=a,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(const n in e){const i=e[n],o={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(o),t[n]=new av(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((t=>e.hasImage(t))),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,i]=e.tl;r.update(t.data,void 0,{x:n,y:i})}}Sp(av,"ImagePosition"),Sp(uv,"ImageAtlas");const cv=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),lv=cv(void 0,(function(){return lv.toString().search("(((.+)+)+)+$").toString().constructor(lv).search("(((.+)+)+)+$")}));lv();const hv={horizontal:1,vertical:2,horizontalOnly:3},pv=-17;class fv{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const r=new fv;return r.scale=e||1,r.fontStack=t,r}static forImage(e){const t=new fv;return t.imageName=e,t}}class dv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const r=new dv;for(let n=0;n<e.sections.length;n++){const i=e.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,t)}return r}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(e){let t="";for(let r=0;r<e.length;r++){const n=e.charCodeAt(r+1)||null,i=e.charCodeAt(r-1)||null;n&&xI(n)&&!TI[e[r+1]]||i&&xI(i)&&!TI[e[r-1]]||!TI[e[r]]?t+=e[r]:t+=TI[e[r]]}return t}(this.text)}trim(){let e=0;for(let t=0;t<this.text.length&&gv[this.text.charCodeAt(t)];t++)e++;let t=this.text.length;for(let r=this.text.length-1;r>=0&&r>=e&&gv[this.text.charCodeAt(r)];r--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const r=new dv;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(fv.forText(e.scale,e.fontStack||t));const r=this.sections.length-1;for(let t=0;t<e.text.length;++t)this.sectionIndex.push(r)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void lp("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(fv.forImage(t)),this.sectionIndex.push(this.sections.length-1)):lp("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Av(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d){const A=dv.fromFeature(e,i);h===hv.vertical&&A.verticalizePunctuation(p);let g=[];const _=function(e,t,r,n,i,o){if(!e)return[];const s=[],a=function(e,t,r,n,i,o){let s=0;for(let r=0;r<e.length();r++){const a=e.getSection(r);s+=mv(e.getCharCode(r),a,n,i,t,o)}const a=Math.max(1,Math.ceil(s/r));return s/a}(e,t,r,n,i,o),u=e.text.indexOf("​")>=0;let c=0;for(let r=0;r<e.length();r++){const l=e.getSection(r),h=e.getCharCode(r);if(gv[h]||(c+=mv(h,l,n,i,t,o)),r<e.length()-1){const t=yI(h);(_v[h]||t||l.imageName)&&s.push(xv(r+1,c,a,s,Ev(h,e.getCharCode(r+1),t&&u),!1))}}return Cv(xv(e.length(),c,a,s,0,!0))}(A,c,o,t,n,f),{processBidirectionalText:m,processStyledBidirectionalText:y}=PI;if(m&&1===A.sections.length){const e=m(A.toString(),_);for(const t of e){const e=new dv;e.text=t,e.sections=A.sections;for(let r=0;r<t.length;r++)e.sectionIndex.push(0);g.push(e)}}else if(y){const e=y(A.text,A.sectionIndex,_);for(const t of e){const e=new dv;e.text=t[0],e.sectionIndex=t[1],e.sections=A.sections,g.push(e)}}else g=function(e,t){const r=[],n=e.text;let i=0;for(const n of t)r.push(e.substring(i,n)),i=n;return i<n.length&&r.push(e.substring(i,n.length)),r}(A,_);const E=[],x={positionedLines:E,text:A.toString(),top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,r,n,i,o,s,a,u,c,l,h){let p=0,f=0,d=0;const A="right"===a?1:"left"===a?0:.5;let g=!1;for(const e of i){const r=e.getSections();for(const e of r){if(e.imageName)continue;const r=t[e.fontStack];if(r&&(g=void 0!==r.ascender&&void 0!==r.descender,!g))break}if(!g)break}let _=0;for(const s of i){s.trim();const i=s.getMaxScale(),a=(i-1)*ib,m={positionedGlyphs:[],lineOffset:0};e.positionedLines[_]=m;const y=m.positionedGlyphs;let E=0;if(!s.length()){f+=o,++_;continue}let x=0,C=0;for(let o=0;o<s.length();o++){const a=s.getSection(o),d=s.getSectionIndex(o),A=s.getCharCode(o);let _=a.scale,m=null,b=null,I=null,v=ib,T=0;const R=!(u===hv.horizontal||!l&&!EI(A)||l&&(gv[A]||CI(A)));if(a.imageName){const t=n[a.imageName];if(!t)continue;I=a.imageName,e.iconsInText=e.iconsInText||!0,b=t.paddedRect;const r=t.displaySize;if(_=_*ib/h,m={width:r[0],height:r[1],left:1,top:-3,advance:R?r[1]:r[0],localGlyph:!1},g){T=-m.height*_}else T=pv+i*ib-r[1]*_;v=m.advance;const o=(R?r[0]:r[1])*_-ib*i;o>0&&o>E&&(E=o)}else{const e=r[a.fontStack];if(!e)continue;e[A]&&(b=e[A]);const n=t[a.fontStack];if(!n)continue;const o=n.glyphs[A];if(!o)continue;if(m=o.metrics,v=8203!==A?ib:0,g){const e=void 0!==n.ascender?Math.abs(n.ascender):0,t=void 0!==n.descender?Math.abs(n.descender):0,r=(e+t)*_;x<r&&(x=r,C=(e-t)/2*_),T=-e*_}else T=pv+(i-_)*ib}R?(e.verticalizable=!0,y.push({glyph:A,imageName:I,x:p,y:f+T,vertical:R,scale:_,localGlyph:m.localGlyph,fontStack:a.fontStack,sectionIndex:d,metrics:m,rect:b}),p+=v*_+c):(y.push({glyph:A,imageName:I,x:p,y:f+T,vertical:R,scale:_,localGlyph:m.localGlyph,fontStack:a.fontStack,sectionIndex:d,metrics:m,rect:b}),p+=m.advance*_+c)}if(0!==y.length){const e=p-c;d=Math.max(e,d),g?Iv(y,A,E,C,o*i/2):Iv(y,A,E,0,o/2)}p=0;const b=o*i+E;m.lineOffset=Math.max(E,a),f+=b,++_}const m=f,{horizontalAlign:y,verticalAlign:E}=bv(s);(function(e,t,r,n,i,o){const s=(t-r)*i,a=-o*n;for(const t of e)for(const e of t.positionedGlyphs)e.x+=s,e.y+=a})(e.positionedLines,A,y,E,d,m),e.top+=-E*m,e.bottom=e.top+m,e.left+=-y*d,e.right=e.left+d,e.hasBaseline=g}(x,t,r,n,g,s,a,u,h,c,p,d),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(E)&&x}const gv={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_v={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function mv(e,t,r,n,i,o){if(t.imageName){const e=n[t.imageName];return e?e.displaySize[0]*t.scale*ib/o+i:0}{const n=r[t.fontStack],o=n&&n.glyphs[e];return o?o.metrics.advance*t.scale+i:0}}function yv(e,t,r,n){const i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function Ev(e,t,r){let n=0;return 10===e&&(n-=1e4),r&&(n+=150),(40===e||65288===e)&&(n+=50),(41===t||65289===t)&&(n+=50),n}function xv(e,t,r,n,i,o){let s=null,a=yv(t,r,i,o);for(const e of n){const n=yv(t-e.x,r,i,o)+e.badness;n<=a&&(s=e,a=n)}return{index:e,x:t,priorBreak:s,badness:a}}function Cv(e){return e?Cv(e.priorBreak).concat(e.index):[]}function bv(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Iv(e,t,r,n,i){if(!(t||r||n||i))return;const o=e.length-1,s=e[o],a=s.metrics.advance*s.scale,u=(s.x+a)*t;for(let t=0;t<=o;t++)e[t].x-=u,e[t].y+=r+n+i}function vv(e,t,r){const{horizontalAlign:n,verticalAlign:i}=bv(r),o=t[0],s=t[1],a=o-e.displaySize[0]*n,u=a+e.displaySize[0],c=s-e.displaySize[1]*i;return{image:e,top:c,bottom:c+e.displaySize[1],left:a,right:u}}function Tv(e,t,r,n,i,o){"none"===r&&console.log("textFit === 'none'"),(!Array.isArray(n)||4!==n.length)&&console.log("!Array.isArray(padding) || padding.length !== 4"),(!Array.isArray(i)||2!==i.length)&&console.log("!Array.isArray(iconOffset) || iconOffset.length !== 2");const s=e.image;let a;if(s.content){const e=s.content,t=s.pixelRatio||1;a=[e[0]/t,e[1]/t,s.displaySize[0]-e[2]/t,s.displaySize[1]-e[3]/t]}const u=t.left*o,c=t.right*o;let l,h,p,f;"width"===r||"both"===r?(f=i[0]+u-n[3],h=i[0]+c+n[1]):(f=i[0]+(u+c-s.displaySize[0])/2,h=f+s.displaySize[0]);const d=t.top*o,A=t.bottom*o;return"height"===r||"both"===r?(l=i[1]+d-n[0],p=i[1]+A+n[2]):(l=i[1]+(d+A-s.displaySize[1])/2,p=l+s.displaySize[1]),{image:s,top:l,right:h,bottom:p,left:f,collisionPadding:a}}var Rv=function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));function i(t,r,n,i,o){e.call(this,t,r),this.angle=i,this.z=n,void 0!==o&&(this.segment=o)}return n(),e&&(i.__proto__=e),i.prototype=Object.create(e&&e.prototype),i.prototype.constructor=i,i.prototype.clone=function(){return new i(this.x,this.y,this.z,this.angle,this.segment)},i}(Pn);Sp(Rv,"Anchor");var Sv,Mv=(Sv=!0,function(e,t){var r=Sv?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Sv=!1,r}),wv=Mv(void 0,(function(){return wv.toString().search("(((.+)+)+)+$").toString().constructor(wv).search("(((.+)+)+)+$")}));function Bv(e,t,r,n,i){if(void 0===t.segment)return!0;for(var o=t,s=t.segment+1,a=0;a>-r/2;){if(--s<0)return!1;a-=e[s].dist(o),o=e[s]}a+=e[s].dist(e[s+1]),s++;for(var u=[],c=0;a<r/2;){var l=e[s-1],h=e[s],p=e[s+1];if(!p)return!1;var f=l.angleTo(h)-h.angleTo(p);for(f=Math.abs((f+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:a,angleDelta:f}),c+=f;a-u[0].distance>n;)c-=u.shift().angleDelta;if(c>i)return!1;s++,a+=h.dist(p)}return!0}wv();const Ov=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Dv=Ov(void 0,(function(){return Dv.toString().search("(((.+)+)+)+$").toString().constructor(Dv).search("(((.+)+)+)+$")}));function Fv(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Pv(e,t,r){return e?.6*t*r:0}function Nv(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Lv(e,t,r,n,i,o){const s=Pv(r,i,o),a=Nv(r,n)*o;let u=0;const c=Fv(e)/2;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1],o=n.dist(i);if(u+o>c){const l=(c-u)/o,h=Dt(n.x,i.x,l),p=Dt(n.y,i.y,l),f=new Rv(h,p,0,i.angleTo(n),r);return!s||Bv(e,f,a,s,t)?f:void 0}u+=o}}function Uv(e,t,r,n,i,o,s,a,u,c){const l=Pv(n,o,s),h=Nv(n,i),p=h*s,f=0===e[0].x||e[0].x===u||0===e[0].y||e[0].y===u;t-p<t/4&&(t=p+t/4);return Gv(e,f?t/2*a%t:(h/2+2*o)*s*a%t,t,l,r,p,f,!1,u,c)}function Gv(e,t,r,n,i,o,s,a,u,c){const l=o/2,h=Fv(e);let p=0,f=t-r,d=[];for(let t=0;t<e.length-1;t++){const s=e[t],a=e[t+1],A=s.dist(a),g=a.angleTo(s);for(;f+r<p+A;){f+=r;const _=(f-p)/A,m=Dt(s.x,a.x,_),y=Dt(s.y,a.y,_);if(m>=0&&m<u&&y>=0&&y<u&&f-l>=0&&f+l<=h){const r=new Rv(m,y,0,g,t);r._round(),(c||!n||Bv(e,r,o,n,i))&&d.push(r)}}p+=A}return!a&&!d.length&&!s&&(d=Gv(e,p/2,r,n,i,o,s,!0,u)),d}Dv();var Qv,kv=(Qv=!0,function(e,t){var r=Qv?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Qv=!1,r}),zv=kv(void 0,(function(){return zv.toString().search("(((.+)+)+)+$").toString().constructor(zv).search("(((.+)+)+)+$")}));zv();const jv=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Hv=jv(void 0,(function(){return Hv.toString().search("(((.+)+)+)+$").toString().constructor(Hv).search("(((.+)+)+)+$")}));Hv();const qv=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Vv=qv(void 0,(function(){return Vv.toString().search("(((.+)+)+)+$").toString().constructor(Vv).search("(((.+)+)+)+$")}));Vv();const Yv=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Xv=Yv(void 0,(function(){return Xv.toString().search("(((.+)+)+)+$").toString().constructor(Xv).search("(((.+)+)+)+$")}));Xv();const Wv=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Kv=Wv(void 0,(function(){return Kv.toString().search("(((.+)+)+)+$").toString().constructor(Kv).search("(((.+)+)+)+$")}));Kv();function $v(e,t,r,n){const i=[],o=e.image,s=o.pixelRatio,a=o.paddedRect.w-2,u=o.paddedRect.h-2,c=e.right-e.left,l=e.bottom-e.top,h=o.stretchX||[[0,a]],p=o.stretchY||[[0,u]],f=(e,t)=>e+t[1]-t[0],d=h.reduce(f,0),A=p.reduce(f,0),g=a-d,_=u-A;let m=0,y=d,E=0,x=A,C=0,b=g,I=0,v=_;if(o.content&&n){const e=o.content;m=Jv(h,0,e[0]),E=Jv(p,0,e[1]),y=Jv(h,e[0],e[2]),x=Jv(p,e[1],e[3]),C=e[0]-m,I=e[1]-E,b=e[2]-e[0]-y,v=e[3]-e[1]-x}const T=(n,i,a,u)=>{const h=eT(n.stretch-m,y,c,e.left),p=tT(n.fixed-C,b,n.stretch,d),f=eT(i.stretch-E,x,l,e.top),g=tT(i.fixed-I,v,i.stretch,A),_=eT(a.stretch-m,y,c,e.left),T=tT(a.fixed-C,b,a.stretch,d),R=eT(u.stretch-E,x,l,e.top),S=tT(u.fixed-I,v,u.stretch,A),M=new Pn(h,f),w=new Pn(_,f),B=new Pn(_,R),O=new Pn(h,R),D=new Pn(p/s,g/s),F=new Pn(T/s,S/s),P=t*Math.PI/180;if(P){const e=Math.sin(P),t=Math.cos(P),r=[t,-e,e,t];M._matMult(r),w._matMult(r),O._matMult(r),B._matMult(r)}const N=n.stretch+n.fixed,L=a.stretch+a.fixed,U=i.stretch+i.fixed,G=u.stretch+u.fixed;return{tl:M,tr:w,bl:O,br:B,tex:{x:o.paddedRect.x+1+N,y:o.paddedRect.y+1+U,w:L-N,h:G-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:F,minFontScaleX:b/s/c,minFontScaleY:v/s/l,isSDF:r}};if(n&&(o.stretchX||o.stretchY)){const e=Zv(h,g,d),t=Zv(p,_,A);for(let r=0;r<e.length-1;r++){const n=e[r],o=e[r+1];for(let e=0;e<t.length-1;e++){const r=t[e],s=t[e+1];i.push(T(n,r,o,s))}}}else i.push(T({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:a+1},{fixed:0,stretch:u+1}));return i}function Jv(e,t,r){let n=0;for(const i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function Zv(e,t,r){const n=[{fixed:-1,stretch:0}];for(const[t,r]of e){const e=n[n.length-1];n.push({fixed:t-e.stretch,stretch:e.stretch}),n.push({fixed:t-e.stretch,stretch:e.stretch+(r-t)})}return n.push({fixed:t+1,stretch:r}),n}function eT(e,t,r,n){return e/t*r+n}function tT(e,t,r,n){return e-t*r/n}function rT(e,t,r,n){const i=t+e.positionedLines[n].lineOffset;if(0===n)return r+i/2;return r+(i+(t+e.positionedLines[n-1].lineOffset))/2}var nT,iT=(nT=!0,function(e,t){var r=nT?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return nT=!1,r}),oT=iT(void 0,(function(){return oT.toString().search("(((.+)+)+)+$").toString().constructor(oT).search("(((.+)+)+)+$")}));function sT(e,t,r){void 0===t&&(t=1),void 0===r&&(r=!1);for(var n=1/0,i=1/0,o=-1/0,s=-1/0,a=e[0],u=0;u<a.length;u++){var c=a[u];(!u||c.x<n)&&(n=c.x),(!u||c.y<i)&&(i=c.y),(!u||c.x>o)&&(o=c.x),(!u||c.y>s)&&(s=c.y)}var l=o-n,h=s-i,p=Math.min(l,h),f=p/2,d=new TinyQueue([],aT);if(0===p)return new Pn(n,i);for(var A=n;A<o;A+=p)for(var g=i;g<s;g+=p)d.push(new uT(A+f,g+f,f,e));for(var _=function(e){for(var t=0,r=0,n=0,i=e[0],o=0,s=i.length,a=s-1;o<s;a=o++){var u=i[o],c=i[a],l=u.x*c.y-c.x*u.y;r+=(u.x+c.x)*l,n+=(u.y+c.y)*l,t+=3*l}return new uT(r/t,n/t,0,e)}(e),m=d.length;d.length;){var y=d.pop();(y.d>_.d||!_.d)&&(_=y,r&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,m)),y.max-_.d<=t||(f=y.h/2,d.push(new uT(y.p.x-f,y.p.y-f,f,e)),d.push(new uT(y.p.x+f,y.p.y-f,f,e)),d.push(new uT(y.p.x-f,y.p.y+f,f,e)),d.push(new uT(y.p.x+f,y.p.y+f,f,e)),m+=4)}return r&&(console.log("num probes: "+m),console.log("best distance: "+_.d)),_.p}function aT(e,t){return t.max-e.max}function uT(e,t,r,n){this.p=new Pn(e,t),this.h=r,this.d=function(e,t){for(var r=!1,n=1/0,i=0;i<t.length;i++)for(var o=t[i],s=0,a=o.length,u=a-1;s<a;u=s++){var c=o[s],l=o[u];c.y>e.y!=l.y>e.y&&e.x<(l.x-c.x)*(e.y-c.y)/(l.y-c.y)+c.x&&(r=!r),n=Math.min(n,P_(e,c,l))}return(r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}function cT(e,t){var r,n,i,o,s,a,u,c;for(r=3&e.length,n=e.length-r,i=t,s=3432918353,a=461845907,c=0;c<n;)u=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*s+(((u>>>16)*s&65535)<<16)&4294967295)<<15|u>>>17))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&e.charCodeAt(c+2))<<16;case 2:u^=(255&e.charCodeAt(c+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(c)))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<15|u>>>17))*a+(((u>>>16)*a&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}oT();const lT=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),hT=lT(void 0,(function(){return hT.toString().search("(((.+)+)+)+$").toString().constructor(hT).search("(((.+)+)+)+$")}));hT();const pT=Number.POSITIVE_INFINITY,fT=Math.sqrt(2);function dT(e,[t,r]){let n=0,i=0;if(r===pT){t<0&&(t=0);const r=t/fT;switch(e){case"top-right":case"top-left":i=r-7;break;case"bottom-right":case"bottom-left":i=7-r;break;case"bottom":i=7-t;break;case"top":i=t-7}switch(e){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=t;break;case"right":n=-t}}else{switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}}return[n,i]}function AT(e,t,r,n,i,o,s,a,u,c,l){e.createArrays();const h=512*e.overscaling;e.tilePixelRatio=Ec/h,e.compareText={},e.iconsNeedLinear=!1;const p=e.layers[0].layout,f=e.layers[0]._unevaluatedLayout._values,d={};if("composite"===e.textSizeData.kind){const{minZoom:t,maxZoom:r}=e.textSizeData;d.compositeTextSizes=[f["text-size"].possiblyEvaluate(new $p(t),a),f["text-size"].possiblyEvaluate(new $p(r),a)]}if("composite"===e.iconSizeData.kind){const{minZoom:t,maxZoom:r}=e.iconSizeData;d.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new $p(t),a),f["icon-size"].possiblyEvaluate(new $p(r),a)]}d.layoutTextSize=f["text-size"].possiblyEvaluate(new $p(u+1),a),d.layoutIconSize=f["icon-size"].possiblyEvaluate(new $p(u+1),a),d.textMaxSize=f["text-size"].possiblyEvaluate(new $p(18),a);const A="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),g=p.get("text-size");!A&&(e.text.createLngLatQuadsArray(),e.icon.createLngLatQuadsArray());for(const o of e.features){const u=p.get("text-font").evaluate(o,{},a).join(","),h=g.evaluate(o,{},a),f=d.layoutTextSize.evaluate(o,{},a),_=d.layoutIconSize.evaluate(o,{},a),m={horizontal:{},vertical:void 0},y=o.text;let E=[0,0];if(y){const n=y.toString(),s=p.get("text-letter-spacing").evaluate(o,{},a)*ib,c=p.get("text-line-height").evaluate(o,{},a)*ib,l=_I(n)?s:0,d=p.get("text-anchor").evaluate(o,{},a),g=p.get("text-variable-anchor");if(!g){const e=p.get("text-radial-offset").evaluate(o,{},a);E=e?dT(d,[e*ib,pT]):p.get("text-offset").evaluate(o,{},a).map((e=>e*ib))}let _=A?"center":p.get("text-justify").evaluate(o,{},a);const x="point"===p.get("symbol-placement"),C=x?p.get("text-max-width").evaluate(o,{},a)*ib:1/0,b=o=>{e.allowVerticalPlacement&&gI(n)&&(m.vertical=Av(y,t,r,i,u,C,c,d,o,l,E,hv.vertical,!0,f,h))};if(!A&&g){const e="auto"===_?g.map((e=>gT(e))):[_];let n=!1;for(let o=0;o<e.length;o++){const s=e[o];if(!m.horizontal[s])if(n)m.horizontal[s]=m.horizontal[0];else{const e=Av(y,t,r,i,u,C,c,"center",s,l,E,hv.horizontal,!1,f,h);e&&(m.horizontal[s]=e,n=1===e.positionedLines.length)}}b("left")}else{if("auto"===_&&(_=gT(d)),x||p.get("text-writing-mode").indexOf("horizontal")>=0||!gI(n)){const e=Av(y,t,r,i,u,C,c,d,_,l,E,hv.horizontal,!1,f,h);e&&(m.horizontal[_]=e)}b(x?"left":_)}}let x,C=!1;if(o.icon&&o.icon.name){const t=n[o.icon.name];t&&(x=vv(i[o.icon.name],p.get("icon-offset").evaluate(o,{},a),p.get("icon-anchor").evaluate(o,{},a)),C=t.sdf,void 0===e.sdfIcons?e.sdfIcons=t.sdf:e.sdfIcons!==t.sdf&&lp("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.pixelRatio||0!==p.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const b=xT(m.horizontal)||m.vertical;!e.iconsInText&&(e.iconsInText=!!b&&b.iconsInText),(b||x)&&_T(e,o,m,x,n,d,f,_,E,C,s,a,c,l)}o&&e.generateCollisionDebugBuffers(u,e.collisionBoxArray)}function gT(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _T(e,t,r,n,i,o,s,a,u,c,l,h,p,f){let d=o.textMaxSize.evaluate(t,{},h);void 0===d&&(d=s);const A=e.layers[0].layout,g=A.get("icon-offset").evaluate(t,{},h),_=xT(r.horizontal)||r.vertical,m=s/24,y=e.tilePixelRatio*d/24,E=(e.tilePixelRatio,function(e,t){t>18&&e>2&&(e>>=1);const r=Ec/(512*e);return Math.max(r,1)}(e.overscaling,e.zoom)*A.get("symbol-spacing")),x=A.get("text-padding")*e.tilePixelRatio,C=A.get("icon-padding")*e.tilePixelRatio,b=Zh(A.get("text-max-angle")),I="map"===A.get("text-rotation-alignment")&&"point"!==A.get("symbol-placement"),v="map"===A.get("icon-rotation-alignment")&&"point"!==A.get("symbol-placement"),T=A.get("symbol-placement"),R=E/2,S=A.get("ignore-line-rotation"),M=A.get("icon-text-fit");let w;n&&"none"!==M&&(e.allowVerticalPlacement&&r.vertical&&(w=Tv(n,r.vertical,M,A.get("icon-text-fit-padding"),g,m)),_&&(n=Tv(n,_,M,A.get("icon-text-fit-padding"),g,m)));const B=(s,a,p)=>{if(a.x<0||a.x>=Ec||a.y<0||a.y>=Ec)return;const d=Ap(f,a.x,a.y,p);!function(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E,x,C,b,I,v,T){const R=e.addToLineVertexArray(t,i);let S,M,w,B,O,D,F,P=0,N=0,L=0,U=0,G=-1,Q=-1;const k={};let z=cT("");const j=n?n.anchor:t;let H=0,q=0;if(void 0===c._unevaluatedLayout.getValue("text-radial-offset")?[H,q]=c.layout.get("text-offset").evaluate(x,{},v).map((e=>e*ib)):(H=c.layout.get("text-radial-offset").evaluate(x,{},v)*ib,q=pT),e.allowVerticalPlacement&&o.vertical){const e=o.vertical;if(A)D=bT(e),u&&(F=bT(u));else{const n=c.layout.get("text-rotate").evaluate(x,{},v)+90;w=CT(l,j,t,r,h,p,f,e,d,n,g),u&&(B=CT(l,j,t,r,h,p,f,u,m,n))}}if(s){const i=c.layout.get("icon-rotate").evaluate(x,{},v),o="none"!==c.layout.get("icon-text-fit"),a=$v(s,i,b,o),d=u?$v(u,i,b,o):void 0;M=CT(l,j,t,r,h,p,f,s,m,i),P=4*a.length;const A=e.iconSizeData;let g=null;"source"===A.kind?(g=[ab*c.layout.get("icon-size").evaluate(x,{},v)],g[0]>yT&&lp(e.layerIds[0]+': Value for "icon-size" is >= '+mT+'. Reduce your "icon-size".')):"composite"===A.kind&&(g=[ab*C.compositeIconSizes[0].evaluate(x,{},v),ab*C.compositeIconSizes[1].evaluate(x,{},v)],(g[0]>yT||g[1]>yT)&&lp(e.layerIds[0]+': Value for "icon-size" is >= '+mT+'. Reduce your "icon-size".')),e.addSymbols(e.icon,a,g,E,y,x,!1,n,t,r,R.lineStartIndex,R.lineLength,-1,I,v,T),G=e.icon.placedSymbolArray.length-1,d&&(N=4*d.length,e.addSymbols(e.icon,d,g,E,y,x,hv.vertical,n,t,r,R.lineStartIndex,R.lineLength,-1,I,v,T),Q=e.icon.placedSymbolArray.length-1)}for(const i in o.horizontal){const s=o.horizontal[i];if(!S)if(z=cT(s.text),A)O=bT(s);else{S=CT(l,j,t,r,h,p,f,s,d,c.layout.get("text-rotate").evaluate(x,{},v),g)}const u=1===s.positionedLines.length;if(L+=ET(e,n,t,r,s,a,c,A,x,g,R,o.vertical?hv.horizontal:hv.horizontalOnly,u?Object.keys(o.horizontal):[i],k,G,C,I,v,T),u)break}o.vertical&&(U+=ET(e,n,t,r,o.vertical,a,c,A,x,g,R,hv.vertical,["vertical"],k,Q,C,I,v,T));let V=-1;const Y=(e,t)=>e?Math.max(e,t):t;V=Y(O,V),V=Y(D,V),V=Y(F,V);const X=V>-1?1:0;e.glyphOffsetArray.length>=65535&&lp("Too many glyphs being rendered in a tile.");void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey);const W=j;e.symbolInstances.emplaceBack(W.x,W.y,W.z,t.x,t.y,k.right>=0?k.right:-1,k.center>=0?k.center:-1,k.left>=0?k.left:-1,k.vertical>=0?k.vertical:-1,G,Q,z,void 0!==S?S:e.collisionBoxArray.length,void 0!==S?S+1:e.collisionBoxArray.length,void 0!==w?w:e.collisionBoxArray.length,void 0!==w?w+1:e.collisionBoxArray.length,void 0!==M?M:e.collisionBoxArray.length,void 0!==M?M+1:e.collisionBoxArray.length,B||e.collisionBoxArray.length,B?B+1:e.collisionBoxArray.length,h,L,U,P,N,X,0,H,q,V)}(e,a,d,null,s,r,n,i,w,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,x,I,u,0,C,v,g,t,o,c,l,h,f)};if("line"===T||"line-direction"===T)for(const i of function(e,t,r,n,i){for(var o=[],s=0;s<e.length;s++)for(var a=e[s],u=void 0,c=0;c<a.length-1;c++){var l=a[c],h=a[c+1];l.x<t&&h.x<t||(l.x<t?l=new Pn(t,l.y+(h.y-l.y)*((t-l.x)/(h.x-l.x)))._round():h.x<t&&(h=new Pn(t,l.y+(h.y-l.y)*((t-l.x)/(h.x-l.x)))._round()),l.y<r&&h.y<r||(l.y<r?l=new Pn(l.x+(h.x-l.x)*((r-l.y)/(h.y-l.y)),r)._round():h.y<r&&(h=new Pn(l.x+(h.x-l.x)*((r-l.y)/(h.y-l.y)),r)._round()),l.x>=n&&h.x>=n||(l.x>=n?l=new Pn(n,l.y+(h.y-l.y)*((n-l.x)/(h.x-l.x)))._round():h.x>=n&&(h=new Pn(n,l.y+(h.y-l.y)*((n-l.x)/(h.x-l.x)))._round()),l.y>=i&&h.y>=i||(l.y>=i?l=new Pn(l.x+(h.x-l.x)*((i-l.y)/(h.y-l.y)),i)._round():h.y>=i&&(h=new Pn(l.x+(h.x-l.x)*((i-l.y)/(h.y-l.y)),i)._round()),(!u||!l.equals(u[u.length-1]))&&(u=[l],o.push(u)),u.push(h)))))}return o}(t.geometry,0,0,Ec,Ec)){const t=Uv(i,E,b,r.vertical||_,n,24,y,e.overscaling,Ec,S);for(const r of t){(!_||!IT(e,_.text,R,r))&&B(i,r,h)}}else if("line-center"===T){for(const e of t.geometry)if(e.length>1){const t=Lv(e,b,r.vertical||_,n,24,y);t&&B(e,t,h)}}else if("Polygon"===t.type)for(const e of Lx(t.geometry,0)){const t=sT(e,16);B(e[0],new Rv(t.x,t.y,0,0,void 0),h)}else if("LineString"===t.type)for(const e of t.geometry)B(e,new Rv(e[0].x,e[0].y,0,0,void 0),h);else if("Point"===t.type)for(const e of t.geometry)for(const t of e)B([t],new Rv(t.x,t.y,0,0,void 0),h)}const mT=255,yT=mT*ab;function ET(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m){const y=function(e,t,r,n,i,o,s,a){const u=[];if(0===t.positionedLines.length)return u;const c=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,l=function(e){const t=e[0],r=e[1],n=t*r;return n>0?[t,-r]:n<0?[-t,r]:0===t?[r,t]:[r,-t]}(r);let h=Math.abs(t.top-t.bottom);for(const e of t.positionedLines)h-=e.lineOffset;const p=t.positionedLines.length,f=h/p;let d=t.top-r[1];for(let e=0;e<p;++e){const n=t.positionedLines[e];d=rT(t,f,d,e);for(const e of n.positionedGlyphs){if(!e.rect)continue;const n=e.rect||{};let o=4,h=!0,p=1,f=0;if(e.imageName){const t=s[e.imageName];if(!t)continue;if(t.sdf){lp("SDF images are not supported in formatted text and will be ignored.");continue}h=!1,p=t.pixelRatio,o=1/p}const _=(i||a)&&e.vertical,m=e.metrics.advance*e.scale/2,y=e.metrics,E=e.rect;if(null===E)continue;a&&t.verticalizable&&(f=e.imageName?m-e.metrics.width*e.scale/2:0);const x=i?[e.x+m,e.y]:[0,0];let C=[0,0],b=[0,0],I=!1;!i&&(_?(b=[e.x+m+l[0],e.y+l[1]-f],I=!0):C=[e.x+m+r[0],e.y+r[1]-f]);const v=E.w*e.scale/(p*(e.localGlyph?2:1)),T=E.h*e.scale/(p*(e.localGlyph?2:1));let R,S,M,w;if(_){const t=e.y-d,r=new Pn(-m,m-t),n=-Math.PI/2,i=new Pn(...b);R=new Pn(-m+C[0],C[1]),R._rotateAround(n,r)._add(i),R.x+=-t+m,R.y-=(y.left-o)*e.scale;const s=e.imageName?y.advance*e.scale:ib*e.scale,a=String.fromCharCode(e.glyph);if("︶"===(g=a)||"﹈"===g||"︸"===g||"﹄"===g||"﹂"===g||"︾"===g||"︼"===g||"︺"===g||"︘"===g||"﹀"===g||"︐"===g||"︓"===g||"︔"===g||"｀"===g||"￣"===g||"︑"===g||"︒"===g)R.x+=(1-o)*e.scale;else if("︵"===(A=a)||"﹇"===A||"︷"===A||"﹃"===A||"﹁"===A||"︽"===A||"︻"===A||"︹"===A||"︗"===A||"︿"===A){const t=s-y.height*e.scale;R.x+=t+(-o-1)*e.scale}else if(e.imageName||y.width+2*o===E.w&&y.height+2*o===E.h){const e=s-T;R.x+=e/2}else{const t=s-(y.height+2*o)*e.scale;R.x+=t/2}S=new Pn(R.x,R.y-v),M=new Pn(R.x+T,R.y),w=new Pn(R.x+T,R.y-v)}else{const t=(y.left-o)*e.scale-m+C[0],r=(-y.top-o)*e.scale+C[1],n=t+v,i=r+T;R=new Pn(t,r),S=new Pn(n,r),M=new Pn(t,i),w=new Pn(n,i)}if(c){let e;e=i?new Pn(0,0):I?new Pn(l[0],l[1]):new Pn(r[0],r[1]),R._rotateAround(c,e),S._rotateAround(c,e),M._rotateAround(c,e),w._rotateAround(c,e)}const B=new Pn(0,0),O=new Pn(0,0),D=0,F=0;u.push({tl:R,tr:S,bl:M,br:w,tex:n,writingMode:t.writingMode,glyphOffset:x,sectionIndex:e.sectionIndex,isSDF:h,pixelOffsetTL:B,pixelOffsetBR:O,minFontScaleX:D,minFontScaleY:F})}}var A,g;return u}(0,i,c,s,a,u,o,e.allowVerticalPlacement),E=e.textSizeData;let x=null;"source"===E.kind?(x=[ab*s.layout.get("text-size").evaluate(u,{},_)],x[0]>yT&&lp(e.layerIds[0]+': Value for "text-size" is >= '+mT+'. Reduce your "text-size".')):"composite"===E.kind&&(x=[ab*A.compositeTextSizes[0].evaluate(u,{},_),ab*A.compositeTextSizes[1].evaluate(u,{},_)],(x[0]>yT||x[1]>yT)&&lp(e.layerIds[0]+': Value for "text-size" is >= '+mT+'. Reduce your "text-size".')),e.addSymbols(e.text,y,x,c,a,u,h,t,r,n,l.lineStartIndex,l.lineLength,d,g,_,m);for(const t of p)f[t]=e.text.placedSymbolArray.length-1;return 4*y.length}function xT(e){for(const t in e)return e[t];return null}function CT(e,t,r,n,i,o,s,a,u,c,l){let h=a.top,p=a.bottom,f=a.left,d=a.right;const A=a.collisionPadding;if(A&&(f-=A[0],h-=A[1],d+=A[2],p+=A[3]),c){const e=new Pn(f,h),t=new Pn(d,h),r=new Pn(f,p),n=new Pn(d,p),i=Zh(c);let o=new Pn(0,0);l&&(o=new Pn(l[0],l[1])),e._rotateAround(i,o),t._rotateAround(i,o),r._rotateAround(i,o),n._rotateAround(i,o),f=Math.min(e.x,t.x,r.x,n.x),d=Math.max(e.x,t.x,r.x,n.x),h=Math.min(e.y,t.y,r.y,n.y),p=Math.max(e.y,t.y,r.y,n.y)}return e.emplaceBack(t.x,t.y,t.z,r.x,r.y,f,h,d,p,u,i,o,s,n.x,n.y,n.z),e.length-1}function bT(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function IT(e,t,r,n){const i=e.compareText;if(t in i){const e=i[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<r)return!0}else i[t]=[];return i[t].push(n),!1}const vT=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),TT=vT(void 0,(function(){return TT.toString().search("(((.+)+)+)+$").toString().constructor(TT).search("(((.+)+)+)+$")}));TT();var RT=Object.freeze({ISERVER_TOKEN:"token",IPORTAL_KEY:"key"});function ST(e,t,r){if(!Nn(e))throw new Ln("first is required");if(!Nn(t))throw new Ln("second is required");if(r=Qn(r,!0),e instanceof mo||(e=new mo(e)),t instanceof mo||(t=new mo(t)),"data"===e.scheme)return e.toString();if("data"===t.scheme)return t.toString();Nn(t.authority)&&!Nn(t.scheme)&&("undefined"!=typeof document&&Nn(document.location)&&Nn(document.location.href)?t.scheme=new mo(document.location.href).scheme:t.scheme=e.scheme);var n=e;t.isAbsolute()&&(n=t);var i="";Nn(n.scheme)&&(i+=n.scheme+":"),Nn(n.authority)&&(i+="//"+n.authority,""!==n.path&&"/"!==n.path&&(i=i.replace(/\/?$/,"/"),n.path=n.path.replace(/^\/?/g,""),""===n.authority&&(i+="/"))),i+=n===e?r?e.path.replace(/\/?$/,"/")+t.path.replace(/^\/?/g,""):e.path+t.path:t.path;var o=Nn(e.query),s=Nn(t.query);o&&s?i+="?"+e.query+"&"+t.query:o&&!s?i+="?"+e.query:!o&&s&&(i+="?"+t.query);var a=Nn(t.fragment);return Nn(e.fragment)&&!a?i+="#"+e.fragment:a&&(i+="#"+t.fragment),i}function MT(e,t){this._keymap={},this.addCredential(e,t)}Object.defineProperties(MT.prototype,{value:{get:function(){return this._value},set:function(e){this._value=e}},name:{get:function(){return this._name},set:function(e){this._name=e}}}),MT.addToken=function(e){var t,r=e.substring(0,e.indexOf("/realspace")+10);if(Nn(MT.CREDENTIAL._keymap[r]))switch(MT.CREDENTIAL._keymap[r].type){case RT.ISERVER_TOKEN:t="?"+Do({token:MT.CREDENTIAL._keymap[r].value});break;case RT.IPORTAL_KEY:t="?"+Do({key:MT.CREDENTIAL._keymap[r].value});break;default:t=""}else switch(MT.CREDENTIAL.name){case RT.ISERVER_TOKEN:t="?"+Do({token:MT.CREDENTIAL.value});break;case RT.IPORTAL_KEY:t="?"+Do({key:MT.CREDENTIAL.value});break;default:t="?"+MT.CREDENTIAL.name+"="+MT.CREDENTIAL.value}return ST(e,t,!1)},MT.addTokenWithKey=function(e,t){var r;if(Nn(MT.CREDENTIAL._keymap[e])){if(MT.CREDENTIAL._keymap[e].type instanceof Array){var n,i=MT.CREDENTIAL._keymap[e].type,o=MT.CREDENTIAL._keymap[e].value;(a={})[i[0]]=o[0],n=ST(t,"?"+Do(a),!1);for(var s=1;s<i.length;s++){(a={})[i[s]]=o[s],n=n+"&"+Do(a)}return n}switch(MT.CREDENTIAL._keymap[e].type){case RT.ISERVER_TOKEN:r="?"+Do({token:MT.CREDENTIAL._keymap[e].value});break;case RT.IPORTAL_KEY:r="?"+Do({key:MT.CREDENTIAL._keymap[e].value});break;default:var a;(a={})[MT.CREDENTIAL._keymap[e].type]=MT.CREDENTIAL._keymap[e].value,r="?"+Do(a)}}else switch(MT.CREDENTIAL.name){case RT.ISERVER_TOKEN:r="?"+Do({token:MT.CREDENTIAL.value});break;case RT.IPORTAL_KEY:r="?"+Do({key:MT.CREDENTIAL.value});break;default:r="?"+MT.CREDENTIAL.name+"="+MT.CREDENTIAL.value}return ST(t,r,!1)},MT.prototype.addCredential=function(e,t){if(e instanceof Array){for(var r=0,n=e.length;r<n;r++)if(this._keymap[e[r].rooturl]={type:e[r].type||RT.ISERVER_TOKEN,value:e[r].value},-1!==e[r].rooturl.indexOf("/realspace")){var i=e[r].rooturl.substring(0,e[r].rooturl.lastIndexOf("/realspace")+10);this._keymap[i]={type:e[r].type||RT.ISERVER_TOKEN,value:e[r].value}}}else{if(this._value=Qn(e,""),null==e)throw new Ln("Credential.value is necessory.");this._name=Qn(t,RT.ISERVER_TOKEN),this._keymap.default={type:this._name,value:this._value}}},MT.CREDENTIAL=null;var wT=484813681109536e-20,BT=Math.PI/2,OT=1e-10,DT=.017453292519943295,FT=57.29577951308232,PT=Math.PI/4,NT=2*Math.PI,LT=3.14159265359,UT={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},GT={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},QT=/[\s_\-\/\(\)]/g;function kT(e,t){if(e[t])return e[t];for(var r,n=Object.keys(e),i=t.toLowerCase().replace(QT,""),o=-1;++o<n.length;)if((r=n[o]).toLowerCase().replace(QT,"")===i)return e[r]}var zT=function(e){var t,r,n,i={},o=e.split("+").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var r=t.split("=");return r.push(!0),e[r[0].toLowerCase()]=r[1],e}),{}),s={proj:"projName",datum:"datumCode",rf:function(e){i.rf=parseFloat(e)},lat_0:function(e){i.lat0=e*DT},lat_1:function(e){i.lat1=e*DT},lat_2:function(e){i.lat2=e*DT},lat_ts:function(e){i.lat_ts=e*DT},lon_0:function(e){i.long0=e*DT},lon_1:function(e){i.long1=e*DT},lon_2:function(e){i.long2=e*DT},alpha:function(e){i.alpha=parseFloat(e)*DT},lonc:function(e){i.longc=e*DT},x_0:function(e){i.x0=parseFloat(e)},y_0:function(e){i.y0=parseFloat(e)},k_0:function(e){i.k0=parseFloat(e)},k:function(e){i.k0=parseFloat(e)},a:function(e){i.a=parseFloat(e)},b:function(e){i.b=parseFloat(e)},r_a:function(){i.R_A=!0},zone:function(e){i.zone=parseInt(e,10)},south:function(){i.utmSouth=!0},towgs84:function(e){i.datum_params=e.split(",").map((function(e){return parseFloat(e)}))},to_meter:function(e){i.to_meter=parseFloat(e)},units:function(e){i.units=e;var t=kT(GT,e);t&&(i.to_meter=t.to_meter)},from_greenwich:function(e){i.from_greenwich=e*DT},pm:function(e){var t=kT(UT,e);i.from_greenwich=(t||parseFloat(e))*DT},nadgrids:function(e){"@null"===e?i.datumCode="none":i.nadgrids=e},axis:function(e){var t="ewnsud";3===e.length&&-1!==t.indexOf(e.substr(0,1))&&-1!==t.indexOf(e.substr(1,1))&&-1!==t.indexOf(e.substr(2,1))&&(i.axis=e)}};for(t in o)r=o[t],t in s?"function"==typeof(n=s[t])?n(r):i[n]=r:i[t]=r;return"string"==typeof i.datumCode&&"WGS84"!==i.datumCode&&(i.datumCode=i.datumCode.toLowerCase()),i},jT=/\s/,HT=/[A-Za-z]/,qT=/[A-Za-z84]/,VT=/[,\]]/,YT=/[\d\.E\-\+]/;function XT(e){if("string"!=typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function WT(e,t,r){Array.isArray(t)&&(r.unshift(t),t=null);var n=t?{}:e,i=r.reduce((function(e,t){return KT(t,e),e}),n);t&&(e[t]=i)}function KT(e,t){if(Array.isArray(e)){var r=e.shift();if("PARAMETER"===r&&(r=e.shift()),1===e.length)return Array.isArray(e[0])?(t[r]={},void KT(e[0],t[r])):void(t[r]=e[0]);if(e.length)if("TOWGS84"!==r){if("AXIS"===r)return r in t||(t[r]=[]),void t[r].push(e);var n;switch(Array.isArray(r)||(t[r]={}),r){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[r]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&KT(e[2],t[r]));case"SPHEROID":case"ELLIPSOID":return t[r]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&KT(e[3],t[r]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return e[0]=["name",e[0]],void WT(t,r,e);default:for(n=-1;++n<e.length;)if(!Array.isArray(e[n]))return KT(e,t[r]);return WT(t,r,e)}}else t[r]=e;else t[r]=!0}else t[e]=!0}XT.prototype.readCharicter=function(){var e=this.text[this.place++];if(4!==this.state)for(;jT.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case 1:return this.neutral(e);case 2:return this.keyword(e);case 4:return this.quoted(e);case 5:return this.afterquote(e);case 3:return this.number(e);case-1:return}},XT.prototype.afterquote=function(e){if('"'===e)return this.word+='"',void(this.state=4);if(VT.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},XT.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},XT.prototype.number=function(e){if(!YT.test(e)){if(VT.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in number yet, index '+this.place)}this.word+=e},XT.prototype.quoted=function(e){'"'!==e?this.word+=e:this.state=5},XT.prototype.keyword=function(e){if(qT.test(e))this.word+=e;else{if("["===e){var t=[];return t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=1)}if(!VT.test(e))throw new Error("havn't handled \""+e+'" in keyword yet, index '+this.place);this.afterItem(e)}},XT.prototype.neutral=function(e){if(HT.test(e))return this.word=e,void(this.state=2);if('"'===e)return this.word="",void(this.state=4);if(YT.test(e))return this.word=e,void(this.state=3);if(!VT.test(e))throw new Error("havn't handled \""+e+'" in neutral yet, index '+this.place);this.afterItem(e)},XT.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function $T(e){return.017453292519943295*e}var JT=function(e){var t=new XT(e).output(),r=t.shift(),n=t.shift();t.unshift(["name",n]),t.unshift(["type",r]);var i={};return KT(t,i),function(e){if("GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):"object"==typeof e.PROJECTION?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var t="",r=0,n=e.AXIS.length;r<n;++r){var i=e.AXIS[r][0].toLowerCase();-1!==i.indexOf("north")?t+="n":-1!==i.indexOf("south")?t+="s":-1!==i.indexOf("east")?t+="e":-1!==i.indexOf("west")&&(t+="w")}2===t.length&&(t+="u"),3===t.length&&(e.axis=t)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var o=e.GEOGCS;function s(t){return t*(e.to_meter||1)}"GEOGCS"===e.type&&(o=e),o&&(o.DATUM?e.datumCode=o.DATUM.name.toLowerCase():e.datumCode=o.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==e.datumCode&&"new_zealand_1949"!==e.datumCode||(e.datumCode="nzgd49"),"wgs_1984"!==e.datumCode&&"world_geodetic_system_1984"!==e.datumCode||("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(e.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=o.DATUM.SPHEROID.a,e.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(e.datum_params=o.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",$T],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",$T],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",$T],["lat0","latitude_of_origin",$T],["lat0","standard_parallel_1",$T],["lat1","standard_parallel_1",$T],["lat2","standard_parallel_2",$T],["azimuth","Azimuth"],["alpha","azimuth",$T],["srsCode","name"]].forEach((function(t){return r=e,i=(n=t)[0],o=n[1],void(!(i in r)&&o in r&&(r[i]=r[o],3===n.length&&(r[i]=n[2](r[i]))));var r,n,i,o})),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.projName&&"Lambert_Azimuthal_Equal_Area"!==e.projName||(e.long0=e.longc),e.lat_ts||!e.lat1||"Stereographic_South_Pole"!==e.projName&&"Polar Stereographic (variant B)"!==e.projName||(e.lat0=$T(e.lat1>0?90:-90),e.lat_ts=e.lat1)}(i),i};function ZT(e){var t=this;if(2===arguments.length){var r=arguments[1];"string"==typeof r?"+"===r.charAt(0)?ZT[e]=zT(arguments[1]):ZT[e]=JT(arguments[1]):ZT[e]=r}else if(1===arguments.length){if(Array.isArray(e))return e.map((function(e){Array.isArray(e)?ZT.apply(t,e):ZT(e)}));if("string"==typeof e){if(e in ZT)return ZT[e]}else"EPSG"in e?ZT["EPSG:"+e.EPSG]=e:"ESRI"in e?ZT["ESRI:"+e.ESRI]=e:"IAU2000"in e?ZT["IAU2000:"+e.IAU2000]=e:console.log(e);return}}!function(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}(ZT);var eR=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var tR=["3857","900913","3785","102113"];function rR(e){if(!function(e){return"string"==typeof e}(e))return e;if(function(e){return e in ZT}(e))return ZT[e];if(function(e){return eR.some((function(t){return e.indexOf(t)>-1}))}(e)){var t=JT(e);if(function(e){var t=kT(e,"authority");if(t){var r=kT(t,"epsg");return r&&tR.indexOf(r)>-1}}(t))return ZT["EPSG:3857"];var r=function(e){var t=kT(e,"extension");if(t)return kT(t,"proj4")}(t);return r?zT(r):t}return function(e){return"+"===e[0]}(e)?zT(e):void 0}var nR=function(e,t){var r,n;if(e=e||{},!t)return e;for(n in t)void 0!==(r=t[n])&&(e[n]=r);return e},iR=function(e,t,r){var n=e*t;return r/Math.sqrt(1-n*n)},oR=function(e){return e<0?-1:1},sR=function(e){return Math.abs(e)<=LT?e:e-oR(e)*NT},aR=function(e,t,r){var n=e*r,i=.5*e;return n=Math.pow((1-n)/(1+n),i),Math.tan(.5*(BT-t))/n},uR=function(e,t){for(var r,n,i=.5*e,o=BT-2*Math.atan(t),s=0;s<=15;s++)if(r=e*Math.sin(o),o+=n=BT-2*Math.atan(t*Math.pow((1-r)/(1+r),i))-o,Math.abs(n)<=1e-10)return o;return-9999};var cR={init:function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=iR(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(e){var t,r,n=e.x,i=e.y;if(i*FT>90&&i*FT<-90&&n*FT>180&&n*FT<-180)return null;if(Math.abs(Math.abs(i)-BT)<=OT)return null;if(this.sphere)t=this.x0+this.a*this.k0*sR(n-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(PT+.5*i));else{var o=Math.sin(i),s=aR(this.e,i,o);t=this.x0+this.a*this.k0*sR(n-this.long0),r=this.y0-this.a*this.k0*Math.log(s)}return e.x=t,e.y=r,e},inverse:function(e){var t,r,n=e.x-this.x0,i=e.y-this.y0;if(this.sphere)r=BT-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var o=Math.exp(-i/(this.a*this.k0));if(-9999===(r=uR(this.e,o)))return null}return t=sR(this.long0+n/(this.a*this.k0)),e.x=t,e.y=r,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]};function lR(e){return e}var hR=[cR,{init:function(){},forward:lR,inverse:lR,names:["longlat","identity"]}],pR={},fR=[];function dR(e,t){var r=fR.length;return e.names?(fR[r]=e,e.names.forEach((function(e){pR[e.toLowerCase()]=r})),this):(console.log(t),!0)}var AR={start:function(){hR.forEach(dR)},add:dR,get:function(e){if(!e)return!1;var t=e.toLowerCase();return void 0!==pR[t]&&fR[pR[t]]?fR[pR[t]]:void 0}},gR={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},_R=gR.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};gR.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var mR={};function yR(e,t){if(!(this instanceof yR))return new yR(e);t=t||function(e){if(e)throw e};var r=rR(e);if("object"==typeof r){var n=yR.projections.get(r.projName);if(n){if(r.datumCode&&"none"!==r.datumCode){var i=kT(mR,r.datumCode);i&&(r.datum_params=i.towgs84?i.towgs84.split(","):null,r.ellps=i.ellipse,r.datumName=i.datumName?i.datumName:r.datumCode)}r.k0=r.k0||1,r.axis=r.axis||"enu",r.ellps=r.ellps||"wgs84";var o=function(e,t,r,n,i){if(!e){var o=kT(gR,n);o||(o=_R),e=o.a,t=o.b,r=o.rf}return r&&!t&&(t=(1-1/r)*e),(0===r||Math.abs(e-t)<OT)&&(i=!0,t=e),{a:e,b:t,rf:r,sphere:i}}(r.a,r.b,r.rf,r.ellps,r.sphere),s=function(e,t,r,n){var i=e*e,o=t*t,s=(i-o)/i,a=0;return n?(i=(e*=1-s*(.16666666666666666+s*(.04722222222222222+.022156084656084655*s)))*e,s=0):a=Math.sqrt(s),{es:s,e:a,ep2:(i-o)/o}}(o.a,o.b,o.rf,r.R_A),a=r.datum||function(e,t,r,n,i,o){var s={};return s.datum_type=void 0===e||"none"===e?5:4,t&&(s.datum_params=t.map(parseFloat),0===s.datum_params[0]&&0===s.datum_params[1]&&0===s.datum_params[2]||(s.datum_type=1),s.datum_params.length>3&&(0===s.datum_params[3]&&0===s.datum_params[4]&&0===s.datum_params[5]&&0===s.datum_params[6]||(s.datum_type=2,s.datum_params[3]*=wT,s.datum_params[4]*=wT,s.datum_params[5]*=wT,s.datum_params[6]=s.datum_params[6]/1e6+1))),s.a=r,s.b=n,s.es=i,s.ep2=o,s}(r.datumCode,r.datum_params,o.a,o.b,s.es,s.ep2);nR(this,r),nR(this,n),this.a=o.a,this.b=o.b,this.rf=o.rf,this.sphere=o.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=a,this.init(),t(null,this)}else t(e)}else t(e)}function ER(e,t,r){var n,i,o,s,a=e.x,u=e.y,c=e.z?e.z:0;if(u<-BT&&u>-1.001*BT)u=-BT;else if(u>BT&&u<1.001*BT)u=BT;else{if(u<-BT)return{x:-1/0,y:-1/0,z:e.z};if(u>BT)return{x:1/0,y:1/0,z:e.z}}return a>Math.PI&&(a-=2*Math.PI),i=Math.sin(u),s=Math.cos(u),o=i*i,{x:((n=r/Math.sqrt(1-t*o))+c)*s*Math.cos(a),y:(n+c)*s*Math.sin(a),z:(n*(1-t)+c)*i}}function xR(e,t,r,n){var i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y=1e-12,E=e.x,x=e.y,C=e.z?e.z:0;if(i=Math.sqrt(E*E+x*x),o=Math.sqrt(E*E+x*x+C*C),i/r<y){if(_=0,o/r<y)return m=-n,{x:e.x,y:e.y,z:e.z}}else _=Math.atan2(x,E);s=C/o,h=(a=i/o)*(1-t)*(u=1/Math.sqrt(1-t*(2-t)*a*a)),p=s*u,g=0;do{g++,c=t*(l=r/Math.sqrt(1-t*p*p))/(l+(m=i*h+C*p-l*(1-t*p*p))),A=(d=s*(u=1/Math.sqrt(1-c*(2-c)*a*a)))*h-(f=a*(1-c)*u)*p,h=f,p=d}while(A*A>1e-24&&g<30);return{x:_,y:Math.atan(d/Math.abs(f)),z:m}}function CR(e){return 1===e||2===e}mR.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},mR.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},mR.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},mR.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},mR.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},mR.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},mR.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},mR.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},mR.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},mR.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},mR.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},mR.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},mR.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},mR.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},mR.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},mR.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},mR.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},yR.projections=AR,yR.projections.start();var bR=function(e,t,r){return function(e,t){return e.datum_type===t.datum_type&&!(e.a!==t.a||Math.abs(e.es-t.es)>5e-11)&&(1===e.datum_type?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:2!==e.datum_type||e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6])}(e,t)||5===e.datum_type||5===t.datum_type?r:e.es!==t.es||e.a!==t.a||CR(e.datum_type)||CR(t.datum_type)?(r=ER(r,e.es,e.a),CR(e.datum_type)&&(r=function(e,t,r){if(1===t)return{x:e.x+r[0],y:e.y+r[1],z:e.z+r[2]};if(2===t){var n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],u=r[5],c=r[6];return{x:c*(e.x-u*e.y+a*e.z)+n,y:c*(u*e.x+e.y-s*e.z)+i,z:c*(-a*e.x+s*e.y+e.z)+o}}}(r,e.datum_type,e.datum_params)),CR(t.datum_type)&&(r=function(e,t,r){if(1===t)return{x:e.x-r[0],y:e.y-r[1],z:e.z-r[2]};if(2===t){var n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],u=r[5],c=r[6],l=(e.x-n)/c,h=(e.y-i)/c,p=(e.z-o)/c;return{x:l+u*h-a*p,y:-u*l+h+s*p,z:a*l-s*h+p}}}(r,t.datum_type,t.datum_params)),xR(r,t.es,t.a,t.b)):r},IR=function(e,t,r){var n,i,o,s=r.x,a=r.y,u=r.z||0,c={};for(o=0;o<3;o++)if(!t||2!==o||void 0!==r.z)switch(0===o?(n=s,i=-1!=="ew".indexOf(e.axis[o])?"x":"y"):1===o?(n=a,i=-1!=="ns".indexOf(e.axis[o])?"y":"x"):(n=u,i="z"),e.axis[o]){case"e":case"w":case"n":case"s":c[i]=n;break;case"u":void 0!==r[i]&&(c.z=n);break;case"d":void 0!==r[i]&&(c.z=-n);break;default:return null}return c},vR=function(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t};function TR(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function RR(e,t,r){var n;return Array.isArray(r)&&(r=vR(r)),function(e){TR(e.x),TR(e.y)}(r),e.datum&&t.datum&&function(e,t){return(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode||(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode}(e,t)&&(r=RR(e,n=new yR("WGS84"),r),e=n),"enu"!==e.axis&&(r=IR(e,!1,r)),"longlat"===e.projName?r={x:r.x*DT,y:r.y*DT,z:r.z||0}:(e.to_meter&&(r={x:r.x*e.to_meter,y:r.y*e.to_meter,z:r.z||0}),r=e.inverse(r)),e.from_greenwich&&(r.x+=e.from_greenwich),r=bR(e.datum,t.datum,r),t.from_greenwich&&(r={x:r.x-t.from_greenwich,y:r.y,z:r.z||0}),"longlat"===t.projName?r={x:r.x*FT,y:r.y*FT,z:r.z||0}:(r=t.forward(r),t.to_meter&&(r={x:r.x/t.to_meter,y:r.y/t.to_meter,z:r.z||0})),"enu"!==t.axis?IR(t,!0,r):r}var SR=yR("WGS84");function MR(e,t,r){var n,i,o;return Array.isArray(r)?(n=RR(e,t,r)||{x:NaN,y:NaN},r.length>2?void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name?"number"==typeof n.z?[n.x,n.y,n.z].concat(r.splice(3)):[n.x,n.y,r[2]].concat(r.splice(3)):[n.x,n.y].concat(r.splice(2)):[n.x,n.y]):(i=RR(e,t,r),2===(o=Object.keys(r)).length||o.forEach((function(n){if(void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;i[n]=r[n]})),i)}function wR(e){return e instanceof yR?e:e.oProj?e.oProj:yR(e)}function BR(e,t,r){e=wR(e);var n,i=!1;return void 0===t?(t=e,e=SR,i=!0):(void 0!==t.x||Array.isArray(t))&&(r=t,t=e,e=SR,i=!0),t=wR(t),r?MR(e,t,r):(n={forward:function(r){return MR(e,t,r)},inverse:function(r){return MR(t,e,r)}},i&&(n.oProj=t),n)}var OR="AJSAJS",DR="AFAFAF",FR=65,PR=73,NR=79,LR=86,UR=90,GR={forward:QR,inverse:function(e){var t=HR(YR(e.toUpperCase()));if(t.lat&&t.lon)return[t.lon,t.lat,t.lon,t.lat];return[t.left,t.bottom,t.right,t.top]},toPoint:kR};function QR(e,t){return t=t||5,function(e,t){var r="00000"+e.easting,n="00000"+e.northing;return e.zoneNumber+e.zoneLetter+(f=e.easting,d=e.northing,A=e.zoneNumber,g=VR(A),_=Math.floor(f/1e5),m=Math.floor(d/1e5)%20,i=_,o=m,s=g,a=s-1,u=OR.charCodeAt(a),c=DR.charCodeAt(a),l=u+i-1,h=c+o,p=!1,l>UR&&(l=l-UR+FR-1,p=!0),(l===PR||u<PR&&l>PR||(l>PR||u<PR)&&p)&&l++,(l===NR||u<NR&&l>NR||(l>NR||u<NR)&&p)&&++l===PR&&l++,l>UR&&(l=l-UR+FR-1),h>LR?(h=h-LR+FR-1,p=!0):p=!1,(h===PR||c<PR&&h>PR||(h>PR||c<PR)&&p)&&h++,(h===NR||c<NR&&h>NR||(h>NR||c<NR)&&p)&&++h===PR&&h++,h>LR&&(h=h-LR+FR-1),String.fromCharCode(l)+String.fromCharCode(h))+r.substr(r.length-5,t)+n.substr(n.length-5,t);var i,o,s,a,u,c,l,h,p;var f,d,A,g,_,m}(function(e){var t,r,n,i,o,s,a,u,c=e.lat,l=e.lon,h=6378137,p=.00669438,f=.9996,d=zR(c),A=zR(l);u=Math.floor((l+180)/6)+1,180===l&&(u=60);c>=56&&c<64&&l>=3&&l<12&&(u=32);c>=72&&c<84&&(l>=0&&l<9?u=31:l>=9&&l<21?u=33:l>=21&&l<33?u=35:l>=33&&l<42&&(u=37));a=zR(6*(u-1)-180+3),t=p/(1-p),r=h/Math.sqrt(1-p*Math.sin(d)*Math.sin(d)),n=Math.tan(d)*Math.tan(d),i=t*Math.cos(d)*Math.cos(d),o=Math.cos(d)*(A-a),s=h*((1-p/4-3*p*p/64-5*p*p*p/256)*d-(3*p/8+3*p*p/32+45*p*p*p/1024)*Math.sin(2*d)+(15*p*p/256+45*p*p*p/1024)*Math.sin(4*d)-35*p*p*p/3072*Math.sin(6*d));var g=f*r*(o+(1-n+i)*o*o*o/6+(5-18*n+n*n+72*i-58*t)*o*o*o*o*o/120)+5e5,_=f*(s+r*Math.tan(d)*(o*o/2+(5-n+9*i+4*i*i)*o*o*o*o/24+(61-58*n+n*n+600*i-330*t)*o*o*o*o*o*o/720));c<0&&(_+=1e7);return{northing:Math.round(_),easting:Math.round(g),zoneNumber:u,zoneLetter:qR(c)}}({lat:e[1],lon:e[0]}),t)}function kR(e){var t=HR(YR(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function zR(e){return e*(Math.PI/180)}function jR(e){return e/Math.PI*180}function HR(e){var t=e.northing,r=e.easting,n=e.zoneLetter,i=e.zoneNumber;if(i<0||i>60)return null;var o,s,a,u,c,l,h,p,f,d=.9996,A=6378137,g=.00669438,_=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),m=r-5e5,y=t;n<"N"&&(y-=1e7),h=6*(i-1)-180+3,o=.006739496752268451,f=(p=y/d/6367449.145945056)+(3*_/2-27*_*_*_/32)*Math.sin(2*p)+(21*_*_/16-55*_*_*_*_/32)*Math.sin(4*p)+151*_*_*_/96*Math.sin(6*p),s=A/Math.sqrt(1-g*Math.sin(f)*Math.sin(f)),a=Math.tan(f)*Math.tan(f),u=o*Math.cos(f)*Math.cos(f),c=.99330562*A/Math.pow(1-g*Math.sin(f)*Math.sin(f),1.5),l=m/(s*d);var E=f-s*Math.tan(f)/c*(l*l/2-(5+3*a+10*u-4*u*u-9*o)*l*l*l*l/24+(61+90*a+298*u+45*a*a-1.6983531815716497-3*u*u)*l*l*l*l*l*l/720);E=jR(E);var x,C=(l-(1+2*a+u)*l*l*l/6+(5-2*u+28*a-3*u*u+8*o+24*a*a)*l*l*l*l*l/120)/Math.cos(f);if(C=h+jR(C),e.accuracy){var b=HR({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});x={top:b.lat,right:b.lon,bottom:E,left:C}}else x={lat:E,lon:C};return x}function qR(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function VR(e){var t=e%6;return 0===t&&(t=6),t}function YR(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,r=e.length,n=null,i="",o=0;!/[A-Z]/.test(t=e.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+e;i+=t,o++}var s=parseInt(i,10);if(0===o||o+3>r)throw"MGRSPoint bad conversion from: "+e;var a=e.charAt(o++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+e;n=e.substring(o,o+=2);for(var u=VR(s),c=function(e,t){var r=OR.charCodeAt(t-1),n=1e5,i=!1;for(;r!==e.charCodeAt(0);){if(++r===PR&&r++,r===NR&&r++,r>UR){if(i)throw"Bad character: "+e;r=FR,i=!0}n+=1e5}return n}(n.charAt(0),u),l=function(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;var r=DR.charCodeAt(t-1),n=0,i=!1;for(;r!==e.charCodeAt(0);){if(++r===PR&&r++,r===NR&&r++,r>LR){if(i)throw"Bad character: "+e;r=FR,i=!0}n+=1e5}return n}(n.charAt(1),u);l<XR(a);)l+=2e6;var h=r-o;if(h%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var p,f,d,A=h/2,g=0,_=0;return A>0&&(p=1e5/Math.pow(10,A),f=e.substring(o,o+A),g=parseFloat(f)*p,d=e.substring(o+A),_=parseFloat(d)*p),{easting:g+c,northing:_+l,zoneLetter:a,zoneNumber:s,accuracy:p}}function XR(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function WR(e,t,r){if(!(this instanceof WR))return new WR(e,t,r);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&void 0===t){var n=e.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=e,this.y=t,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}WR.fromMGRS=function(e){return new WR(kR(e))},WR.prototype.toMGRS=function(e){return QR([this.x,this.y],e)};var KR=.046875,$R=.01953125,JR=.01068115234375,ZR=function(e){var t=[];t[0]=1-e*(.25+e*(KR+e*($R+e*JR))),t[1]=e*(.75-e*(KR+e*($R+e*JR)));var r=e*e;return t[2]=r*(.46875-e*(.013020833333333334+.007120768229166667*e)),r*=e,t[3]=r*(.3645833333333333-.005696614583333333*e),t[4]=r*e*.3076171875,t},eS=function(e,t,r,n){return r*=t,t*=t,n[0]*e-r*(n[1]+t*(n[2]+t*(n[3]+t*n[4])))},tS=function(e,t,r){for(var n=1/(1-t),i=e,o=20;o;--o){var s=Math.sin(i),a=1-t*s*s;if(i-=a=(eS(i,s,Math.cos(i),r)-e)*(a*Math.sqrt(a))*n,Math.abs(a)<OT)return i}return i};var rS={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=ZR(this.es),this.ml0=eS(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(e){var t,r,n,i=e.x,o=e.y,s=sR(i-this.long0),a=Math.sin(o),u=Math.cos(o);if(this.es){var c=u*s,l=Math.pow(c,2),h=this.ep2*Math.pow(u,2),p=Math.pow(h,2),f=Math.abs(u)>OT?Math.tan(o):0,d=Math.pow(f,2),A=Math.pow(d,2);t=1-this.es*Math.pow(a,2),c/=Math.sqrt(t);var g=eS(o,a,u,this.en);r=this.a*(this.k0*c*(1+l/6*(1-d+h+l/20*(5-18*d+A+14*h-58*d*h+l/42*(61+179*A-A*d-479*d)))))+this.x0,n=this.a*(this.k0*(g-this.ml0+a*s*c/2*(1+l/12*(5-d+9*h+4*p+l/30*(61+A-58*d+270*h-330*d*h+l/56*(1385+543*A-A*d-3111*d))))))+this.y0}else{var _=u*Math.sin(s);if(Math.abs(Math.abs(_)-1)<OT)return 93;if(r=.5*this.a*this.k0*Math.log((1+_)/(1-_))+this.x0,n=u*Math.cos(s)/Math.sqrt(1-Math.pow(_,2)),(_=Math.abs(n))>=1){if(_-1>OT)return 93;n=0}else n=Math.acos(n);o<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return e.x=r,e.y=n,e},inverse:function(e){var t,r,n,i,o=(e.x-this.x0)*(1/this.a),s=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+s/this.k0,r=tS(t,this.es,this.en),Math.abs(r)<BT){var a=Math.sin(r),u=Math.cos(r),c=Math.abs(u)>OT?Math.tan(r):0,l=this.ep2*Math.pow(u,2),h=Math.pow(l,2),p=Math.pow(c,2),f=Math.pow(p,2);t=1-this.es*Math.pow(a,2);var d=o*Math.sqrt(t)/this.k0,A=Math.pow(d,2);n=r-(t*=c)*A/(1-this.es)*.5*(1-A/12*(5+3*p-9*l*p+l-4*h-A/30*(61+90*p-252*l*p+45*f+46*l-A/56*(1385+3633*p+4095*f+1574*f*p)))),i=sR(this.long0+d*(1-A/6*(1+2*p+l-A/20*(5+28*p+24*f+8*l*p+6*l-A/42*(61+662*p+1320*f+720*f*p))))/u)}else n=BT*oR(s),i=0;else{var g=Math.exp(o/this.k0),_=.5*(g-1/g),m=this.lat0+s/this.k0,y=Math.cos(m);t=Math.sqrt((1-Math.pow(y,2))/(1+Math.pow(_,2))),n=Math.asin(t),s<0&&(n=-n),i=0===_&&0===y?0:sR(Math.atan2(_,y)+this.long0)}return e.x=i,e.y=n,e},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},nS=function(e){var t=Math.exp(e);return t=(t-1/t)/2},iS=function(e,t){e=Math.abs(e),t=Math.abs(t);var r=Math.max(e,t),n=Math.min(e,t)/(r||1);return r*Math.sqrt(1+Math.pow(n,2))},oS=function(e){var t=Math.abs(e);return t=function(e){var t=1+e,r=t-1;return 0===r?e:e*Math.log(t)/r}(t*(1+t/(iS(1,t)+1))),e<0?-t:t},sS=function(e,t){for(var r,n=2*Math.cos(2*t),i=e.length-1,o=e[i],s=0;--i>=0;)r=n*o-s+e[i],s=o,o=r;return t+r*Math.sin(2*t)},aS=function(e,t,r){for(var n,i,o=Math.sin(t),s=Math.cos(t),a=nS(r),u=function(e){var t=Math.exp(e);return(t+1/t)/2}(r),c=2*s*u,l=-2*o*a,h=e.length-1,p=e[h],f=0,d=0,A=0;--h>=0;)n=d,i=f,p=c*(d=p)-n-l*(f=A)+e[h],A=l*d-i+c*f;return[(c=o*u)*p-(l=s*a)*A,c*A+l*p]};var uS={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),r=t;this.cgb[0]=t*(2+t*(-2/3+t*(t*(116/45+t*(26/45+t*(-2854/675)))-2))),this.cbg[0]=t*(t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))-2),r*=t,this.cgb[1]=r*(7/3+t*(t*(-227/45+t*(2704/315+t*(2323/945)))-1.6)),this.cbg[1]=r*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),r*=t,this.cgb[2]=r*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=r*(-26/15+t*(34/21+t*(1.6+t*(-12686/2835)))),r*=t,this.cgb[3]=r*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=r*(1237/630+t*(t*(-24832/14175)-2.4)),r*=t,this.cgb[4]=r*(4174/315+t*(-144838/6237)),this.cbg[4]=r*(-734/315+t*(109598/31185)),r*=t,this.cgb[5]=r*(601676/22275),this.cbg[5]=r*(444337/155925),r=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+r*(1/4+r*(1/64+r/256))),this.utg[0]=t*(t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))-.5),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=r*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=r*(13/48+t*(t*(557/1440+t*(281/630+t*(-1983433/1935360)))-.6)),r*=t,this.utg[2]=r*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=r*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),r*=t,this.utg[3]=r*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=r*(49561/161280+t*(-179/168+t*(6601661/7257600))),r*=t,this.utg[4]=r*(-4583/161280+t*(108847/3991680)),this.gtu[4]=r*(34729/80640+t*(-3418889/1995840)),r*=t,this.utg[5]=r*(-20648693/638668800),this.gtu[5]=.6650675310896665*r;var n=sS(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(e,t){for(var r,n=2*Math.cos(t),i=e.length-1,o=e[i],s=0;--i>=0;)r=n*o-s+e[i],s=o,o=r;return Math.sin(t)*r}(this.gtu,2*n))},forward:function(e){var t=sR(e.x-this.long0),r=e.y;r=sS(this.cbg,r);var n=Math.sin(r),i=Math.cos(r),o=Math.sin(t),s=Math.cos(t);r=Math.atan2(n,s*i),t=Math.atan2(o*i,iS(n,i*s)),t=oS(Math.tan(t));var a,u,c=aS(this.gtu,2*r,2*t);return r+=c[0],t+=c[1],Math.abs(t)<=2.623395162778?(a=this.a*(this.Qn*t)+this.x0,u=this.a*(this.Qn*r+this.Zb)+this.y0):(a=1/0,u=1/0),e.x=a,e.y=u,e},inverse:function(e){var t,r,n=(e.x-this.x0)*(1/this.a),i=(e.y-this.y0)*(1/this.a);if(i=(i-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var o=aS(this.utg,2*i,2*n);i+=o[0],n+=o[1],n=Math.atan(nS(n));var s=Math.sin(i),a=Math.cos(i),u=Math.sin(n),c=Math.cos(n);i=Math.atan2(s*c,iS(u,c*a)),n=Math.atan2(u,c*a),t=sR(n+this.long0),r=sS(this.cgb,i)}else t=1/0,r=1/0;return e.x=t,e.y=r,e},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]};var cS={init:function(){var e=function(e,t){if(void 0===e){if((e=Math.floor(30*(sR(t)+Math.PI)/Math.PI)+1)<0)return 0;if(e>60)return 60}return e}(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*DT,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,uS.init.apply(this),this.forward=uS.forward,this.inverse=uS.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},lS=function(e,t){return Math.pow((1-e)/(1+e),t)};var hS={init:function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+PT)/(Math.pow(Math.tan(.5*this.lat0+PT),this.C)*lS(this.e*e,this.ratexp))},forward:function(e){var t=e.x,r=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+PT),this.C)*lS(this.e*Math.sin(r),this.ratexp))-BT,e.x=this.C*t,e},inverse:function(e){for(var t=e.x/this.C,r=e.y,n=Math.pow(Math.tan(.5*r+PT)/this.K,1/this.C),i=20;i>0&&(r=2*Math.atan(n*lS(this.e*Math.sin(e.y),-.5*this.e))-BT,!(Math.abs(r-e.y)<1e-14));--i)e.y=r;return i?(e.x=t,e.y=r,e):null},names:["gauss"]};var pS={init:function(){hS.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(e){var t,r,n,i;return e.x=sR(e.x-this.long0),hS.forward.apply(this,[e]),t=Math.sin(e.y),r=Math.cos(e.y),n=Math.cos(e.x),i=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*r*n),e.x=i*r*Math.sin(e.x),e.y=i*(this.cosc0*t-this.sinc0*r*n),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var t,r,n,i,o;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,o=Math.sqrt(e.x*e.x+e.y*e.y)){var s=2*Math.atan2(o,this.R2);t=Math.sin(s),r=Math.cos(s),i=Math.asin(r*this.sinc0+e.y*t*this.cosc0/o),n=Math.atan2(e.x*t,o*this.cosc0*r-e.y*this.sinc0*t)}else i=this.phic0,n=0;return e.x=n,e.y=i,hS.inverse.apply(this,[e]),e.x=sR(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var fS={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=OT&&(this.k0=.5*(1+oR(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=OT&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=OT&&(this.k0=.5*this.cons*iR(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/aR(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=iR(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-BT,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(e){var t,r,n,i,o,s,a=e.x,u=e.y,c=Math.sin(u),l=Math.cos(u),h=sR(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=OT&&Math.abs(u+this.lat0)<=OT?(e.x=NaN,e.y=NaN,e):this.sphere?(t=2*this.k0/(1+this.sinlat0*c+this.coslat0*l*Math.cos(h)),e.x=this.a*t*l*Math.sin(h)+this.x0,e.y=this.a*t*(this.coslat0*c-this.sinlat0*l*Math.cos(h))+this.y0,e):(r=2*Math.atan(this.ssfn_(u,c,this.e))-BT,i=Math.cos(r),n=Math.sin(r),Math.abs(this.coslat0)<=OT?(o=aR(this.e,u*this.con,this.con*c),s=2*this.a*this.k0*o/this.cons,e.x=this.x0+s*Math.sin(a-this.long0),e.y=this.y0-this.con*s*Math.cos(a-this.long0),e):(Math.abs(this.sinlat0)<OT?(t=2*this.a*this.k0/(1+i*Math.cos(h)),e.y=t*n):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*i*Math.cos(h))),e.y=t*(this.cosX0*n-this.sinX0*i*Math.cos(h))+this.y0),e.x=t*i*Math.sin(h)+this.x0,e))},inverse:function(e){var t,r,n,i,o;e.x-=this.x0,e.y-=this.y0;var s=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var a=2*Math.atan(s/(2*this.a*this.k0));return t=this.long0,r=this.lat0,s<=OT?(e.x=t,e.y=r,e):(r=Math.asin(Math.cos(a)*this.sinlat0+e.y*Math.sin(a)*this.coslat0/s),t=Math.abs(this.coslat0)<OT?this.lat0>0?sR(this.long0+Math.atan2(e.x,-1*e.y)):sR(this.long0+Math.atan2(e.x,e.y)):sR(this.long0+Math.atan2(e.x*Math.sin(a),s*this.coslat0*Math.cos(a)-e.y*this.sinlat0*Math.sin(a))),e.x=t,e.y=r,e)}if(Math.abs(this.coslat0)<=OT){if(s<=OT)return r=this.lat0,t=this.long0,e.x=t,e.y=r,e;e.x*=this.con,e.y*=this.con,n=s*this.cons/(2*this.a*this.k0),r=this.con*uR(this.e,n),t=this.con*sR(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else i=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,s<=OT?o=this.X0:(o=Math.asin(Math.cos(i)*this.sinX0+e.y*Math.sin(i)*this.cosX0/s),t=sR(this.long0+Math.atan2(e.x*Math.sin(i),s*this.cosX0*Math.cos(i)-e.y*this.sinX0*Math.sin(i)))),r=-1*uR(this.e,Math.tan(.5*(BT+o)));return e.x=t,e.y=r,e},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(e,t,r){return t*=r,Math.tan(.5*(BT+e))*Math.pow((1-t)/(1+t),.5*r)}};var dS={init:function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),r=this.a,n=1/this.rf,i=2*n-Math.pow(n,2),o=this.e=Math.sqrt(i);this.R=this.k0*r*Math.sqrt(1-i)/(1-i*Math.pow(t,2)),this.alpha=Math.sqrt(1+i/(1-i)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+e/2)),u=Math.log((1+o*t)/(1-o*t));this.K=s-this.alpha*a+this.alpha*o/2*u},forward:function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),n=-this.alpha*(t+r)+this.K,i=2*(Math.atan(Math.exp(n))-Math.PI/4),o=this.alpha*(e.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(o));return e.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,e.x=this.R*s+this.x0,e},inverse:function(e){for(var t=e.x-this.x0,r=e.y-this.y0,n=t/this.R,i=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(n)),s=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(i))),a=this.lambda0+s/this.alpha,u=0,c=o,l=-1e3,h=0;Math.abs(c-l)>1e-7;){if(++h>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),l=c,c=2*Math.atan(Math.exp(u))-Math.PI/2}return e.x=a,e.y=c,e},names:["somerc"]};var AS={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e=Math.sin(this.lat0),t=Math.cos(this.lat0),r=this.e*e;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(t,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-r*r);var n,i,o=aR(this.e,this.lat0,e),s=this.bl/t*Math.sqrt((1-this.es)/(1-r*r));if(s*s<1&&(s=1),isNaN(this.longc)){var a=aR(this.e,this.lat1,Math.sin(this.lat1)),u=aR(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(s+Math.sqrt(s*s-1))*Math.pow(o,this.bl):this.el=(s-Math.sqrt(s*s-1))*Math.pow(o,this.bl);var c=Math.pow(a,this.bl),l=Math.pow(u,this.bl);i=.5*((n=this.el/c)-1/n);var h=(this.el*this.el-l*c)/(this.el*this.el+l*c),p=(l-c)/(l+c),f=sR(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(h*Math.tan(.5*this.bl*f)/p)/this.bl,this.long0=sR(this.long0);var d=sR(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*d)/i),this.alpha=Math.asin(s*Math.sin(this.gamma0))}else n=this.lat0>=0?s+Math.sqrt(s*s-1):s-Math.sqrt(s*s-1),this.el=n*Math.pow(o,this.bl),i=.5*(n-1/n),this.gamma0=Math.asin(Math.sin(this.alpha)/s),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha))},forward:function(e){var t,r,n,i=e.x,o=e.y,s=sR(i-this.long0);if(Math.abs(Math.abs(o)-BT)<=OT)n=o>0?-1:1,r=this.al/this.bl*Math.log(Math.tan(PT+n*this.gamma0*.5)),t=-1*n*BT*this.al/this.bl;else{var a=aR(this.e,o,Math.sin(o)),u=this.el/Math.pow(a,this.bl),c=.5*(u-1/u),l=.5*(u+1/u),h=Math.sin(this.bl*s),p=(c*Math.sin(this.gamma0)-h*Math.cos(this.gamma0))/l;r=Math.abs(Math.abs(p)-1)<=OT?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-p)/(1+p))/this.bl,t=Math.abs(Math.cos(this.bl*s))<=OT?this.al*this.bl*s:this.al*Math.atan2(c*Math.cos(this.gamma0)+h*Math.sin(this.gamma0),Math.cos(this.bl*s))/this.bl}return this.no_rot?(e.x=this.x0+t,e.y=this.y0+r):(t-=this.uc,e.x=this.x0+r*Math.cos(this.alpha)+t*Math.sin(this.alpha),e.y=this.y0+t*Math.cos(this.alpha)-r*Math.sin(this.alpha)),e},inverse:function(e){var t,r;this.no_rot?(r=e.y-this.y0,t=e.x-this.x0):(r=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),t=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),t+=this.uc);var n=Math.exp(-1*this.bl*r/this.al),i=.5*(n-1/n),o=.5*(n+1/n),s=Math.sin(this.bl*t/this.al),a=(s*Math.cos(this.gamma0)+i*Math.sin(this.gamma0))/o,u=Math.pow(this.el/Math.sqrt((1+a)/(1-a)),1/this.bl);return Math.abs(a-1)<OT?(e.x=this.long0,e.y=BT):Math.abs(a+1)<OT?(e.x=this.long0,e.y=-1*BT):(e.y=uR(this.e,u),e.x=sR(this.long0-Math.atan2(i*Math.cos(this.gamma0)-s*Math.sin(this.gamma0),Math.cos(this.bl*t/this.al))/this.bl)),e},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]};var gS={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<OT)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),r=Math.cos(this.lat1),n=iR(this.e,t,r),i=aR(this.e,this.lat1,t),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=iR(this.e,o,s),u=aR(this.e,this.lat2,o),c=aR(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>OT?this.ns=Math.log(n/a)/Math.log(i/u):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=n/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(e){var t=e.x,r=e.y;Math.abs(2*Math.abs(r)-Math.PI)<=OT&&(r=oR(r)*(BT-2e-10));var n,i,o=Math.abs(Math.abs(r)-BT);if(o>OT)n=aR(this.e,r,Math.sin(r)),i=this.a*this.f0*Math.pow(n,this.ns);else{if((o=r*this.ns)<=0)return null;i=0}var s=this.ns*sR(t-this.long0);return e.x=this.k0*(i*Math.sin(s))+this.x0,e.y=this.k0*(this.rh-i*Math.cos(s))+this.y0,e},inverse:function(e){var t,r,n,i,o,s=(e.x-this.x0)/this.k0,a=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(s*s+a*a),r=1):(t=-Math.sqrt(s*s+a*a),r=-1);var u=0;if(0!==t&&(u=Math.atan2(r*s,r*a)),0!==t||this.ns>0){if(r=1/this.ns,n=Math.pow(t/(this.a*this.f0),r),-9999===(i=uR(this.e,n)))return null}else i=-BT;return o=sR(u/this.ns+this.long0),e.x=o,e.y=i,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]};var _S={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var t,r,n,i,o,s,a,u=e.x,c=e.y,l=sR(u-this.long0);return t=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/t)-this.s45),n=-l*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(n)),o=Math.asin(Math.cos(r)*Math.sin(n)/Math.cos(i)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),e.y=a*Math.cos(s)/1,e.x=a*Math.sin(s)/1,this.czech||(e.y*=-1,e.x*=-1),e},inverse:function(e){var t,r,n,i,o,s,a,u=e.x;e.x=e.y,e.y=u,this.czech||(e.y*=-1,e.x*=-1),o=Math.sqrt(e.x*e.x+e.y*e.y),i=Math.atan2(e.y,e.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),r=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(t)),e.x=this.long0-r/this.alfa,s=t,a=0;var c=0;do{e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-e.y)<1e-10&&(a=1),s=e.y,c+=1}while(0===a&&c<15);return c>=15?null:e},names:["Krovak","krovak"]},mS=function(e,t,r,n,i){return e*i-t*Math.sin(2*i)+r*Math.sin(4*i)-n*Math.sin(6*i)},yS=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))},ES=function(e){return.375*e*(1+.25*e*(1+.46875*e))},xS=function(e){return.05859375*e*e*(1+.75*e)},CS=function(e){return e*e*e*(35/3072)},bS=function(e,t,r){var n=t*r;return e/Math.sqrt(1-n*n)},IS=function(e){return Math.abs(e)<BT?e:e-oR(e)*Math.PI},vS=function(e,t,r,n,i){var o,s;o=e/t;for(var a=0;a<15;a++)if(o+=s=(e-(t*o-r*Math.sin(2*o)+n*Math.sin(4*o)-i*Math.sin(6*o)))/(t-2*r*Math.cos(2*o)+4*n*Math.cos(4*o)-6*i*Math.cos(6*o)),Math.abs(s)<=1e-10)return o;return NaN};var TS={init:function(){this.sphere||(this.e0=yS(this.es),this.e1=ES(this.es),this.e2=xS(this.es),this.e3=CS(this.es),this.ml0=this.a*mS(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(e){var t,r,n=e.x,i=e.y;if(n=sR(n-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(i)*Math.sin(n)),r=this.a*(Math.atan2(Math.tan(i),Math.cos(n))-this.lat0);else{var o=Math.sin(i),s=Math.cos(i),a=bS(this.a,this.e,o),u=Math.tan(i)*Math.tan(i),c=n*Math.cos(i),l=c*c,h=this.es*s*s/(1-this.es);t=a*c*(1-l*u*(1/6-(8-u+8*h)*l/120)),r=this.a*mS(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+a*o/s*l*(.5+(5-u+6*h)*l/24)}return e.x=t+this.x0,e.y=r+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,r,n=e.x/this.a,i=e.y/this.a;if(this.sphere){var o=i+this.lat0;t=Math.asin(Math.sin(o)*Math.cos(n)),r=Math.atan2(Math.tan(n),Math.cos(o))}else{var s=this.ml0/this.a+i,a=vS(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-BT)<=OT)return e.x=this.long0,e.y=BT,i<0&&(e.y*=-1),e;var u=bS(this.a,this.e,Math.sin(a)),c=u*u*u/this.a/this.a*(1-this.es),l=Math.pow(Math.tan(a),2),h=n*this.a/u,p=h*h;t=a-u*Math.tan(a)/c*h*h*(.5-(1+3*l)*h*h/24),r=h*(1-p*(l/3+(1+3*l)*l*p/15))/Math.cos(a)}return e.x=sR(r+this.long0),e.y=IS(t),e},names:["Cassini","Cassini_Soldner","cass"]},RS=function(e,t){var r;return e>1e-7?(1-e*e)*(t/(1-(r=e*t)*r)-.5/e*Math.log((1-r)/(1+r))):2*t};var SS=.3333333333333333,MS=.17222222222222222,wS=.10257936507936508,BS=.06388888888888888,OS=.0664021164021164,DS=.016415012942191543;var FS={init:function(){var e,t=Math.abs(this.lat0);if(Math.abs(t-BT)<OT?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<OT?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=RS(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(e){var t,r=[];return r[0]=e*SS,t=e*e,r[0]+=t*MS,r[1]=t*BS,t*=e,r[0]+=t*wS,r[1]+=t*OS,r[2]=t*DS,r}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=RS(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(e){var t,r,n,i,o,s,a,u,c,l,h=e.x,p=e.y;if(h=sR(h-this.long0),this.sphere){if(o=Math.sin(p),l=Math.cos(p),n=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((r=this.mode===this.EQUIT?1+l*n:1+this.sinph0*o+this.cosph0*l*n)<=OT)return null;t=(r=Math.sqrt(2/r))*l*Math.sin(h),r*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*l*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(p+this.phi0)<OT)return null;r=PT-.5*p,t=(r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)))*Math.sin(h),r*=n}}else{switch(a=0,u=0,c=0,n=Math.cos(h),i=Math.sin(h),o=Math.sin(p),s=RS(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,u=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:c=1+this.sinb1*a+this.cosb1*u*n;break;case this.EQUIT:c=1+u*n;break;case this.N_POLE:c=BT+p,s=this.qp-s;break;case this.S_POLE:c=p-BT,s=this.qp+s}if(Math.abs(c)<OT)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),r=this.mode===this.OBLIQ?this.ymf*c*(this.cosb1*a-this.sinb1*u*n):(c=Math.sqrt(2/(1+u*n)))*a*this.ymf,t=this.xmf*c*u*i;break;case this.N_POLE:case this.S_POLE:s>=0?(t=(c=Math.sqrt(s))*i,r=n*(this.mode===this.S_POLE?c:-c)):t=r=0}}return e.x=this.a*t+this.x0,e.y=this.a*r+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,r,n,i,o,s,a,u=e.x/this.a,c=e.y/this.a;if(this.sphere){var l,h=0,p=0;if((r=.5*(l=Math.sqrt(u*u+c*c)))>1)return null;switch(r=2*Math.asin(r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(p=Math.sin(r),h=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(l)<=OT?0:Math.asin(c*p/l),u*=p,c=h*l;break;case this.OBLIQ:r=Math.abs(l)<=OT?this.phi0:Math.asin(h*this.sinph0+c*p*this.cosph0/l),u*=p*this.cosph0,c=(h-Math.sin(r)*this.sinph0)*l;break;case this.N_POLE:c=-c,r=BT-r;break;case this.S_POLE:r-=BT}t=0!==c||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,c):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,c*=this.dd,(s=Math.sqrt(u*u+c*c))<OT)return e.x=0,e.y=this.phi0,e;i=2*Math.asin(.5*s/this.rq),n=Math.cos(i),u*=i=Math.sin(i),this.mode===this.OBLIQ?(a=n*this.sinb1+c*i*this.cosb1/s,o=this.qp*a,c=s*this.cosb1*n-c*this.sinb1*i):(a=c*i/s,o=this.qp*a,c=s*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(c=-c),!(o=u*u+c*c))return e.x=0,e.y=this.phi0,e;a=1-o/this.qp,this.mode===this.S_POLE&&(a=-a)}t=Math.atan2(u,c),r=function(e,t){var r=e+e;return e+t[0]*Math.sin(r)+t[1]*Math.sin(r+r)+t[2]*Math.sin(r+r+r)}(Math.asin(a),this.apa)}return e.x=sR(this.long0+t),e.y=r,e},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},PS=function(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)};var NS={init:function(){Math.abs(this.lat1+this.lat2)<OT||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=iR(this.e3,this.sin_po,this.cos_po),this.qs1=RS(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=iR(this.e3,this.sin_po,this.cos_po),this.qs2=RS(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=RS(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>OT?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(e){var t=e.x,r=e.y;this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r);var n=RS(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,o=this.ns0*sR(t-this.long0),s=i*Math.sin(o)+this.x0,a=this.rh-i*Math.cos(o)+this.y0;return e.x=s,e.y=a,e},inverse:function(e){var t,r,n,i,o,s;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),n=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),n=-1),i=0,0!==t&&(i=Math.atan2(n*e.x,n*e.y)),n=t*this.ns0/this.a,this.sphere?s=Math.asin((this.c-n*n)/(2*this.ns0)):(r=(this.c-n*n)/this.ns0,s=this.phi1z(this.e3,r)),o=sR(i/this.ns0+this.long0),e.x=o,e.y=s,e},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(e,t){var r,n,i,o,s=PS(.5*t);if(e<OT)return s;for(var a=e*e,u=1;u<=25;u++)if(s+=o=.5*(i=1-(n=e*(r=Math.sin(s)))*n)*i/Math.cos(s)*(t/(1-a)-r/i+.5/e*Math.log((1-n)/(1+n))),Math.abs(o)<=1e-7)return s;return null}};var LS={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var t,r,n,i,o,s,a,u=e.x,c=e.y;return n=sR(u-this.long0),t=Math.sin(c),r=Math.cos(c),i=Math.cos(n),(o=this.sin_p14*t+this.cos_p14*r*i)>0||Math.abs(o)<=OT?(s=this.x0+1*this.a*r*Math.sin(n)/o,a=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*r*i)/o):(s=this.x0+this.infinity_dist*r*Math.sin(n),a=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*r*i)),e.x=s,e.y=a,e},inverse:function(e){var t,r,n,i,o,s;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(i=Math.atan2(t,this.rc),r=Math.sin(i),n=Math.cos(i),s=PS(n*this.sin_p14+e.y*r*this.cos_p14/t),o=Math.atan2(e.x*r,t*this.cos_p14*n-e.y*this.sin_p14*r),o=sR(this.long0+o)):(s=this.phic0,o=0),e.x=o,e.y=s,e},names:["gnom"]};var US={init:function(){this.sphere||(this.k0=iR(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var t,r,n=e.x,i=e.y,o=sR(n-this.long0);if(this.sphere)t=this.x0+this.a*o*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var s=RS(this.e,Math.sin(i));t=this.x0+this.a*this.k0*o,r=this.y0+this.a*s*.5/this.k0}return e.x=t,e.y=r,e},inverse:function(e){var t,r;return e.x-=this.x0,e.y-=this.y0,this.sphere?(t=sR(this.long0+e.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(r=function(e,t){var r=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-r)<1e-6)return t<0?-1*BT:BT;for(var n,i,o,s,a=Math.asin(.5*t),u=0;u<30;u++)if(i=Math.sin(a),o=Math.cos(a),s=e*i,a+=n=Math.pow(1-s*s,2)/(2*o)*(t/(1-e*e)-i/(1-s*s)+.5/e*Math.log((1-s)/(1+s))),Math.abs(n)<=1e-10)return a;return NaN}(this.e,2*e.y*this.k0/this.a),t=sR(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=r,e},names:["cea"]};var GS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(e){var t=e.x,r=e.y,n=sR(t-this.long0),i=IS(r-this.lat0);return e.x=this.x0+this.a*n*this.rc,e.y=this.y0+this.a*i,e},inverse:function(e){var t=e.x,r=e.y;return e.x=sR(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=IS(this.lat0+(r-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};var QS={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=yS(this.es),this.e1=ES(this.es),this.e2=xS(this.es),this.e3=CS(this.es),this.ml0=this.a*mS(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t,r,n,i=e.x,o=e.y,s=sR(i-this.long0);if(n=s*Math.sin(o),this.sphere)Math.abs(o)<=OT?(t=this.a*s,r=-1*this.a*this.lat0):(t=this.a*Math.sin(n)/Math.tan(o),r=this.a*(IS(o-this.lat0)+(1-Math.cos(n))/Math.tan(o)));else if(Math.abs(o)<=OT)t=this.a*s,r=-1*this.ml0;else{var a=bS(this.a,this.e,Math.sin(o))/Math.tan(o);t=a*Math.sin(n),r=this.a*mS(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+a*(1-Math.cos(n))}return e.x=t+this.x0,e.y=r+this.y0,e},inverse:function(e){var t,r,n,i,o,s,a,u,c;if(n=e.x-this.x0,i=e.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=OT)t=sR(n/this.a+this.long0),r=0;else{var l;for(s=this.lat0+i/this.a,a=n*n/this.a/this.a+s*s,u=s,o=20;o;--o)if(u+=c=-1*(s*(u*(l=Math.tan(u))+1)-u-.5*(u*u+a)*l)/((u-s)/l-1),Math.abs(c)<=OT){r=u;break}t=sR(this.long0+Math.asin(n*Math.tan(u)/this.a)/Math.sin(r))}else if(Math.abs(i+this.ml0)<=OT)r=0,t=sR(this.long0+n/this.a);else{var h,p,f,d,A;for(s=(this.ml0+i)/this.a,a=n*n/this.a/this.a+s*s,u=s,o=20;o;--o)if(A=this.e*Math.sin(u),h=Math.sqrt(1-A*A)*Math.tan(u),p=this.a*mS(this.e0,this.e1,this.e2,this.e3,u),f=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),u-=c=(s*(h*(d=p/this.a)+1)-d-.5*h*(d*d+a))/(this.es*Math.sin(2*u)*(d*d+a-2*s*d)/(4*h)+(s-d)*(h*f-2/Math.sin(2*u))-f),Math.abs(c)<=OT){r=u;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),t=sR(this.long0+Math.asin(n*h/this.a)/Math.sin(r))}return e.x=t,e.y=r,e},names:["Polyconic","poly"]};var kS={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(e){var t,r=e.x,n=e.y-this.lat0,i=r-this.long0,o=n/wT*1e-5,s=i,a=1,u=0;for(t=1;t<=10;t++)a*=o,u+=this.A[t]*a;var c,l=u,h=s,p=1,f=0,d=0,A=0;for(t=1;t<=6;t++)c=f*l+p*h,p=p*l-f*h,f=c,d=d+this.B_re[t]*p-this.B_im[t]*f,A=A+this.B_im[t]*p+this.B_re[t]*f;return e.x=A*this.a+this.x0,e.y=d*this.a+this.y0,e},inverse:function(e){var t,r,n=e.x,i=e.y,o=n-this.x0,s=(i-this.y0)/this.a,a=o/this.a,u=1,c=0,l=0,h=0;for(t=1;t<=6;t++)r=c*s+u*a,u=u*s-c*a,c=r,l=l+this.C_re[t]*u-this.C_im[t]*c,h=h+this.C_im[t]*u+this.C_re[t]*c;for(var p=0;p<this.iterations;p++){var f,d=l,A=h,g=s,_=a;for(t=2;t<=6;t++)f=A*l+d*h,d=d*l-A*h,A=f,g+=(t-1)*(this.B_re[t]*d-this.B_im[t]*A),_+=(t-1)*(this.B_im[t]*d+this.B_re[t]*A);d=1,A=0;var m=this.B_re[1],y=this.B_im[1];for(t=2;t<=6;t++)f=A*l+d*h,d=d*l-A*h,A=f,m+=t*(this.B_re[t]*d-this.B_im[t]*A),y+=t*(this.B_im[t]*d+this.B_re[t]*A);var E=m*m+y*y;l=(g*m+_*y)/E,h=(_*m-g*y)/E}var x=l,C=h,b=1,I=0;for(t=1;t<=9;t++)b*=x,I+=this.D[t]*b;var v=this.lat0+I*wT*1e5,T=this.long0+C;return e.x=T,e.y=v,e},names:["New_Zealand_Map_Grid","nzmg"]};var zS={init:function(){},forward:function(e){var t=e.x,r=e.y,n=sR(t-this.long0),i=this.x0+this.a*n,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return e.x=i,e.y=o,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=sR(this.long0+e.x/this.a),r=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=r,e},names:["Miller_Cylindrical","mill"]};var jS={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ZR(this.es)},forward:function(e){var t,r,n=e.x,i=e.y;if(n=sR(n-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(i),s=20;s;--s){var a=(this.m*i+Math.sin(i)-o)/(this.m+Math.cos(i));if(i-=a,Math.abs(a)<OT)break}else i=1!==this.n?Math.asin(this.n*Math.sin(i)):i;t=this.a*this.C_x*n*(this.m+Math.cos(i)),r=this.a*this.C_y*i}else{var u=Math.sin(i),c=Math.cos(i);r=this.a*eS(i,u,c,this.en),t=this.a*n*c/Math.sqrt(1-this.es*u*u)}return e.x=t,e.y=r,e},inverse:function(e){var t,r,n,i;return e.x-=this.x0,n=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,n/=this.C_x*(this.m+Math.cos(t)),this.m?t=PS((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=PS(Math.sin(t)/this.n)),n=sR(n+this.long0),t=IS(t)):(t=tS(e.y/this.a,this.es,this.en),(i=Math.abs(t))<BT?(i=Math.sin(t),r=this.long0+e.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(t)),n=sR(r)):i-OT<BT&&(n=this.long0)),e.x=n,e.y=t,e},names:["Sinusoidal","sinu"]};var HS={init:function(){},forward:function(e){for(var t=e.x,r=e.y,n=sR(t-this.long0),i=r,o=Math.PI*Math.sin(r);;){var s=-(i+Math.sin(i)-o)/(1+Math.cos(i));if(i+=s,Math.abs(s)<OT)break}i/=2,Math.PI/2-Math.abs(r)<OT&&(n=0);var a=.900316316158*this.a*n*Math.cos(i)+this.x0,u=1.4142135623731*this.a*Math.sin(i)+this.y0;return e.x=a,e.y=u,e},inverse:function(e){var t,r;e.x-=this.x0,e.y-=this.y0,r=e.y/(1.4142135623731*this.a),Math.abs(r)>.999999999999&&(r=.999999999999),t=Math.asin(r);var n=sR(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),r=(2*t+Math.sin(2*t))/Math.PI,Math.abs(r)>1&&(r=1);var i=Math.asin(r);return e.x=n,e.y=i,e},names:["Mollweide","moll"]};var qS={init:function(){Math.abs(this.lat1+this.lat2)<OT||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=yS(this.es),this.e1=ES(this.es),this.e2=xS(this.es),this.e3=CS(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=iR(this.e,this.sinphi,this.cosphi),this.ml1=mS(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<OT?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=iR(this.e,this.sinphi,this.cosphi),this.ml2=mS(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=mS(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(e){var t,r=e.x,n=e.y;if(this.sphere)t=this.a*(this.g-n);else{var i=mS(this.e0,this.e1,this.e2,this.e3,n);t=this.a*(this.g-i)}var o=this.ns*sR(r-this.long0),s=this.x0+t*Math.sin(o),a=this.y0+this.rh-t*Math.cos(o);return e.x=s,e.y=a,e},inverse:function(e){var t,r,n,i;e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns>=0?(r=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(r=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var o=0;if(0!==r&&(o=Math.atan2(t*e.x,t*e.y)),this.sphere)return i=sR(this.long0+o/this.ns),n=IS(this.g-r/this.a),e.x=i,e.y=n,e;var s=this.g-r/this.a;return n=vS(s,this.e0,this.e1,this.e2,this.e3),i=sR(this.long0+o/this.ns),e.x=i,e.y=n,e},names:["Equidistant_Conic","eqdc"]};var VS={init:function(){this.R=this.a},forward:function(e){var t,r,n=e.x,i=e.y,o=sR(n-this.long0);Math.abs(i)<=OT&&(t=this.x0+this.R*o,r=this.y0);var s=PS(2*Math.abs(i/Math.PI));(Math.abs(o)<=OT||Math.abs(Math.abs(i)-BT)<=OT)&&(t=this.x0,r=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/o-o/Math.PI),u=a*a,c=Math.sin(s),l=Math.cos(s),h=l/(c+l-1),p=h*h,f=h*(2/c-1),d=f*f,A=Math.PI*this.R*(a*(h-d)+Math.sqrt(u*(h-d)*(h-d)-(d+u)*(p-d)))/(d+u);o<0&&(A=-A),t=this.x0+A;var g=u+h;return A=Math.PI*this.R*(f*g-a*Math.sqrt((d+u)*(u+1)-g*g))/(d+u),r=i>=0?this.y0+A:this.y0-A,e.x=t,e.y=r,e},inverse:function(e){var t,r,n,i,o,s,a,u,c,l,h,p;return e.x-=this.x0,e.y-=this.y0,h=Math.PI*this.R,o=(n=e.x/h)*n+(i=e.y/h)*i,h=3*(i*i/(u=-2*(s=-Math.abs(i)*(1+o))+1+2*i*i+o*o)+(2*(a=s-2*i*i+n*n)*a*a/u/u/u-9*s*a/u/u)/27)/(c=(s-a*a/3/u)/u)/(l=2*Math.sqrt(-c/3)),Math.abs(h)>1&&(h=h>=0?1:-1),p=Math.acos(h)/3,r=e.y>=0?(-l*Math.cos(p+Math.PI/3)-a/3/u)*Math.PI:-(-l*Math.cos(p+Math.PI/3)-a/3/u)*Math.PI,t=Math.abs(n)<OT?this.long0:sR(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(n*n-i*i)+o*o))/2/n),e.x=t,e.y=r,e},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var YS={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E,x,C,b=e.x,I=e.y,v=Math.sin(e.y),T=Math.cos(e.y),R=sR(b-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=OT?(e.x=this.x0+this.a*(BT-I)*Math.sin(R),e.y=this.y0-this.a*(BT-I)*Math.cos(R),e):Math.abs(this.sin_p12+1)<=OT?(e.x=this.x0+this.a*(BT+I)*Math.sin(R),e.y=this.y0+this.a*(BT+I)*Math.cos(R),e):(m=this.sin_p12*v+this.cos_p12*T*Math.cos(R),_=(g=Math.acos(m))/Math.sin(g),e.x=this.x0+this.a*_*T*Math.sin(R),e.y=this.y0+this.a*_*(this.cos_p12*v-this.sin_p12*T*Math.cos(R)),e):(t=yS(this.es),r=ES(this.es),n=xS(this.es),i=CS(this.es),Math.abs(this.sin_p12-1)<=OT?(o=this.a*mS(t,r,n,i,BT),s=this.a*mS(t,r,n,i,I),e.x=this.x0+(o-s)*Math.sin(R),e.y=this.y0-(o-s)*Math.cos(R),e):Math.abs(this.sin_p12+1)<=OT?(o=this.a*mS(t,r,n,i,BT),s=this.a*mS(t,r,n,i,I),e.x=this.x0+(o+s)*Math.sin(R),e.y=this.y0+(o+s)*Math.cos(R),e):(a=v/T,u=bS(this.a,this.e,this.sin_p12),c=bS(this.a,this.e,v),l=Math.atan((1-this.es)*a+this.es*u*this.sin_p12/(c*T)),y=0===(h=Math.atan2(Math.sin(R),this.cos_p12*Math.tan(l)-this.sin_p12*Math.cos(R)))?Math.asin(this.cos_p12*Math.sin(l)-this.sin_p12*Math.cos(l)):Math.abs(Math.abs(h)-Math.PI)<=OT?-Math.asin(this.cos_p12*Math.sin(l)-this.sin_p12*Math.cos(l)):Math.asin(Math.sin(R)*Math.cos(l)/Math.sin(h)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),g=u*y*(1-(E=y*y)*(A=(f=this.e*this.cos_p12*Math.cos(h)/Math.sqrt(1-this.es))*f)*(1-A)/6+(x=E*y)/8*(d=p*f)*(1-2*A)+(C=x*y)/120*(A*(4-7*A)-3*p*p*(1-7*A))-C*y/48*d),e.x=this.x0+g*Math.sin(h),e.y=this.y0+g*Math.cos(h),e))},inverse:function(e){var t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g,_,m,y,E,x,C;if(e.x-=this.x0,e.y-=this.y0,this.sphere){if((t=Math.sqrt(e.x*e.x+e.y*e.y))>2*BT*this.a)return;return r=t/this.a,n=Math.sin(r),i=Math.cos(r),o=this.long0,Math.abs(t)<=OT?s=this.lat0:(s=PS(i*this.sin_p12+e.y*n*this.cos_p12/t),a=Math.abs(this.lat0)-BT,o=Math.abs(a)<=OT?this.lat0>=0?sR(this.long0+Math.atan2(e.x,-e.y)):sR(this.long0-Math.atan2(-e.x,e.y)):sR(this.long0+Math.atan2(e.x*n,t*this.cos_p12*i-e.y*this.sin_p12*n))),e.x=o,e.y=s,e}return u=yS(this.es),c=ES(this.es),l=xS(this.es),h=CS(this.es),Math.abs(this.sin_p12-1)<=OT?(p=this.a*mS(u,c,l,h,BT),t=Math.sqrt(e.x*e.x+e.y*e.y),s=vS((p-t)/this.a,u,c,l,h),o=sR(this.long0+Math.atan2(e.x,-1*e.y)),e.x=o,e.y=s,e):Math.abs(this.sin_p12+1)<=OT?(p=this.a*mS(u,c,l,h,BT),t=Math.sqrt(e.x*e.x+e.y*e.y),s=vS((t-p)/this.a,u,c,l,h),o=sR(this.long0+Math.atan2(e.x,e.y)),e.x=o,e.y=s,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),A=Math.atan2(e.x,e.y),f=bS(this.a,this.e,this.sin_p12),g=Math.cos(A),m=-(_=this.e*this.cos_p12*g)*_/(1-this.es),y=3*this.es*(1-m)*this.sin_p12*this.cos_p12*g/(1-this.es),C=1-m*(x=(E=t/f)-m*(1+m)*Math.pow(E,3)/6-y*(1+3*m)*Math.pow(E,4)/24)*x/2-E*x*x*x/6,d=Math.asin(this.sin_p12*Math.cos(x)+this.cos_p12*Math.sin(x)*g),o=sR(this.long0+Math.asin(Math.sin(A)*Math.sin(x)/Math.cos(d))),s=Math.atan((1-this.es*C*this.sin_p12/Math.sin(d))*Math.tan(d)/(1-this.es)),e.x=o,e.y=s,e)},names:["Azimuthal_Equidistant","aeqd"]};var XS={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var t,r,n,i,o,s,a,u=e.x,c=e.y;return n=sR(u-this.long0),t=Math.sin(c),r=Math.cos(c),i=Math.cos(n),((o=this.sin_p14*t+this.cos_p14*r*i)>0||Math.abs(o)<=OT)&&(s=1*this.a*r*Math.sin(n),a=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*r*i)),e.x=s,e.y=a,e},inverse:function(e){var t,r,n,i,o,s,a;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),r=PS(t/this.a),n=Math.sin(r),i=Math.cos(r),s=this.long0,Math.abs(t)<=OT?(a=this.lat0,e.x=s,e.y=a,e):(a=PS(i*this.sin_p14+e.y*n*this.cos_p14/t),o=Math.abs(this.lat0)-BT,Math.abs(o)<=OT?(s=this.lat0>=0?sR(this.long0+Math.atan2(e.x,-e.y)):sR(this.long0-Math.atan2(-e.x,e.y)),e.x=s,e.y=a,e):(s=sR(this.long0+Math.atan2(e.x*n,t*this.cos_p14*i-e.y*this.sin_p14*n)),e.x=s,e.y=a,e))},names:["ortho"]},WS=1,KS=2,$S=3,JS=4,ZS=5,eM=6,tM=1,rM=2,nM=3,iM=4;function oM(e,t,r,n){var i;return e<OT?(n.value=tM,i=0):(i=Math.atan2(t,r),Math.abs(i)<=PT?n.value=tM:i>PT&&i<=BT+PT?(n.value=rM,i-=BT):i>BT+PT||i<=-(BT+PT)?(n.value=nM,i=i>=0?i-LT:i+LT):(n.value=iM,i+=BT)),i}function sM(e,t){var r=e+t;return r<-LT?r+=NT:r>+LT&&(r-=NT),r}var aM={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=BT-PT/2?this.face=ZS:this.lat0<=-(BT-PT/2)?this.face=eM:Math.abs(this.long0)<=PT?this.face=WS:Math.abs(this.long0)<=BT+PT?this.face=this.long0>0?KS:JS:this.face=$S,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(e){var t,r,n,i,o,s,a={x:0,y:0},u={value:0};if(e.x-=this.long0,t=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,r=e.x,this.face===ZS)i=BT-t,r>=PT&&r<=BT+PT?(u.value=tM,n=r-BT):r>BT+PT||r<=-(BT+PT)?(u.value=rM,n=r>0?r-LT:r+LT):r>-(BT+PT)&&r<=-PT?(u.value=nM,n=r+BT):(u.value=iM,n=r);else if(this.face===eM)i=BT+t,r>=PT&&r<=BT+PT?(u.value=tM,n=-r+BT):r<PT&&r>=-PT?(u.value=rM,n=-r):r<-PT&&r>=-(BT+PT)?(u.value=nM,n=-r-BT):(u.value=iM,n=r>0?-r+LT:-r-LT);else{var c,l,h,p,f,d;this.face===KS?r=sM(r,+BT):this.face===$S?r=sM(r,+LT):this.face===JS&&(r=sM(r,-BT)),p=Math.sin(t),f=Math.cos(t),d=Math.sin(r),c=f*Math.cos(r),l=f*d,h=p,this.face===WS?n=oM(i=Math.acos(c),h,l,u):this.face===KS?n=oM(i=Math.acos(l),h,-c,u):this.face===$S?n=oM(i=Math.acos(-c),h,-l,u):this.face===JS?n=oM(i=Math.acos(-l),h,c,u):(i=n=0,u.value=tM)}return s=Math.atan(12/LT*(n+Math.acos(Math.sin(n)*Math.cos(PT))-BT)),o=Math.sqrt((1-Math.cos(i))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(n))))),u.value===rM?s+=BT:u.value===nM?s+=LT:u.value===iM&&(s+=1.5*LT),a.x=o*Math.cos(s),a.y=o*Math.sin(s),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,e.x=a.x,e.y=a.y,e},inverse:function(e){var t,r,n,i,o,s,a,u,c,l,h,p,f={lam:0,phi:0},d={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,r=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),t=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?d.value=tM:e.y>=0&&e.y>=Math.abs(e.x)?(d.value=rM,t-=BT):e.x<0&&-e.x>=Math.abs(e.y)?(d.value=nM,t=t<0?t+LT:t-LT):(d.value=iM,t+=BT),c=LT/12*Math.tan(t),o=Math.sin(c)/(Math.cos(c)-1/Math.sqrt(2)),s=Math.atan(o),(a=1-(n=Math.cos(t))*n*(i=Math.tan(r))*i*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?a=-1:a>1&&(a=1),this.face===ZS)u=Math.acos(a),f.phi=BT-u,d.value===tM?f.lam=s+BT:d.value===rM?f.lam=s<0?s+LT:s-LT:d.value===nM?f.lam=s-BT:f.lam=s;else if(this.face===eM)u=Math.acos(a),f.phi=u-BT,d.value===tM?f.lam=-s+BT:d.value===rM?f.lam=-s:d.value===nM?f.lam=-s-BT:f.lam=s<0?-s-LT:-s+LT;else{var A,g,_;c=(A=a)*A,g=(c+=(_=c>=1?0:Math.sqrt(1-c)*Math.sin(s))*_)>=1?0:Math.sqrt(1-c),d.value===rM?(c=g,g=-_,_=c):d.value===nM?(g=-g,_=-_):d.value===iM&&(c=g,g=_,_=-c),this.face===KS?(c=A,A=-g,g=c):this.face===$S?(A=-A,g=-g):this.face===JS&&(c=A,A=g,g=-c),f.phi=Math.acos(-_)-BT,f.lam=Math.atan2(g,A),this.face===KS?f.lam=sM(f.lam,-BT):this.face===$S?f.lam=sM(f.lam,-LT):this.face===JS&&(f.lam=sM(f.lam,+BT))}return 0!==this.es&&(l=f.phi<0?1:0,h=Math.tan(f.phi),p=this.b/Math.sqrt(h*h+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),l&&(f.phi=-f.phi)),f.lam+=this.long0,e.x=f.lam,e.y=f.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},uM=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],cM=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],lM=.8487,hM=1.3523,pM=FT/5,fM=1/pM,dM=18,AM=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))};var gM={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(e){var t=sR(e.x-this.long0),r=Math.abs(e.y),n=Math.floor(r*pM);n<0?n=0:n>=dM&&(n=17);var i={x:AM(uM[n],r=FT*(r-fM*n))*t,y:AM(cM[n],r)};return e.y<0&&(i.y=-i.y),i.x=i.x*this.a*lM+this.x0,i.y=i.y*this.a*hM+this.y0,i},inverse:function(e){var t={x:(e.x-this.x0)/(this.a*lM),y:Math.abs(e.y-this.y0)/(this.a*hM)};if(t.y>=1)t.x/=uM[18][0],t.y=e.y<0?-BT:BT;else{var r=Math.floor(t.y*dM);for(r<0?r=0:r>=dM&&(r=17);;)if(cM[r][0]>t.y)--r;else{if(!(cM[r+1][0]<=t.y))break;++r}var n=cM[r],i=5*(t.y-n[0])/(cM[r+1][0]-n[0]);i=function(e,t,r,n){for(var i=t;n;--n){var o=e(i);if(i-=o,Math.abs(o)<r)break}return i}((function(e){return(AM(n,e)-t.y)/function(e,t){return e[1]+t*(2*e[2]+3*t*e[3])}(n,e)}),i,OT,100),t.x/=AM(uM[r],i),t.y=(5*r+i)*DT,e.y<0&&(t.y=-t.y)}return t.x=sR(t.x+this.long0),t},names:["Robinson","robin"]};var _M,mM={init:function(){this.name="geocent"},forward:function(e){return ER(e,this.es,this.a)},inverse:function(e){return xR(e,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};BR.defaultDatum="WGS84",BR.Proj=yR,BR.WGS84=new BR.Proj("WGS84"),BR.Point=WR,BR.toPoint=vR,BR.defs=ZT,BR.transform=RR,BR.mgrs=GR,BR.version="2.6.1",(_M=BR).Proj.projections.add(rS),_M.Proj.projections.add(uS),_M.Proj.projections.add(cS),_M.Proj.projections.add(pS),_M.Proj.projections.add(fS),_M.Proj.projections.add(dS),_M.Proj.projections.add(AS),_M.Proj.projections.add(gS),_M.Proj.projections.add(_S),_M.Proj.projections.add(TS),_M.Proj.projections.add(FS),_M.Proj.projections.add(NS),_M.Proj.projections.add(LS),_M.Proj.projections.add(US),_M.Proj.projections.add(GS),_M.Proj.projections.add(QS),_M.Proj.projections.add(kS),_M.Proj.projections.add(zS),_M.Proj.projections.add(jS),_M.Proj.projections.add(HS),_M.Proj.projections.add(qS),_M.Proj.projections.add(VS),_M.Proj.projections.add(YS),_M.Proj.projections.add(XS),_M.Proj.projections.add(aM),_M.Proj.projections.add(gM),_M.Proj.projections.add(mM);var yM,EM=(yM=!0,function(e,t){var r=yM?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return yM=!1,r}),xM=EM(void 0,(function(){return xM.toString().search("(((.+)+)+)+$").toString().constructor(xM).search("(((.+)+)+)+$")}));xM();const CM={"EPSG:4490":'GEOGCS["China Geodetic Coordinate System 2000",DATUM["China_2000",SPHEROID["CGCS2000",6378137,298.257222101,AUTHORITY["EPSG","1024"]],AUTHORITY["EPSG","1043"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4490"]]',"EPSG:4214":'GEOGCS["Beijing 1954",DATUM["Beijing_1954",SPHEROID["Krassowsky 1940",6378245,298.3],TOWGS84[15.8,-154.4,-82.3,0,0,0,0]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4214"]]',"EPSG:4610":'GEOGCS["Xian 1980",DATUM["Xian_1980",SPHEROID["IAG 1975",6378140,298.257,AUTHORITY["EPSG","7049"]],AUTHORITY["EPSG","6610"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4610"]]'};class bM{constructor(e,t,r){this.epsgCode=e,this.extent=r,this.sceneMode=_c.SCENE3D,Array.isArray(t)&&(this.extent=t),this.getExtent(),this.WKT=t,(!this.WKT||Array.isArray(this.WKT))&&(this.WKT=CM[e]),this.WKT&&BR.defs(e,this.WKT);var n=BR.defs(e);if(!n)throw new Error(e+" was not defined,make sure the WKT param was not null");this.unit=n.units||"degree",this.proj4Projection=BR(e),this._id=op++}getExtent(){if(!this._rectifyExtent){var e=this.extent[2]-this.extent[0],t=this.extent[3]-this.extent[1];if(e===t)this._rectifyExtent=[this.extent[0],this.extent[1],this.extent[2],this.extent[3]];else{var r=Math.max(e,t);this._rectifyExtent=[this.extent[0],this.extent[3]-r,this.extent[0]+r,this.extent[3]]}}return this._rectifyExtent}getLngLatCenter(){return this._rectifyLngLatExtent||this.getLngLatExtent(),[this._rectifyLngLatExtent[2]+(this._rectifyLngLatExtent[2]-this._rectifyLngLatExtent[0])/2,this._rectifyLngLatExtent[3]-(this._rectifyLngLatExtent[3]-this._rectifyLngLatExtent[1])/2]}getLngLatExtent(){if(!this._rectifyLngLatExtent){var e=this.proj4Projection.inverse([this.extent[0],this.extent[1]]),t=this.proj4Projection.inverse([this.extent[2],this.extent[3]]),r=t[0]-e[0],n=t[1]-e[1];if(r===n)this._rectifyLngLatExtent=[e[0],e[1],t[0],t[0]];else{var i=Math.max(r,n);this._rectifyLngLatExtent=[e[0],t[1]-i,e[0]+i,t[1]]}}return this._rectifyLngLatExtent}getOrigin(){return[this.extent[0],this.extent[3]]}getEpsgCode(){return this.epsgCode}getUnit(){return this.unit}getWKT(){return this.WKT}getWidth(){return this._rectifyExtent[2]-this._rectifyExtent[0]}getHeight(){return this._rectifyExtent[3]-this._rectifyExtent[1]}getOriginX(){return this._rectifyExtent[0]}getOriginY(){return this._rectifyExtent[3]}toWGS84(e){return this.proj4Projection.inverse(e)}fromWGS84(e){return this.proj4Projection.forward(e)}fromLngLat(e,t){var r=XE.convert(e),n=this.proj4Projection.forward([r.lng,r.lat]);return{x:(n[0]-this.getOriginX())/this.getWidth(),y:(this.getOriginY()-n[1])/this.getHeight(),z:t||0}}toLngLat(e,t){var r=this.proj4Projection.inverse([e*this.getWidth()+this.getOriginX(),this.getOriginY()-t*this.getHeight()]);return new XE(r[0],r[1])}isProj(){return!("degree"==this.unit||"degrees"==this.unit||"d"==this.unit)}static get(e){for(var t in bM)if(bM.hasOwnProperty(t)&&bM[t].getEpsgCode&&bM[t].getEpsgCode()===e)return bM[t];return null}static set(e){var t=e.getEpsgCode().replace(":","").toUpperCase();bM[t]=e}static fromEpsgCode(e,t,r){"number"==typeof e&&(e="EPSG:"+e);let n=bM[e.replace(":","")];if(void 0===n){if(void 0===t||void 0===r)throw new Error("Invalid epsgCode: "+e);return new bM(e,t,r)}return n}}let IM;function vM(e){let t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r="";const n=IM.crypto||IM.webkitCrypto||IM.mozCrypto||IM.oCrypto||IM.msCrypto;for(let i=e;i>0;--i)r+=t[Math.floor(n.getRandomValues(new Uint32Array(1))[0]%.9999*62)];return r}bM.EPSG4326=new bM("EPSG:4326",[-180,-90,180,90]),bM.EPSG4490=new bM("EPSG:4490",[-180,-90,180,90]),bM.EPSG4214=new bM("EPSG:4214",[-180,-90,180,90]),bM.EPSG4610=new bM("EPSG:4610",[-180,-90,180,90]),bM.EPSG3857=new bM("EPSG:3857",[-20037508.3427892,-20037508.3427892,20037508.3427892,20037508.3427892]),IM=pp()?self:window,vM(16),vM(12);var TM,RM=(TM=!0,function(e,t){var r=TM?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return TM=!1,r}),SM=RM(void 0,(function(){return SM.toString().search("(((.+)+)+)+$").toString().constructor(SM).search("(((.+)+)+)+$")}));SM();const MM=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),wM=MM(void 0,(function(){return wM.toString().search("(((.+)+)+)+$").toString().constructor(wM).search("(((.+)+)+)+$")}));wM();class BM{constructor(e,t,r,n){this.z=e,this.x=t,this.y=r,this.key=FM(0,e,e,t,r),n&&(this.indexExtent=n,this.worldWidth=n[2]-n[0],this.worldHeight=n[3]-n[1])}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}getTileBBox(){var e=Math.pow(2,this.z);return this.indexExtent,this.indexExtent[0]+this.worldWidth*this.x/e+","+(this.indexExtent[3]-this.worldHeight*(this.y+1)/e)+","+(this.indexExtent[0]+this.worldWidth*(this.x+1)/e)+","+(this.indexExtent[3]-this.worldHeight*this.y/e)}url(e,t,r,n){const i=this.getTileBBox(),o=function(e,t,r){let n,i="";for(let o=e;o>0;o--)n=1<<o-1,i+=(t&n?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y),s=this.x,a=this.y,u=this.z;var c,l,h;let p=e[(c=this.x,l=this.y,h=e.length,(c+l)%h)].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(u)).replace(/{x}/g,String(s)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:a)).replace("{quadkey}",o).replace("{bbox-epsg-3857}",i).replace("{bbox}",i).replace("{width}",r).replace("{height}",r);if(this.getViewBounds){var f=this.getViewBounds();f&&(p=p.replace("{viewBounds}",f))}return n&&(p=p.replace("{scale}",n)),p}getViewBounds(){var e=Math.pow(2,this.z);let t=this.indexExtent[0]+this.worldWidth*this.x/e,r=this.indexExtent[0]+this.worldWidth*(this.x+1)/e;return'{"leftBottom":{"x":'+t+',"y":'+(this.indexExtent[3]-this.worldHeight*(this.y+1/e))+'},"rightTop":{"x":'+r+',"y":'+(this.indexExtent[3]-this.worldHeight*(this.y/e))+"}}"}toString(){return this.z+"/"+this.x+"/"+this.y}}class OM{constructor(e,t){this.wrap=e,this.canonical=t,this.key=FM(e,t.z,t.z,t.x,t.y)}}class DM{constructor(e,t,r,n,i,o){this.overscaledZ=e,this.wrap=t,this.canonical=new BM(r,+n,+i,o),this.key=0===t&&e===r?this.canonical.key:FM(t,e,r,n,i),this.indexExtent=o}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const t=this.canonical.z-e;return e>this.canonical.z?new DM(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y,this.indexExtent):new DM(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t,this.indexExtent)}calculateScaledKey(e,t=!0){if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return FM(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);{const r=this.canonical.z-e;return FM(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new DM(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y,this.indexExtent)];const t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new DM(t,this.wrap,t,r,n,this.indexExtent),new DM(t,this.wrap,t,r+1,n,this.indexExtent),new DM(t,this.wrap,t,r,n+1,this.indexExtent),new DM(t,this.wrap,t,r+1,n+1,this.indexExtent)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new DM(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y,this.indexExtent)}unwrapTo(e){return new DM(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y,this.indexExtent)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new OM(this.wrap,this.canonical)}toString(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y}}function FM(e,t,r,n,i){const o=1<<Math.min(r,22);let s=o*(i%o)+n%o;if(e&&r<22){s+=o*o*((e<0?-2*e-1:2*e)%(1<<2*(22-r)))}return 16*(32*s+r)+(t-r)}Sp(BM,"CanonicalTileID"),Sp(DM,"OverscaledTileID",{omit:["projMatrix"]});const PM=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),NM=PM(void 0,(function(){return NM.toString().search("(((.+)+)+)+$").toString().constructor(NM).search("(((.+)+)+)+$")}));function LM(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const r=Math.pow(2,-e.z),n=e.x*r,i=(e.x+1)*r,o=e.y*r,s=(e.y+1)*r,a=ZE(n),u=ZE(i),c=ex(o),l=ex(s),h=t.project(a,c),p=t.project(u,c),f=t.project(u,l),d=t.project(a,l);let A=Math.min(h.x,p.x,f.x,d.x),g=Math.min(h.y,p.y,f.y,d.y),_=Math.max(h.x,p.x,f.x,d.x),m=Math.max(h.y,p.y,f.y,d.y);const y=r/16;function E(e,r,n,i,o,s){const a=(n+o)/2,u=(i+s)/2,c=t.project(ZE(a),ex(u)),l=Math.max(0,A-c.x,g-c.y,c.x-_,c.y-m);A=Math.min(A,c.x),_=Math.max(_,c.x),g=Math.min(g,c.y),m=Math.max(m,c.y),l>y&&(E(e,c,n,i,a,u),E(c,r,a,u,o,s))}E(h,p,n,o,i,o),E(p,f,i,o,i,s),E(f,d,i,s,n,s),E(d,h,n,s,n,o),A-=y,g-=y,_+=y,m+=y;const x=1/Math.max(_-A,m-g);return{scale:x,x:A*x,y:g*x,x2:_*x,y2:m*x,projection:t}}NM();const UM=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),GM=UM(void 0,(function(){return GM.toString().search("(((.+)+)+)+$").toString().constructor(GM).search("(((.+)+)+)+$")}));GM();const QM=J_.mat4.identity(new Float32Array(16));class kM{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,t){return{x:0,y:0,z:0}}unproject(e,t){return new XE(0,0)}projectTilePoint(e,t,r){return{x:e,y:t,z:0}}locationPoint(e,t,r=!0){return e._coordinatePoint(e.locationCoordinate(t),r)}pixelsPerMeter(e,t){return JE(1,e)*t}pixelSpaceConversion(e,t,r){return 1}farthestPixelDistance(e){return function(e){const t=e.fovAboveCenter,r=(e._camera.position[2]*e.worldSize-0)/Math.cos(e._pitch),n=Math.sin(t)*r/Math.sin(Math.max(Math.PI/2-e._pitch-t,.01)),i=Math.sin(e._pitch)*n+r,o=r*(1/e._horizonShift);return Math.min(1.01*i,o)}(e,e.pixelsPerMeter)}pointCoordinate(e,t,r,n){const i=e.horizonLineFromTop(!1),o=new Pn(t,Math.max(i,r));return e.rayIntersectionCoordinate(e.pointRayIntersection(o,n))}pointCoordinate3D(e,t,r){const n=new Pn(t,r),i=this.pointCoordinate(e,n.x,n.y,0);return[i.x,i.y,i.z]}isPointAboveHorizon(e,t){const r=e.horizonLineFromTop();return t.y<r}createInversionMatrix(e,t){return QM}createTileMatrix(e,t,r){let n,i,o;const s=r.canonical,a=J_.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const u=LM(s,this);n=1,i=u.x+r.wrap*u.scale,o=u.y,J_.mat4.scale(a,a,[n/u.scale,n/u.scale,e.pixelsPerMeter/t])}else{n=t/e.zoomScale(s.z);i=(s.x+Math.pow(2,s.z)*r.wrap)*n,o=s.y*n}return J_.mat4.translate(a,a,[i,o,0]),J_.mat4.scale(a,a,[n/Ec,n/Ec,1]),a}upVector(e,t,r){return[0,0,1]}upVectorScale(e,t,r){return{metersToTile:1}}}const zM=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),jM=zM(void 0,(function(){return jM.toString().search("(((.+)+)+)+$").toString().constructor(jM).search("(((.+)+)+)+$")}));jM();class HM extends kM{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[t,r]=this.parallels=e.parallels||[29.5,45.5],n=Math.sin(Zh(t));this.n=(n+Math.sin(Zh(r)))/2,this.c=1+n*(2*this.n-n),this.r0=Math.sqrt(this.c)/this.n}project(e,t){const{n:r,c:n,r0:i}=this,o=Zh(e-this.center[0]),s=Zh(t),a=Math.sqrt(n-2*r*Math.sin(s))/r;return{x:a*Math.sin(o*r),y:a*Math.cos(o*r)-i,z:0}}unproject(e,t){const{n:r,c:n,r0:i}=this,o=i+t;let s=Math.atan2(e,Math.abs(o))*Math.sign(o);o*r<0&&(s-=Math.PI*Math.sign(e)*Math.sign(o));const a=Zh(this.center[0])*r;s=rp(s,-Math.PI-a,Math.PI-a);const u=tp(ep(s/r)+this.center[0],-180,180),c=Math.asin(tp((n-(e*e+o*o)*r*r)/(2*r),-1,1)),l=tp(ep(c),-85.051129,tx);return new XE(u,l)}}const qM=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),VM=qM(void 0,(function(){return VM.toString().search("(((.+)+)+)+$").toString().constructor(VM).search("(((.+)+)+)+$")}));VM();const YM=1.340264,XM=-.081106,WM=893e-6,KM=.003796,$M=Math.sqrt(3)/2;class JM extends kM{project(e,t){t=t/180*Math.PI,e=e/180*Math.PI;const r=Math.asin($M*Math.sin(t)),n=r*r,i=n*n*n,o=e*Math.cos(r)/($M*(YM+3*XM*n+i*(7*WM+.034164*n))),s=r*(YM+XM*n+i*(WM+KM*n));return{x:.5*(o/Math.PI+.5),y:1-.5*(s/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let r=t=(2*(1-t)-1)*Math.PI,n=r*r,i=n*n*n;for(let e,o,s,a=0;a<12&&(o=r*(YM+XM*n+i*(WM+KM*n))-t,s=YM+3*XM*n+i*(7*WM+.034164*n),e=o/s,r=tp(r-e,-Math.PI/3,Math.PI/3),n=r*r,i=n*n*n,!(Math.abs(e)<1e-12));++a);const o=$M*e*(YM+3*XM*n+i*(7*WM+.034164*n))/Math.cos(r),s=Math.asin(Math.sin(r)/$M),a=tp(180*o/Math.PI,-180,180),u=tp(180*s/Math.PI,-85.051129,tx);return new XE(a,u)}}const ZM=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),ew=ZM(void 0,(function(){return ew.toString().search("(((.+)+)+)+$").toString().constructor(ew).search("(((.+)+)+)+$")}));ew();class tw extends kM{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}unproject(e,t){const r=360*(e-.5),n=tp(360*(.5-t),-85.051129,tx);return new XE(r,n)}}const rw=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),nw=rw(void 0,(function(){return nw.toString().search("(((.+)+)+)+$").toString().constructor(nw).search("(((.+)+)+)+$")}));nw();const iw=Math.PI/2;function ow(e){return Math.tan((iw+e)/2)}class sw extends kM{constructor(e){super(e),this.center=e.center||[0,30];const[t,r]=this.parallels=e.parallels||[30,30];let n=Zh(t),i=Zh(r);this.southernCenter=n+i<0,this.southernCenter&&(n=-n,i=-i);const o=Math.cos(n),s=ow(n);this.n=n===i?Math.sin(n):Math.log(o/Math.cos(i))/Math.log(ow(i)/s),this.f=o*Math.pow(ow(n),this.n)/this.n}project(e,t){t=Zh(t),this.southernCenter&&(t=-t),e=Zh(e-this.center[0]);const r=1e-6,{n:n,f:i}=this;i>0?t<-iw+r&&(t=-iw+r):t>iw-r&&(t=iw-r);const o=i/Math.pow(ow(t),n);let s=o*Math.sin(n*e),a=i-o*Math.cos(n*e);return s=.5*(s/Math.PI+.5),a=.5*(a/Math.PI+.5),{x:s,y:this.southernCenter?a:1-a,z:0}}unproject(e,t){e=(2*e-.5)*Math.PI,this.southernCenter&&(t=1-t),t=(2*(1-t)-.5)*Math.PI;const{n:r,f:n}=this,i=n-t,o=Math.sign(i),s=Math.sign(r)*Math.sqrt(e*e+i*i);let a=Math.atan2(e,Math.abs(i))*o;i*r<0&&(a-=Math.PI*Math.sign(e)*o);const u=tp(ep(a/r)+this.center[0],-180,180),c=tp(ep(2*Math.atan(Math.pow(n/s,1/r))-iw),-85.051129,tx);return new XE(u,this.southernCenter?-c:c)}}const aw=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),uw=aw(void 0,(function(){return uw.toString().search("(((.+)+)+)+$").toString().constructor(uw).search("(((.+)+)+)+$")}));uw();class cw extends kM{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,t){return{x:(180+e)/360,y:$E(t),z:0}}unproject(e,t){const r=ZE(e),n=ex(t);return new XE(r,n)}}const lw=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),hw=lw(void 0,(function(){return hw.toString().search("(((.+)+)+)+$").toString().constructor(hw).search("(((.+)+)+)+$")}));hw();const pw=Zh(tx);class fw extends kM{project(e,t){const r=(t=Zh(t))*t,n=r*r,i=t*(1.007226+r*(.015085+n*(.028874*r-.044475-.005916*n)));return{x:.5*((e=Zh(e))*(.8707-.131979*r+n*(n*(.003971*r-.001529*n)-.013791))/Math.PI+.5),y:1-.5*(i/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let r=t=(2*(1-t)-1)*Math.PI,n=25,i=0,o=r*r;do{o=r*r;const e=o*o;i=(r*(1.007226+o*(.015085+e*(.028874*o-.044475-.005916*e)))-t)/(1.007226+o*(.045255+e*(.259866*o-.311325-.005916*11*e))),r=tp(r-i,-pw,pw)}while(Math.abs(i)>1e-6&&--n>0);o=r*r;const s=tp(ep(e/(.8707+o*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979))),-180,180),a=ep(r);return new XE(s,a)}}const dw=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Aw=dw(void 0,(function(){return Aw.toString().search("(((.+)+)+)+$").toString().constructor(Aw).search("(((.+)+)+)+$")}));Aw();const gw=Zh(tx);class _w extends kM{project(e,t){t=Zh(t),e=Zh(e);const r=Math.cos(t),n=2/Math.PI,i=Math.acos(r*Math.cos(e/2)),o=Math.sin(i)/i,s=.5*(e*n+2*r*Math.sin(e/2)/o)||0,a=.5*(t+Math.sin(t)/o)||0;return{x:.5*(s/Math.PI+.5),y:1-.5*(a/Math.PI+1),z:0}}unproject(e,t){let r=e=(2*e-.5)*Math.PI,n=t=(2*(1-t)-1)*Math.PI,i=25;const o=1e-6;let s=0,a=0;do{const i=Math.cos(n),o=Math.sin(n),u=2*o*i,c=o*o,l=i*i,h=Math.cos(r/2),p=Math.sin(r/2),f=2*h*p,d=p*p,A=1-l*h*h,g=A?1/A:0,_=A?Math.acos(i*h)*Math.sqrt(1/A):0,m=.5*(2*_*i*p+2*r/Math.PI)-e,y=.5*(_*o+n)-t,E=.5*g*(l*d+_*i*h*c)+1/Math.PI,x=g*(f*u/4-_*o*p),C=.125*g*(u*p-_*o*l*f),b=.5*g*(c*h+_*d*i)+.5,I=x*C-b*E;s=(y*x-m*b)/I,a=(m*C-y*E)/I,r=tp(r-s,-Math.PI,Math.PI),n=tp(n-a,-gw,gw)}while((Math.abs(s)>o||Math.abs(a)>o)&&--i>0);return new XE(ep(r),ep(n))}}const mw=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),yw=mw(void 0,(function(){return yw.toString().search("(((.+)+)+)+$").toString().constructor(yw).search("(((.+)+)+)+$")}));yw();class Ew extends kM{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Zh(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){const{scale:r,cosPhi:n}=this;return{x:Zh(e)*n*r+.5,y:-(Math.sin(Zh(t))/n)*r+.5,z:0}}unproject(e,t){const{scale:r,cosPhi:n}=this,i=-(t-.5)/r,o=tp(ep((e-.5)/r)/n,-180,180),s=i*n,a=Math.asin(tp(s,-1,1)),u=tp(ep(a),-85.051129,tx);return new XE(o,u)}}const xw=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Cw=xw(void 0,(function(){return Cw.toString().search("(((.+)+)+)+$").toString().constructor(Cw).search("(((.+)+)+)+$")}));function bw(e){const t=e.parallels,r=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new cw(e);case"equirectangular":return new tw(e);case"naturalEarth":return new fw(e);case"equalEarth":return new JM(e);case"winkelTripel":return new _w(e);case"albers":return r?new Ew(e):new HM(e);case"lambertConformalConic":return r?new Ew(e):new sw(e)}throw new Error("Invalid projection name: "+e.name)}Cw();const Iw=(e,t,r,n)=>{let i=t;const o=r>>>1,s=e[i-1];for(;t<=o;){(t=i<<1)<r&&0>n(e[t-1],e[t])&&++t;const o=e[t-1];if(0>=n(o,s))break;e[i-1]=o,i=t}e[i-1]=s},vw=(e,t)=>e<t?-1:e>t?1:0;function Tw(){}function Rw(e=1){this._seed=e}function Sw(){}function Mw(e){return e}function ww(e){return e?(Pw.seed=e,()=>Pw.getFloat()):Math.random}Tw.sort=function(e,t,r,n){void 0===t&&(t=0),void 0===r&&(r=e.length),void 0===n&&(n=vw);for(var i=r>>>1;i>t;i--)Iw(e,i,r,n);for(i=t+1,--r;r>t;r--){const o=e[t];e[t]=e[r],e[r]=o,Iw(e,i,r,n)}},Tw.iterableSort=function*(e,t,r,n){void 0===t&&(t=0),void 0===r&&(r=e.length),void 0===n&&(n=vw);for(var i=r>>>1;i>t;i--)Iw(e,i,r,n),yield;for(i=t+1,--r;r>t;r--){const o=e[t];e[t]=e[r],e[r]=o,Iw(e,i,r,n),yield}},Object.defineProperties(Rw.prototype,{seed:{set:function(e){this._seed=null==e?Math.random()*c._m:e}}}),Rw.prototype.getInt=function(){return this._seed=(c._a*this._seed+c._c)%c._m},Rw.prototype.getFloat=function(){return this.getInt()/(c._m-1)},Rw.prototype.getIntRange=function(e,t){return Math.round(this.getFloatRange(e,t))},Rw.prototype.getFloatRange=function(e,t){t-=e;return e+this.getInt()/c._m*t},Rw._m=2147483647,Rw._a=48271,Rw._c=0;const Bw=!!Array.prototype.fill;function Ow(){this.last=0}const Dw=new Ow,Fw=new Set,Pw=new Rw;function Nw(e){e.data.length>1.5*e.length&&(e.data.length=Math.floor(1.1*e.length))}function Lw(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Ow,e&&(e.initialSize&&(this.data=Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),void 0!==e.deallocator&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>Nw(this)))}function Uw(e,t=30){this.name=e,this._counter=0,this._samples=Array(t)}function Gw(){}function Qw(){}function kw(){this._groups=new Map}function zw(){}function jw(e){return{remove:()=>{e&&(e(),e=void 0)}}}function Hw(e,t,r,n=1,i=0){if(this._ctor=e,this._acquireFunction=t,this._releaseFunction=r,this.allocationSize=n,this._pool=Array(i),this._initialSize=i,this._ctor)for(e=0;e<i;e++)this._pool[e]=new this._ctor;this.allocationSize=Math.max(n,1)}function qw(e){e.length=0}function Vw(e=50,t=50){this._pool=new Hw(Array,void 0,qw,t,e)}Sw.EmptyArray=[],Sw.ReallocGrowthFactor=1.5,Sw.ReallocShrinkFactor=1/1.5,Sw.ReallocShrinkTreshold=.5,Sw.binaryFindClosest=function(e,t,r){if(e&&0!==e.length){var n=e.length-1,i=e[0];if(t<=r(i))return i;if(t>=r(i=e[n]))return i;var o=0;i=0;for(var s=n;o<s;){const u=e[i=o+Math.floor((s-o)/2)],c=r(u);if(c===t)return u;if(t<c){if(0<i){var a=r(s=e[i-1]);if(t>a)return t-a>=c-t?u:s}s=i}else{if(i<n&&t<(a=r(o=e[i+1])))return t-c>=a-t?o:u;o=i+1}}return e[i]}},Sw.binaryIndexOf=function(e,t,r){const n=e.length;let i=0;for(var o=n-1;i<o;){const r=i+Math.floor((o-i)/2);t>e[r]?i=r+1:o=r}return o=e[i],r?t>=e[n-1]?-1:o===t?i:i-1:o===t?i:-1},Sw.constant=function(e,t){if(Bw)return Array(e).fill(t);const r=Array(e);for(let n=0;n<e;n++)r[n]=t;return r},Sw.difference=function(e,t,r){let n,i;return r?(n=t.filter((t=>!e.some((e=>r(e,t))))),i=e.filter((e=>!t.some((t=>r(t,e)))))):(n=t.filter((t=>!e.includes(t))),i=e.filter((e=>!t.includes(e)))),{added:n,removed:i}},Sw.equals=function(e,t,r){if(null==e&&null==t)return!0;if(null==e||null==t||e.length!==t.length)return!1;if(r){for(let n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},Sw.filterInPlace=function(e,t){let r=0;for(let n=0;n<e.length;++n){const i=e[n];t(i,n)&&(e[r]=i,r++)}e.length=r},Sw.first=function(e){if(e)return 0<e.length?e[0]:void 0},Sw.groupToMap=function(e,t){const r=new Map,n=e.length;for(let i=0;i<n;i++){const n=e[i],o=t(n,i,e),s=r.get(o);s?s.push(n):r.set(o,[n])}return r},Sw.intersect=function(e,t,r){return e&&t?r?e.filter((e=>-1<t.findIndex((t=>r(e,t))))):e.filter((e=>t.includes(e))):[]},Sw.isArrayLike=function(e){return e&&"number"==typeof e.length},Sw.isSome=function(e,t){return null!=e},Sw.last=function(e){if(e){var t=e.length;return 0<t?e[t-1]:void 0}},Sw.max=function(e,t=Mw){if(e&&0!==e.length){var r=e[0],n=t(r);for(let i=1;i<e.length;++i){const o=e[i],s=Number(t(o));s>n&&(n=s,r=o)}return r}},Sw.min=function(e,t=Mw){return Sw.max(e,(e=>-t(e)))},Sw.pickRandom=function(e,t,r){const n=e.length;if(t>=n)return e.slice(0);let i=ww(r);const o=new Set,s=[];for(;s.length<t;){const t=Math.floor(i()*n);o.has(t)||(o.add(t),s.push(e[t]))}return s},Sw.range=function(e,t){void 0===t&&(t=e,e=0);const r=Array(t-e);for(let n=e;n<t;n++)r[n-e]=n;return r},Sw.indexOf=function(e,t,r,n){n=n||Dw;var i=Math.max(0,n.last-10);for(let o=i;o<r;++o)if(e[o]===t)return n.last=o;for(r=Math.min(i,r),i=0;i<r;++i)if(e[i]===t)return n.last=i;return-1},Sw.remove=function(e,t){const r=e.indexOf(t);return-1!==r?(e.splice(r,1),t):null},Sw.removeUnordered=function(e,t,r,n){const i=null==r?e.length:r;let o=Sw.indexOf(e,t,i,n);if(-1!==o)return e[o]=e[i-1],null==r&&e.pop(),t},Sw.removeUnorderedMany=function(e,t,r=e.length,n=t.length,i,o){if(0===n||0===r)return r;Fw.clear();for(let e=0;e<n;++e)Fw.add(t[e]);i=i||Dw;let s=Math.max(0,i.last-10);for(var a=s;a<r;++a)if(Fw.has(e[a])&&(o&&o.push(e[a]),Fw.delete(e[a]),e[a]=e[r-1],--r,--a,0===Fw.size||0===r))return Fw.clear(),r;for(a=0;a<s;++a)if(Fw.has(e[a])&&(o&&o.push(e[a]),Fw.delete(e[a]),e[a]=e[r-1],--r,--a,0===Fw.size||0===r))return Fw.clear(),r;return Fw.clear(),r},Sw.shuffle=function(e,t){let r=ww(t);for(let t=e.length-1;0<t;t--){const n=Math.floor(r()*(t+1)),i=e[t];e[t]=e[n],e[n]=i}return e},Sw.splitIntoChunks=function(e,t){const r=e.length;if(0===r)return[];const n=[];for(let i=0;i<r;i+=t)n.push(e.slice(i,i+t));return n},Sw.unique=function(e,t){return t?e.filter(((e,r,n)=>n.findIndex(t.bind(null,e))===r)):e.filter(((e,t,r)=>r.indexOf(e)===t))},Sw.update=function(e,t){let r=e.length!==t.length;r&&(e.length=t.length);for(let n=0;n<t.length;++n)e[n]!==t[n]&&(e[n]=t[n],r=!0);return r},Lw.prototype.toArray=function(){return this.data.slice(0,this.length)},Lw.prototype.filter=function(e){const t=[];for(let r=0;r<this._length;r++){const n=this.data[r];e(n)&&t.push(n)}return t},Lw.prototype.at=function(e){if(0>(e=Math.trunc(e)||0)&&(e+=this._length),!(0>e||e>=this._length))return this.data[e]},Lw.prototype.includes=function(e,t){return-1!==(e=this.data.indexOf(e,t))&&e<this.length},Lw.prototype.clear=function(){this.length=0},Lw.prototype.prune=function(){this.clear(),this.data=[]},Lw.prototype.push=function(e){this.data[this._length++]=e},Lw.prototype.pushArray=function(e,t=e.length){for(let r=0;r<t;r++)this.data[this._length++]=e[r]},Lw.prototype.fill=function(e,t){for(let r=0;r<t;r++)this.data[this._length++]=e},Lw.prototype.pushNew=function(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e},Lw.prototype.unshift=function(e){this.data.unshift(e),this._length++,Nw(this)},Lw.prototype.pop=function(){if(0!==this.length){var e=this.data[this.length-1];return--this.length,this._shrink(),e}},Lw.prototype.remove=function(e){const t=Sw.indexOf(this.data,e,this.length,this._hint);if(-1!==t)return this.data.splice(t,1),--this.length,e},Lw.prototype.removeUnordered=function(e){return this.removeUnorderedIndex(Sw.indexOf(this.data,e,this.length,this._hint))},Lw.prototype.removeUnorderedIndex=function(e){if(!(e>=this.length||0>e))return this.swapElements(e,this.length-1),this.pop()},Lw.prototype.removeUnorderedMany=function(e,t=e.length,r){this.length=Sw.removeUnorderedMany(this.data,e,this.length,t,this._hint,r),this._shrink()},Lw.prototype.front=function(){if(0!==this.length)return this.data[0]},Lw.prototype.back=function(){if(0!==this.length)return this.data[this.length-1]},Lw.prototype.swapElements=function(e,t){if(!(e>=this.length||t>=this.length||e===t)){var r=this.data[e];this.data[e]=this.data[t],this.data[t]=r}},Lw.prototype.sort=function(e){Tw.sort(this.data,0,this.length,e)},Lw.prototype.iterableSort=function(e){return Tw.iterableSort(this.data,0,this.length,e)},Lw.prototype.some=function(e,t){for(let r=0;r<this.length;++r)if(e.call(t,this.data[r],r,this.data))return!0;return!1},Lw.prototype.find=function(e,t){for(let r=0;r<this.length;++r){const n=this.data[r];if(e.call(t,n,r))return n}},Lw.prototype.filterInPlace=function(e,t){let r=0;for(let n=0;n<this._length;++n){const i=this.data[n];e.call(t,i,n,this.data)&&(this.data[n]=this.data[r],this.data[r]=i,r++)}if(this._deallocator)for(e=r;e<this._length;e++)this.data[e]=this._deallocator(this.data[e]);return this._length=r,this._shrink(),this},Lw.prototype.forAll=function(e,t){const r=this.length,n=this.data;for(let i=0;i<r;++i)e.call(t,n[i],i,n)},Lw.prototype.forEach=function(e,t){for(let r=0;r<this.length;++r)e.call(t,this.data[r],r,this.data)},Lw.prototype.map=function(e,t){const r=Array(this.length);for(let n=0;n<this.length;++n)r[n]=e.call(t,this.data[n],n,this.data);return r},Lw.prototype.reduce=function(e,t){for(let r=0;r<this.length;++r)t=e(t,this.data[r],r,this.data);return t},Lw.prototype.has=function(e){const t=this.length,r=this.data;for(let n=0;n<t;++n)if(r[n]===e)return!0;return!1},Object.defineProperties(Lw.prototype,{length:{get:function(){return this._length},set:function(e){if(e>this._length)if(this._allocator)for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);else this._length=e;else{if(this._deallocator)for(let t=e;t<this._length;++t)this.data[t]=this._deallocator(this.data[t]);this._length=e,this._shrink()}}}}),Object.defineProperties(Uw.prototype,{median:{get:function(){return this._samples.slice().sort(((e,t)=>e-t))[Math.floor(this._samples.length/2)]}},average:{get:function(){return this._samples.reduce(((e,t)=>e+t),0)/this._samples.length}},last:{get:function(){return this._samples[this._counter%this._samples.length]}}}),Uw.prototype.record=function(e){null!=e&&(this._samples[++this._counter%this._samples.length]=e)},Gw.cache=function(e){const t=[];return function*(){yield*t;for(const r of e)t.push(r),yield r}},Gw.find=function(e,t){for(const r of e)if(null!=r&&t(r))return r},Gw.isIterable=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},Qw.abortMaybe=function(e){return e&&e.abort(),null},Qw.applySome=function(e,t){return null!=e?t(e):null},Qw.assertIsSome=function(e,t){if(null==e)throw Error(t||"value is None")},Qw.assumeNonNull=function(e){return e},Qw.destroyMaybe=function(e){return e&&e.destroy(),null},Qw.disposeMaybe=function(e){return e&&e.dispose(),null},Qw.equalsMaybe=function(e,t,r){return null!=e&&null!=t?null!=r?r(e,t):e.equals(t):e===t},Qw.forEachSome=function(e,t){for(const r of e)Qw.applySome(r,t)},Qw.mapMany=function(e,t){const r=[];for(const n of e)r.push(null!=n?t(n):null);return r},Qw.nullifyNonNullableForDispose=function(e){return null},Qw.releaseMaybe=function(e){return e&&e.release(),null},Qw.removeMaybe=function(e){return e&&e.remove(),null},Qw.unwrapOrThrow=function(e,t){return Qw.assertIsSome(e,t),e},Object.defineProperties(kw.prototype,{size:{get:function(){let e=0;return this._groups.forEach((t=>{e+=t.length})),e}}}),kw.prototype.destroy=function(){this.removeAll()},kw.prototype.add=function(e,t){if(Gw.isIterable(e)){t=this._getOrCreateGroup(t);for(const r of e)this._isHandle(r)&&t.push(r)}else this._isHandle(e)&&this._getOrCreateGroup(t).push(e);return this},kw.prototype.forEach=function(e,t){if("function"==typeof e)this._groups.forEach((t=>t.forEach(e)));else{const r=this._getGroup(e);r&&t&&r.forEach(t)}},kw.prototype.has=function(e){return this._groups.has(this._ensureGroupKey(e))},kw.prototype.remove=function(e){if("string"!=typeof e&&Gw.isIterable(e)){for(const t of e)this.remove(t);return this}return this.has(e)?(this._removeAllFromGroup(this._getGroup(e)),this._groups.delete(this._ensureGroupKey(e)),this):this},kw.prototype.removeAll=function(){return this._groups.forEach((e=>this._removeAllFromGroup(e))),this._groups.clear(),this},kw.prototype._isHandle=function(e){return e&&(!!e.remove||e instanceof f)},kw.prototype._getOrCreateGroup=function(e){if(this.has(e))return this._getGroup(e);const t=[];return this._groups.set(this._ensureGroupKey(e),t),t},kw.prototype._getGroup=function(e){return Qw.assumeNonNull(this._groups.get(this._ensureGroupKey(e)))},kw.prototype._ensureGroupKey=function(e){return e||"_default_"},kw.prototype._removeAllFromGroup=function(e){for(const t of e)t instanceof f?t.removeAll():t.remove()},zw.abortHandle=function(e){return jw((()=>e&&e.abort()))},zw.asyncHandle=function(e,t){let r=!1,n=null;return e.then((e=>{r?e.remove():n=e})),jw((()=>{r=!0,null!=n?n.remove():null!=t&&(t.abort(),t=null)}))},zw.destroyHandle=function(e){return jw(null!=e?()=>e.destroy():void 0)},zw.handlesGroup=function(e){return jw((()=>e.forEach((e=>null!=e&&e.remove()))))},zw.makeHandle=jw,zw.refHandle=function(e){return jw((()=>{const t=e();null!=t&&t.remove()}))},zw.timeoutHandle=function(e,t){const r=setTimeout(e,t);return jw((()=>clearTimeout(r)))},Hw.prototype.destroy=function(){this.prune(0)},Hw.prototype.acquire=function(...e){if(Hw.test.disabled)var t=new this._ctor;else{if(0===this._pool.length){t=this.allocationSize;for(let e=0;e<t;e++)this._pool[e]=new this._ctor}t=this._pool.pop()}return this._acquireFunction?this._acquireFunction(t,...e):t&&t.acquire&&"function"==typeof t.acquire&&t.acquire(...e),t},Hw.prototype.release=function(e){e&&!Hw.test.disabled&&(this._releaseFunction?this._releaseFunction(e):e&&e.release&&"function"==typeof e.release&&e.release(),this._pool.push(e))},Hw.prototype.prune=function(e=this._initialSize){if(!(e>=this._pool.length)){for(let t=e;t<this._pool.length;++t)this._dispose(this._pool[t]);this._pool.length=e}},Hw.prototype._dispose=function(e){e.dispose&&"function"==typeof e.dispose&&e.dispose()},Hw.test={disabled:!1},Vw.prototype.acquire=function(){return this._pool.acquire()},Vw.prototype.release=function(e){this._pool.release(e)},Vw.prototype.prune=function(){this._pool.prune(0)},Vw.acquire=function(){return Yw.acquire()},Vw.release=function(e){return Yw.release(e)},Vw.prune=function(){Yw.prune()};const Yw=new Vw(100);function Xw(){}function Ww(e){return"Int8Array"===e&&e.constructor&&e.constructor.name}function Kw(e){return"Uint8Array"===e&&e.constructor&&e.constructor.name}function $w(e){return"Uint8ClampedArray"===e&&e.constructor&&e.constructor.name}function Jw(e){return"Int16Array"===e&&e.constructor&&e.constructor.name}function Zw(e){return"Uint16Array"===e&&e.constructor&&e.constructor.name}function eB(e){return"Int32Array"===e&&e.constructor&&e.constructor.name}function tB(e){return"Uint32Array"===e&&e.constructor&&e.constructor.name}function rB(e){return"Float32Array"===e&&e.constructor&&e.constructor.name}function nB(e){return"Float64Array"===e&&e.constructor&&e.constructor.name}function iB(e){return!("buffer"in e)}function oB(){}function sB(e){return"function"==typeof e.map&&"function"==typeof e.forEach}function aB(e){if(Xw.isInt8Array(e)||Xw.isUint8Array(e)||Xw.isUint8ClampedArray(e)||Xw.isInt16Array(e)||Xw.isUint16Array(e)||Xw.isInt32Array(e)||Xw.isUint32Array(e)||Xw.isFloat32Array(e)||Xw.isFloat64Array(e))return e.slice();if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return e.slice(0,e.byteLength);if(e instanceof Map){var t=new Map;for(const[r,n]of e)t.set(r,oB.clone(n));return t}if(e instanceof Set){t=new Set;for(const r of e)t.add(oB.clone(r));return t}return null}function uB(){Hw.call(this,...arguments),this._set=new Set}function cB(){}Xw.NATIVE_ARRAY_MAX_SIZE=1024,Xw.estimateSize=function(e){return null!=e?iB(e)?8*e.length+12:e.byteLength+145:0},Xw.isArray=iB,Xw.isArrayBuffer=function(e){return e instanceof ArrayBuffer},Xw.isFloat=function(e){return nB(e)||rB(e)},Xw.isFloat32Array=rB,Xw.isFloat64Array=nB,Xw.isInt16Array=Jw,Xw.isInt32Array=eB,Xw.isInt8Array=Ww,Xw.isSigned=function(e){return nB(e)||rB(e)||eB(e)||Jw(e)||Ww(e)},Xw.isUint16Array=Zw,Xw.isUint32Array=tB,Xw.isUint8Array=Kw,Xw.isUint8ClampedArray=$w,Xw.maximumValue=function(e){return nB(e)?179769e303:rB(e)?3402823e32:tB(e)?4294967295:Zw(e)?65535:Kw(e)||$w(e)?255:eB(e)?2147483647:Jw(e)?32767:Ww(e)?127:256},Xw.typedArrayStaticSize=145,oB.clone=function(e){if(!e||"object"!=typeof e||"function"==typeof e)return e;var t=aB(e);if(null!=t)return t;if(oB.isClonable(e))return e.clone();if(sB(e))return e.map(g);if(oB.isAccessorLike(e))return e.clone();t={};for(const r of Object.getOwnPropertyNames(e))t[r]=oB.clone(e[r]);return t},oB.equals=function(e,t){return e===t||"number"==typeof e&&isNaN(e)&&"number"==typeof t&&isNaN(t)||"function"==typeof(e||{}).getTime&&"function"==typeof(t||{}).getTime&&e.getTime()===t.getTime()||!1},oB.equalsShallow=function(e,t){if(e===t)return!0;if(null==e||"string"==typeof e)return e===t;if("number"==typeof e)return e===t||"number"==typeof t&&isNaN(e)&&isNaN(t);if(e instanceof Date)return t instanceof Date&&e.getTime()===t.getTime();if(Array.isArray(e))return Array.isArray(t)&&Sw.equals(e,t);if(e instanceof Set){var r;if(r=t instanceof Set)e:if(e.size!==t.size)r=!1;else{for(const n of e)if(!t.has(n)){r=!1;break e}r=!0}return r}if(e instanceof Map){if(r=t instanceof Map)e:if(e.size!==t.size)r=!1;else{for(const[n,i]of e)if((e=t.get(n))!==i||void 0===e&&!t.has(n)){r=!1;break e}r=!0}return r}return!!oB.isPlainObject(e)&&(oB.isPlainObject(t)&&function(e,t){if(null===e||null===t)return!1;const r=Object.keys(e);if(null===t||Object.keys(t).length!==r.length)return!1;for(const n of r)if(e[n]!==t[n]||!Object.prototype.hasOwnProperty.call(t,n))return!1;return!0}(e,t))},oB.fixJson=function(e,t){let r;if(t)for(r in e)e.hasOwnProperty(r)&&(void 0===e[r]?delete e[r]:e[r]instanceof Object&&oB.fixJson(e[r],!0));else for(r in e)e.hasOwnProperty(r)&&void 0===e[r]&&delete e[r];return e},oB.isAccessorLike=function(e){return"function"==typeof e.notifyChange&&"function"==typeof e.watch},oB.isClonable=function(e){return"function"==typeof e.clone},oB.isPlainObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)&&(null===(e=Object.getPrototypeOf(e))||e===Object.prototype)},oB.tryClone=function(e){if(!e||"object"!=typeof e||"function"==typeof e||"HTMLElement"in globalThis&&e instanceof HTMLElement)return e;var t=aB(e);if(null!=t)return t;if(sB(e)){let t=!0;return e=e.map((e=>{const r=oB.tryClone(e);return null!=e&&null==r&&(t=!1),r})),t?e:null}if(u(e))return e.clone();if(e instanceof File||e instanceof Blob)return e;if(!oB.isAccessorLike(e)){t=new(Object.getPrototypeOf(e).constructor);for(const r of Object.getOwnPropertyNames(e)){const n=e[r],i=oB.tryClone(n);if(null!=n&&null==i)return null;t[r]=i}return t}return null},uB.prototype=Object.create(Hw.prototype),uB.prototype.constructor=uB,uB.prototype.destroy=function(){Hw.prototype.destroy.apply(this),this._set=null},uB.prototype.acquire=function(...e){return e=Hw.prototype.acquire.apply(this,Array.prototype.slice.apply(arguments)),this._set.delete(e),e},uB.prototype.release=function(e){e&&!this._set.has(e)&&(Hw.prototype.release.apply(this,e),this._set.add(e))},uB.prototype._dispose=function(e){this._set.delete(e),Hw.prototype._dispose.apply(this,e)};const lB=[];function hB(){}function pB(){for(;dB.length;){const e=dB.shift();e.isActive&&e.callback()}AB.willDispatch=!1}cB.nextTick=function(e){lB.push(e),1===lB.length&&queueMicrotask((()=>{const e=lB.slice();lB.length=0;for(const t of e)t()}))};class fB{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}}var dB=[];const AB={willDispatch:!1,dispatch:pB};hB.schedule=function(e){return e=new fB(e),dB.push(e),AB.willDispatch||(AB.willDispatch=!0,cB.nextTick(pB)),e};let gB=0;function _B(){}function mB(){}function yB(e){return e.__accessor__?e.__accessor__:null}function EB(e,t,r){return t?Object.keys(t).reduce(((e,n)=>{let i=null;var o="merge";if(r&&(i=r.path?`${r.path}.${n}`:n,o=r.policy(i)),"replace"===o||"replace-arrays"===o&&Array.isArray(e[n]))return e[n]=t[n],e;if(void 0===e[n])return e[n]=oB.clone(t[n]),e;let s=e[n];if(o=t[n],s===o)return e;if(Array.isArray(o)||Array.isArray(e))s=s?Array.isArray(s)?e[n]=s.concat():e[n]=[s]:e[n]=[],o&&(Array.isArray(o)||(o=[o]),o.forEach((e=>{s.includes(e)||s.push(e)})));else if(o&&"object"==typeof o)if(r){const t=r.path;r.path=Qw.assumeNonNull(i),e[n]=EB(s,o,r),r.path=t}else e[n]=EB(s,o,null);else e.hasOwnProperty(n)&&!t.hasOwnProperty(n)||(e[n]=o);return e}),e||{}):e}function xB(e){return Array.isArray(e)?e:e.split(".")}function CB(e){return e.includes(",")?e.split(",").map((e=>e.trim())):[e.trim()]}function bB(e){if(Array.isArray(e)){const t=[];for(const r of e)t.push(...CB(r));return t}return CB(e)}function IB(){}function vB(e,t){if(e="?"===e[e.length-1]?e.slice(0,-1):e,null!=t.getItemAt||Array.isArray(t)){var r=parseInt(e,10);if(!isNaN(r))return Array.isArray(t)?t[r]:t.at(r)}return r=mB.getProperties(t),mB.isPropertyDeclared(r,e)?r.get(e):t[e]}function TB(e,t,r){return null==e?e:!(e=vB(t[r],e))&&r<t.length-1?void 0:r===t.length-1?e:TB(e,t,r+1)}function RB(e,t,r=0){return"string"!=typeof t||t.includes(".")?TB(e,mB.pathToArray(t),r):vB(t,e)}function SB(){}function MB(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}function wB(e){this._accessed=[],this._handles=[],this._observerObject=new MB(e)}_B.NullUID=0,_B.generateUID=function(){return++gB},mB.getDependsInfo=function(e,t){const r=yB(e);return r?r.getDependsInfo(e,t,""):""},mB.getProperties=yB,mB.isPropertyDeclared=function(e,t){return null!=e&&e.metadatas&&null!=e.metadatas[t]},mB.merge=function(e,t,r){return EB(e,t,r?{policy:r,path:""}:null)},mB.once=function(e){let t=!1;return()=>{t||(t=!0,e())}},mB.parse=function(e,t,r,n){return 1!==(t=bB(t)).length?(t=t.map((t=>n(e,t,r))),zw.handlesGroup(t)):n(e,t[0],r)},mB.parseConditionalPath=function(e){if(!e.includes("?"))return null;e=xB(e);const t=Array(e.length);for(let r=0;r<e.length;r++){const n=e[r];t[r]="?"===n[n.length-1],t[r]&&(e[r]=n.slice(0,-1))}return{fullPath:e.join("."),conditional:t}},mB.pathToArray=xB,mB.pathToStringOrArray=function(e){return!e||"string"==typeof e&&!e.includes(".")?e:xB(e)},mB.splitPath=bB,IB.exists=function(e,t){return void 0!==RB(t,e)},IB.get=function(e,t){return RB(e,t)},IB.valueOf=RB,MB.prototype.onInvalidated=function(){this._invalidCount++},MB.prototype.onCommitted=function(){if(!this.destroyed){var e=this._invalidCount;1===e?(this._invalidCount=0,this._notify()):this._invalidCount=0<e?e-1:0}},MB.prototype.destroy=function(){this.destroyed=!0,this._notify=SB},wB.prototype.destroy=function(){this._accessed.length=0,this._observerObject&&this._observerObject.destroy(),this.clear()},wB.prototype.onObservableAccessed=function(e){const t=this._accessed;t.includes(e)||t.push(e)},wB.prototype.onTrackingEnd=function(){const e=this._handles,t=this._accessed,r=this._observerObject;for(let n=0;n<t.length;++n)e.push(t[n].observe(r));t.length=0},wB.prototype.clear=function(){const e=this._handles;for(let t=0;t<e.length;++t)e[t].remove();e.length=0};let BB={};function OB(){}function DB(){var e=NB.length;if(1<e){const t=NB.pop();LB=NB[e-2],t.onTrackingEnd()}else if(1===e){const e=NB.pop();LB=PB,e.onTrackingEnd()}else LB=PB}function FB(e,t,r){if(t="?"===t[t.length-1]?t.slice(0,-1):t,null!=e.getItemAt||Array.isArray(e)){var n=parseInt(t,10);if(!isNaN(n))return Array.isArray(e)?e[n]:e.at(n)}return(n=mB.getProperties(e))&&(n=n.propertiesByName.get(t))&&(OB.trackAccess(n.observerObject),OB.initializeDependencyTracking(e,n)),r?e[t]:void 0}BB[BB.Dirty=1]="Dirty",BB[BB.Overriden=2]="Overriden",BB[BB.Computing=4]="Computing",BB[BB.NonNullable=8]="NonNullable",BB[BB.HasDefaultValue=16]="HasDefaultValue",BB[BB.DepTrackingInitialized=32]="DepTrackingInitialized",BB[BB.AutoTracked=64]="AutoTracked",BB[BB.ExplicitlyTracking=128]="ExplicitlyTracking";const PB={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},NB=[];let LB=PB,UB=!1,GB=!1;const QB=[];function kB(){}OB.initializeDependencyTracking=function(e,t){if(!(t.flags&BB.DepTrackingInitialized)){var r=GB;GB=!1,t.flags&BB.AutoTracked?OB.runTrackedNoThrow(t,t.metadata.get,e):OB.trackExplicitDependencies(e,t),GB=r}},OB.runTracked=function(e,t,r){if(UB)return OB.runTrackedNoThrow(e,t,r);LB=e,NB.push(e);var n=t.call(r);return DB(),n},OB.runTrackedNoThrow=function(e,t,r){const n=UB;UB=!0,LB=e,NB.push(e),e=null;try{e=t.call(r)}catch(e){GB&&console.log("core.accessorSupport.tracking",e)}return DB(),UB=n,e},OB.runUntracked=function(e,t){return OB.runTracked(PB,e,t)},OB.trackAccess=function(e){LB.onObservableAccessed(e)},OB.trackExplicitDependencies=function(e,t){const r=t.observerObject;r.flags&BB.ExplicitlyTracking||(r.flags|=BB.ExplicitlyTracking,OB.runTrackedNoThrow(t,(()=>{var r=t.metadata.dependsOn||QB;for(const t of r)if("string"!=typeof t||t.includes(".")){r=mB.pathToArray(t);for(let t=0,n=e;t<r.length&&null!=n&&"object"==typeof n;++t)n=FB(n,r[t],t!==r.length-1)}else FB(e,t,!1)})),r.flags&=~BB.ExplicitlyTracking)};let zB=!1;const jB=[];function HB(){this.uid=_B.generateUID(),this.removed=!1,this.equals=null,this.path=null,this.target=null,this.getValue=null,this.callback=null,this.oldValue=null,this.type=null}function qB(){}function VB(e){JB.delete(e),JB.add(e),ZB||(ZB=hB.schedule(XB))}function YB(e){if(!e.removed){var t=e.oldValue,r=e.getValue();e.equals(t,r)||(e.oldValue=r,e.notify(r,t))}}function XB(){let e=10;for(;ZB&&e--;){ZB=null;const e=WB(),t=$B.acquire();for(const r of e){const e=r.uid;YB(r),e===r.uid&&r.removed&&t.push(r)}for(const e of JB)e.removed&&(t.push(e),JB.delete(e));for(const e of t)HB.pool.release(e);$B.release(t),$B.release(e),eO.forEach((e=>e()))}}function WB(){const e=$B.acquire();e.length=JB.size;let t=0;for(const r of JB)e[t]=r,++t;return JB.clear(),e}var KB;kB.autorun=function(e){let t=new wB((function n(){if(t&&!r)if(zB)jB.includes(n)||jB.unshift(n);else for(t.clear(),r=zB=!0,OB.runTracked(t,e),zB=r=!1;jB.length;)jB.pop()()})),r=!1;return r=!0,OB.runTracked(t,e),r=!1,{remove:function(){t&&(t.destroy(),t=null)}}},kB.reaction=function(e,t){let r=new wB((function o(){if(r&&!i)if(zB)jB.includes(o)||jB.unshift(o);else{var s=n;for(r.clear(),i=zB=!0,n=OB.runTracked(r,e),zB=i=!1,t(n,s);jB.length;)jB.pop()()}})),n=null,i=!1;return i=!0,n=OB.runTracked(r,e),i=!1,{remove:function(){r&&(r.destroy(),n=r=null)}}},kB.reactionDeferred=function(e,t){function r(){return n?(n.clear(),i=OB.runTracked(n,e)):null}let n=new wB((function(){t(i,r)}));var i=null;return r(),{remove:function(){n&&(n.destroy(),n=null),i=null}}},HB.acquireUntracked=function(e,t,r,n,i){return this.pool.acquire(KB.Untracked,e,t,r,n,i,oB.equals)},HB.acquireTracked=function(e,t,r,n){return this.pool.acquire(KB.Tracked,e,t,r,null,null,n)},HB.prototype.notify=function(e,t){this.type===KB.Untracked?this.callback.call(this.target,e,t,this.path,this.target):this.callback.call(null,e,t,void 0,void 0)},HB.prototype.acquire=function(e,t,r,n,i,o,s){this.uid=_B.generateUID(),this.removed=!1,this.type=e,this.oldValue=t,this.callback=r,this.getValue=n,this.target=i,this.path=o,this.equals=s},HB.prototype.release=function(){this.target=null,this.path=null,this.oldValue=null,this.callback=null,this.getValue=null,this.uid=_B.generateUID(),this.removed=!1},HB.pool=new uB(HB),function(e){e[e.Untracked=0]="Untracked",e[e.Tracked=1]="Tracked"}(KB||(KB={}));const $B=new Vw,JB=new Set;let ZB;const eO=new Set;function tO(){}function rO(e="Aborted"){return{type:"AbortError",status:e}}function nO(e,t="Aborted"){if(oO(e))throw rO(t)}function iO(e){return null!=e?"aborted"in e?e:e.signal:e}function oO(e){return null!=(e=iO(e))&&e.aborted}function sO(e,t){null!=(e=iO(e))&&e.aborted&&t()}function aO(e){return"AbortError"===e?.name}async function uO(e){if(e){if("function"!=typeof e.forEach){const t=Object.keys(e),r=t.map((t=>e[t])),n=await uO(r),i={};return t.map(((e,t)=>i[e]=n[t])),i}return Promise.allSettled(e).then((t=>Array.from(e,((e,r)=>"fulfilled"===(r=t[r]).status?{promise:e,value:r.value}:{promise:e,error:r.reason}))))}}function cO(e){return e&&"function"==typeof e.then}function lO(){}function hO(e,t,r={},n){let i=null;const o=r.once?(e,r)=>{n(e)&&(Qw.removeMaybe(i),t(e,r))}:(e,r)=>{n(e)&&t(e,r)};if(i=qB.watchTracked(e,o,r.sync,r.equals),r.initial){let t=e();o(t,t)}return i}function pO(e,t,r){if(tO.isAborted(r))return Promise.reject(tO.createAbortError());const n=e();if(t&&t(n))return Promise.resolve(n);let i=null;return new Promise(((n,o)=>{i=zw.handlesGroup([tO.onAbort(r,(()=>{i=Qw.removeMaybe(i),o(tO.createAbortError())})),hO(e,(e=>{i=Qw.removeMaybe(i),n(e)}),{sync:!1,once:!0},t||fO)])}))}function fO(e){return!0}function dO(e){return!!e}function AO(e,t){this._observers=e,this._observer=t}function gO(){this._observers=null,this.destroyed=!1}qB.afterDispatch=function(e){return eO.add(e),zw.makeHandle((()=>eO.delete(e)))},qB.dispatch=XB,qB.removeTarget=function(e){for(const t of JB.values())t.target===e&&(t.removed=!0)},qB.watch=function(e,t,r,n=!1){return!e.__accessor__||e.__accessor__.destroyed?zw.makeHandle():n?function(e,t,r){const n=mB.parse(e,t,r,((e,t,r)=>{let i=!1;return kB.reaction((()=>IB.valueOf(e,t)),((o,s)=>{e.__accessor__.destroyed?n.remove():i||(i=!0,oB.equals(s,o)||r.call(e,o,s,t,e),i=!1)}))}));return n}(e,t,r):function(e,t,r){let n=mB.parse(e,t,r,((e,t,r)=>{let i,o,s=kB.reactionDeferred((()=>IB.valueOf(e,t)),((s,a)=>{e.__accessor__.destroyed||i&&i.uid!==o?n.remove():(i||(i=HB.acquireUntracked(s,r,a,e,t),o=i.uid),VB(i))}));return zw.makeHandle((()=>{s.remove(),i&&(i.uid!==o||i.removed||(i.removed=!0,VB(i)),i=null),n=s=null}))}));return n}(e,t,r)},qB.watchTracked=function(e,t,r=!1,n=oB.equalsShallow){return r?function(e,t,r){let n=!1;return kB.reaction(e,((e,i)=>{n||(n=!0,r(i,e)||t(e,i),n=!1)}))}(e,t,n):function(e,t,r){var n,i,o=kB.reactionDeferred(e,((e,s)=>{n&&n.uid!==i?o.remove():(n||(n=HB.acquireTracked(e,t,s,r),i=n.uid),VB(n))}));return zw.makeHandle((()=>{o.remove(),n&&(n.uid!==i||n.removed||(n.removed=!0,VB(n)),n=null),o=null}))}(e,t,n)},tO.after=function(e,t,r){const n=new AbortController;return sO(r,(()=>n.abort())),new Promise(((r,i)=>{let o=setTimeout((()=>{o=0,r(t)}),e);sO(n,(()=>{o&&(clearTimeout(o),i(rO()))}))}))},tO.allSettledErrors=async function(e){return(await Promise.allSettled(e)).filter((e=>"rejected"===e.status)).map((e=>e.reason))},tO.allSettledValues=async function(e){return(await Promise.allSettled(e)).filter((e=>"fulfilled"===e.status)).map((e=>e.value))},tO.always=function(e,t){return e.then(t,t)},tO.createAbortError=rO,tO.eachAlways=uO,tO.eachAlwaysValues=async function(e){return(await uO(e)).filter((e=>!!e.value)).map((e=>e.value))},tO.filter=async function(e,t){const r=e.slice(),n=await Promise.all(e.map(((e,r)=>t(e,r))));return r.filter(((e,t)=>n[t]))},tO.ignoreAbortErrors=async function(e){try{return await e}catch(e){if(!aO(e))throw e}},tO.isAbortError=aO,tO.isAborted=oO,tO.isPromiseLike=cO,tO.onAbort=sO,tO.settleWithPromise=function(e,t){t.then(e.resolve,e.reject)},tO.throwIfAbortError=function(e){if(aO(e))throw e},tO.throwIfAborted=nO,tO.throwIfNotAbortError=function(e){if(!aO(e))throw e},tO.waitTick=async function(e){await Promise.resolve(),nO(e)},tO.when=function(e){return cO(e)?e:Promise.resolve(e)},tO.whenOrAbort=function(e,t){return null==iO(t)?e:new Promise(((r,n)=>{let i=sO(t,(()=>n(rO())));const o=()=>{i=Qw.removeMaybe(i)};e.then(o,o),e.then(r,n)}))},lO.autorun=kB.autorun,lO.initial={initial:!0},lO.pausable=function(e,t,r={}){let n=!1;const i=lO.watch(e,((e,r)=>{n||t(e,r)}),r);return{remove(){i.remove()},pause(){n=!0},resume(){n=!1}}},lO.sync={sync:!0},lO.syncAndInitial={sync:!0,initial:!0},lO.watch=function(e,t,r={}){return hO(e,t,r,fO)},lO.when=function(e,t,r={}){return hO(e,t,r,dO)},lO.once=function(e,t){return pO(e,null,t)},lO.whenOnce=function(e,t){return pO(e,dO,t)},AO.prototype.remove=function(){Sw.remove(this._observers,this._observer)},gO.prototype.observe=function(e){if(this.destroyed||e.destroyed)return _O;null==this._observers&&(this._observers=[]);const t=this._observers;let r=!1,n=!1;const i=t.length;for(let o=0;o<i;++o){const i=t[o];if(i.destroyed)n=!0;else if(i===e){r=!0;break}}return r||(t.push(e),n&&this._removeDestroyedObservers()),new AO(t,e)},gO.prototype._removeDestroyedObservers=function(){const e=this._observers;if(e&&0!==e.length){var t=e.length,r=0;for(let n=0;n<t;++n){for(;n+r<t&&e[n+r].destroyed;)++r;if(0<r){if(!(n+r<t))break;e[n]=e[n+r]}}e.length=t-r}},gO.prototype.destroy=function(){if(!this.destroyed){this.destroyed=!0;var e=this._observers;if(null!=e){for(const t of e)t.onCommitted();this._observers=null}}};const _O=zw.makeHandle();function mO(){gO.call(this)}function yO(e,t){this._observable=new mO,this._value=e,this._equalityFunction=t}function EO(e,t,r,n,i){this.resolve=e,this.reject=t,this.callback=r,this.signal=n,this.abortCallback=i}function xO(){this._tasks=[],this._running=yO.signal(!1)}mO.prototype=Object.create(gO.prototype),mO.prototype.constructor=gO,mO.prototype.notify=function(){var e=this._observers;if(e&&0<e.length){e=e.slice();for(const t of e)t.onInvalidated(),t.onCommitted()}},Object.defineProperties(yO.prototype,{value:{get:function(){return OB.trackAccess(this._observable),this._value},set:function(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}}}),yO.prototype.mutate=function(e){e(this._value),this._observable.notify()},yO.signal=function(e,t=oB.equalsShallow){return new yO(e,t)},Object.defineProperties(xO.prototype,{length:{get:function(){return this._tasks.length}},running:{get:function(){return this._running.value}}}),xO.prototype.destroy=function(){this.cancelAll()},xO.prototype.runTask=function(e){for(;!e.done&&this._process(e);)e.madeProgress()},xO.prototype.push=function(e,t,r){return this._running.value=!0,new Promise(((n,i)=>this._tasks.push(new EO(n,i,e,t,r))))},xO.prototype.unshift=function(e,t,r){return this._running.value=!0,new Promise(((n,i)=>this._tasks.unshift(new EO(n,i,e,t,r))))},xO.prototype._process=function(e){if(0===this._tasks.length)return!1;const t=this._tasks.shift();try{const r=c.isAborted(t.signal);if(r&&!t.abortCallback)t.reject(c.createAbortError());else{const n=r?t.abortCallback&&t.abortCallback(c.createAbortError()):t.callback(e);c.isPromiseLike(n)?n.then(t.resolve,t.reject):t.resolve(n)}}catch(e){t.reject(e)}return this._running.value=0<this._tasks.length,!0},xO.prototype.cancelAll=function(){const e=c.createAbortError();for(const t of this._tasks)if(t.abortCallback){const r=t.abortCallback(e);t.resolve(r)}else t.reject(e);this._tasks.length=0,this._running.value=!1};const CO="YIELD",bO="INTERACTING",IO="IDLE";function vO(e){return BO.has(e)?BO.get(e):"number"==typeof e?e:1}const TO={TESTA:"immediate",TESTB:"schedule",TESTC:"slide",SHADOW_ACCUMULATOR:"shadow accumulator",GRAPHICS_DECONFLICTOR:"graphics deconflictor",LABELER:"LABELER",GET_ELEVATION:"GET_ELEVATION"},RO="s",SO="r",MO="w",wO="i",BO=new Map([[TO.RESOURCE_CONTROLLER_IMMEDIATE,0],[TO.RESOURCE_CONTROLLER,4],[TO.GRAPHICS_DECONFLICTOR,4],[TO.LABELER,8],[TO.GET_ELEVATION,9],[TO.SLIDE,0],[TO.SHADOW_ACCUMULATOR,30]]);function OO(e){this._updating=yO.signal(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new Uw("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new DO,this._state=bO,this._tasks=new Lw,this._runQueue=new Lw,this._load=0,this._idleStateCallbacks=new Lw,this._debug=!1,this._forceTask=!1,this._idleUpdatesStartFired=!1,this._cameraChangeTime=0;for(const e of Object.keys(TO))this.performanceInfo.tasks.set(TO[e],new Uw(TO[e]));const t=this;e.camera.changed.addEventListener((()=>{t._cameraChangeTime=performance.now()}))}Object.defineProperties(OO.prototype,{updating:{get:function(){return this._updating.value}},load:{get:function(){return this._load}},state:{get:function(){return this._state},set:function(e){this._state!==e&&(this._state=e,this.state!==IO&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}},test:{get:function(){return this._test}}}),OO.prototype._updatingChanged=function(){this._updating.value=this._tasks.some((e=>e.needsUpdate))},OO.prototype.destroy=function(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),this._microTaskQueued=!1,this._updatingChanged()},OO.prototype.taskRunningChanged=function(e){this._updatingChanged(),e&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())})))},OO.prototype.registerTask=function(e,t){return t=new FO(this,e,t,vO(e)),this._tasks.push(t),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(H,new Uw(e)),t},OO.prototype.registerIdleStateCallbacks=function(e,t){const r={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(r),this.state===IO&&this._idleUpdatesStartFired&&r.idleBegin();const n=this;return{remove:()=>this._removeIdleStateCallbacks(r),set idleBegin(e){n._idleUpdatesStartFired&&(r.idleEnd(),n._state===IO&&e()),r.idleBegin=e},set idleEnd(e){r.idleEnd=e}}};function DO(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=IO,this._progressed=this._done=!1,this._enabled=!0}function FO(e,t,r,n){this._scheduler=e,this.name=t,this._basePriority=n,this.runtime=this.blockFrame=0,this._queue=new xO,this._handles=new kw,this.schedulePriority=this._basePriority,this._task=yO.signal(null!=r?r:this._queue),this._handles.add(lO.when((()=>{this.task.running}),(t=>e.taskRunningChanged(t))))}function PO(e){Un.defined("scene",e.scene),Un.defined("globe",e.globe),this._scene=e.scene,this._globe=e.globe,this._running=!0,this._frameTask=this._scene._frameScheduler.registerTask(TO.GET_ELEVATION,this),this._requestManager=new QO}OO.prototype.updateBudget=function(e){++this._frameNumber;let t=6.5,r=e.frameDuration,n=1;switch(this.state){case IO:t=0,r=Math.max(60,e.frameDuration),n=15;break;case bO:r=Math.max(5,e.frameDuration)}return r=r-e.elapsedFrameTime-t,this.state!==IO&&r<1&&!this._forceTask?(this._forceTask=!0,!1):(r=Math.max(r,n),this._budget.reset(r,this.state),this._updateLoad(),this._schedule())},OO.prototype.frame=function(){switch(300>=performance.now()-this._cameraChangeTime?this._state=bO:this._state=IO,this._microTaskQueued=this._forceTask=!1,this.state){case IO:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case bO:this._runInteracting();break;default:this._runAnimating()}},OO.prototype.stopFrame=function(){this._budget.reset(0,this._state),this._budget.madeProgress()},OO.prototype._removeIdleStateCallbacks=function(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)},OO.prototype.removeTask=function(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()},OO.prototype._updateTask=function(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))},OO.prototype._getState=function(e){if(this._runQueue.some((t=>t.name===e)))return RO;let t=wO;return this._tasks.forAll((r=>{r.name===e&&r.needsUpdate&&(1>=r.schedulePriority?t=SO:t!==SO&&(t=MO))})),t},OO.prototype._getRuntime=function(e){let t=0;return this._tasks.forAll((r=>{r.name===e&&(t+=r.runtime)})),t},OO.prototype._resetRuntimes=function(){this._tasks.forAll((e=>e.runtime=0))},OO.prototype._getRunning=function(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,r)=>{t=1<e?t+` ${e}x ${r}`:t+` ${r}`})),t},OO.prototype._runIdle=function(){this._run()},OO.prototype._runInteracting=function(){this._run()},OO.prototype._runAnimating=function(){this._run()},OO.prototype._updateLoad=function(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)},OO.prototype._schedule=function(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1;if(this._tasks.forAll((t=>{if(t.needsUpdate&&0!==t.schedulePriority&&0!==t.basePriority&&t.blockFrame!==this._frameNumber)if(e=!0,1===t.schedulePriority)t.schedulePriority=0,this._runQueue.push(t);else--t.schedulePriority})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0},OO.prototype._run=function(){const e=this._budget.now();this._startFrameTaskTimes();do{for(;0<this._runQueue.length;){var t=this._budget.now();const n=this._runQueue.pop();this._budget.resetProgress();try{n.task.runTask(this._budget)===CO&&(n.blockFrame=this._frameNumber)}catch(e){console.log(`Exception in task "${n.name}"`+e)}!this._budget.hasProgressed&&n.blockFrame!==this._frameNumber&&n.needsUpdate&&(n.blockFrame=this._frameNumber),n.schedulePriority=n.basePriority;var r=this._budget.now()-t;if(n.runtime+=r,this._frameTaskTimes.set(n.priority,this._frameTaskTimes.get(n.priority)+r),this._debug&&r>2*this._budget.budget&&console.log("Task",n.name,"used",r,"of max",this._budget.budget,"ms"),0>=this._budget.remaining)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-e)},OO.prototype._startFrameTaskTimes=function(){for(const e of Object.keys(TO))this._frameTaskTimes.set(TO[e],0)},OO.prototype._recordFrameTaskTimes=function(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).record(e))),this.performanceInfo.total.record(e)},Object.defineProperties(DO.prototype,{done:{get:function(){return this._done}},budget:{get:function(){return this._budget}},state:{get:function(){return this._state}},enabled:{get:function(){return this._enabled}},remaining:{get:function(){return Math.max(this._budget-this.elapsed,0)}},elapsed:{get:function(){return performance.now()-this._begin}},hasProgressed:{get:function(){return this._progressed}}}),DO.prototype.run=function(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)},DO.prototype.madeProgress=function(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled},DO.prototype.reset=function(e,t){this._begin=this.now(),this._budget=e,this._state=t,this.resetProgress()},DO.prototype.now=function(){return performance.now()},DO.prototype.resetProgress=function(){this._done=this._progressed=!1},Object.defineProperties(FO.prototype,{task:{get:function(){return this._task.value}},updating:{get:function(){return this._queue.running}},basePriority:{get:function(){return this._basePriority}},priority:{get:function(){return this.name},set:function(e){this.setPriority(e)}},needsUpdate:{get:function(){return this.updating||this.task.running}}}),FO.prototype.remove=function(){this.processQueue(C),this._scheduler.removeTask(this),this.schedule=D.schedule,this.reschedule=D.reschedule,this._handles.destroy()},FO.prototype.setPriority=function(e){this.name=e;let t=vO(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t},FO.prototype.schedule=function(e,t,r){return this._queue.push(e,t,r)},FO.prototype.reschedule=function(e,t,r){return this._queue.unshift(e,t,r)},FO.prototype.processQueue=function(e){this._queue.runTask(e)},Object.defineProperties(PO.prototype,{clampEnabled:{get:function(){return!!this._scene._hasLayerCoveredMap||this._globe.terrainProvider!==this._globe._defaultTerrainProvider}},clampTerrainEnabled:{get:function(){return!this._scene._hasLayerCoveredMap&&this._globe.terrainProvider!==this._globe._defaultTerrainProvider}},clampModelEnabled:{get:function(){return this._scene._hasLayerCoveredMap}},running:{get:function(){return this._running}}});var NO=new xl,LO=new ni;function UO(e,t,r){if(!t.visible||null==t.coveredMap)return 0;var n=e._scene,i=e._globe._ellipsoid;r.height=9e3,ni.toCartesian(r,Os.WGS84,NO.origin),i.geodeticSurfaceNormal(NO.origin,NO.direction),qn.negate(NO.direction,NO.direction);let o=t.intersect(NO,n);return Nn(o)?(ni.fromCartesian(o,Os.WGS84,LO),LO.height):void 0}function GO(e){this._set=new Set,this.carto=ni.clone(e)}function QO(){this._map=new Map}function kO(e){this.owner=e.owner,this.callbackParameter=e.callbackParameter,this.requesCarto=e.requesCarto,this.key=this._getRequesKey()}PO.prototype.getElevation=function(e){let t=this._globe.getHeight(e);if(void 0===t&&(t=0),this.clampModelEnabled){var r=t;let n=this._scene.layers.layerQueue;for(let i of n)t=UO(this,i,e),Nn(t)&&r<t&&(r=t);return r}return t},PO.prototype.cancelRequestor=function(e){this._requestManager.remove(e)},PO.prototype.requestElevation=function(e){this._requestManager.add(e)},PO.prototype._resetIterator=function(){this._iterators=null},PO.prototype.runTask=function(e){for(this._iterators||(this._iterators=function*(e){var t=e.iterableIterator();for(let e=t.next();!e.done;e=t.next())yield e.value[1]}(this._requestManager));!e.done;){e.madeProgress();let t=this._iterators.next();if(!0===t.done)return this._resetIterator(),this._requestManager.clear(),CO;let r=t.value;if(r.size>0){let e=this.getElevation(r.carto);r.updateElevation(e),r.clear()}}return CO},Object.defineProperties(GO.prototype,{size:{get:function(){return this._set.size}}}),GO.prototype.add=function(e){this._set.add(e)},GO.prototype.remove=function(e){this._set.delete(e)},GO.prototype.updateElevation=function(e){for(let t of this._set)t.updateElevation(e)},GO.prototype.clear=function(){this._set.clear()},QO.prototype.iterableIterator=function(){return this._map.entries()},QO.prototype.add=function(e){let t=e.key,r=null;this._map.has(t)?r=this._map.get(t):(r=new GO(e.requesCarto),this._map.set(t,r)),r.add(e)},QO.prototype.remove=function(e){let t=e.key,r=this._map.get(t);r&&r.remove(e)},QO.prototype.clear=function(){this._map.clear()},kO.prototype._getRequesKey=function(){return this.requesCarto.longitude+"_"+this.requesCarto.latitude},kO.prototype.updateElevation=function(e){this.owner&&this.owner.updateElevationRequestor(e,this.callbackParameter)};const zO=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),jO=zO(void 0,(function(){return jO.toString().search("(((.+)+)+)+$").toString().constructor(jO).search("(((.+)+)+)+$")}));jO();let HO=new ni,qO=new ni,VO=new qn,YO=new x_;var XO=["Unknown","Point","LineString","Polygon"];const WO=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0,strideInBytes:1}],KO=[{name:"a_fade_opacity",components:1,type:"Uint32",offset:0,strideInBytes:4}];function $O(e,t,r,n,i,o,s,a,u,c,l,h,p){const f=a?Math.min(yT,Math.round(a[0])):0,d=a?Math.min(yT,Math.round(a[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),o,s,(f<<1)+(u?1:0),d,16*c,16*l,256*h,256*p)}function JO(e){for(const t of e.sections)if(bI(t.text))return!0;return!1}class ZO{constructor(e){this.layoutVertexArray=new Pf,this.indexArray=new Hf,this.programConfigurations=e,this.segments=new l_,this.dynamicLayoutVertexArray=new Jf,this.opacityVertexArray=new Uf,this.placedSymbolArray=new ad,this.alongLine=!0}createLngLatQuadsArray(){this.lngLatQuadsArray=new gd,this.alongLine=!1,this.heightDirty=!0}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,n){this.isEmpty()||((r||!this.alongLine&&this.heightDirty)&&(void 0===this.dynamicLayoutVertexBuffer?this.dynamicLayoutVertexBuffer=lg.toVertexBuffer(e,this.dynamicLayoutVertexArray,$C.members,!0):lg.copyFromArrayView(this.dynamicLayoutVertexBuffer,this.dynamicLayoutVertexArray.arrayBuffer,0),!this.alongLine&&(this.heightDirty=!1)),r&&(this.layoutVertexBuffer=lg.toVertexBuffer(e,this.layoutVertexArray,KC.members),this.indexBuffer=lg.toIndexBuffer(e,this.indexArray,t),this.opacityVertexBuffer=lg.toVertexBuffer(e,this.opacityVertexArray,e.webgpu?KO:WO,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}updateElevationRequestor(e,t){let r=this.lngLatQuadsArray.get(t.lngLatQuadsIndex),n=r.lng,i=r.lat,o=r.quads;ni.fromRadians(n,i,0,HO),HO.height=e,ni.toCartesian(HO,void 0,VO);let s=this._crs;(s.sceneMode==_c.COLUMBUS_VIEW||s.sceneMode==_c.SCENE2D)&&(VO=Ou.convertToColumbusCartesian(VO)),x_.fromCartesian(VO,YO),r.height=HO.height;let a=this.dynamicLayoutVertexArray.bytesPerElement/4,u=4*a,c=t.quadIndex,l=this.dynamicLayoutVertexArray.float32;for(let e=0;e<o;e++){for(let e=0;e<4;e++){let t=c*u+e*a;l[t+4]=YO.high.x,l[t+5]=YO.high.y,l[t+6]=YO.high.z,l[t+7]=YO.low.x,l[t+8]=YO.low.y,l[t+9]=YO.low.z}c++}this.heightDirty=!0}correctHeight(e,t){if(this._elevationProvider=e,this._crs=t,!this.alongLine){this.createElevationRequestors();for(let t=0;t<this.elevationRequestorArray.length;t++){let r=this.elevationRequestorArray[t];e.requestElevation(r)}}}createElevationRequestors(){if(this.elevationRequestorArray)return;this.elevationRequestorArray=[];let e=0;for(let t=0;t<this.lngLatQuadsArray.length;t++){let r=this.lngLatQuadsArray.get(t),n=r.lng,i=r.lat,o=ni.fromRadians(n,i,0),s=r.quads;this.elevationRequestorArray.push(new kO({owner:this,callbackParameter:{quadIndex:e,lngLatQuadsIndex:t},requesCarto:o})),e+=s}}destroy(){if(this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.lngLatQuadsArray&&this.lngLatQuadsArray.destroy(),this.elevationRequestorArray)){for(let e=0;e<this.elevationRequestorArray.length;e++){let t=this.elevationRequestorArray[e];this._elevationProvider.cancelRequestor(t)}this.elevationRequestorArray=[]}}}Sp(ZO,"SymbolBuffers");class eD{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new l_,this.collisionVertexArray=new zf,this.collisionVertexArrayExt=new jf}upload(e){this.layoutVertexBuffer=lg.toVertexBuffer(e,this.layoutVertexArray,this.layoutAttributes.members),this.indexBuffer=lg.toIndexBuffer(e,this.indexArray),this.collisionVertexBuffer=lg.toVertexBuffer(e,this.collisionVertexArray,JC.members,!0),this.collisionVertexBufferExt=lg.toVertexBuffer(e,this.collisionVertexArrayExt,ZC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Sp(eD,"CollisionBuffers");class tD{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.webgpu=e.webgpu,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=J_.mat4.identity([]),this.placementViewportMatrix=J_.mat4.identity([]);const t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ub(this.zoom,t["text-size"]),this.iconSizeData=ub(this.zoom,t["icon-size"]);const r=this.layers[0].layout,n=r.get("symbol-sort-key"),i=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==i&&void 0!==n.constantOr(1);const o="viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&this.canOverlap,this.writingModes=r.get("text-writing-mode").map((e=>hv[e])),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){var e=KC.members;this.text=new ZO(new Rg(e,this.layers,this.zoom,(e=>/^text/.test(e))),this.webgpu),this.icon=new ZO(new Rg(e,this.layers,this.zoom,(e=>/^icon/.test(e))),this.webgpu),this.glyphOffsetArray=new ld,this.lineVertexArray=new hd,this.symbolInstances=new cd}calculateGlyphDependencies(e,t,r,n,i){for(let r=0;r<e.length;r++)if(t[e.charCodeAt(r)]=!0,n&&i){const n=TI[e.charAt(r)];n&&(t[n.charCodeAt(0)]=!0)}}populate(e,t,r,n){const i=this.layers[0],o=i.layout,s=o.get("text-font"),a=o.get("text-field"),u=o.get("icon-image"),c=("constant"!==a.value.kind||a.value.value instanceof Z&&!a.value.value.isEmpty()||a.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),l="constant"!==u.value.kind||!!u.value.value||Object.keys(u.parameters).length>0,h=o.get("symbol-sort-key");if(this.features=[],!c&&!l)return;const p=t.iconDependencies,f=t.glyphDependencies,d=t.availableImages,A=new $p(this.zoom);for(const{feature:t,id:n,index:a,sourceLayerIndex:u}of e){const e=i._featureFilter.needGeometry,g=E_(t,e);if(!i._featureFilter.filter(A,g,r))continue;let _,m;if(e||(g.geometry=g_(t)),c){const e=i.getValueAndResolveTokens("text-field",g,r,d),t=Z.factory(e);JO(t)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===DI||this.hasRTLText&&PI.isParsed())&&(_=db(t,i,g))}if(l){const e=i.getValueAndResolveTokens("icon-image",g,r,d);m=e instanceof ne?e:ne.fromString(e)}if(!_&&!m)continue;const y=this.sortFeaturesByKey?h.evaluate(g,{},r):void 0,E={id:n,text:_,icon:m,index:a,sourceLayerIndex:u,geometry:g.geometry,properties:t.properties,type:XO[t.type],sortKey:y};if(this.features.push(E),m&&(p[m.name]=!0),_){const e=s.evaluate(g,{},r).join(","),t="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(hv.vertical)>=0;for(const r of _.sections)if(r.image)p[r.image.name]=!0;else{const n=gI(_.toString()),i=r.fontStack||e,o=f[i]=f[i]||{};this.calculateGlyphDependencies(r.text,o,t,this.allowVerticalPlacement,n)}}}("line"===o.get("symbol-placement")||"line-direction"===o.get("symbol-placement"))&&(this.features=function(e){var t={},r={},n=[],i=0;function o(t){n.push(e[t]),i++}function s(e,t,i){var o=r[e];return delete r[e],r[t]=o,n[o].geometry[0].pop(),n[o].geometry[0]=n[o].geometry[0].concat(i[0]),o}function a(e,r,i){var o=t[r];return delete t[r],t[e]=o,n[o].geometry[0].shift(),n[o].geometry[0]=i[0].concat(n[o].geometry[0]),o}function u(e,t,r){var n=r?t[0][t[0].length-1]:t[0][0];return e+":"+n.x+":"+n.y}for(var c=0;c<e.length;c++){var l=e[c],h=l.geometry,p=l.text?l.text.toString():null;if(p){var f=u(p,h),d=u(p,h,!0);if(f in r&&d in t&&r[f]!==t[d]){var A=a(f,d,h),g=s(f,d,n[A].geometry);delete t[f],delete r[d],r[u(p,n[g].geometry,!0)]=g,n[A].geometry=null}else f in r?s(f,d,h):d in t?a(f,d,h):(o(c),t[f]=i-1,r[d]=i-1)}else o(c)}return n.filter((function(e){return e.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload||this.text.heightDirty||this.icon.heightDirty}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return!this.projectionInstance&&(this.projectionInstance=bw(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const r=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:e,y:r}of t)this.lineVertexArray.emplaceBack(e,r);return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A){const g=e.indexArray,_=e.layoutVertexArray,m=e.segments.prepareSegment(4*t.length,_,g,this.canOverlap?o.sortKey:void 0),y=this.glyphOffsetArray.length,E=m.vertexLength,x=this.allowVerticalPlacement&&s===hv.vertical?Math.PI/2:0,C=o.text&&o.text.sections;if(!i){let r=function(e,t,r){if(e.sceneMode===_c.COLUMBUS_VIEW||e.sceneMode===_c.SCENE2D){let e=Ou.convertTo3DCartesian(t);return ni.fromCartesian(e,void 0,r)}return ni.fromCartesian(t,void 0,r)}(A,c,qO);e.lngLatQuadsArray.emplaceBack(r.longitude,r.latitude,0,t.length)}for(let n=0;n<t.length;n++){const{tl:i,tr:s,bl:a,br:l,tex:h,pixelOffsetTL:p,pixelOffsetBR:A,minFontScaleX:y,minFontScaleY:E,glyphOffset:b,isSDF:I,sectionIndex:v}=t[n],T=m.vertexLength,R=b[1];$O(_,u.x,u.y,i.x,R+i.y,h.x,h.y,r,I,p.x,p.y,y,E),$O(_,u.x,u.y,s.x,R+s.y,h.x+h.w,h.y,r,I,A.x,p.y,y,E),$O(_,u.x,u.y,a.x,R+a.y,h.x,h.y+h.h,r,I,p.x,A.y,y,E),$O(_,u.x,u.y,l.x,R+l.y,h.x+h.w,h.y+h.h,r,I,A.x,A.y,y,E);const S=x_.fromCartesian(c);tD.addDynamicAttributes(e.dynamicLayoutVertexArray,u.x,u.y,u.z,x,S.high.x,S.high.y,S.high.z,S.low.x,S.low.y,S.low.z),g.emplaceBack(T,T+1,T+2),g.emplaceBack(T+1,T+2,T+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),(n===t.length-1||v!==t[n+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(_.length,o,o.index,{},f,d,C&&C[v])}const b=u;e.placedSymbolArray.emplaceBack(b.x,b.y,b.z,u.x,u.y,y,this.glyphOffsetArray.length-y,E,l,h,u.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],s,0,!1,0,p,0)}_commitLayoutVertex(e,t,r,n,i,o,s){e.emplaceBack(t,r,n,i,o,Math.round(s.x),Math.round(s.y))}_addCollisionDebugVertices(e,t,r,n,i,o,s){const a=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),u=a.vertexLength,c=s.tileAnchorX,l=s.tileAnchorY;for(let e=0;e<4;e++)r.collisionVertexArray.emplaceBack(0,0,0,0);r.collisionVertexArrayExt.emplaceBack(t,-e.padding,-e.padding),r.collisionVertexArrayExt.emplaceBack(t,e.padding,-e.padding),r.collisionVertexArrayExt.emplaceBack(t,e.padding,e.padding),r.collisionVertexArrayExt.emplaceBack(t,-e.padding,e.padding),this._commitLayoutVertex(r.layoutVertexArray,n,i,o,c,l,new Pn(e.x1,e.y1)),this._commitLayoutVertex(r.layoutVertexArray,n,i,o,c,l,new Pn(e.x2,e.y1)),this._commitLayoutVertex(r.layoutVertexArray,n,i,o,c,l,new Pn(e.x2,e.y2)),this._commitLayoutVertex(r.layoutVertexArray,n,i,o,c,l,new Pn(e.x1,e.y2)),a.vertexLength+=4;const h=r.indexArray;h.emplaceBack(u,u+1),h.emplaceBack(u+1,u+2),h.emplaceBack(u+2,u+3),h.emplaceBack(u+3,u),a.primitiveLength+=4}_addTextDebugCollisionBoxes(e,t,r,n,i,o){for(let s=n;s<i;s++){const n=r.get(s),i=this.getSymbolInstanceTextSize(e,o,t,s);this._addCollisionDebugVertices(n,i,this.textCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,o)}}_addIconDebugCollisionBoxes(e,t,r,n,i,o){for(let s=n;s<i;s++){const n=r.get(s),i=this.getSymbolInstanceIconSize(e,t,o.placedIconSymbolIndex);this._addCollisionDebugVertices(n,i,this.iconCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,o)}}generateCollisionDebugBuffers(e,t){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new eD(Qf,eb.members,ed),this.iconCollisionBox=new eD(Qf,eb.members,ed);const r=lb(this.iconSizeData,e),n=lb(this.textSizeData,e);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this._addTextDebugCollisionBoxes(n,e,t,o.textBoxStartIndex,o.textBoxEndIndex,o),this._addTextDebugCollisionBoxes(n,e,t,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._addIconDebugCollisionBoxes(r,e,t,o.iconBoxStartIndex,o.iconBoxEndIndex,o),this._addIconDebugCollisionBoxes(r,e,t,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o)}}getSymbolInstanceText(e){let t=this.symbolInstances.get(e);return t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:e}getSymbolInstanceTextSize(e,t,r,n){const i=t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:n,o=this.text.placedSymbolArray.get(i),s=cb(this.textSizeData,e,o)/ib;return this.tilePixelRatio*s}getSymbolInstanceIconSize(e,t,r){const n=this.icon.placedSymbolArray.get(r),i=cb(this.iconSizeData,e,n);return this.tilePixelRatio*i}_commitDebugCollisionVertexUpdate(e,t,r){e.emplaceBack(t,-r,-r),e.emplaceBack(t,r,-r),e.emplaceBack(t,r,r),e.emplaceBack(t,-r,r)}_updateTextDebugCollisionBoxes(e,t,r,n,i,o){for(let s=n;s<i;s++){const n=r.get(s),i=this.getSymbolInstanceTextSize(e,o,t,s),a=this.textCollisionBox.collisionVertexArrayExt;this._commitDebugCollisionVertexUpdate(a,i,n.padding)}}_updateIconDebugCollisionBoxes(e,t,r,n,i,o){for(let s=n;s<i;s++){const n=r.get(s),i=this.getSymbolInstanceIconSize(e,t,o),a=this.iconCollisionBox.collisionVertexArrayExt;this._commitDebugCollisionVertexUpdate(a,i,n.padding)}}updateCollisionDebugBuffers(e,t){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const r=lb(this.iconSizeData,e),n=lb(this.textSizeData,e);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this._updateTextDebugCollisionBoxes(n,e,t,o.textBoxStartIndex,o.textBoxEndIndex,o),this._updateTextDebugCollisionBoxes(n,e,t,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._updateIconDebugCollisionBoxes(r,e,t,o.iconBoxStartIndex,o.iconBoxEndIndex,o.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(r,e,t,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.copyFromArrayView(this.textCollisionBox.collisionVertexArrayExt.arrayBuffer),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.copyFromArrayView(this.iconCollisionBox.collisionVertexArrayExt.arrayBuffer)}_deserializeCollisionBoxesForSymbol(e,t,r,n,i,o,s,a,u){const c={};if(t<r){const{x1:r,y1:n,x2:i,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:p,featureIndex:f,ecefX:d,ecefY:A,ecefZ:g}=e.get(t);c.textBox={x1:r,y1:n,x2:i,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:p,ecefX:d,ecefY:A,ecefZ:g},c.textFeatureIndex=f}if(n<i){const{x1:t,y1:r,x2:i,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:p,featureIndex:f,ecefX:d,ecefY:A,ecefZ:g}=e.get(n);c.verticalTextBox={x1:t,y1:r,x2:i,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:p,ecefX:d,ecefY:A,ecefZ:g},c.verticalTextFeatureIndex=f}if(o<s){const{x1:t,y1:r,x2:n,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:p,featureIndex:f,ecefX:d,ecefY:A,ecefZ:g}=e.get(o);c.iconBox={x1:t,y1:r,x2:n,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:p,ecefX:d,ecefY:A,ecefZ:g},c.iconFeatureIndex=f}if(a<u){const{x1:t,y1:r,x2:n,y2:i,padding:o,projectedAnchorX:s,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:p,featureIndex:f,ecefX:d,ecefY:A,ecefZ:g}=e.get(a);c.verticalIconBox={x1:t,y1:r,x2:n,y2:i,padding:o,projectedAnchorX:s,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:p,ecefX:d,ecefY:A,ecefZ:g},c.verticalIconFeatureIndex=f}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs;for(let t=r.vertexStartIndex;t<n;t+=4)e.indexArray.emplaceBack(t,t+1,t+2),e.indexArray.emplaceBack(t+1,t+2,t+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),r=Math.cos(e),n=[],i=[],o=[];for(let e=0;e<this.symbolInstances.length;++e){o.push(e);const s=this.symbolInstances.get(e);n.push(0|Math.round(t*s.tileAnchorX+r*s.tileAnchorY)),i.push(s.featureIndex)}return o.sort(((e,t)=>n[e]-n[t]||i[t]-i[e])),o}addToSortKeyRanges(e,t){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex);const{rightJustifiedTextSymbolIndex:r,centerJustifiedTextSymbolIndex:n,leftJustifiedTextSymbolIndex:i,verticalPlacedTextSymbolIndex:o,placedIconSymbolIndex:s,verticalPlacedIconSymbolIndex:a}=t;r>=0&&this.addIndicesForPlacedSymbol(this.text,r),n>=0&&n!==r&&this.addIndicesForPlacedSymbol(this.text,n),i>=0&&i!==n&&i!==r&&this.addIndicesForPlacedSymbol(this.text,i),o>=0&&this.addIndicesForPlacedSymbol(this.text,o),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a)}this.text.indexBuffer&&this.text.indexBuffer.copyFromArrayView(this.text.indexArray.arrayBuffer),this.icon.indexBuffer&&this.icon.indexBuffer.copyFromArrayView(this.icon.indexArray.arrayBuffer)}}static addDynamicAttributes(e,t,r,n,i,o,s,a,u,c,l){e.emplaceBack(t,r,n,i,o,s,a,u,c,l),e.emplaceBack(t,r,n,i,o,s,a,u,c,l),e.emplaceBack(t,r,n,i,o,s,a,u,c,l),e.emplaceBack(t,r,n,i,o,s,a,u,c,l)}}Sp(tD,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]});var rD,nD=(rD=!0,function(e,t){var r=rD?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return rD=!1,r}),iD=nD(void 0,(function(){return iD.toString().search("(((.+)+)+)+$").toString().constructor(iD).search("(((.+)+)+)+$")}));iD();const oD=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),sD=oD(void 0,(function(){return sD.toString().search("(((.+)+)+)+$").toString().constructor(sD).search("(((.+)+)+)+$")}));sD();const aD=new pf({"symbol-placement":new cf(Ug.layout_symbol["symbol-placement"]),"symbol-spacing":new cf(Ug.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new cf(Ug.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new lf(Ug.layout_symbol["symbol-sort-key"]),"symbol-z-order":new cf(Ug.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new cf(Ug.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new cf(Ug.layout_symbol["icon-ignore-placement"]),"icon-optional":new cf(Ug.layout_symbol["icon-optional"]),"icon-rotation-alignment":new cf(Ug.layout_symbol["icon-rotation-alignment"]),"icon-size":new lf(Ug.layout_symbol["icon-size"]),"icon-text-fit":new cf(Ug.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new cf(Ug.layout_symbol["icon-text-fit-padding"]),"icon-image":new lf(Ug.layout_symbol["icon-image"]),"icon-rotate":new lf(Ug.layout_symbol["icon-rotate"]),"icon-padding":new cf(Ug.layout_symbol["icon-padding"]),"icon-keep-upright":new cf(Ug.layout_symbol["icon-keep-upright"]),"icon-offset":new lf(Ug.layout_symbol["icon-offset"]),"icon-anchor":new lf(Ug.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new cf(Ug.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new cf(Ug.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new cf(Ug.layout_symbol["text-rotation-alignment"]),"text-field":new lf(Ug.layout_symbol["text-field"]),"text-font":new lf(Ug.layout_symbol["text-font"]),"text-size":new lf(Ug.layout_symbol["text-size"]),"text-max-width":new lf(Ug.layout_symbol["text-max-width"]),"text-line-height":new lf(Ug.layout_symbol["text-line-height"]),"text-letter-spacing":new lf(Ug.layout_symbol["text-letter-spacing"]),"text-justify":new lf(Ug.layout_symbol["text-justify"]),"text-radial-offset":new lf(Ug.layout_symbol["text-radial-offset"]),"text-variable-anchor":new cf(Ug.layout_symbol["text-variable-anchor"]),"text-anchor":new lf(Ug.layout_symbol["text-anchor"]),"text-max-angle":new cf(Ug.layout_symbol["text-max-angle"]),"text-writing-mode":new cf(Ug.layout_symbol["text-writing-mode"]),"text-rotate":new lf(Ug.layout_symbol["text-rotate"]),"text-padding":new cf(Ug.layout_symbol["text-padding"]),"text-keep-upright":new cf(Ug.layout_symbol["text-keep-upright"]),"text-transform":new lf(Ug.layout_symbol["text-transform"]),"text-offset":new lf(Ug.layout_symbol["text-offset"]),"text-allow-overlap":new cf(Ug.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new cf(Ug.layout_symbol["text-ignore-placement"]),"text-optional":new cf(Ug.layout_symbol["text-optional"]),"ignore-line-rotation":new cf(Ug.layout_symbol["ignore-line-rotation"])});var uD={paint:new pf({"icon-opacity":new lf(Ug.paint_symbol["icon-opacity"]),"icon-color":new lf(Ug.paint_symbol["icon-color"]),"icon-halo-color":new lf(Ug.paint_symbol["icon-halo-color"]),"icon-halo-width":new lf(Ug.paint_symbol["icon-halo-width"]),"icon-halo-blur":new lf(Ug.paint_symbol["icon-halo-blur"]),"icon-translate":new cf(Ug.paint_symbol["icon-translate"]),"icon-translate-anchor":new cf(Ug.paint_symbol["icon-translate-anchor"]),"text-opacity":new lf(Ug.paint_symbol["text-opacity"]),"text-color":new lf(Ug.paint_symbol["text-color"],{runtimeType:O,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new lf(Ug.paint_symbol["text-halo-color"]),"text-halo-width":new lf(Ug.paint_symbol["text-halo-width"]),"text-halo-blur":new lf(Ug.paint_symbol["text-halo-blur"]),"text-translate":new cf(Ug.paint_symbol["text-translate"]),"text-translate-anchor":new cf(Ug.paint_symbol["text-translate-anchor"])}),layout:aD};const cD=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),lD=cD(void 0,(function(){return lD.toString().search("(((.+)+)+)+$").toString().constructor(lD).search("(((.+)+)+)+$")}));lD();class hD{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:S,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){e(this.defaultValue.value._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}}Sp(hD,"FormatSectionOverride",{omit:["defaultValue"]});const pD=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),fD=pD(void 0,(function(){return fD.toString().search("(((.+)+)+)+$").toString().constructor(fD).search("(((.+)+)+)+$")}));fD();class dD extends n_{constructor(e){super(e,uD)}recalculate(e,t){super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const r=this.layout.get("text-writing-mode");if(r){const e=[];for(const t of r)e.indexOf(t)<0&&e.push(t);this.layout._values["text-writing-mode"]=e}else"point"===this.layout.get("symbol-placement")?this.layout._values["text-writing-mode"]=["horizontal"]:this.layout._values["text-writing-mode"]=["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){const i=this.layout.get(e).evaluate(t,{},r,n),o=this._unevaluatedLayout._values[e];return o.isDataDriven()||vn(o.value)||!i?i:(s=t.properties,i.replace(/{([^{}]+)}/g,((e,t)=>t in s?String(s[t]):"")));var s}createBucket(e){return new tD(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of uD.paint.overridableProperties){if(!dD.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),r=new hD(t),n=new In(r,t.property.specification);let i=null;i="constant"===t.value.kind||"source"===t.value.kind?new Rn("source",n):new Sn("composite",n,t.value.zoomStops,t.value._interpolationType),this.paint._values[e]=new af(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&dD.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const r=e.get("text-field"),n=uD.paint.properties[t];let i=!1;const o=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(i=!0)};if("constant"===r.value.kind&&r.value.value instanceof Z)o(r.value.value.sections);else if("source"===r.value.kind){const e=t=>{if(!i)if(t instanceof pe&&ue(t.value)===L){const e=t.value;o(e.sections)}else t instanceof be?o(t.sections):t.eachChild(e)},t=r.value;t._styleExpression&&e(t._styleExpression.expression)}return i}getProgramConfiguration(e){return new Tg(this,e)}}const AD=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),gD=AD(void 0,(function(){return gD.toString().search("(((.+)+)+)+$").toString().constructor(gD).search("(((.+)+)+)+$")}));gD();var _D={paint:new pf({"background-color":new cf(Ug.paint_background["background-color"]),"background-pattern":new cf(Ug.paint_background["background-pattern"]),"background-opacity":new cf(Ug.paint_background["background-opacity"])})};const mD=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),yD=mD(void 0,(function(){return yD.toString().search("(((.+)+)+)+$").toString().constructor(yD).search("(((.+)+)+)+$")}));yD();const ED=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),xD=ED(void 0,(function(){return xD.toString().search("(((.+)+)+)+$").toString().constructor(xD).search("(((.+)+)+)+$")}));xD();var CD,bD={paint:new pf({"raster-opacity":new cf(Ug.paint_raster["raster-opacity"]),"raster-hue-rotate":new cf(Ug.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new cf(Ug.paint_raster["raster-brightness-min"]),"raster-brightness-max":new cf(Ug.paint_raster["raster-brightness-max"]),"raster-saturation":new cf(Ug.paint_raster["raster-saturation"]),"raster-contrast":new cf(Ug.paint_raster["raster-contrast"]),"raster-resampling":new cf(Ug.paint_raster["raster-resampling"]),"raster-fade-duration":new cf(Ug.paint_raster["raster-fade-duration"])})},ID=(CD=!0,function(e,t){var r=CD?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return CD=!1,r}),vD=ID(void 0,(function(){return vD.toString().search("(((.+)+)+)+$").toString().constructor(vD).search("(((.+)+)+)+$")}));vD();const TD=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),RD=TD(void 0,(function(){return RD.toString().search("(((.+)+)+)+$").toString().constructor(RD).search("(((.+)+)+)+$")}));RD();class SD extends n_{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}const MD=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),wD=MD(void 0,(function(){return wD.toString().search("(((.+)+)+)+$").toString().constructor(wD).search("(((.+)+)+)+$")}));wD();const BD={circle:class extends n_{constructor(e){super(e,W_)}createBucket(e){return new R_(e)}queryRadius(e){const t=e;return k_("circle-radius",this,t)+k_("circle-stroke-width",this,t)+z_(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,n,i,o,s,a){const u=H_(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r);return ax(e,n,o,s,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),u,c)}getProgramIds(){return["circle"]}getProgramConfiguration(e){return new Tg(this,e)}},heatmap:class extends n_{createBucket(e){return new HeatmapBucket(e)}constructor(e){super(e,fx),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){const e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=bx({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return k_("heatmap-radius",this,e)}queryIntersectsFeature(e,t,r,n,i,o,s,a){const u=this.paint.get("heatmap-radius").evaluate(t,r);return ax(e,n,o,s,0,!0,!0,new Pn(0,0),u)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(e){return new Tg(this,e)}},fill:class extends n_{constructor(e){super(e,Wx)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),r=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(e){return new Tg(this,e)}recalculate(e,t){super.recalculate(e,t);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new qx(e)}queryRadius(){return z_(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,n,i,o){if(e.queryGeometry.isAboveHorizon)return!1;return B_(j_(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),n)}isTileClipped(){return!0}},"fill-extrusion":class extends n_{constructor(e){super(e,bC)}createBucket(e){return new fC(e)}queryRadius(){return z_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(e){return new Tg(this,e)}queryIntersectsFeature(e,t,r,n,i,o,s,a,u){const c=H_(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),l=this.paint.get("fill-extrusion-height").evaluate(t,r),h=this.paint.get("fill-extrusion-base").evaluate(t,r),[p,f]=function(e,t,r,n,i){const o=[],s=[],a=i[8]*t,u=i[9]*t,c=i[10]*t,l=i[11]*t,h=i[8]*r,p=i[9]*r,f=i[10]*r,d=i[11]*r;for(const t of e){const e=[],r=[];for(const o of t){const t=o.x+n.x,s=o.y+n.y,A=i[0]*t+i[4]*s+i[12],g=i[1]*t+i[5]*s+i[13],_=i[2]*t+i[6]*s+i[14],m=i[3]*t+i[7]*s+i[15],y=A+a,E=g+u,x=_+c,C=Math.max(m+l,1e-5),b=A+h,I=g+p,v=_+f,T=Math.max(m+d,1e-5);e.push(new TC(y/C,E/C,x/C)),r.push(new TC(b/T,I/T,v/T))}o.push(e),s.push(r)}return[o,s]}(n,h,l,c,s),d=e.queryGeometry;return function(e,t,r){let n=1/0;B_(r,t)&&(n=SC(r,t[0]));for(let i=0;i<t.length;i++){const o=t[i],s=e[i];for(let e=0;e<o.length-1;e++){const t=o[e],i=o[e+1],a=s[e],u=[t,i,s[e+1],a,t];w_(r,u)&&(n=Math.min(n,SC(r,u)))}}return n!==1/0&&n}(p,f,d.isPointQuery()?d.screenBounds:d.screenGeometry)}},line:class extends n_{constructor(e){super(e,jC),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof vt,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=VC.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new GC(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(e){return new Tg(this,e)}queryRadius(e){const t=e,r=YC(k_("line-width",this,t),k_("line-gap-width",this,t)),n=k_("line-offset",this,t);return r/2+Math.abs(n)+z_(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,n,i,o){if(e.queryGeometry.isAboveHorizon)return!1;const s=j_(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),a=e.pixelToTileUnitsFactor/2*YC(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),u=this.paint.get("line-offset").evaluate(t,r);return u&&(n=function(e,t){const r=[],n=new Pn(0,0);for(let i=0;i<e.length;i++){const o=e[i],s=[];for(let e=0;e<o.length;e++){const r=o[e-1],i=o[e],a=o[e+1],u=0===e?n:i.sub(r)._unit()._perp(),c=e===o.length-1?n:a.sub(i)._unit()._perp(),l=u._add(c)._unit(),h=l.x*c.x+l.y*c.y;l._mult(1/h),s.push(l._mult(t)._add(i))}r.push(s)}return r}(n,u*e.pixelToTileUnitsFactor)),function(e,t,r){for(let n=0;n<t.length;n++){const i=t[n];if(e.length>=3)for(let t=0;t<i.length;t++)if(L_(e,i[t]))return!0;if(O_(e,i,r))return!0}return!1}(s,n,a)}isTileClipped(){return!0}},symbol:dD,background:class extends n_{constructor(e){super(e,_D)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends n_{constructor(e){super(e,bD)}getProgramIds(){return["raster"]}}};var OD,DD=(OD=!0,function(e,t){var r=OD?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return OD=!1,r}),FD=DD(void 0,(function(){return FD.toString().search("(((.+)+)+)+$").toString().constructor(FD).search("(((.+)+)+)+$")}));FD();var PD=["type","source","source-layer","minzoom","maxzoom","filter","layout"];const ND=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),LD=ND(void 0,(function(){return LD.toString().search("(((.+)+)+)+$").toString().constructor(LD).search("(((.+)+)+)+$")}));function UD(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const r of e)t+=UD(r)+",";return t+"]"}let t="{";for(const r of Object.keys(e).sort())t+=r+":"+UD(e[r])+",";return t+"}"}function GD(e){let t="";for(const r of PD)t+="/"+UD(e[r]);return t}LD();const QD=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),kD=QD(void 0,(function(){return kD.toString().search("(((.+)+)+)+$").toString().constructor(kD).search("(((.+)+)+)+$")}));kD();class zD{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(e,t){for(const t of e){this._layerConfigs[t.id]=t;(this._layers[t.id]="custom"===(r=t).type?new SD(r):new BD[r.type](r)).compileFilter(),this.keyCache[t.id]&&delete this.keyCache[t.id]}var r;for(const e of t)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const n=function(e,t){const r={};for(let n=0;n<e.length;n++){const i=t&&t[e[n].id]||GD(e[n]);t&&(t[e[n].id]=i);let o=r[i];!o&&(o=r[i]=[]),o.push(e[n])}const n=[];for(const e in r)n.push(r[e]);return n}(np(this._layerConfigs),this.keyCache);for(const e of n){const t=e.map((e=>this._layers[e.id])),r=t[0];if("none"===r.visibility)continue;const n=r.source||"";let i=this.familiesBySource[n];!i&&(i=this.familiesBySource[n]={});const o=r.sourceLayer||"_geojsonTileLayer";let s=i[o];!s&&(s=i[o]=[]),s.push(t)}}}var jD,HD=(jD=!0,function(e,t){var r=jD?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return jD=!1,r}),qD=HD(void 0,(function(){return qD.toString().search("(((.+)+)+)+$").toString().constructor(qD).search("(((.+)+)+)+$")}));function VD(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(YD,this,t)}function YD(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){var r=e.readVarint()+e.pos;for(;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function XD(e){for(var t,r,n=0,i=0,o=e.length,s=o-1;i<o;s=i++)t=e[i],n+=((r=e[s]).x-t.x)*(t.y+r.y);return n}qD(),VD.types=["Unknown","Point","LineString","Polygon"],VD.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,o=0,s=0,a=[];e.pos<r;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}i--,1===n||2===n?(o+=e.readSVarint(),s+=e.readSVarint(),1===n&&(t&&a.push(t),t=[]),t.push(new Pn(o,s))):7===n?t&&t.push(t[0].clone()):console.log("VectorTileFeature loadGeometry unknown command "+n)}return t&&a.push(t),a},VD.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,s=1/0,a=-1/0,u=1/0,c=-1/0;e.pos<t;){if(n<=0){var l=e.readVarint();r=7&l,n=l>>3}if(n--,1===r||2===r)(i+=e.readSVarint())<s&&(s=i),i>a&&(a=i),(o+=e.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==r)throw new Error("unknown command "+r)}return[s,u,a,c]},VD.prototype.toGeoJSON=function(e,t,r){var n,i,o=this.extent*Math.pow(2,r),s=this.extent*e,a=this.extent*t,u=this.loadGeometry(),c=VD.types[this.type];function l(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-360*(r.y+a)/o;e[t]=[360*(r.x+s)/o-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<u.length;n++)h[n]=u[n][0];l(u=h);break;case 2:for(n=0;n<u.length;n++)l(u[n]);break;case 3:for(u=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],o=0;o<t;o++){var s=XD(e[o]);0!==s&&(void 0===n&&(n=s<0),n===s<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}r&&i.push(r);return i}(u),n=0;n<u.length;n++)for(i=0;i<u[n].length;i++)l(u[n][i])}1===u.length?u=u[0]:c="Multi"+c;var p={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(p.id=this.id),p};var WD,KD=(WD=!0,function(e,t){var r=WD?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return WD=!1,r}),$D=KD(void 0,(function(){return $D.toString().search("(((.+)+)+)+$").toString().constructor($D).search("(((.+)+)+)+$")}));function JD(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ZD,this,t),this.length=this._features.length}function ZD(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){var t=null,r=e.readVarint()+e.pos;for(;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}$D(),JD.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new VD(this._pbf,t,this.extent,this._keys,this._values)};var eF,tF=(eF=!0,function(e,t){var r=eF?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return eF=!1,r}),rF=tF(void 0,(function(){return rF.toString().search("(((.+)+)+)+$").toString().constructor(rF).search("(((.+)+)+)+$")}));function nF(e,t){this.layers=e.readFields(iF,{},t)}function iF(e,t,r){if(3===e){var n=new JD(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}rF();const oF=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),sF=oF(void 0,(function(){return sF.toString().search("(((.+)+)+)+$").toString().constructor(sF).search("(((.+)+)+)+$")}));sF();class aF{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const uF=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),cF=uF(void 0,(function(){return cF.toString().search("(((.+)+)+)+$").toString().constructor(cF).search("(((.+)+)+)+$")}));cF();const lF=["tile","layer","source","sourceLayer","state"];class hF{constructor(e,t,r,n,i){this.type="Feature",this._vectorTileFeature=e,this._z=t,this._x=r,this._y=n,this.properties=e.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const t of lF)void 0!==this[t]&&(e[t]=this[t]);return e}}const pF=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),fF=pF(void 0,(function(){return fF.toString().search("(((.+)+)+)+$").toString().constructor(fF).search("(((.+)+)+)+$")}));fF();var dF={DONT_CARE:Dh.DONT_CARE,FASTEST:Dh.FASTEST,NICEST:Dh.NICEST,validate:function(e){return e===dF.DONT_CARE||e===dF.FASTEST||e===dF.NICEST}},AF=Object.freeze(dF);function gF(e){e=Qn(e,Qn.EMPTY_OBJECT);var t=Qn(e.wrapS,TA.CLAMP_TO_EDGE),r=Qn(e.wrapT,TA.CLAMP_TO_EDGE),n=Qn(e.wrapR,TA.CLAMP_TO_EDGE),i=Qn(e.minificationFilter,wA.LINEAR),o=Qn(e.magnificationFilter,SA.LINEAR),s=Nn(e.maximumAnisotropy)?e.maximumAnisotropy:1;if(!TA.validate(t))throw new Ln("Invalid sampler.wrapS.");if(!TA.validate(r))throw new Ln("Invalid sampler.wrapT.");if(!TA.validate(n))throw new Ln("Invalid sampler.wrapR.");if(!wA.validate(i))throw new Ln("Invalid sampler.minificationFilter.");if(!SA.validate(o))throw new Ln("Invalid sampler.magnificationFilter.");Un.typeOf.number.greaterThanOrEquals("maximumAnisotropy",s,1),this._wrapS=t,this._wrapT=r,this._wrapR=n,this._minificationFilter=i,this._magnificationFilter=o,this._maximumAnisotropy=s,this._comparisonFunction=e.comparisonFunction}function _F(e,t,r,n){var i=e._gl;if(r.is3D||r.is2DArray){const e=n||0,o=0;i.framebufferTextureLayer(i.FRAMEBUFFER,t,r._inner._texture,o,e)}else i.framebufferTexture2D(i.FRAMEBUFFER,t,r._target,r._texture,0)}function mF(e,t,r){var n=e._gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,t,n.RENDERBUFFER,r._getRenderbuffer())}function yF(e){var t=(e=Qn(e,Qn.EMPTY_OBJECT)).context;Un.defined("options.context",t);var r=t._gl,n=gA.maximumColorAttachments;if(this._context=t,this._gl=r,this._framebuffer=r.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=Qn(e.destroyAttachments,!0),Nn(e.colorTextures)&&Nn(e.colorRenderbuffers))throw new Ln("Cannot have both color texture and color renderbuffer attachments.");if(Nn(e.depthTexture)&&Nn(e.depthRenderbuffer))throw new Ln("Cannot have both a depth texture and depth renderbuffer attachment.");if(Nn(e.depthStencilTexture)&&Nn(e.depthStencilRenderbuffer))throw new Ln("Cannot have both a depth-stencil texture and depth-stencil renderbuffer attachment.");var i,o,s,a,u,c=Nn(e.depthTexture)||Nn(e.depthRenderbuffer),l=Nn(e.depthStencilTexture)||Nn(e.depthStencilRenderbuffer);if(c&&l)throw new Ln("Cannot have both a depth and depth-stencil attachment.");if(Nn(e.stencilRenderbuffer)&&l)throw new Ln("Cannot have both a stencil and depth-stencil attachment.");if(c&&Nn(e.stencilRenderbuffer))throw new Ln("Cannot have both a depth and stencil attachment.");if(this._bind(),Nn(e.colorTextures)){var h=e.colorTextures;if((a=this._colorTextures.length=this._activeColorAttachments.length=h.length)>n)throw new Ln("The number of color attachments exceeds the number supported.");if(Nn(e.colorTextureActiveLayers)&&e.colorTextureActiveLayers.length!=a)throw new Ln("length of colorTextureActiveLayers must be equal to colorTextures.");for(s=0;s<a;++s){if(i=h[s],!IA.isColorFormat(i.pixelFormat))throw new Ln("The color-texture pixel-format must be a color format.");if(i.pixelDatatype===CA.FLOAT&&!t.colorBufferFloat)throw new Ln("The color texture pixel datatype is FLOAT and the WebGL implementation does not support the EXT_color_buffer_float or WEBGL_color_buffer_float extensions. See Context.colorBufferFloat.");if(i.pixelDatatype===CA.HALF_FLOAT&&!t.colorBufferHalfFloat)throw new Ln("The color texture pixel datatype is HALF_FLOAT and the WebGL implementation does not support the EXT_color_buffer_half_float extension. See Context.colorBufferHalfFloat.");var p=0;Nn(e.colorTextureActiveLayers)&&(p=e.colorTextureActiveLayers[s]),_F(this,u=this._gl.COLOR_ATTACHMENT0+s,i,p),this._activeColorAttachments[s]=u,this._colorTextures[s]=i}}if(Nn(e.colorRenderbuffers)){var f=e.colorRenderbuffers;if((a=this._colorRenderbuffers.length=this._activeColorAttachments.length=f.length)>n)throw new Ln("The number of color attachments exceeds the number supported.");for(s=0;s<a;++s)o=f[s],mF(this,u=this._gl.COLOR_ATTACHMENT0+s,o),this._activeColorAttachments[s]=u,this._colorRenderbuffers[s]=o}if(Nn(e.depthTexture)){if((i=e.depthTexture).pixelFormat!==IA.DEPTH_COMPONENT&&i.pixelFormat!==IA.DEPTH_COMPONENT16&&i.pixelFormat!==IA.DEPTH_COMPONENT32F)throw new Ln("The depth-texture pixel-format must be DEPTH_COMPONENT.");_F(this,this._gl.DEPTH_ATTACHMENT,i,0),this._depthTexture=i}if(Nn(e.depthRenderbuffer)&&(o=e.depthRenderbuffer,mF(this,this._gl.DEPTH_ATTACHMENT,o),this._depthRenderbuffer=o),Nn(e.stencilRenderbuffer)&&(o=e.stencilRenderbuffer,mF(this,this._gl.STENCIL_ATTACHMENT,o),this._stencilRenderbuffer=o),Nn(e.depthStencilTexture)){if((i=e.depthStencilTexture).pixelFormat!==IA.DEPTH_STENCIL)throw new Ln("The depth-stencil pixel-format must be DEPTH_STENCIL.");_F(this,this._gl.DEPTH_STENCIL_ATTACHMENT,i,0),this._depthStencilTexture=i}Nn(e.depthStencilRenderbuffer)&&(o=e.depthStencilRenderbuffer,mF(this,this._gl.DEPTH_STENCIL_ATTACHMENT,o),this._depthStencilRenderbuffer=o),this._unBind()}Object.defineProperties(gF.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},wrapR:{get:function(){return this._wrapR}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}},comparisonFunction:{get:function(){return this._comparisonFunction}}}),gF.equals=function(e,t){return e===t||Nn(e)&&Nn(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._wrapR===t._wrapR&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy},Object.defineProperties(yF.prototype,{status:{get:function(){this._bind();var e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}}),yF.prototype._bind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)},yF.prototype._unBind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},yF.prototype._attachTexture=function(e,t){if(1==this.destroyAttachments)throw new Ln("destroyAttachments must be false");var r=this._gl;r.framebufferTexture2D(r.FRAMEBUFFER,e,t._target,t._texture,0)},yF.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments},yF.prototype.getColorTexture=function(e){if(!Nn(e)||e<0||e>=this._colorTextures.length)throw new Ln("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorTextures[e]},yF.prototype.getColorRenderbuffer=function(e){if(!Nn(e)||e<0||e>=this._colorRenderbuffers.length)throw new Ln("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorRenderbuffers[e]},yF.prototype.isDestroyed=function(){return!1},yF.prototype.destroy=function(){if(this.destroyAttachments){for(var e=0,t=this._colorTextures,r=t.length;e<r;++e){var n=t[e];Nn(n)&&n.destroy()}var i=this._colorRenderbuffers;for(r=i.length,e=0;e<r;++e){var o=i[e];Nn(o)&&o.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return!this._context._contextWasLost&&this._gl.deleteFramebuffer(this._framebuffer),Dd(this)},yF.blitFramebuffers=function(e,t,r,n,i,o){if(e.webgl2){var s=e._gl,a=0;if(r.numberOfColorAttachments>0&&(a|=s.COLOR_BUFFER_BIT),(Nn(r.depthStencilTexture)||Nn(r.depthTexture))&&(a|=s.DEPTH_BUFFER_BIT|(o?s.STENCIL_BUFFER_BIT:0)),0!=a){s.bindFramebuffer(s.READ_FRAMEBUFFER,t._inner._framebuffer),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,r._inner._framebuffer);var u=r.getColorTexture(0),c=u.width,l=u.height;s.blitFramebuffer(0,0,c,l,0,0,c,l,a,s.NEAREST),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null)}}};var EF,xF=(EF=!0,function(e,t){var r=EF?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return EF=!1,r}),CF=xF(void 0,(function(){return CF.toString().search("(((.+)+)+)+$").toString().constructor(CF).search("(((.+)+)+)+$")}));function bF(e,t,r,n){void 0===t&&(t=!1),this.initialize(e,t,r,n)}function IF(e,t,r){void 0===r&&(r=null),this.callback=e,this.mask=t,this.scope=r,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}function vF(e){this._observers=new Array,this._eventState=new bF(0),e&&(this._onObserverAdded=e)}CF(),bF.prototype.initialize=function(e,t,r,n){return void 0===t&&(t=!1),this.mask=e,this.skipNextObservers=t,this.target=r,this.currentTarget=n,this},vF.FromPromise=function(e,t){var r=new vF;return e.then((function(e){r.notifyObservers(e)})).catch((function(e){if(!t)throw e;t.notifyObservers(e)})),r},Object.defineProperty(vF.prototype,"observers",{get:function(){return this._observers},enumerable:!1,configurable:!0}),vF.prototype.add=function(e,t,r,n,i){if(void 0===t&&(t=-1),void 0===r&&(r=!1),void 0===n&&(n=null),void 0===i&&(i=!1),!e)return null;var o=new IF(e,t,n);return o.unregisterOnNextCall=i,r?this._observers.unshift(o):this._observers.push(o),this._onObserverAdded&&this._onObserverAdded(o),o},vF.prototype.addOnce=function(e){return this.add(e,void 0,void 0,void 0,!0)},vF.prototype.remove=function(e){return!!e&&(-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0))},vF.prototype.removeCallback=function(e,t){for(var r=0;r<this._observers.length;r++){var n=this._observers[r];if(!n._willBeUnregistered&&(n.callback===e&&(!t||t===n.scope)))return this._deferUnregister(n),!0}return!1},vF.prototype._deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((function(){t._remove(e)}),0)},vF.prototype._remove=function(e){if(!e)return!1;var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},vF.prototype.makeObserverTopPriority=function(e){this._remove(e),this._observers.unshift(e)},vF.prototype.makeObserverBottomPriority=function(e){this._remove(e),this._observers.push(e)},vF.prototype.notifyObservers=function(e,t,r,n,i){if(void 0===t&&(t=-1),!this._observers.length)return!0;var o=this._eventState;o.mask=t,o.target=r,o.currentTarget=n,o.skipNextObservers=!1,o.lastReturnValue=e,o.userInfo=i;for(var s=0,a=this._observers;s<a.length;s++){var u=a[s];if(!u._willBeUnregistered&&(u.mask&t&&(u.scope?o.lastReturnValue=u.callback.apply(u.scope,[e,o]):o.lastReturnValue=u.callback(e,o),u.unregisterOnNextCall&&this._deferUnregister(u)),o.skipNextObservers))return!1}return!0},vF.prototype.notifyObserversWithPromise=function(e,t,r,n,i){var o=this;void 0===t&&(t=-1);var s=Promise.resolve(e);if(!this._observers.length)return s;var a=this._eventState;return a.mask=t,a.target=r,a.currentTarget=n,a.skipNextObservers=!1,a.userInfo=i,this._observers.forEach((function(r){a.skipNextObservers||r._willBeUnregistered||r.mask&t&&(s=r.scope?s.then((function(t){return a.lastReturnValue=t,r.callback.apply(r.scope,[e,a])})):s.then((function(t){return a.lastReturnValue=t,r.callback(e,a)})),r.unregisterOnNextCall&&o._deferUnregister(r))})),s.then((function(){return e}))},vF.prototype.notifyObserver=function(e,t,r){if(void 0===r&&(r=-1),!e._willBeUnregistered){var n=this._eventState;n.mask=r,n.skipNextObservers=!1,e.callback(t,n),e.unregisterOnNextCall&&this._deferUnregister(e)}},vF.prototype.hasObservers=function(){return this._observers.length>0},vF.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},vF.prototype.clone=function(){var e=new vF;return e._observers=this._observers.slice(0),e},vF.prototype.hasSpecificMask=function(e){void 0===e&&(e=-1);for(var t=0,r=this._observers;t<r.length;t++){var n=r[t];if(n.mask&e||n.mask===e)return!0}return!1};var TF,RF,SF=(TF=!0,function(e,t){var r=TF?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return TF=!1,r}),MF=SF(void 0,(function(){return MF.toString().search("(((.+)+)+)+$").toString().constructor(MF).search("(((.+)+)+)+$")}));function wF(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}MF(),Object.defineProperty(wF.prototype,"wrapU",{get:function(){return this._cachedWrapU},set:function(e){this._cachedWrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(wF.prototype,"wrapV",{get:function(){return this._cachedWrapV},set:function(e){this._cachedWrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(wF.prototype,"wrapR",{get:function(){return this._cachedWrapR},set:function(e){this._cachedWrapR=e},enumerable:!1,configurable:!0}),Object.defineProperty(wF.prototype,"anisotropicFilteringLevel",{get:function(){return this._cachedAnisotropicFilteringLevel},set:function(e){this._cachedAnisotropicFilteringLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(wF.prototype,"comparisonFunction",{get:function(){return this._comparisonFunction},set:function(e){this._comparisonFunction=e},enumerable:!1,configurable:!0}),Object.defineProperty(wF.prototype,"useMipMaps",{get:function(){return this._useMipMaps},set:function(e){this._useMipMaps=e},enumerable:!1,configurable:!0}),wF.prototype.setParameters=function(e,t,r,n,i,o){return void 0===e&&(e=Qd.TEXTURE_WRAP_ADDRESSMODE),void 0===t&&(t=Qd.TEXTURE_WRAP_ADDRESSMODE),void 0===r&&(r=Qd.TEXTURE_WRAP_ADDRESSMODE),void 0===n&&(n=1),void 0===i&&(i=Qd.TEXTURE_BILINEAR_SAMPLINGMODE),void 0===o&&(o=0),this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=r,this._cachedAnisotropicFilteringLevel=n,this.samplingMode=i,this._comparisonFunction=o,this},wF.prototype.compareSampler=function(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps},function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));n(),e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.DepthStencil=12]="DepthStencil",e[e.CubeRawRGBD=13]="CubeRawRGBD",e[e.Depth=14]="Depth"}(RF||(RF={}));const BF=RF;function OF(e,t,r){void 0===r&&(r=!1);var n=wF.call(this)||this;return n.isReady=!1,n.isCube=!1,n.is3D=!1,n.is2DArray=!1,n.isMultiview=!1,n.url="",n.generateMipMaps=!1,n.samples=0,n.type=-1,n.format=-1,n.onLoadedObservable=new vF,n.onErrorObservable=new vF,n.onRebuildCallback=null,n.width=0,n.height=0,n.depth=0,n.baseWidth=0,n.baseHeight=0,n.baseDepth=0,n.invertY=!1,n._invertVScale=!1,n._associatedChannel=-1,n._source=BF.Unknown,n._buffer=null,n._bufferView=null,n._bufferViewArray=null,n._bufferViewArrayArray=null,n._size=0,n._extension="",n._files=null,n._workingCanvas=null,n._workingContext=null,n._cachedCoordinatesMode=null,n._isDisabled=!1,n._compression=null,n._sphericalPolynomial=null,n._sphericalPolynomialPromise=null,n._sphericalPolynomialComputed=!1,n._lodGenerationScale=0,n._lodGenerationOffset=0,n._useSRGBBuffer=!1,n._lodTextureHigh=null,n._lodTextureMid=null,n._lodTextureLow=null,n._isRGBD=!1,n._linearSpecularLOD=!1,n._irradianceTexture=null,n._hardwareTexture=null,n._maxLodLevel=null,n._references=1,n._gammaSpace=null,n._engine=e,n._source=t,n._uniqueId=OF._Counter++,!r&&(n._hardwareTexture=e._createHardwareTexture()),n}wF&&(OF.__proto__=wF),OF.prototype=Object.create(wF&&wF.prototype),OF.prototype.constructor=wF,Object.defineProperty(OF.prototype,"useMipMaps",{get:function(){return this._useMipMaps},set:function(e){this._useMipMaps=e},enumerable:!1,configurable:!0}),Object.defineProperty(OF.prototype,"uniqueId",{get:function(){return this._uniqueId},enumerable:!1,configurable:!0}),OF.prototype.getEngine=function(){return this._engine},Object.defineProperty(OF.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),OF.prototype.incrementReferences=function(){this._references++},OF.prototype.updateSize=function(e,t,r){void 0===r&&(r=1),this._engine.updateTextureDimensions(this,e,t,r),this.width=e,this.height=t,this.depth=r,this.baseWidth=e,this.baseHeight=t,this.baseDepth=r,this._size=e*t*r},OF.prototype._rebuild=function(){var e,t=this;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){var r=this.onRebuildCallback(this),n=function(e){e._swapAndDie(t,!1),t.isReady=r.isReady};r.isAsync?r.proxy.then(n):n(r.proxy)}else{var i;switch(this.source){case BF.Temp:break;case BF.Url:return void(i=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(function(){i._swapAndDie(t,!1),t.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case BF.Raw:(i=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,void 0,this._useSRGBBuffer))._swapAndDie(this,!1),this.isReady=!0;break;case BF.Raw3D:(i=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case BF.Raw2DArray:(i=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case BF.Dynamic:(i=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this,!1),this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case BF.Cube:return void(i=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(function(){i._swapAndDie(t,!1),t.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer));case BF.CubeRaw:(i=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this,!1),this.isReady=!0;break;case BF.CubeRawRGBD:return;case BF.CubePrefiltered:return void((i=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(function(e){e&&e._swapAndDie(t,!1),t.isReady=!0}),null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}}},OF.prototype._swapAndDie=function(e,t){var r;void 0===t&&(t=!0),null===(r=this._hardwareTexture)||void 0===r||r.setUsage(e._source,this.generateMipMaps,this.isCube,this.width,this.height),e._hardwareTexture=this._hardwareTexture,t&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);var n=this._engine.getLoadedTexturesCache(),i=n.indexOf(this);-1!==i&&n.splice(i,1),-1===(i=n.indexOf(e))&&n.push(e)},OF.prototype.dispose=function(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null)},OF._Counter=0;var DF,FF=(DF=!0,function(e,t){var r=DF?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return DF=!1,r}),PF=FF(void 0,(function(){return PF.toString().search("(((.+)+)+)+$").toString().constructor(PF).search("(((.+)+)+)+$")}));function NF(e,t,r,n){this._textures=null,this._attachments=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._depthStencilTextureWithStencil=!1,this._isMulti=e,this._isCube=t,this._size=r,this._engine=n,this._depthStencilTexture=null}function LF(e){var t=(e=Qn(e,Qn.EMPTY_OBJECT)).context,r=e.width,n=e.height,i=Qn(e.depth,0);Qn(e.mipmapLevels,0);var o=e.source,s=Qn(e.is3D,!0);this._is3D=s;var a=Qn(e.pixelFormat,IA.RGBA),u=Qn(e.pixelDatatype,CA.UNSIGNED_BYTE),c=IA.toInternalFormat(a,u,t),l=IA.isCompressedFormat(c);if(!Nn(r)||!Nn(n))throw new Ln("options requires a source field to create an initialized texture or width and height fields to create a blank texture.");if(Un.typeOf.number.greaterThan("width",r,0),r>gA.maximumTextureSize)throw new Ln("Width must be less than or equal to the maximum texture size ("+gA.maximumTextureSize+").  Check maximumTextureSize.");if(Un.typeOf.number.greaterThan("height",n,0),n>gA.maximumTextureSize)throw new Ln("Height must be less than or equal to the maximum texture size ("+gA.maximumTextureSize+").  Check maximumTextureSize.");if(!IA.validate(a))throw new Ln("Invalid options.pixelFormat.");if(!l&&!CA.validate(u))throw new Ln("Invalid options.pixelDatatype.");if(a===IA.DEPTH_COMPONENT&&u!==CA.UNSIGNED_SHORT&&u!==CA.UNSIGNED_INT)throw new Ln("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.");if(a===IA.DEPTH_STENCIL&&u!==CA.UNSIGNED_INT_24_8)throw new Ln("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.");if(u===CA.FLOAT&&!t.floatingPointTexture)throw new Ln("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.");if(u===CA.HALF_FLOAT&&!t.halfFloatingPointTexture)throw new Ln("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.");if(IA.isDepthFormat(a)&&!t.depthTexture)throw new Ln("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.");if(l){if(IA.isDXTFormat(c)&&!t.s3tc)throw new Ln("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_texture_compression_s3tc extension. Check context.s3tc.");if(IA.isPVRTCFormat(c)&&!t.pvrtc)throw new Ln("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_texture_compression_pvrtc extension. Check context.pvrtc.");if(IA.isETC1Format(c)&&!t.etc1)throw new Ln("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_texture_compression_etc1 extension. Check context.etc1.")}var h,p=e.preMultiplyAlpha||a===IA.RGB||a===IA.LUMINANCE,f=Qn(e.flipY,!0),d=t._gl,A=s?d.TEXTURE_3D:d.TEXTURE_2D_ARRAY,g=d.createTexture();d.activeTexture(d.TEXTURE0),d.bindTexture(A,g),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1),Nn(o)?Nn(o.arrayBufferView):d.texImage3D(A,0,c,r,n,i,0,a,u,null),d.bindTexture(A,null),h=l?IA.compressedTextureSizeInBytes(a,r,n,i):IA.textureSizeInBytes(a,u,r,n,i),this._id=tA(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=A,this._texture=g,this._pixelFormat=a,this._internalFormat=c,this._pixelDatatype=u,this._width=r,this._height=n,this._depth=i,this._dimensions=new qn(r,n,i),this._hasMipmap=!1,this._sizeInBytes=h,this._preMultiplyAlpha=p,this._flipY=f,this._sampler=void 0,this.ignoreWEBGL2=!1,this._isCompressed=l,this.sampler=Nn(e.sampler)?e.sampler:new gF,t.memorySize+=h,this._ownerName=e.owner,t.memoryAnalyzer.allocateGPUMemory(Fd,e.owner,h)}function UF(e,t,r){switch(e){case IA.RGB_DXT1:case IA.RGB_ETC1:return(t+3>>2)*(r+3>>2)*8;case IA.RGBA_DXT5:return(t+3>>2)*(r+3>>2)*16;case IA.RGB_PVRTC_4BPPV1:case IA.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(r,8)*4+7)/8);case IA.RGB_PVRTC_2BPPV1:case IA.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(r,8)*2+7)/8);case Dh.RGB565:return t*r*2;case IA.RGBA:return t*r*4;case IA.LUMINANCE_ALPHA:return t*r*2;default:return 0}}PF(),Object.defineProperty(NF.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"depthStencilTextureWithStencil",{get:function(){return this._depthStencilTextureWithStencil},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"isCube",{get:function(){return this._isCube},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"isMulti",{get:function(){return this._isMulti},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"is2DArray",{get:function(){return this.layers>0},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"size",{get:function(){return this.width},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"width",{get:function(){return this._size.width||this._size},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"height",{get:function(){return this._size.height||this._size},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"layers",{get:function(){return this._size.layers||0},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"texture",{get:function(){var e,t;return null!==(t=null===(e=this._textures)||void 0===e?void 0:e[0])&&void 0!==t?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"textures",{get:function(){return this._textures},enumerable:!1,configurable:!0}),Object.defineProperty(NF.prototype,"samples",{get:function(){var e,t;return null!==(t=null===(e=this.texture)||void 0===e?void 0:e.samples)&&void 0!==t?t:1},enumerable:!1,configurable:!0}),NF.prototype.setSamples=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=!1),this.samples!==e||r?this._isMulti?this._engine.updateMultipleRenderTargetTextureSampleCount(this,e,t):this._engine.updateRenderTargetTextureSampleCount(this,e):e},NF.prototype.setTextures=function(e){Array.isArray(e)?this._textures=e:this._textures=e?[e]:null},NF.prototype.setTexture=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=!0),!this._textures&&(this._textures=[]),this._textures[t]&&r&&this._textures[t].dispose(),this._textures[t]=e},NF.prototype.createDepthStencilTexture=function(e,t,r,n,i){var o;return void 0===e&&(e=0),void 0===t&&(t=!0),void 0===r&&(r=!1),void 0===n&&(n=1),void 0===i&&(i=Qd.TEXTUREFORMAT_DEPTH32_FLOAT),null===(o=this._depthStencilTexture)||void 0===o||o.dispose(),this._depthStencilTextureWithStencil=r,this._depthStencilTexture=this._engine.createDepthStencilTexture(this._size,{bilinearFiltering:t,comparisonFunction:e,generateStencil:r,isCube:this._isCube,samples:n,depthTextureFormat:i},this),this._depthStencilTexture},NF.prototype._shareDepth=function(e){this._depthStencilTexture&&(e._depthStencilTexture&&e._depthStencilTexture.dispose(),e._depthStencilTexture=this._depthStencilTexture,this._depthStencilTexture.incrementReferences())},NF.prototype._swapAndDie=function(e){this.texture&&this.texture._swapAndDie(e),this._textures=null,this.dispose(!0)},NF.prototype._cloneRenderTargetWrapper=function(){var e,t,r,n,i,o,s=null;if(this._isMulti){var a=this.textures;if(a&&a.length>0){var u=!1,c=a.length,l=a[a.length-1]._source;(l===BF.Depth||l===BF.DepthStencil)&&(u=!0,c--);for(var h=[],p=[],f=0;f<c;++f){var d=a[f];h.push(d.samplingMode),p.push(d.type)}var A={samplingModes:h,generateMipMaps:a[0].generateMipMaps,generateDepthBuffer:this._generateDepthBuffer,generateStencilBuffer:this._generateStencilBuffer,generateDepthTexture:u,types:p,textureCount:c},g={width:this.width,height:this.height};s=this._engine.createMultipleRenderTarget(g,A)}}else{var _={};if(_.generateDepthBuffer=this._generateDepthBuffer,_.generateMipMaps=null!==(t=null===(e=this.texture)||void 0===e?void 0:e.generateMipMaps)&&void 0!==t&&t,_.generateStencilBuffer=this._generateStencilBuffer,_.samplingMode=null===(r=this.texture)||void 0===r?void 0:r.samplingMode,_.type=null===(n=this.texture)||void 0===n?void 0:n.type,_.format=null===(i=this.texture)||void 0===i?void 0:i.format,this.isCube)s=this._engine.createRenderTargetCubeTexture(this.width,_);else{g={width:this.width,height:this.height,layers:this.is2DArray?null===(o=this.texture)||void 0===o?void 0:o.depth:void 0};s=this._engine.createRenderTargetTexture(g,_)}s.texture.isReady=!0}return s},NF.prototype._swapRenderTargetWrapper=function(e){if(this._textures&&e._textures)for(var t=0;t<this._textures.length;++t)this._textures[t]._swapAndDie(e._textures[t],!1),e._textures[t].isReady=!0;this._depthStencilTexture&&e._depthStencilTexture&&(this._depthStencilTexture._swapAndDie(e._depthStencilTexture),e._depthStencilTexture.isReady=!0),this._textures=null,this._depthStencilTexture=null},NF.prototype._rebuild=function(){var e=this._cloneRenderTargetWrapper();if(e){if(this._depthStencilTexture){var t=this._depthStencilTexture.samplingMode,r=t===Qd.TEXTURE_BILINEAR_SAMPLINGMODE||t===Qd.TEXTURE_TRILINEAR_SAMPLINGMODE||t===Qd.TEXTURE_LINEAR_LINEAR_MIPNEAREST;e.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction,r,this._depthStencilTextureWithStencil,this._depthStencilTexture.samples)}this.samples>1&&e.setSamples(this.samples),e._swapRenderTargetWrapper(this),e.dispose()}},NF.prototype.releaseTextures=function(){var e,t;if(this._textures)for(var r=0;null!==(t=r<(null===(e=this._textures)||void 0===e?void 0:e.length))&&void 0!==t&&t;++r)this._textures[r].dispose();this._textures=null},NF.prototype.dispose=function(e){var t;void 0===e&&(e=!1),!e&&(null===(t=this._depthStencilTexture)||void 0===t||t.dispose(),this._depthStencilTexture=null,this.releaseTextures()),this._engine._releaseRenderTargetWrapper(this)},Object.defineProperties(LF.prototype,{id:{set:function(e){this._id=e},get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter,n=t===wA.NEAREST_MIPMAP_NEAREST||t===wA.NEAREST_MIPMAP_LINEAR||t===wA.LINEAR_MIPMAP_NEAREST||t===wA.LINEAR_MIPMAP_LINEAR,i=this._context,o=this._pixelDatatype;const s=this._pixelFormat;(o===CA.FLOAT&&!i.textureFloatLinear||o===CA.HALF_FLOAT&&!i.textureHalfFloatLinear)&&(t=n?wA.NEAREST_MIPMAP_NEAREST:wA.NEAREST,r=SA.NEAREST),i.webgl2&&IA.isDepthFormat(s)&&(t=wA.NEAREST,r=SA.NEAREST);var a=i._gl,u=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(u,this._texture),a.texParameteri(u,a.TEXTURE_MIN_FILTER,t),a.texParameteri(u,a.TEXTURE_MAG_FILTER,r),a.texParameteri(u,a.TEXTURE_WRAP_S,e.wrapS),a.texParameteri(u,a.TEXTURE_WRAP_T,e.wrapT),a.texParameteri(u,a.TEXTURE_WRAP_R,e.wrapR),Nn(this._textureFilterAnisotropic)&&a.texParameteri(u,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),a.bindTexture(u,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},depth:{get:function(){return this._depth}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}},is3D:{get:function(){return this._is3D}}}),LF.prototype.copyFromFramebuffer=function(e,t,r,n,i,o,s,a){if(t=Qn(t,0),r=Qn(r,0),n=Qn(n,0),i=Qn(i,0),o=Qn(o,0),s=Qn(s,this._width),a=Qn(a,this._height),IA.isDepthFormat(this._pixelFormat))throw new Ln("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(this._pixelDatatype===CA.FLOAT)throw new Ln("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===CA.HALF_FLOAT)throw new Ln("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");if(IA.isCompressedFormat(this._pixelFormat))throw new Ln("Cannot call copyFrom with a compressed texture pixel format.");Un.typeOf.number.greaterThanOrEquals("xOffset",t,0),Un.typeOf.number.greaterThanOrEquals("yOffset",r,0),Un.typeOf.number.greaterThanOrEquals("zOffset",n,0),Un.typeOf.number.greaterThanOrEquals("framebufferXOffset",i,0),Un.typeOf.number.greaterThanOrEquals("framebufferYOffset",o,0),Un.typeOf.number.lessThanOrEquals("xOffset + width",t+s,this._width),Un.typeOf.number.lessThanOrEquals("yOffset + height",r+a,this._height);var u=this._context._gl,c=this._textureTarget;u.activeTexture(u.TEXTURE0),u.bindTexture(c,this._texture),u.copyTexSubImage3D(c,e,t,r,n,i,o,s,a),u.bindTexture(c,null),this._initialized=!0},LF.prototype.copyFromTexture=function(e,t,r,n,i,o,s,a,u){var c=this._context,l=new dN({context:c,colorTextures:[e],destroyAttachments:!1});if(l!==c._currentFramebuffer&&(c._currentFramebuffer=l,Nn(l))){l._bind();var h=l._getActiveColorAttachments();c.drawBuffers&&c.glDrawBuffers(h)}this.copyFromFramebuffer(t,r,n,i,o,s,a,u),l.destroy()},LF.prototype.setDataBufferWithMipmap=function(e,t){var r=this._context._gl;r.activeTexture(r.TEXTURE0),r.bindTexture(this._textureTarget,this._texture);var n=this._width,i=this._height,o=function(e,t,r,n){if(!zn.isPowerOfTwo(r)||!zn.isPowerOfTwo(n))return!1;for(var i=e.length,o=r,s=n,a=0;a+=IA.compressedTextureSizeInBytes(t,o,s),s>>=1,0!=(o>>=1)||0!=s;)o=Math.max(o,1),s=Math.max(s,1);return a==i}(t,this._internalFormat,n,i),s=0,a=0;do{var u,c=UF(this._internalFormat,n,i);u=this._internalFormat==IA.RGBA&&this._pixelDatatype===CA.FLOAT?new Float32Array(t.buffer,t.byteOffset+s,c):new Uint8Array(t.buffer,t.byteOffset+s,c),this._isCompressed?r.compressedTexSubImage3D(this._textureTarget,a++,0,0,e,n,i,1,this._internalFormat,u):r.texSubImage3D(this._textureTarget,a++,0,0,e,n,i,1,this._internalFormat,this._pixelDatatype,u),n=Math.max(n>>1,1),i=Math.max(i>>1,1),s+=c}while(s<t.length&&o);r.bindTexture(this._textureTarget,null)},LF.prototype.generateMipmap=function(e){if(e=Qn(e,AF.DONT_CARE),this._width>1&&!zn.isPowerOfTwo(this._width))throw new Ln("width must be a power of two to call generateMipmap().");if(this._height>1&&!zn.isPowerOfTwo(this._height))throw new Ln("height must be a power of two to call generateMipmap().");var t=this._context._gl,r=this._target;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(r,this._texture),t.generateMipmap(r)},LF.prototype.isDestroyed=function(){return!1},LF.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._context.memorySize-=this._sizeInBytes,this._context.memoryAnalyzer.releaseGPUMemory(Fd,this._ownerName,this._sizeInBytes),Dd(this)};var GF,QF=(GF=!0,function(e,t){var r=GF?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return GF=!1,r}),kF=QF(void 0,(function(){return kF.toString().search("(((.+)+)+)+$").toString().constructor(kF).search("(((.+)+)+)+$")}));function zF(e,t){this.width=e,this.height=t}kF(),zF.prototype.toString=function(){return"{W: ".concat(this.width,", H: ").concat(this.height,"}")},zF.prototype.getClassName=function(){return"Size"},zF.prototype.getHashCode=function(){var e=0|this.width;return e=397*e^this.height},zF.prototype.copyFrom=function(e){this.width=e.width,this.height=e.height},zF.prototype.copyFromFloats=function(e,t){return this.width=e,this.height=t,this},zF.prototype.set=function(e,t){return this.copyFromFloats(e,t)},zF.prototype.multiplyByFloats=function(e,t){return new zF(this.width*e,this.height*t)},zF.prototype.clone=function(){return new zF(this.width,this.height)},zF.prototype.equals=function(e){return!!e&&(this.width===e.width&&this.height===e.height)},Object.defineProperty(zF.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),zF.Zero=function(){return new zF(0,0)},zF.prototype.add=function(e){return new zF(this.width+e.width,this.height+e.height)},zF.prototype.subtract=function(e){return new zF(this.width-e.width,this.height-e.height)},zF.Lerp=function(e,t,r){return new zF(e.width+(t.width-e.width)*r,e.height+(t.height-e.height)*r)};var jF,HF=(jF=!0,function(e,t){var r=jF?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return jF=!1,r}),qF=HF(void 0,(function(){return qF.toString().search("(((.+)+)+)+$").toString().constructor(qF).search("(((.+)+)+)+$")}));function VF(e){this._wrapU=Qd.TEXTURE_WRAP_ADDRESSMODE,this._wrapV=Qd.TEXTURE_WRAP_ADDRESSMODE,this.wrapR=Qd.TEXTURE_WRAP_ADDRESSMODE,this.anisotropicFilteringLevel=4,this.delayLoadState=Qd.DELAYLOADSTATE_NONE,this._texture=null,this._engine=null,this._cachedSize=zF.Zero(),this._cachedBaseSize=zF.Zero(),this._initialSamplingMode=Qd.TEXTURE_BILINEAR_SAMPLINGMODE,this._texture=e,this._texture&&(this._engine=this._texture.getEngine())}function YF(e){var t=(e=Qn(e,Qn.EMPTY_OBJECT)).context,r=e.width,n=e.height,i=e.depth;e.mipmapLevels,this._is3D=Qn(e.is3D,!0);var o=e.source;this._hasMipmap=Qn(e.generateMipmap,!1);var s=Qn(e.pixelFormat,IA.RGBA),a=Qn(e.pixelDatatype,CA.UNSIGNED_BYTE),u=s,c=e.context.engine,l=BA.toPixelFormat(s),h=BA.toPixelType(a);this._sampler=Nn(e.sampler)?e.sampler:new gF,this._samples=Qn(e.samples,1);var p,f=BA.toAddressMode(this._sampler.wrapS),d=BA.toAddressMode(this._sampler.wrapT),A=BA.toAddressMode(this._sampler.wrapR),g=BA.toSamplerMode(a,this._sampler),_=IA.isCompressedFormat(u),m=e.preMultiplyAlpha||s===IA.RGB||s===IA.LUMINANCE,y=Qn(e.flipY,!0),E=null;Nn(o)||((E=this._is3D?c.createRawTexture3D(null,r,n,i,l,this._hasMipmap,y,g,0,h):c.createRawTexture2DArray(null,r,n,i,l,this._hasMipmap,y,g,0,h)).samples=this._samples,this._texture=new VF(E),E.wrapU=f,E.wrapV=d,E.wrapR=A),p=_?IA.compressedTextureSizeInBytes(s,r,n,i):IA.textureSizeInBytes(s,a,r,n,i),this._id=tA(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=null,this._pixelFormat=s,this._internalFormat=u,this._pixelDatatype=a,this._width=r,this._height=n,this._depth=i,this._dimensions=new qn(r,n,i),this._sizeInBytes=p,this._preMultiplyAlpha=m,this._flipY=y,this._sampler=void 0,this._isCompressed=_,this._renderTargetWrapperRefCount=0,this.sampler=Nn(e.sampler)?e.sampler:new gF,t.memorySize+=p,this._ownerName=e.owner,t.memoryAnalyzer.allocateGPUMemory(Fd,e.owner,p)}function XF(e){(e=Qn(e,Qn.EMPTY_OBJECT)).context.webgpu?this._inner=new YF(e):this._inner=new LF(e)}qF(),Object.defineProperty(VF.prototype,"wrapU",{get:function(){return this._wrapU},set:function(e){this._wrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(VF.prototype,"wrapV",{get:function(){return this._wrapV},set:function(e){this._wrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(VF.prototype,"coordinatesMode",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(VF.prototype,"isCube",{get:function(){return!!this._texture&&this._texture.isCube},set:function(e){this._texture&&(this._texture.isCube=e)},enumerable:!1,configurable:!0}),Object.defineProperty(VF.prototype,"is3D",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!1,configurable:!0}),Object.defineProperty(VF.prototype,"is2DArray",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)},enumerable:!1,configurable:!0}),VF.prototype.getClassName=function(){return"ThinTexture"},VF.prototype.isReady=function(){return this.delayLoadState===Qd.DELAYLOADSTATE_NOTLOADED?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady},VF.prototype.delayLoad=function(){},VF.prototype.getInternalTexture=function(){return this._texture},VF.prototype.getSize=function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize},VF.prototype.getBaseSize=function(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)},Object.defineProperty(VF.prototype,"samplingMode",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!1,configurable:!0}),VF.prototype.updateSamplingMode=function(e){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(e,this._texture)},VF.prototype.releaseInternalTexture=function(){this._texture&&(this._texture.dispose(),this._texture=null)},VF.prototype.dispose=function(){this._texture&&(this.releaseInternalTexture(),this._engine=null)},Object.defineProperties(YF.prototype,{id:{set:function(e){this._id=e},get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},depth:{get:function(){return this._depth}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}},is3D:{get:function(){return this._is3D}},thinTexture:{get:function(){return this._texture}},internalTexture:{get:function(){return this._texture._texture}},GPUTexture:{get:function(){return this._texture._texture._hardwareTexture.underlyingResource}}}),YF.prototype.copyFromTexture=function(e,t,r,n,i,o,s,a,u){var c=this._context.engine._device,l=this.GPUTexture,h=e._inner.GPUTexture,p=c.createCommandEncoder({});p.copyTextureToTexture({texture:h,origin:{x:o,y:s},mipLevel:t},{texture:l,origin:{x:r,y:n,z:i},mipLevel:t},{width:h.width,height:h.height,depthOrArrayLayers:1}),c.queue.submit([p.finish()])},YF.prototype.setDataBufferWithMipmap=function(e,t){console.log("Texture3DGPU.prototype.setDataBufferWithMipmap not supported")},YF.prototype.useSharedRenderTargetWrapper=function(e){return this._renderTargetWrapper||(this._renderTargetWrapper=new NF(!1,!1,e,this._context.engine)),this._renderTargetWrapperRefCount++,this._renderTargetWrapper},YF.prototype.unuseSharedRenderTargetWrapper=function(){this._renderTargetWrapperRefCount--,this._renderTargetWrapperRefCount=Math.max(0,this._renderTargetWrapperRefCount),0==this._renderTargetWrapperRefCount&&this._renderTargetWrapper.dispose(!0)},YF.prototype.generateMipmap=function(e){console.log("Texture3DGPU.prototype.generateMipmap not supported")},YF.prototype.isDestroyed=function(){return!1},YF.prototype.destroy=function(){return this._context.memorySize-=this._sizeInBytes,this._context.memoryAnalyzer.releaseGPUMemory(Fd,this._ownerName,this._sizeInBytes),this._texture.dispose(),Dd(this)},XF.create=function(e){return new Texture(e)},Object.defineProperties(XF.prototype,{id:{set:function(e){this._inner.id=e},get:function(){return this._inner.id}},sampler:{get:function(){return this._inner.sampler},set:function(e){this._inner.sampler=e}},pixelFormat:{get:function(){return this._inner.pixelFormat}},pixelDatatype:{get:function(){return this._inner.pixelDatatype}},dimensions:{get:function(){return this._inner.dimensions}},preMultiplyAlpha:{get:function(){return this._inner.preMultiplyAlpha}},flipY:{get:function(){return this._inner.flipY}},width:{get:function(){return this._inner.width}},depth:{get:function(){return this._inner.depth}},height:{get:function(){return this._inner.height}},sizeInBytes:{get:function(){return this._inner.sizeInBytes}},_target:{get:function(){return this._inner._target}},_texture:{get:function(){return this._inner._texture}},is3D:{get:function(){return this._inner.is3D}},is2DArray:{get:function(){return!this._inner.is3D}}}),XF.prototype.setDataBufferWithMipmap=function(e,t){this._inner.setDataBufferWithMipmap(e,t)},XF.prototype.copyFromTexture=function(e,t,r,n,i,o,s,a,u){this._inner.copyFromTexture(e,t,r,n,i,o,s,a,u)},XF.prototype.generateMipmap=function(e){this._inner.generateMipmap(e)},XF.prototype.isDestroyed=function(){return!1},XF.prototype.destroy=function(){return this._inner.destroy(),Dd(this)};var WF,KF,$F,JF,ZF,eP,tP,rP,nP,iP,oP,sP,aP,uP,cP,lP,hP,pP,fP,dP,AP,gP,_P,mP,yP,EP,xP,CP,bP,IP,vP,TP,RP,SP,MP,wP,BP,OP,DP,FP,PP,NP,LP,UP,GP,QP,kP,zP,jP,HP,qP,VP,YP,XP,WP,KP,$P,JP,ZP,eN,tN,rN,nN,iN,oN,sN,aN,uN,cN,lN,hN,pN=1;function fN(e){var t=(e=Qn(e,Qn.EMPTY_OBJECT)).context;Un.defined("options.context",t),this.id=pN++,this._faceIndex=0,this._context=t,this._colorTextures=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthStencilTexture=void 0,this.destroyAttachments=Qn(e.destroyAttachments,!0);var r=e.colorTextures,n=!1,i=!1,o=1,s=1;Nn(e.colorTextures)?(n=r.length>1,o=r[0].width,s=r[0].height,i=r[0]&&r[0]._texture&&r[0]._texture.isCube):Nn(e.depthTexture)?(o=e.depthTexture.width,s=e.depthTexture.height):Nn(e.depthStencilTexture)&&(o=e.depthStencilTexture.width,s=e.depthStencilTexture.height);var a,u,c,l=0;(this._shareRenderTargetWrapper=!1,Nn(e.colorTextureActiveLayers)&&e.colorTextures)&&((h=e.colorTextures[0])instanceof XF&&(this._shareRenderTargetWrapper=!0,l=r[0].depth));if(i){var h=e.colorTextures[0];this._faceIndex=h.targetFace,this._shareRenderTargetWrapper=!0}if(this._textureSize={width:o,height:s,layers:l},this._shareRenderTargetWrapper){h=e.colorTextures[0];this._renderTargetWrapper=h._inner.useSharedRenderTargetWrapper(this._textureSize),this._activeLayer=e.colorTextureActiveLayers?e.colorTextureActiveLayers[0]:0}else this._renderTargetWrapper=new NF(n,i,this._textureSize,t.engine),this._activeLayer=0;if(Nn(e.colorTextures)){var p=e.colorTextures;c=this._colorTextures.length=this._activeColorAttachments.length=p.length;var f=[],d=[];for(u=0;u<c;++u){if(a=p[u],!IA.isColorFormat(a.pixelFormat))throw new Ln("The color-texture pixel-format must be a color format.");if(a.pixelDatatype===CA.FLOAT&&!t.colorBufferFloat)throw new Ln("The color texture pixel datatype is FLOAT and the WebGL implementation does not support the EXT_color_buffer_float or WEBGL_color_buffer_float extensions. See Context.colorBufferFloat.");if(a.pixelDatatype===CA.HALF_FLOAT&&!t.colorBufferHalfFloat)throw new Ln("The color texture pixel datatype is HALF_FLOAT and the WebGL implementation does not support the EXT_color_buffer_half_float extension. See Context.colorBufferHalfFloat.");this._renderTargetWrapper.setTexture(a._inner.internalTexture,u,!1),this._colorTextures[u]=a,f.push(u+1),d.push(u+1)}this._renderTargetWrapper._attachments=f,this._renderTargetWrapper._defaultAttachments=d}Nn(e.depthTexture)&&(this._renderTargetWrapper._depthStencilTextureWithStencil=!1,this._renderTargetWrapper._depthStencilTexture=e.depthTexture._inner.internalTexture,this._depthTexture=e.depthTexture),Nn(e.depthStencilTexture)&&(this._renderTargetWrapper._depthStencilTextureWithStencil=!0,this._renderTargetWrapper._depthStencilTexture=e.depthStencilTexture._inner.internalTexture,this._depthStencilTexture=e.depthStencilTexture)}function dN(e){var t=(e=Qn(e,Qn.EMPTY_OBJECT)).context;Un.defined("options.context",t),e.context.webgpu?this._inner=new fN(e):this._inner=new yF(e)}function AN(e){e=Qn(e,Qn.EMPTY_OBJECT),Un.defined("options.context",e.context);var t=e.context,r=e.width,n=e.height,i=e.source;Nn(i)&&(Nn(r)||(r=Qn(i.videoWidth,i.width)),Nn(n)||(n=Qn(i.videoHeight,i.height)));var o=Qn(e.pixelFormat,IA.RGBA),s=Qn(e.pixelDatatype,CA.UNSIGNED_BYTE),a=IA.toInternalFormat(o,s,t),u=Qn(e.unpackAlignment,4),c=IA.isCompressedFormat(a);if(!Nn(r)||!Nn(n))throw new Ln("options requires a source field to create an initialized texture or width and height fields to create a blank texture.");if(Un.typeOf.number.greaterThan("width",r,0),r>gA.maximumTextureSize)throw new Ln("Width must be less than or equal to the maximum texture size ("+gA.maximumTextureSize+").  Check maximumTextureSize.");if(Un.typeOf.number.greaterThan("height",n,0),n>gA.maximumTextureSize)throw new Ln("Height must be less than or equal to the maximum texture size ("+gA.maximumTextureSize+").  Check maximumTextureSize.");if(!IA.validate(o))throw new Ln("Invalid options.pixelFormat.");if(!c&&!CA.validate(s))throw new Ln("Invalid options.pixelDatatype.");if(o===IA.DEPTH_COMPONENT&&s!==CA.UNSIGNED_SHORT&&s!==CA.UNSIGNED_INT&&s!==CA.FLOAT)throw new Ln("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.");if(o===IA.DEPTH_STENCIL&&s!==CA.UNSIGNED_INT_24_8)throw new Ln("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.");if(s===CA.FLOAT&&!t.floatingPointTexture)throw new Ln("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.");if(s===CA.HALF_FLOAT&&!t.halfFloatingPointTexture)throw new Ln("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.");if(IA.isDepthFormat(o)){if(Nn(i))throw new Ln("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.");if(!t.depthTexture)throw new Ln("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}if(c){if(!Nn(i)||!Nn(i.arrayBufferView))throw new Ln("When options.pixelFormat is compressed, options.source.arrayBufferView must be defined.");if(IA.isDXTFormat(a)&&!t.s3tc)throw new Ln("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_texture_compression_s3tc extension. Check context.s3tc.");if(IA.isPVRTCFormat(a)&&!t.pvrtc)throw new Ln("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_texture_compression_pvrtc extension. Check context.pvrtc.");if(IA.isETC1Format(a)&&!t.etc1)throw new Ln("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_texture_compression_etc1 extension. Check context.etc1.");if(IA.compressedTextureSizeInBytes(a,r,n)!==i.arrayBufferView.byteLength)throw new Ln("The byte length of the array buffer is invalid for the compressed texture with the given width and height.")}var l=e.preMultiplyAlpha||o===IA.RGB||o===IA.LUMINANCE,h=e.forcePremultipliedAlpha||!1,p=Qn(e.flipY,!0);const f=Qn(e.skipColorSpaceConversion,!1);var d,A=!0,g=t._gl,_=g.TEXTURE_2D,m=g.createTexture();if(g.activeTexture(g.TEXTURE0),g.bindTexture(_,m),!Nn(e.unpackAlignment)&&Nn(i)&&Nn(i.arrayBufferView)&&!c&&(u=IA.alignmentInBytes(o,s,r)),g.pixelStorei(g.UNPACK_ALIGNMENT,u),f?g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.NONE):g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.BROWSER_DEFAULT_WEBGL),Nn(i))if(Nn(i.arrayBufferView)){h&&o===IA.RGBA&&!c?g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0):g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,!1);var y,E,x=i.arrayBufferView;if(c){if(g.compressedTexImage2D(_,0,a,r,n,0,x),Nn(i.mipLevels))for(y=r,E=n,C=0;C<i.mipLevels.length;++C)(y=0|Math.floor(y/2))<1&&(y=1),(E=0|Math.floor(E/2))<1&&(E=1),g.compressedTexImage2D(_,C+1,a,y,E,0,i.mipLevels[C])}else if(p&&(x=IA.flipY(x,o,s,r,n)),g.texImage2D(_,0,a,r,n,0,o,CA.toWebGLConstant(s,t),x),Nn(i.mipLevels))for(y=r,E=n,C=0;C<i.mipLevels.length;++C)(y=0|Math.floor(y/2))<1&&(y=1),(E=0|Math.floor(E/2))<1&&(E=1),g.texImage2D(_,C+1,a,y,E,0,o,CA.toWebGLConstant(s,t),i.mipLevels[C])}else if(Nn(i.framebuffer))g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,!1),i.framebuffer!==t.defaultFramebuffer&&i.framebuffer._bind(),g.copyTexImage2D(_,0,a,i.xOffset,i.yOffset,r,n,0),i.framebuffer!==t.defaultFramebuffer&&i.framebuffer._unBind();else{g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,p),g.texImage2D(_,0,a,o,CA.toWebGLConstant(s,t),i);let r=e.mipLevels;if(Nn(r))for(var C=0,b=r.length;C<b;++C)g.texImage2D(_,C+1,a,o,CA.toWebGLConstant(s,t),r[C])}else g.texImage2D(_,0,a,r,n,0,o,CA.toWebGLConstant(s,t),null),A=!1;g.bindTexture(_,null),d=c?IA.compressedTextureSizeInBytes(o,r,n):IA.textureSizeInBytes(o,s,r,n),this._id=tA(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=_,this._texture=m,this._internalFormat=a,this._pixelFormat=o,this._pixelDatatype=s,this._width=r,this._height=n,this._dimensions=new li(r,n),this._size=[r,n],this._hasMipmap=!1,this._sizeInBytes=d,this._preMultiplyAlpha=l,this._flipY=p,this._initialized=A,this._sampler=void 0,this.ignoreWEBGL2=!1,this._samples=Qn(e.samples,1),this.sampler=Nn(e.sampler)?e.sampler:new gF,t.memorySize+=d,this._ownerName=e.owner,t.memoryAnalyzer.allocateGPUMemory(Fd,e.owner,d)}Object.defineProperties(fN.prototype,{status:{get:function(){return Dh.FRAMEBUFFER_COMPLETE}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}},textureSize:{get:function(){return this._textureSize}}}),fN.prototype._bind=function(){Nn(this._renderTargetWrapper)&&this._context._engine.bindFramebuffer(this._renderTargetWrapper,this._faceIndex,null,null,null,null,this._activeLayer,0)},fN.prototype._unBind=function(){Nn(this._renderTargetWrapper)&&this._context._engine.unBindFramebuffer(this._renderTargetWrapper)},fN.prototype._attachTexture=function(e,t){console.log("FramebufferGPU.prototype._attachTexture")},fN.prototype._getActiveColorAttachments=function(){console.log("FramebufferGPU.prototype._getActiveColorAttachments")},fN.prototype.getColorTexture=function(e){if(!Nn(e)||e<0||e>=this._colorTextures.length)throw new Ln("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorTextures[e]},fN.prototype.getColorRenderbuffer=function(e){if(!Nn(e)||e<0||e>=this._colorRenderbuffers.length)throw new Ln("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorRenderbuffers[e]},fN.prototype.isDestroyed=function(){return!1},fN.prototype.destroy=function(){if(this._shareRenderTargetWrapper?(this._colorTextures[0]._inner.unuseSharedRenderTargetWrapper(),this._renderTargetWrapper=void 0):this._renderTargetWrapper.dispose(!0),this.destroyAttachments){for(var e=this._colorTextures,t=e.length,r=0;r<t;++r){var n=e[r];Nn(n)&&n.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy()}return Dd(this)},Object.defineProperties(dN.prototype,{status:{get:function(){return this._inner.status}},numberOfColorAttachments:{get:function(){return this._inner.numberOfColorAttachments}},depthTexture:{get:function(){return this._inner.depthTexture}},depthRenderbuffer:{get:function(){return this._inner.depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._inner.stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._inner.depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._inner.depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}},textureSize:{get:function(){return this._inner.textureSize}}}),dN.prototype._bind=function(){this._inner._bind()},dN.prototype._unBind=function(){this._inner._unBind()},dN.prototype._attachTexture=function(e,t){this._inner._attachTexture(e,t)},dN.prototype._getActiveColorAttachments=function(){return this._inner._getActiveColorAttachments()},dN.prototype.getColorTexture=function(e){return this._inner.getColorTexture(e)},dN.prototype.getColorRenderbuffer=function(e){return this._inner.getColorRenderbuffer(e)},dN.prototype.isDestroyed=function(){return!1},dN.prototype.destroy=function(){return this._inner.destroy(),Dd(this)},dN.blitFramebuffers=function(e,t,r,n,i,o){e.webgpu||yF.blitFramebuffers(e,t,r,n,i,o)},AN.fromFramebuffer=function(e){e=Qn(e,Qn.EMPTY_OBJECT),Un.defined("options.context",e.context);var t=e.context,r=t._gl,n=Qn(e.pixelFormat,IA.RGB),i=Qn(e.framebufferXOffset,0),o=Qn(e.framebufferYOffset,0),s=Qn(e.width,r.drawingBufferWidth),a=Qn(e.height,r.drawingBufferHeight),u=e.framebuffer;if(!IA.validate(n))throw new Ln("Invalid pixelFormat.");if(IA.isDepthFormat(n)||IA.isCompressedFormat(n))throw new Ln("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.");if(Un.defined("options.context",e.context),Un.typeOf.number.greaterThanOrEquals("framebufferXOffset",i,0),Un.typeOf.number.greaterThanOrEquals("framebufferYOffset",o,0),i+s>r.drawingBufferWidth)throw new Ln("framebufferXOffset + width must be less than or equal to drawingBufferWidth");if(o+a>r.drawingBufferHeight)throw new Ln("framebufferYOffset + height must be less than or equal to drawingBufferHeight.");return new AN({context:t,width:s,height:a,pixelFormat:n,source:{framebuffer:Nn(u)?u:t.defaultFramebuffer,xOffset:i,yOffset:o,width:s,height:a}})},Object.defineProperties(AN.prototype,{id:{set:function(e){this._id=e},get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter,n=e.comparisonFunction,i=t===wA.NEAREST_MIPMAP_NEAREST||t===wA.NEAREST_MIPMAP_LINEAR||t===wA.LINEAR_MIPMAP_NEAREST||t===wA.LINEAR_MIPMAP_LINEAR,o=this._context,s=this._pixelDatatype;const a=this._pixelFormat;(s===CA.FLOAT&&!o.textureFloatLinear||s===CA.HALF_FLOAT&&!o.textureHalfFloatLinear)&&(t=i?wA.NEAREST_MIPMAP_NEAREST:wA.NEAREST,r=SA.NEAREST),o.webgl2&&IA.isDepthFormat(a)&&(t=wA.NEAREST,r=SA.NEAREST);var u=o._gl,c=this._textureTarget;u.activeTexture(u.TEXTURE0),u.bindTexture(c,this._texture),u.texParameteri(c,u.TEXTURE_MIN_FILTER,t),u.texParameteri(c,u.TEXTURE_MAG_FILTER,r),u.texParameteri(c,u.TEXTURE_WRAP_S,e.wrapS),u.texParameteri(c,u.TEXTURE_WRAP_T,e.wrapT),Nn(this._textureFilterAnisotropic)&&u.texParameteri(c,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),o.webgl2&&n&&(n===Dh.LEQUAL?(u.texParameteri(c,u.TEXTURE_COMPARE_FUNC,Dh.LEQUAL),u.texParameteri(c,u.TEXTURE_COMPARE_MODE,u.NONE)):(u.texParameteri(c,u.TEXTURE_COMPARE_FUNC,n),u.texParameteri(c,u.TEXTURE_COMPARE_MODE,u.COMPARE_REF_TO_TEXTURE))),u.bindTexture(c,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},size:{get:function(){return this._size}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),AN.prototype.copyFrom=function(e,t,r){if(t=Qn(t,0),r=Qn(r,0),Un.defined("source",e),IA.isDepthFormat(this._pixelFormat))throw new Ln("Cannot call copyFrom when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");var n=IA.isCompressedFormat(this._pixelFormat);Un.typeOf.number.greaterThanOrEquals("xOffset",t,0),Un.typeOf.number.greaterThanOrEquals("yOffset",r,0),Un.typeOf.number.lessThanOrEquals("xOffset + source.width",t+e.width,this._width),Un.typeOf.number.lessThanOrEquals("yOffset + source.height",r+e.height,this._height);const i=this._context;var o=i._gl,s=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture);var a=e.width,u=e.height,c=e.arrayBufferView,l=this._width,h=this._height,p=this._pixelFormat,f=this._pixelDatatype;const d=this._internalFormat;var A=this._preMultiplyAlpha,g=this._flipY,_=Qn(e.unpackAlignment,4);!Nn(e.unpackAlignment)&&Nn(c)&&(_=IA.alignmentInBytes(p,f,a)),o.pixelStorei(o.UNPACK_ALIGNMENT,_),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.BROWSER_DEFAULT_WEBGL);var m=!1;if(!this._initialized){if(0===t&&0===r&&a===l&&u===h)Nn(c)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),g&&(c=IA.flipY(c,p,f,l,h)),o.texImage2D(s,0,d,l,h,0,p,CA.toWebGLConstant(f,i),c)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,g),o.texImage2D(s,0,d,p,CA.toWebGLConstant(f,i),e)),m=!0;else{o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1);var y=IA.createTypedArray(p,f,l,h);o.texImage2D(s,0,d,l,h,0,p,CA.toWebGLConstant(f,i),y)}this._initialized=!0}m||(Nn(c)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),g&&(c=IA.flipY(c,p,f,a,u)),n?o.compressedTexSubImage2D(s,0,t,r,a,u,p,c):o.texSubImage2D(s,0,t,r,a,u,p,CA.toWebGLConstant(f,i),c)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,g),n?o.compressedTexSubImage2D(s,0,t,r,a,u,p,c):o.texSubImage2D(s,0,t,r,p,CA.toWebGLConstant(f,i),e))),o.bindTexture(s,null)},AN.prototype.copyFromFramebuffer=function(e,t,r,n,i,o){if(e=Qn(e,0),t=Qn(t,0),r=Qn(r,0),n=Qn(n,0),i=Qn(i,this._width),o=Qn(o,this._height),IA.isDepthFormat(this._pixelFormat))throw new Ln("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(this._pixelDatatype===CA.FLOAT)throw new Ln("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===CA.HALF_FLOAT)throw new Ln("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");if(IA.isCompressedFormat(this._pixelFormat))throw new Ln("Cannot call copyFrom with a compressed texture pixel format.");Un.typeOf.number.greaterThanOrEquals("xOffset",e,0),Un.typeOf.number.greaterThanOrEquals("yOffset",t,0),Un.typeOf.number.greaterThanOrEquals("framebufferXOffset",r,0),Un.typeOf.number.greaterThanOrEquals("framebufferYOffset",n,0),Un.typeOf.number.lessThanOrEquals("xOffset + width",e+i,this._width),Un.typeOf.number.lessThanOrEquals("yOffset + height",t+o,this._height);var s=this._context._gl,a=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(a,this._texture),s.copyTexSubImage2D(a,0,e,t,r,n,i,o),s.bindTexture(a,null),this._initialized=!0},AN.prototype.copyFromTexture=function(e,t,r,n,i,o,s){var a=this._context,u=new dN({context:a,colorTextures:[e],destroyAttachments:!1});if(u!==a._currentFramebuffer&&(a._currentFramebuffer=u,Nn(u))){u._bind();var c=u._getActiveColorAttachments();a.drawBuffers&&a.glDrawBuffers(c)}this.copyFromFramebuffer(t,r,n,i,o,s),u.destroy()},AN.prototype.generateMipmap=function(e){if(e=Qn(e,AF.DONT_CARE),IA.isDepthFormat(this._pixelFormat))throw new Ln("Cannot call generateMipmap when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(IA.isCompressedFormat(this._pixelFormat))throw new Ln("Cannot call generateMipmap with a compressed pixel format.");if(!this._context.webgl2){if(this._width>1&&!zn.isPowerOfTwo(this._width))throw new Ln("width must be a power of two to call generateMipmap() in a WebGL1 context.");if(this._height>1&&!zn.isPowerOfTwo(this._height))throw new Ln("height must be a power of two to call generateMipmap() in a WebGL1 context.")}if(!AF.validate(e))throw new Ln("hint is invalid.");this._hasMipmap=!0;var t=this._context._gl,r=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(r,this._texture),t.generateMipmap(r),t.bindTexture(r,null)},AN.prototype.isDestroyed=function(){return!1},AN.prototype.destroy=function(){return!this._context._contextWasLost&&this._context._gl.deleteTexture(this._texture),this._context.memorySize-=this._sizeInBytes,this._context.memoryAnalyzer.releaseGPUMemory(Fd,this._ownerName,this._sizeInBytes),Dd(this)},(WF||(WF={})).SRGB="srgb",($F=KF||(KF={})).LowPower="low-power",$F.HighPerformance="high-performance",(ZF=JF||(JF={})).DepthClipControl="depth-clip-control",ZF.Depth24UnormStencil8="depth24unorm-stencil8",ZF.Depth32FloatStencil8="depth32float-stencil8",ZF.TextureCompressionBC="texture-compression-bc",ZF.TextureCompressionETC2="texture-compression-etc2",ZF.TextureCompressionASTC="texture-compression-astc",ZF.TimestampQuery="timestamp-query",ZF.IndirectFirstInstance="indirect-first-instance",ZF.ShaderF16="shader-f16",ZF.BGRA8UnormStorage="bgra8unorm-storage",(tP=eP||(eP={}))[tP.MapRead=1]="MapRead",tP[tP.MapWrite=2]="MapWrite",tP[tP.CopySrc=4]="CopySrc",tP[tP.CopyDst=8]="CopyDst",tP[tP.Index=16]="Index",tP[tP.Vertex=32]="Vertex",tP[tP.Uniform=64]="Uniform",tP[tP.Storage=128]="Storage",tP[tP.Indirect=256]="Indirect",tP[tP.QueryResolve=512]="QueryResolve",function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));n(),e[e.Read=1]="Read",e[e.Write=2]="Write"}(rP||(rP={})),(iP=nP||(nP={})).E1d="1d",iP.E2d="2d",iP.E3d="3d",(sP=oP||(oP={}))[sP.CopySrc=1]="CopySrc",sP[sP.CopyDst=2]="CopyDst",sP[sP.TextureBinding=4]="TextureBinding",sP[sP.StorageBinding=8]="StorageBinding",sP[sP.RenderAttachment=16]="RenderAttachment",(uP=aP||(aP={})).E1d="1d",uP.E2d="2d",uP.E2dArray="2d-array",uP.Cube="cube",uP.CubeArray="cube-array",uP.E3d="3d",(lP=cP||(cP={})).All="all",lP.StencilOnly="stencil-only",lP.DepthOnly="depth-only",(pP=hP||(hP={})).R8Unorm="r8unorm",pP.R8Snorm="r8snorm",pP.R8Uint="r8uint",pP.R8Sint="r8sint",pP.R16Uint="r16uint",pP.R16Sint="r16sint",pP.R16Float="r16float",pP.RG8Unorm="rg8unorm",pP.RG8Snorm="rg8snorm",pP.RG8Uint="rg8uint",pP.RG8Sint="rg8sint",pP.R32Uint="r32uint",pP.R32Sint="r32sint",pP.R32Float="r32float",pP.RG16Uint="rg16uint",pP.RG16Sint="rg16sint",pP.RG16Float="rg16float",pP.RGBA8Unorm="rgba8unorm",pP.RGBA8UnormSRGB="rgba8unorm-srgb",pP.RGBA8Snorm="rgba8snorm",pP.RGBA8Uint="rgba8uint",pP.RGBA8Sint="rgba8sint",pP.BGRA8Unorm="bgra8unorm",pP.BGRA8UnormSRGB="bgra8unorm-srgb",pP.RGB9E5UFloat="rgb9e5ufloat",pP.RGB10A2Unorm="rgb10a2unorm",pP.RG11B10UFloat="rg11b10ufloat",pP.RG32Uint="rg32uint",pP.RG32Sint="rg32sint",pP.RG32Float="rg32float",pP.RGBA16Uint="rgba16uint",pP.RGBA16Sint="rgba16sint",pP.RGBA16Float="rgba16float",pP.RGBA32Uint="rgba32uint",pP.RGBA32Sint="rgba32sint",pP.RGBA32Float="rgba32float",pP.Stencil8="stencil8",pP.Depth16Unorm="depth16unorm",pP.Depth24Plus="depth24plus",pP.Depth24PlusStencil8="depth24plus-stencil8",pP.Depth32Float="depth32float",pP.BC1RGBAUnorm="bc1-rgba-unorm",pP.BC1RGBAUnormSRGB="bc1-rgba-unorm-srgb",pP.BC2RGBAUnorm="bc2-rgba-unorm",pP.BC2RGBAUnormSRGB="bc2-rgba-unorm-srgb",pP.BC3RGBAUnorm="bc3-rgba-unorm",pP.BC3RGBAUnormSRGB="bc3-rgba-unorm-srgb",pP.BC4RUnorm="bc4-r-unorm",pP.BC4RSnorm="bc4-r-snorm",pP.BC5RGUnorm="bc5-rg-unorm",pP.BC5RGSnorm="bc5-rg-snorm",pP.BC6HRGBUFloat="bc6h-rgb-ufloat",pP.BC6HRGBFloat="bc6h-rgb-float",pP.BC7RGBAUnorm="bc7-rgba-unorm",pP.BC7RGBAUnormSRGB="bc7-rgba-unorm-srgb",pP.ETC2RGB8Unorm="etc2-rgb8unorm",pP.ETC2RGB8UnormSRGB="etc2-rgb8unorm-srgb",pP.ETC2RGB8A1Unorm="etc2-rgb8a1unorm",pP.ETC2RGB8A1UnormSRGB="etc2-rgb8a1unorm-srgb",pP.ETC2RGBA8Unorm="etc2-rgba8unorm",pP.ETC2RGBA8UnormSRGB="etc2-rgba8unorm-srgb",pP.EACR11Unorm="eac-r11unorm",pP.EACR11Snorm="eac-r11snorm",pP.EACRG11Unorm="eac-rg11unorm",pP.EACRG11Snorm="eac-rg11snorm",pP.ASTC4x4Unorm="astc-4x4-unorm",pP.ASTC4x4UnormSRGB="astc-4x4-unorm-srgb",pP.ASTC5x4Unorm="astc-5x4-unorm",pP.ASTC5x4UnormSRGB="astc-5x4-unorm-srgb",pP.ASTC5x5Unorm="astc-5x5-unorm",pP.ASTC5x5UnormSRGB="astc-5x5-unorm-srgb",pP.ASTC6x5Unorm="astc-6x5-unorm",pP.ASTC6x5UnormSRGB="astc-6x5-unorm-srgb",pP.ASTC6x6Unorm="astc-6x6-unorm",pP.ASTC6x6UnormSRGB="astc-6x6-unorm-srgb",pP.ASTC8x5Unorm="astc-8x5-unorm",pP.ASTC8x5UnormSRGB="astc-8x5-unorm-srgb",pP.ASTC8x6Unorm="astc-8x6-unorm",pP.ASTC8x6UnormSRGB="astc-8x6-unorm-srgb",pP.ASTC8x8Unorm="astc-8x8-unorm",pP.ASTC8x8UnormSRGB="astc-8x8-unorm-srgb",pP.ASTC10x5Unorm="astc-10x5-unorm",pP.ASTC10x5UnormSRGB="astc-10x5-unorm-srgb",pP.ASTC10x6Unorm="astc-10x6-unorm",pP.ASTC10x6UnormSRGB="astc-10x6-unorm-srgb",pP.ASTC10x8Unorm="astc-10x8-unorm",pP.ASTC10x8UnormSRGB="astc-10x8-unorm-srgb",pP.ASTC10x10Unorm="astc-10x10-unorm",pP.ASTC10x10UnormSRGB="astc-10x10-unorm-srgb",pP.ASTC12x10Unorm="astc-12x10-unorm",pP.ASTC12x10UnormSRGB="astc-12x10-unorm-srgb",pP.ASTC12x12Unorm="astc-12x12-unorm",pP.ASTC12x12UnormSRGB="astc-12x12-unorm-srgb",pP.Depth24UnormStencil8="depth24unorm-stencil8",pP.Depth32FloatStencil8="depth32float-stencil8",(dP=fP||(fP={})).ClampToEdge="clamp-to-edge",dP.Repeat="repeat",dP.MirrorRepeat="mirror-repeat",(gP=AP||(AP={})).Nearest="nearest",gP.Linear="linear",(mP=_P||(_P={})).Never="never",mP.Less="less",mP.Equal="equal",mP.LessEqual="less-equal",mP.Greater="greater",mP.NotEqual="not-equal",mP.GreaterEqual="greater-equal",mP.Always="always",(EP=yP||(yP={}))[EP.Vertex=1]="Vertex",EP[EP.Fragment=2]="Fragment",EP[EP.Compute=4]="Compute",(CP=xP||(xP={})).Uniform="uniform",CP.Storage="storage",CP.ReadOnlyStorage="read-only-storage",(IP=bP||(bP={})).Filtering="filtering",IP.NonFiltering="non-filtering",IP.Comparison="comparison",(TP=vP||(vP={})).Float="float",TP.UnfilterableFloat="unfilterable-float",TP.Depth="depth",TP.Sint="sint",TP.Uint="uint",(RP||(RP={})).WriteOnly="write-only",(MP=SP||(SP={})).Error="error",MP.Warning="warning",MP.Info="info",(wP||(wP={})).Auto="auto",(OP=BP||(BP={})).PointList="point-list",OP.LineList="line-list",OP.LineStrip="line-strip",OP.TriangleList="triangle-list",OP.TriangleStrip="triangle-strip",(FP=DP||(DP={})).CCW="ccw",FP.CW="cw",(NP=PP||(PP={})).None="none",NP.Front="front",NP.Back="back",(UP=LP||(LP={}))[UP.Red=1]="Red",UP[UP.Green=2]="Green",UP[UP.Blue=4]="Blue",UP[UP.Alpha=8]="Alpha",UP[UP.All=15]="All",(QP=GP||(GP={})).Zero="zero",QP.One="one",QP.Src="src",QP.OneMinusSrc="one-minus-src",QP.SrcAlpha="src-alpha",QP.OneMinusSrcAlpha="one-minus-src-alpha",QP.Dst="dst",QP.OneMinusDst="one-minus-dst",QP.DstAlpha="dst-alpha",QP.OneMinusDstAlpha="one-minus-dst-alpha",QP.SrcAlphaSaturated="src-alpha-saturated",QP.Constant="constant",QP.OneMinusConstant="one-minus-constant",(zP=kP||(kP={})).Add="add",zP.Subtract="subtract",zP.ReverseSubtract="reverse-subtract",zP.Min="min",zP.Max="max",(HP=jP||(jP={})).Keep="keep",HP.Zero="zero",HP.Replace="replace",HP.Invert="invert",HP.IncrementClamp="increment-clamp",HP.DecrementClamp="decrement-clamp",HP.IncrementWrap="increment-wrap",HP.DecrementWrap="decrement-wrap",(VP=qP||(qP={})).Uint16="uint16",VP.Uint32="uint32",(XP=YP||(YP={})).Uint8x2="uint8x2",XP.Uint8x4="uint8x4",XP.Sint8x2="sint8x2",XP.Sint8x4="sint8x4",XP.Unorm8x2="unorm8x2",XP.Unorm8x4="unorm8x4",XP.Snorm8x2="snorm8x2",XP.Snorm8x4="snorm8x4",XP.Uint16x2="uint16x2",XP.Uint16x4="uint16x4",XP.Sint16x2="sint16x2",XP.Sint16x4="sint16x4",XP.Unorm16x2="unorm16x2",XP.Unorm16x4="unorm16x4",XP.Snorm16x2="snorm16x2",XP.Snorm16x4="snorm16x4",XP.Float16x2="float16x2",XP.Float16x4="float16x4",XP.Float32="float32",XP.Float32x2="float32x2",XP.Float32x3="float32x3",XP.Float32x4="float32x4",XP.Uint32="uint32",XP.Uint32x2="uint32x2",XP.Uint32x3="uint32x3",XP.Uint32x4="uint32x4",XP.Sint32="sint32",XP.Sint32x2="sint32x2",XP.Sint32x3="sint32x3",XP.Sint32x4="sint32x4",(KP=WP||(WP={})).Vertex="vertex",KP.Instance="instance",(JP=$P||($P={})).Beginning="beginning",JP.End="end",(eN=ZP||(ZP={})).Beginning="beginning",eN.End="end",(rN=tN||(tN={})).Load="load",rN.Clear="clear",(iN=nN||(nN={})).Store="store",iN.Discard="discard",(sN=oN||(oN={})).Occlusion="occlusion",sN.Timestamp="timestamp",(uN=aN||(aN={})).Opaque="opaque",uN.Premultiplied="premultiplied",(cN||(cN={})).Destroyed="destroyed",(hN=lN||(lN={})).OutOfMemory="out-of-memory",hN.Validation="validation";var gN,_N={PredefinedColorSpace:WF,PowerPreference:KF,FeatureName:JF,BufferUsage:eP,MapMode:rP,TextureDimension:nP,TextureUsage:oP,TextureViewDimension:aP,TextureAspect:cP,TextureFormat:hP,AddressMode:fP,FilterMode:AP,CompareFunction:_P,ShaderStage:yP,BufferBindingType:xP,SamplerBindingType:bP,TextureSampleType:vP,StorageTextureAccess:RP,CompilationMessageType:SP,AutoLayoutMode:wP,PrimitiveTopology:BP,FrontFace:DP,CullMode:PP,ColorWriteFlags:LP,BlendFactor:GP,BlendOperation:kP,StencilOperation:jP,IndexFormat:qP,VertexFormat:YP,InputStepMode:WP,ComputePassTimestampLocation:$P,RenderPassTimestampLocation:ZP,LoadOp:tN,StoreOp:nN,QueryType:oN,CanvasCompositingAlphaMode:aN,DeviceLostReason:cN,ErrorFilter:lN},mN=(gN=!0,function(e,t){var r=gN?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return gN=!1,r}),yN=mN(void 0,(function(){return yN.toString().search("(((.+)+)+)+$").toString().constructor(yN).search("(((.+)+)+)+$")}));function EN(){}yN(),EN.WithinEpsilon=function(e,t,r){return void 0===r&&(r=1401298e-51),Math.abs(e-t)<=r},EN.ToHex=function(e){var t=e.toString(16);return e<=15?("0"+t).toUpperCase():t.toUpperCase()},EN.Sign=function(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1},EN.Clamp=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),Math.min(r,Math.max(t,e))},EN.Log2=function(e){return Math.log(e)*Math.LOG2E},EN.ILog2=function(e){if(Math.log2)return Math.floor(Math.log2(e));if(e<0)return NaN;if(0===e)return-1/0;var t=0;if(e<1){for(;e<1;)t++,e*=2;t=-t}else if(e>1)for(;e>1;)t++,e=Math.floor(e/2);return t},EN.Repeat=function(e,t){return e-Math.floor(e/t)*t},EN.Normalize=function(e,t,r){return(e-t)/(r-t)},EN.Denormalize=function(e,t,r){return e*(r-t)+t},EN.DeltaAngle=function(e,t){var r=EN.Repeat(t-e,360);return r>180&&(r-=360),r},EN.PingPong=function(e,t){var r=EN.Repeat(e,2*t);return t-Math.abs(r-t)},EN.SmoothStep=function(e,t,r){var n=EN.Clamp(r);return t*(n=-2*n*n*n+3*n*n)+e*(1-n)},EN.MoveTowards=function(e,t,r){return Math.abs(t-e)<=r?t:e+EN.Sign(t-e)*r},EN.MoveTowardsAngle=function(e,t,r){var n=EN.DeltaAngle(e,t),i=0;return-r<n&&n<r?i=t:(t=e+n,i=EN.MoveTowards(e,t,r)),i},EN.Lerp=function(e,t,r){return e+(t-e)*r},EN.LerpAngle=function(e,t,r){var n=EN.Repeat(t-e,360);return n>180&&(n-=360),e+n*EN.Clamp(r)},EN.InverseLerp=function(e,t,r){return e!=t?EN.Clamp((r-e)/(t-e)):0},EN.Hermite=function(e,t,r,n,i){var o=i*i,s=i*o;return e*(2*s-3*o+1)+r*(-2*s+3*o)+t*(s-2*o+i)+n*(s-o)},EN.Hermite1stDerivative=function(e,t,r,n,i){var o=i*i;return 6*(o-i)*e+(3*o-4*i+1)*t+6*(-o+i)*r+(3*o-2*i)*n},EN.RandomRange=function(e,t){return e===t?e:Math.random()*(t-e)+e},EN.RangeToPercent=function(e,t,r){return(e-t)/(r-t)},EN.PercentToRange=function(e,t,r){return(r-t)*e+t},EN.NormalizeRadians=function(e){return e-=EN.TwoPi*Math.floor((e+Math.PI)/EN.TwoPi)},EN.HCF=function(e,t){var r=e%t;return 0===r?t:EN.HCF(t,r)},EN.TwoPi=2*Math.PI;var xN,CN=(xN=!0,function(e,t){var r=xN?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return xN=!1,r}),bN=CN(void 0,(function(){return bN.toString().search("(((.+)+)+)+$").toString().constructor(bN).search("(((.+)+)+)+$")}));function IN(e){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=IN._Counter++;return this._buffer=e,this}bN(),Object.defineProperty(IN.prototype,"underlyingResource",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),IN._Counter=0;var vN,TN=(vN=!0,function(e,t){var r=vN?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return vN=!1,r}),RN=TN(void 0,(function(){return RN.toString().search("(((.+)+)+)+$").toString().constructor(RN).search("(((.+)+)+)+$")}));RN();var SN,MN=(SN=!0,function(e,t){var r=SN?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return SN=!1,r}),wN=MN(void 0,(function(){return wN.toString().search("(((.+)+)+)+$").toString().constructor(wN).search("(((.+)+)+)+$")}));function BN(e){var t=VF.call(this,null)||this;return t.metadata=null,t.reservedDataStore=null,t._hasAlpha=!1,t._getAlphaFromRGB=!1,t.level=1,t._coordinatesIndex=0,t._coordinatesMode=Qd.TEXTURE_EXPLICIT_MODE,t.wrapR=Qd.TEXTURE_WRAP_ADDRESSMODE,t.anisotropicFilteringLevel=BN.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,t._isCube=!1,t._gammaSpace=!0,t.invertZ=!1,t.lodLevelInAlpha=!1,t.isRenderTarget=!1,t._prefiltered=!1,t._forceSerialize=!1,t.animations=new Array,t.onDisposeObservable=new vF,t._onDisposeObserver=null,t._scene=null,t._uid=null,t._parentContainer=null,t._loadingError=!1,e?BN._IsScene(e)?t._scene=e:t._engine=e:t._scene=EngineStore.LastCreatedScene,t._scene&&(t.uniqueId=t._scene.getUniqueId(),t._scene.addTexture(t),t._engine=t._scene.getEngine()),t._uid=null,t}wN(),VF&&(BN.__proto__=VF),BN.prototype=Object.create(VF&&VF.prototype),BN.prototype.constructor=VF,Object.defineProperty(BN.prototype,"hasAlpha",{get:function(){return this._hasAlpha},set:function(e){var t=this;this._hasAlpha!==e&&(this._hasAlpha=e,this._scene&&this._scene.markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"getAlphaFromRGB",{get:function(){return this._getAlphaFromRGB},set:function(e){var t=this;this._getAlphaFromRGB!==e&&(this._getAlphaFromRGB=e,this._scene&&this._scene.markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"coordinatesIndex",{get:function(){return this._coordinatesIndex},set:function(e){var t=this;this._coordinatesIndex!==e&&(this._coordinatesIndex=e,this._scene&&this._scene.markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"coordinatesMode",{get:function(){return this._coordinatesMode},set:function(e){var t=this;this._coordinatesMode!==e&&(this._coordinatesMode=e,this._scene&&this._scene.markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"wrapU",{get:function(){return this._wrapU},set:function(e){this._wrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"wrapV",{get:function(){return this._wrapV},set:function(e){this._wrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"isCube",{get:function(){return this._texture?this._texture.isCube:this._isCube},set:function(e){this._texture?this._texture.isCube=e:this._isCube=e},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"is3D",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"is2DArray",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"gammaSpace",{get:function(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace},set:function(e){if(this._texture){if(this._texture._gammaSpace===e)return;this._texture._gammaSpace=e}else{if(this._gammaSpace===e)return;this._gammaSpace=e}this._markAllSubMeshesAsTexturesDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"isRGBD",{get:function(){return null!=this._texture&&this._texture._isRGBD},set:function(e){this._texture&&(this._texture._isRGBD=e)},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"noMipmap",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"lodGenerationOffset",{get:function(){return this._texture?this._texture._lodGenerationOffset:0},set:function(e){this._texture&&(this._texture._lodGenerationOffset=e)},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"lodGenerationScale",{get:function(){return this._texture?this._texture._lodGenerationScale:0},set:function(e){this._texture&&(this._texture._lodGenerationScale=e)},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"linearSpecularLOD",{get:function(){return!!this._texture&&this._texture._linearSpecularLOD},set:function(e){this._texture&&(this._texture._linearSpecularLOD=e)},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"irradianceTexture",{get:function(){return this._texture?this._texture._irradianceTexture:null},set:function(e){this._texture&&(this._texture._irradianceTexture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"uid",{get:function(){return!this._uid&&(this._uid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))),this._uid},enumerable:!1,configurable:!0}),BN.prototype.toString=function(){return this.name},BN.prototype.getClassName=function(){return"BaseTexture"},Object.defineProperty(BN.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"isBlocking",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"loadingError",{get:function(){return this._loadingError},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"errorObject",{get:function(){return this._errorObject},enumerable:!1,configurable:!0}),BN.prototype.getScene=function(){return this._scene},BN.prototype._getEngine=function(){return this._engine},BN.prototype.checkTransformsAreIdentical=function(e){return null!==e},BN.prototype.getTextureMatrix=function(){return _Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.IdentityReadOnly},BN.prototype.getReflectionTextureMatrix=function(){return _Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.IdentityReadOnly},BN.prototype.isReadyOrNotBlocking=function(){return!this.isBlocking||this.isReady()||this.loadingError},BN.prototype.scale=function(e){},Object.defineProperty(BN.prototype,"canRescale",{get:function(){return!1},enumerable:!1,configurable:!0}),BN.prototype._getFromCache=function(e,t,r,n,i){var o=this._getEngine();if(!o)return null;for(var s=o._getUseSRGBBuffer(!!i,t),a=o.getLoadedTexturesCache(),u=0;u<a.length;u++){var c=a[u];if((void 0===i||s===c._useSRGBBuffer)&&!(void 0!==n&&n!==c.invertY||c.url!==e||c.generateMipMaps!==!t||r&&r!==c.samplingMode))return c.incrementReferences(),c}return null},BN.prototype._rebuild=function(){},BN.prototype.clone=function(){return null},Object.defineProperty(BN.prototype,"textureType",{get:function(){return this._texture&&void 0!==this._texture.type?this._texture.type:Qd.TEXTURETYPE_UNSIGNED_INT},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"textureFormat",{get:function(){return this._texture&&void 0!==this._texture.format?this._texture.format:Qd.TEXTUREFORMAT_RGBA},enumerable:!1,configurable:!0}),BN.prototype._markAllSubMeshesAsTexturesDirty=function(){var e=this.getScene();e&&e.markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag)},BN.prototype.readPixels=function(e,t,r,n,i,o,s,a,u){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=null),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=Number.MAX_VALUE),void 0===u&&(u=Number.MAX_VALUE),!this._texture)return null;var c=this._getEngine();if(!c)return null;var l=this.getSize(),h=l.width,p=l.height;0!==t&&(h/=Math.pow(2,t),p/=Math.pow(2,t),h=Math.round(h),p=Math.round(p)),a=Math.min(h,a),u=Math.min(p,u);try{return this._texture.isCube?c._readTexturePixels(this._texture,a,u,e,t,r,n,i,o,s):c._readTexturePixels(this._texture,a,u,-1,t,r,n,i,o,s)}catch(e){return null}},BN.prototype._readPixelsSync=function(e,t,r,n,i){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=null),void 0===n&&(n=!0),void 0===i&&(i=!1),!this._texture)return null;var o=this.getSize(),s=o.width,a=o.height,u=this._getEngine();if(!u)return null;0!=t&&(s/=Math.pow(2,t),a/=Math.pow(2,t),s=Math.round(s),a=Math.round(a));try{return this._texture.isCube?u._readTexturePixelsSync(this._texture,s,a,e,t,r,n,i):u._readTexturePixelsSync(this._texture,s,a,-1,t,r,n,i)}catch(e){return null}},Object.defineProperty(BN.prototype,"_lodTextureHigh",{get:function(){return this._texture?this._texture._lodTextureHigh:null},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"_lodTextureMid",{get:function(){return this._texture?this._texture._lodTextureMid:null},enumerable:!1,configurable:!0}),Object.defineProperty(BN.prototype,"_lodTextureLow",{get:function(){return this._texture?this._texture._lodTextureLow:null},enumerable:!1,configurable:!0}),BN.prototype.dispose=function(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene._removePendingData(this);var e=this._scene.textures.indexOf(this);if(e>=0&&this._scene.textures.splice(e,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){var t=this._parentContainer.textures.indexOf(this);t>-1&&this._parentContainer.textures.splice(t,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,_super.prototype.dispose.call(this)},BN.prototype.serialize=function(){if(!this.name)return null;var e=_Misc_decorators__WEBPACK_IMPORTED_MODULE_1__.SerializationHelper.Serialize(this);return _Misc_decorators__WEBPACK_IMPORTED_MODULE_1__.SerializationHelper.AppendSerializedAnimations(this,e),e},BN.WhenAllReady=function(e,t){var r=e.length;if(0!==r)for(var n=0;n<e.length;n++){var i=e[n];if(i.isReady())0==--r&&t();else{var o=i.onLoadObservable;o?o.addOnce((function(){0==--r&&t()})):0==--r&&t()}}else t()},BN._IsScene=function(e){return"Scene"===e.getClassName()},BN.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4;var ON,DN=(ON=!0,function(e,t){var r=ON?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return ON=!1,r}),FN=DN(void 0,(function(){return FN.toString().search("(((.+)+)+)+$").toString().constructor(FN).search("(((.+)+)+)+$")}));function PN(e,t,r,n,i,o,s,a,u,c,l,h,p,f){void 0===i&&(i=PN.TRILINEAR_SAMPLINGMODE),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=!1);var d,A,g,_,m,y,E,x,C,b=this;(b=BN.call(this,t)||this).url=null,b.uOffset=0,b.vOffset=0,b.uScale=1,b.vScale=1,b.uAng=0,b.vAng=0,b.wAng=0,b.uRotationCenter=.5,b.vRotationCenter=.5,b.wRotationCenter=.5,b.homogeneousRotationInUVTransform=!1,b.inspectableCustomProperties=null,b._noMipmap=!1,b._invertY=!1,b._rowGenerationMatrix=null,b._cachedTextureMatrix=null,b._projectionModeMatrix=null,b._t0=null,b._t1=null,b._t2=null,b._cachedUOffset=-1,b._cachedVOffset=-1,b._cachedUScale=0,b._cachedVScale=0,b._cachedUAng=-1,b._cachedVAng=-1,b._cachedWAng=-1,b._cachedProjectionMatrixId=-1,b._cachedURotationCenter=-1,b._cachedVRotationCenter=-1,b._cachedWRotationCenter=-1,b._cachedHomogeneousRotationInUVTransform=!1,b._cachedCoordinatesMode=-1,b._buffer=null,b._deleteBuffer=!1,b._format=null,b._delayedOnLoad=null,b._delayedOnError=null,b.onLoadObservable=new vF,b._isBlocking=!0,b.name=e||"",b.url=e;var I,v=!1,T=null;"object"==typeof r&&null!==r?(I=null!==(d=r.noMipmap)&&void 0!==d&&d,n=null!==(A=r.invertY)&&void 0!==A&&A,i=null!==(g=r.samplingMode)&&void 0!==g?g:PN.TRILINEAR_SAMPLINGMODE,o=null!==(_=r.onLoad)&&void 0!==_?_:null,s=null!==(m=r.onError)&&void 0!==m?m:null,a=null!==(y=r.buffer)&&void 0!==y?y:null,u=null!==(E=r.deleteBuffer)&&void 0!==E&&E,c=r.format,l=r.mimeType,h=r.loaderOptions,p=r.creationFlags,v=null!==(x=r.useSRGBBuffer)&&void 0!==x&&x,T=null!==(C=r.internalTexture)&&void 0!==C?C:null):I=!!r,b._noMipmap=I,b._invertY=void 0!==n&&n,b._initialSamplingMode=i,b._buffer=a,b._deleteBuffer=u,b._mimeType=l,b._loaderOptions=h,b._creationFlags=p,b._useSRGBBuffer=v,b._forcedExtension=f,c&&(b._format=c);var R=b.getScene(),S=b._getEngine();if(!S)return b;S.onBeforeTextureInitObservable.notifyObservers(b);var M=function(){b._texture&&(b._texture._invertVScale&&(b.vScale*=-1,b.vOffset+=1),null!==b._texture._cachedWrapU&&(b.wrapU=b._texture._cachedWrapU,b._texture._cachedWrapU=null),null!==b._texture._cachedWrapV&&(b.wrapV=b._texture._cachedWrapV,b._texture._cachedWrapV=null),null!==b._texture._cachedWrapR&&(b.wrapR=b._texture._cachedWrapR,b._texture._cachedWrapR=null)),b.onLoadObservable.hasObservers()&&b.onLoadObservable.notifyObservers(b),o&&o(),!b.isBlocking&&R&&R.resetCachedMaterial()},w=function(e,t){b._loadingError=!0,b._errorObject={message:e,exception:t},s&&s(e,t),PN.OnTextureLoadErrorObservable.notifyObservers(b)};if(!b.url)return b._delayedOnLoad=M,b._delayedOnError=w,b;if(b._texture=null!=T?T:b._getFromCache(b.url,I,i,b._invertY,v),b._texture)if(b._texture.isReady)_Misc_timingTools__WEBPACK_IMPORTED_MODULE_8__.TimingTools.SetImmediate((function(){return M()}));else{var B=b._texture.onLoadedObservable.add(M);b._texture.onErrorObservable.add((function(e){var t;w(e.message,e.exception),null===(t=b._texture)||void 0===t||t.onLoadedObservable.remove(B)}))}else if(R&&R.useDelayedTextureLoading)b.delayLoadState=Qd.DELAYLOADSTATE_NOTLOADED,b._delayedOnLoad=M,b._delayedOnError=w;else{try{b._texture=S.createTexture(b.url,I,b._invertY,R,i,M,w,b._buffer,void 0,b._format,b._forcedExtension,l,h,p,v)}catch(e){throw w("error loading",e),e}u&&(b._buffer=null)}return b}FN(),BN&&(PN.__proto__=BN),PN.prototype=Object.create(BN&&BN.prototype),PN.prototype.constructor=BN,Object.defineProperty(PN.prototype,"noMipmap",{get:function(){return this._noMipmap},enumerable:!1,configurable:!0}),Object.defineProperty(PN.prototype,"mimeType",{get:function(){return this._mimeType},enumerable:!1,configurable:!0}),Object.defineProperty(PN.prototype,"isBlocking",{get:function(){return this._isBlocking},set:function(e){this._isBlocking=e},enumerable:!1,configurable:!0}),Object.defineProperty(PN.prototype,"invertY",{get:function(){return this._invertY},enumerable:!1,configurable:!0}),PN.prototype.updateURL=function(e,t,r,n){void 0===t&&(t=null),this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag)),(!this.name||this.name.startsWith("data:"))&&(this.name=e),this.url=e,this._buffer=t,this._forcedExtension=n,this.delayLoadState=Qd.DELAYLOADSTATE_NOTLOADED,r&&(this._delayedOnLoad=r),this.delayLoad()},PN.prototype.delayLoad=function(){if(this.delayLoadState===Qd.DELAYLOADSTATE_NOTLOADED){var e=this.getScene();e&&(this.delayLoadState=Qd.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer),this._texture?this._delayedOnLoad&&(this._texture.isReady?_Misc_timingTools__WEBPACK_IMPORTED_MODULE_8__.TimingTools.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=e.getEngine().createTexture(this.url,this._noMipmap,this._invertY,e,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}},PN.prototype._prepareRowForTextureGeneration=function(e,t,r,n){e*=this._cachedUScale,t*=this._cachedVScale,e-=this.uRotationCenter*this._cachedUScale,t-=this.vRotationCenter*this._cachedVScale,r-=this.wRotationCenter,_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Vector3.TransformCoordinatesFromFloatsToRef(e,t,r,this._rowGenerationMatrix,n),n.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,n.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,n.z+=this.wRotationCenter},PN.prototype.checkTransformsAreIdentical=function(e){return null!==e&&this.uOffset===e.uOffset&&this.vOffset===e.vOffset&&this.uScale===e.uScale&&this.vScale===e.vScale&&this.uAng===e.uAng&&this.vAng===e.vAng&&this.wAng===e.wAng},PN.prototype.getTextureMatrix=function(e){var t=this;if(void 0===e&&(e=1),this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*e===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*e,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,(!this._cachedTextureMatrix||!this._rowGenerationMatrix)&&(this._cachedTextureMatrix=_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.Zero(),this._rowGenerationMatrix=new _Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix,this._t0=_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Vector3.Zero(),this._t1=_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Vector3.Zero(),this._t2=_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Vector3.Zero()),_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.TmpVectors.Matrix[0]),_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.TmpVectors.Matrix[1]),_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.ScalingToRef(this._cachedUScale,this._cachedVScale,0,_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.TmpVectors.Matrix[2]),_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.TmpVectors.Matrix[3]),_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.TmpVectors.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.TmpVectors.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.TmpVectors.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.TmpVectors.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));var r=this.getScene();return r?(r.markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})),this._cachedTextureMatrix):this._cachedTextureMatrix},PN.prototype.getReflectionTextureMatrix=function(){var e=this,t=this.getScene();if(!t)return this._cachedTextureMatrix;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.coordinatesMode===this._cachedCoordinatesMode){if(this.coordinatesMode!==PN.PROJECTION_MODE)return this._cachedTextureMatrix;if(this._cachedProjectionMatrixId===t.getProjectionMatrix().updateFlag)return this._cachedTextureMatrix}!this._cachedTextureMatrix&&(this._cachedTextureMatrix=_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.Zero()),!this._projectionModeMatrix&&(this._projectionModeMatrix=_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.Zero());var r=this._cachedCoordinatesMode!==this.coordinatesMode;switch(this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale,this._cachedVScale=this.vScale,this._cachedCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case PN.PLANAR_MODE:_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.IdentityToRef(this._cachedTextureMatrix),this._cachedTextureMatrix[0]=this.uScale,this._cachedTextureMatrix[5]=this.vScale,this._cachedTextureMatrix[12]=this.uOffset,this._cachedTextureMatrix[13]=this.vOffset;break;case PN.PROJECTION_MODE:_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);var n=t.getProjectionMatrix();this._cachedProjectionMatrixId=n.updateFlag,n.multiplyToRef(this._projectionModeMatrix,this._cachedTextureMatrix);break;default:_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.IdentityToRef(this._cachedTextureMatrix)}return r&&t.markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag,(function(t){return-1!==t.getActiveTextures().indexOf(e)})),this._cachedTextureMatrix},PN.prototype.clone=function(){var e=this,t={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return _Misc_decorators__WEBPACK_IMPORTED_MODULE_1__.SerializationHelper.Clone((function(){return new PN(e._texture?e._texture.url:null,e.getScene(),t)}),this)},PN.prototype.serialize=function(){var e=this.name;!PN.SerializeBuffers&&this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");var t=_super.prototype.serialize.call(this);return t?((PN.SerializeBuffers||PN.ForceSerializeBuffers)&&("string"==typeof this._buffer&&"data:"===this._buffer.substr(0,5)?(t.base64String=this._buffer,t.name=t.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?t.base64String="data:image/png;base64,"+(0,_Misc_stringTools__WEBPACK_IMPORTED_MODULE_11__.EncodeArrayBufferToBase64)(this._buffer):(PN.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(t.base64String=!this._engine||this._engine._features.supportSyncTextureRead?(0,_Misc_copyTools__WEBPACK_IMPORTED_MODULE_12__.GenerateBase64StringFromTexture)(this):(0,_Misc_copyTools__WEBPACK_IMPORTED_MODULE_12__.GenerateBase64StringFromTextureAsync)(this))),t.invertY=this._invertY,t.samplingMode=this.samplingMode,t._creationFlags=this._creationFlags,t._useSRGBBuffer=this._useSRGBBuffer,this.name=e,t):null},PN.prototype.getClassName=function(){return"Texture"},PN.prototype.dispose=function(){_super.prototype.dispose.call(this),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null},PN.Parse=function(e,t,r){if(e.customType){var n=_Misc_instantiationTools__WEBPACK_IMPORTED_MODULE_9__.InstantiationTools.Instantiate(e.customType).Parse(e,t,r);return e.samplingMode&&n.updateSamplingMode&&n._samplingMode&&n._samplingMode!==e.samplingMode&&n.updateSamplingMode(e.samplingMode),n}if(e.isCube&&!e.isRenderTarget)return PN._CubeTextureParser(e,t,r);if(!e.name&&!e.isRenderTarget)return null;var i=function(){if(o&&o._texture&&(o._texture._cachedWrapU=null,o._texture._cachedWrapV=null,o._texture._cachedWrapR=null),e.samplingMode){var t=e.samplingMode;o&&o.samplingMode!==t&&o.updateSamplingMode(t)}if(o&&e.animations)for(var r=0;r<e.animations.length;r++){var n=e.animations[r],i=(0,_Misc_typeStore__WEBPACK_IMPORTED_MODULE_6__.GetClass)("BABYLON.Animation");i&&o.animations.push(i.Parse(n))}},o=_Misc_decorators__WEBPACK_IMPORTED_MODULE_1__.SerializationHelper.Parse((function(){var n,o,s,a,u=!0;if(e.noMipmap&&(u=!1),e.mirrorPlane){var c=PN._CreateMirror(e.name,e.renderTargetSize,t,u);return c._waitingRenderList=e.renderList,c.mirrorPlane=_Maths_math_plane__WEBPACK_IMPORTED_MODULE_10__.Plane.FromArray(e.mirrorPlane),i(),c}if(e.isRenderTarget){var l=null;if(e.isCube){if(t.reflectionProbes)for(var h=0;h<t.reflectionProbes.length;h++){var p=t.reflectionProbes[h];if(p.name===e.name)return p.cubeTexture}}else(l=PN._CreateRenderTargetTexture(e.name,e.renderTargetSize,t,u,null!==(n=e._creationFlags)&&void 0!==n?n:0))._waitingRenderList=e.renderList;return i(),l}if(e.base64String)a=PN.CreateFromBase64String(e.base64String,e.name,t,!u,e.invertY,e.samplingMode,i,null!==(o=e._creationFlags)&&void 0!==o?o:0,null!==(s=e._useSRGBBuffer)&&void 0!==s&&s);else{var f=void 0;f=e.name&&e.name.indexOf("://")>0?e.name:r+e.name,e.url&&(e.url.startsWith("data:")||PN.UseSerializedUrlIfAny)&&(f=e.url),a=new PN(f,t,!u,e.invertY,e.samplingMode,i)}return a}),e,t);return o},PN.CreateFromBase64String=function(e,t,r,n,i,o,s,a,u,c){return void 0===o&&(o=PN.TRILINEAR_SAMPLINGMODE),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=Qd.TEXTUREFORMAT_RGBA),new PN("data:"+t,r,n,i,o,s,a,e,!1,u,void 0,void 0,c)},PN.LoadFromDataString=function(e,t,r,n,i,o,s,a,u,c,l){return void 0===n&&(n=!1),void 0===o&&(o=!0),void 0===s&&(s=PN.TRILINEAR_SAMPLINGMODE),void 0===a&&(a=null),void 0===u&&(u=null),void 0===c&&(c=Qd.TEXTUREFORMAT_RGBA),"data:"!==e.substr(0,5)&&(e="data:"+e),new PN(e,r,i,o,s,a,u,t,n,c,void 0,void 0,l)},PN.SerializeBuffers=!0,PN.ForceSerializeBuffers=!1,PN.OnTextureLoadErrorObservable=new vF,PN._CubeTextureParser=function(e,t,r){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_7__._WarnImport)("CubeTexture")},PN._CreateMirror=function(e,t,r,n){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_7__._WarnImport)("MirrorTexture")},PN._CreateRenderTargetTexture=function(e,t,r,n,i){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_7__._WarnImport)("RenderTargetTexture")},PN.NEAREST_SAMPLINGMODE=Qd.TEXTURE_NEAREST_SAMPLINGMODE,PN.NEAREST_NEAREST_MIPLINEAR=Qd.TEXTURE_NEAREST_NEAREST_MIPLINEAR,PN.BILINEAR_SAMPLINGMODE=Qd.TEXTURE_BILINEAR_SAMPLINGMODE,PN.LINEAR_LINEAR_MIPNEAREST=Qd.TEXTURE_LINEAR_LINEAR_MIPNEAREST,PN.TRILINEAR_SAMPLINGMODE=Qd.TEXTURE_TRILINEAR_SAMPLINGMODE,PN.LINEAR_LINEAR_MIPLINEAR=Qd.TEXTURE_LINEAR_LINEAR_MIPLINEAR,PN.NEAREST_NEAREST_MIPNEAREST=Qd.TEXTURE_NEAREST_NEAREST_MIPNEAREST,PN.NEAREST_LINEAR_MIPNEAREST=Qd.TEXTURE_NEAREST_LINEAR_MIPNEAREST,PN.NEAREST_LINEAR_MIPLINEAR=Qd.TEXTURE_NEAREST_LINEAR_MIPLINEAR,PN.NEAREST_LINEAR=Qd.TEXTURE_NEAREST_LINEAR,PN.NEAREST_NEAREST=Qd.TEXTURE_NEAREST_NEAREST,PN.LINEAR_NEAREST_MIPNEAREST=Qd.TEXTURE_LINEAR_NEAREST_MIPNEAREST,PN.LINEAR_NEAREST_MIPLINEAR=Qd.TEXTURE_LINEAR_NEAREST_MIPLINEAR,PN.LINEAR_LINEAR=Qd.TEXTURE_LINEAR_LINEAR,PN.LINEAR_NEAREST=Qd.TEXTURE_LINEAR_NEAREST,PN.EXPLICIT_MODE=Qd.TEXTURE_EXPLICIT_MODE,PN.SPHERICAL_MODE=Qd.TEXTURE_SPHERICAL_MODE,PN.PLANAR_MODE=Qd.TEXTURE_PLANAR_MODE,PN.CUBIC_MODE=Qd.TEXTURE_CUBIC_MODE,PN.PROJECTION_MODE=Qd.TEXTURE_PROJECTION_MODE,PN.SKYBOX_MODE=Qd.TEXTURE_SKYBOX_MODE,PN.INVCUBIC_MODE=Qd.TEXTURE_INVCUBIC_MODE,PN.EQUIRECTANGULAR_MODE=Qd.TEXTURE_EQUIRECTANGULAR_MODE,PN.FIXED_EQUIRECTANGULAR_MODE=Qd.TEXTURE_FIXED_EQUIRECTANGULAR_MODE,PN.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=Qd.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE,PN.CLAMP_ADDRESSMODE=Qd.TEXTURE_CLAMP_ADDRESSMODE,PN.WRAP_ADDRESSMODE=Qd.TEXTURE_WRAP_ADDRESSMODE,PN.MIRROR_ADDRESSMODE=Qd.TEXTURE_MIRROR_ADDRESSMODE;var NN,LN=(NN=!0,function(e,t){var r=NN?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return NN=!1,r}),UN=LN(void 0,(function(){return UN.toString().search("(((.+)+)+)+$").toString().constructor(UN).search("(((.+)+)+)+$")}));function GN(){}UN(),Object.defineProperty(GN,"BaseUrl",{get:function(){return _fileTools__WEBPACK_IMPORTED_MODULE_9__.FileToolsOptions.BaseUrl},set:function(e){_fileTools__WEBPACK_IMPORTED_MODULE_9__.FileToolsOptions.BaseUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(GN,"DefaultRetryStrategy",{get:function(){return _fileTools__WEBPACK_IMPORTED_MODULE_9__.FileToolsOptions.DefaultRetryStrategy},set:function(e){_fileTools__WEBPACK_IMPORTED_MODULE_9__.FileToolsOptions.DefaultRetryStrategy=e},enumerable:!1,configurable:!0}),Object.defineProperty(GN,"CorsBehavior",{get:function(){return _fileTools__WEBPACK_IMPORTED_MODULE_9__.FileToolsOptions.CorsBehavior},set:function(e){_fileTools__WEBPACK_IMPORTED_MODULE_9__.FileToolsOptions.CorsBehavior=e},enumerable:!1,configurable:!0}),Object.defineProperty(GN,"UseFallbackTexture",{get:function(){return _Engines_engineStore__WEBPACK_IMPORTED_MODULE_8__.EngineStore.UseFallbackTexture},set:function(e){_Engines_engineStore__WEBPACK_IMPORTED_MODULE_8__.EngineStore.UseFallbackTexture=e},enumerable:!1,configurable:!0}),Object.defineProperty(GN,"RegisteredExternalClasses",{get:function(){return _instantiationTools__WEBPACK_IMPORTED_MODULE_11__.InstantiationTools.RegisteredExternalClasses},set:function(e){_instantiationTools__WEBPACK_IMPORTED_MODULE_11__.InstantiationTools.RegisteredExternalClasses=e},enumerable:!1,configurable:!0}),Object.defineProperty(GN,"fallbackTexture",{get:function(){return _Engines_engineStore__WEBPACK_IMPORTED_MODULE_8__.EngineStore.FallbackTexture},set:function(e){_Engines_engineStore__WEBPACK_IMPORTED_MODULE_8__.EngineStore.FallbackTexture=e},enumerable:!1,configurable:!0}),GN.FetchToRef=function(e,t,r,n,i,o){var s=4*((Math.abs(e)*r%r|0)+(Math.abs(t)*n%n|0)*r);o.r=i[s]/255,o.g=i[s+1]/255,o.b=i[s+2]/255,o.a=i[s+3]/255},GN.Mix=function(e,t,r){return e*(1-r)+t*r},GN.Instantiate=function(e){return _instantiationTools__WEBPACK_IMPORTED_MODULE_11__.InstantiationTools.Instantiate(e)},GN.SetImmediate=function(e){_timingTools__WEBPACK_IMPORTED_MODULE_10__.TimingTools.SetImmediate(e)},GN.IsExponentOfTwo=function(e){var t=1;do{t*=2}while(t<e);return t===e},GN.FloatRound=function(e){return Math.fround?Math.fround(e):(GN._TmpFloatArray[0]=e,GN._TmpFloatArray[0])},GN.GetFilename=function(e){var t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)},GN.GetFolderPath=function(e,t){void 0===t&&(t=!1);var r=e.lastIndexOf("/");return r<0?t?e:"":e.substring(0,r+1)},GN.ToDegrees=function(e){return 180*e/Math.PI},GN.ToRadians=function(e){return e*Math.PI/180},GN.MakeArray=function(e,t){return!0===t||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null},GN.GetPointerPrefix=function(e){var t="pointer";return(0,_domManagement__WEBPACK_IMPORTED_MODULE_2__.IsWindowObjectExist)()&&!window.PointerEvent&&(t="mouse"),e._badDesktopOS&&!e._badOS&&!(document&&"ontouchend"in document)&&(t="mouse"),t},GN.SetCorsBehavior=function(e,t){t.crossOrigin="anonymous"},GN.CleanUrl=function(e){return e=e.replace(/#/gm,"%23")},Object.defineProperty(GN,"PreprocessUrl",{get:function(){return _fileTools__WEBPACK_IMPORTED_MODULE_9__.FileToolsOptions.PreprocessUrl},set:function(e){_fileTools__WEBPACK_IMPORTED_MODULE_9__.FileToolsOptions.PreprocessUrl=e},enumerable:!1,configurable:!0}),GN.LoadImage=function(e,t,r,n,i,o){return(0,_fileTools__WEBPACK_IMPORTED_MODULE_9__.LoadImage)(e,t,r,n,i,o)},GN.LoadFile=function(e,t,r,n,i,o){return(0,_fileTools__WEBPACK_IMPORTED_MODULE_9__.LoadFile)(e,t,r,n,i,o)},GN.LoadFileAsync=function(e,t){return void 0===t&&(t=!0),new Promise((function(r,n){(0,_fileTools__WEBPACK_IMPORTED_MODULE_9__.LoadFile)(e,(function(e){r(e)}),void 0,void 0,t,(function(e,t){n(t)}))}))},GN.LoadScript=function(e,t,r,n){if("undefined"!=typeof window){var i=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",e),n&&(o.id=n),o.onload=function(){t&&t()},o.onerror=function(t){r&&r("Unable to load script '".concat(e,"'"),t)},i.appendChild(o)}},GN.LoadScriptAsync=function(e){var t=this;return new Promise((function(r,n){t.LoadScript(e,(function(){r()}),(function(e,t){n(t)}))}))},GN.ReadFileAsDataURL=function(e,t,r){var n=new FileReader,i={onCompleteObservable:new _observable__WEBPACK_IMPORTED_MODULE_1__.Observable,abort:function(){return n.abort()}};return n.onloadend=function(){i.onCompleteObservable.notifyObservers(i)},n.onload=function(e){t(e.target.result)},n.onprogress=r,n.readAsDataURL(e),i},GN.ReadFile=function(e,t,r,n,i){return(0,_fileTools__WEBPACK_IMPORTED_MODULE_9__.ReadFile)(e,t,r,n,i)},GN.FileAsURL=function(e){var t=new Blob([e]);return(window.URL||window.webkitURL).createObjectURL(t)},GN.Format=function(e,t){return void 0===t&&(t=2),e.toFixed(t)},GN.DeepCopy=function(e,t,r,n){_deepCopier__WEBPACK_IMPORTED_MODULE_4__.DeepCopier.DeepCopy(e,t,r,n)},GN.IsEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},GN.RegisterTopRootEvents=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];e.addEventListener(n.name,n.handler,!1);try{window.parent&&window.parent.addEventListener(n.name,n.handler,!1)}catch(e){}}},GN.UnregisterTopRootEvents=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];e.removeEventListener(n.name,n.handler);try{e.parent&&e.parent.removeEventListener(n.name,n.handler)}catch(e){}}},GN.DumpFramebuffer=function(e,t,r,n,i,o){return void 0===i&&(i="image/png"),(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this,void 0,void 0,(function(){var s,a;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this,(function(u){switch(u.label){case 0:return[4,r.readPixels(0,0,e,t)];case 1:return s=u.sent(),a=new Uint8Array(s.buffer),GN.DumpData(e,t,a,n,i,o,!0),[2]}}))}))},GN.DumpData=function(e,t,r,n,i,o,s,a,u){void 0===i&&(i="image/png"),void 0===s&&(s=!1),void 0===a&&(a=!1),!GN._ScreenshotCanvas&&(GN._ScreenshotCanvas=document.createElement("canvas")),GN._ScreenshotCanvas.width=e,GN._ScreenshotCanvas.height=t;var c=GN._ScreenshotCanvas.getContext("2d");if(c){if(r instanceof Float32Array){for(var l=new Uint8Array(r.length),h=r.length;h--;){var p=r[h];l[h]=p<0?0:p>1?1:Math.round(255*p)}r=l}var f=c.createImageData(e,t);f.data.set(r),c.putImageData(f,0,0);var d=GN._ScreenshotCanvas;if(s){var A=document.createElement("canvas");A.width=e,A.height=t;var g=A.getContext("2d");if(!g)return;g.translate(0,t),g.scale(1,-1),g.drawImage(GN._ScreenshotCanvas,0,0),d=A}a?GN.ToBlob(d,(function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;n&&n(t)},t.readAsArrayBuffer(e)}),i,u):GN.EncodeScreenshotCanvasData(n,i,o,d,u)}},GN.DumpDataAsync=function(e,t,r,n,i,o,s,a){return void 0===n&&(n="image/png"),void 0===o&&(o=!1),void 0===s&&(s=!1),new Promise((function(u){GN.DumpData(e,t,r,(function(e){return u(e)}),n,i,o,s,a)}))},GN.ToBlob=function(e,t,r,n){void 0===r&&(r="image/png"),!e.toBlob&&(e.toBlob=function(e,t,r){var n=this;setTimeout((function(){for(var i=atob(n.toDataURL(t,r).split(",")[1]),o=i.length,s=new Uint8Array(o),a=0;a<o;a++)s[a]=i.charCodeAt(a);e(new Blob([s]))}))}),e.toBlob((function(e){t(e)}),r,n)},GN.EncodeScreenshotCanvasData=function(e,t,r,n,i){(void 0===t&&(t="image/png"),e)?e((null!=n?n:GN._ScreenshotCanvas).toDataURL(t,i)):this.ToBlob(null!=n?n:GN._ScreenshotCanvas,(function(e){if("download"in document.createElement("a")){if(!r){var t=new Date,n=(t.getFullYear()+"-"+(t.getMonth()+1)).slice(2)+"-"+t.getDate()+"_"+t.getHours()+"-"+("0"+t.getMinutes()).slice(-2);r="screenshot_"+n+".png"}GN.Download(e,r)}else if(e){var i=URL.createObjectURL(e),o=window.open("");if(!o)return;var s=o.document.createElement("img");s.onload=function(){URL.revokeObjectURL(i)},s.src=i,o.document.body.appendChild(s)}}),t,i)},GN.Download=function(e,t){if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(e,t);else{var r=window.URL.createObjectURL(e),n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=r,n.download=t,n.addEventListener("click",(function(){n.parentElement&&n.parentElement.removeChild(n)})),n.click(),window.URL.revokeObjectURL(r)}},GN.BackCompatCameraNoPreventDefault=function(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]},GN.CreateScreenshot=function(e,t,r,n,i){throw(0,_devTools__WEBPACK_IMPORTED_MODULE_6__._WarnImport)("ScreenshotTools")},GN.CreateScreenshotAsync=function(e,t,r,n){throw(0,_devTools__WEBPACK_IMPORTED_MODULE_6__._WarnImport)("ScreenshotTools")},GN.CreateScreenshotUsingRenderTarget=function(e,t,r,n,i,o,s,a){throw(0,_devTools__WEBPACK_IMPORTED_MODULE_6__._WarnImport)("ScreenshotTools")},GN.CreateScreenshotUsingRenderTargetAsync=function(e,t,r,n,i,o,s){throw(0,_devTools__WEBPACK_IMPORTED_MODULE_6__._WarnImport)("ScreenshotTools")},GN.RandomId=function(){return(0,_guid__WEBPACK_IMPORTED_MODULE_12__.RandomGUID)()},GN.IsBase64=function(e){return(0,_fileTools__WEBPACK_IMPORTED_MODULE_9__.IsBase64DataUrl)(e)},GN.DecodeBase64=function(e){return(0,_fileTools__WEBPACK_IMPORTED_MODULE_9__.DecodeBase64UrlToBinary)(e)},Object.defineProperty(GN,"errorsCount",{get:function(){return _logger__WEBPACK_IMPORTED_MODULE_3__.Logger.errorsCount},enumerable:!1,configurable:!0}),GN.Log=function(e){_logger__WEBPACK_IMPORTED_MODULE_3__.Logger.Log(e)},GN.Warn=function(e){_logger__WEBPACK_IMPORTED_MODULE_3__.Logger.Warn(e)},GN.Error=function(e){_logger__WEBPACK_IMPORTED_MODULE_3__.Logger.Error(e)},Object.defineProperty(GN,"LogCache",{get:function(){return _logger__WEBPACK_IMPORTED_MODULE_3__.Logger.LogCache},enumerable:!1,configurable:!0}),GN.ClearLogCache=function(){_logger__WEBPACK_IMPORTED_MODULE_3__.Logger.ClearLogCache()},Object.defineProperty(GN,"LogLevels",{set:function(e){_logger__WEBPACK_IMPORTED_MODULE_3__.Logger.LogLevels=e},enumerable:!1,configurable:!0}),Object.defineProperty(GN,"PerformanceLogLevel",{set:function(e){return(e&GN.PerformanceUserMarkLogLevel)===GN.PerformanceUserMarkLogLevel?(GN.StartPerformanceCounter=GN._StartUserMark,void(GN.EndPerformanceCounter=GN._EndUserMark)):(e&GN.PerformanceConsoleLogLevel)===GN.PerformanceConsoleLogLevel?(GN.StartPerformanceCounter=GN._StartPerformanceConsole,void(GN.EndPerformanceCounter=GN._EndPerformanceConsole)):(GN.StartPerformanceCounter=GN._StartPerformanceCounterDisabled,void(GN.EndPerformanceCounter=GN._EndPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),GN._StartPerformanceCounterDisabled=function(e,t){},GN._EndPerformanceCounterDisabled=function(e,t){},GN._StartUserMark=function(e,t){if(void 0===t&&(t=!0),!GN._Performance){if(!(0,_domManagement__WEBPACK_IMPORTED_MODULE_2__.IsWindowObjectExist)())return;GN._Performance=window.performance}t&&GN._Performance.mark&&GN._Performance.mark(e+"-Begin")},GN._EndUserMark=function(e,t){void 0===t&&(t=!0),t&&GN._Performance.mark&&(GN._Performance.mark(e+"-End"),GN._Performance.measure(e,e+"-Begin",e+"-End"))},GN._StartPerformanceConsole=function(e,t){void 0===t&&(t=!0),t&&(GN._StartUserMark(e,t),console.time&&console.time(e))},GN._EndPerformanceConsole=function(e,t){void 0===t&&(t=!0),t&&(GN._EndUserMark(e,t),console.timeEnd(e))},Object.defineProperty(GN,"Now",{get:function(){return _precisionDate__WEBPACK_IMPORTED_MODULE_5__.PrecisionDate.Now},enumerable:!1,configurable:!0}),GN.GetClassName=function(e,t){void 0===t&&(t=!1);var r=null;if(!t&&e.getClassName)r=e.getClassName();else{if(e instanceof Object)r=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__;!r&&(r=typeof e)}return r},GN.First=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(t(i))return i}return null},GN.getFullClassName=function(e,t){void 0===t&&(t=!1);var r=null,n=null;if(!t&&e.getClassName)r=e.getClassName();else{if(e instanceof Object){var i=t?e:Object.getPrototypeOf(e);r=i.constructor.__bjsclassName__,n=i.constructor.__bjsmoduleName__}!r&&(r=typeof e)}return r?(null!=n?n+".":"")+r:null},GN.DelayAsync=function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},GN.IsSafari=function(){return!!(0,_domManagement__WEBPACK_IMPORTED_MODULE_2__.IsNavigatorAvailable)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)};var QN,kN=(QN=!0,function(e,t){var r=QN?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return QN=!1,r}),zN=kN(void 0,(function(){return zN.toString().search("(((.+)+)+)+$").toString().constructor(zN).search("(((.+)+)+)+$")}));function jN(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A,g){void 0===i&&(i=!0),void 0===o&&(o=Qd.TEXTURETYPE_UNSIGNED_INT),void 0===s&&(s=!1),void 0===a&&(a=PN.TRILINEAR_SAMPLINGMODE),void 0===u&&(u=!0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===h&&(h=Qd.TEXTUREFORMAT_RGBA),void 0===p&&(p=!1),void 0===A&&(A=!1),void 0===g&&(g=!1);var _,m=this;if((m=PN.call(this,null,r,!n,void 0,a,void 0,void 0,void 0,void 0,h)||this).renderParticles=!0,m.renderSprites=!1,m.ignoreCameraViewport=!1,m.onBeforeBindObservable=new vF,m.onAfterUnbindObservable=new vF,m.onBeforeRenderObservable=new vF,m.onAfterRenderObservable=new vF,m.onClearObservable=new vF,m.onResizeObservable=new vF,m._cleared=!1,m.skipInitialClear=!1,m._currentRefreshId=-1,m._refreshRate=1,m._samples=1,m._canRescale=!0,m._renderTarget=null,m.boundingBoxPosition=_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Vector3.Zero(),!(r=m.getScene()))return m;var y=m.getScene().getEngine();return m._coordinatesMode=PN.PROJECTION_MODE,m.renderList=new Array,m.name=e,m.isRenderTarget=!0,m._initialSizeParameter=t,m._renderPassIds=[],m._isCubeData=s,m._processSizeParameter(t),m.renderPassId=m._renderPassIds[0],m._resizeObserver=y.onResizeObservable.add((function(){})),m._generateMipMaps=!!n,m._doNotChangeAspectRatio=i,m._renderingManager=new _Rendering_renderingManager__WEBPACK_IMPORTED_MODULE_6__.RenderingManager(r),m._renderingManager._useSceneAutoClearSetup=!0,l||(m._renderTargetOptions={generateMipMaps:n,type:o,format:null!==(_=m._format)&&void 0!==_?_:void 0,samplingMode:m.samplingMode,generateDepthBuffer:u,generateStencilBuffer:c,samples:f,creationFlags:d,noColorTarget:A,useSRGBBuffer:g},m.samplingMode===PN.NEAREST_SAMPLINGMODE&&(m.wrapU=PN.CLAMP_ADDRESSMODE,m.wrapV=PN.CLAMP_ADDRESSMODE),!p&&(s?(m._renderTarget=r.getEngine().createRenderTargetCubeTexture(m.getRenderSize(),m._renderTargetOptions),m.coordinatesMode=PN.INVCUBIC_MODE,m._textureMatrix=_Maths_math_vector__WEBPACK_IMPORTED_MODULE_3__.Matrix.Identity()):m._renderTarget=r.getEngine().createRenderTargetTexture(m._size,m._renderTargetOptions),m._texture=m._renderTarget.texture,void 0!==f&&(m.samples=f))),m}zN(),PN&&(jN.__proto__=PN),jN.prototype=Object.create(PN&&PN.prototype),jN.prototype.constructor=PN,Object.defineProperty(jN.prototype,"renderList",{get:function(){return this._renderList},set:function(e){this._renderList=e,this._renderList&&this._hookArray(this._renderList)},enumerable:!1,configurable:!0}),jN.prototype._hookArray=function(e){var t=this,r=e.push;e.push=function(){for(var n,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=0===e.length,a=r.apply(e,i);return s&&(null===(n=t.getScene())||void 0===n||n.meshes.forEach((function(e){e._markSubMeshesAsLightDirty()}))),a};var n=e.splice;e.splice=function(r,i){var o,s=n.apply(e,[r,i]);return 0===e.length&&(null===(o=t.getScene())||void 0===o||o.meshes.forEach((function(e){e._markSubMeshesAsLightDirty()}))),s}},Object.defineProperty(jN.prototype,"postProcesses",{get:function(){return this._postProcesses},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"_prePassEnabled",{get:function(){return!!this._prePassRenderTarget&&this._prePassRenderTarget.enabled},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"onAfterUnbind",{set:function(e){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"onBeforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"onAfterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"onClear",{set:function(e){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver),this._onClearObserver=this.onClearObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"renderPassIds",{get:function(){return this._renderPassIds},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"currentRefreshId",{get:function(){return this._currentRefreshId},enumerable:!1,configurable:!0}),jN.prototype.setMaterialForRendering=function(e,t){var r;r=Array.isArray(e)?e:[e];for(var n=0;n<r.length;++n)for(var i=0;i<this._renderPassIds.length;++i)r[n].setMaterialForRenderPass(this._renderPassIds[i],void 0!==t?Array.isArray(t)?t[i]:t:void 0)},Object.defineProperty(jN.prototype,"renderTargetOptions",{get:function(){return this._renderTargetOptions},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"renderTarget",{get:function(){return this._renderTarget},enumerable:!1,configurable:!0}),jN.prototype._onRatioRescale=function(){this._sizeRatio&&this.resize(this._initialSizeParameter)},Object.defineProperty(jN.prototype,"boundingBoxSize",{get:function(){return this._boundingBoxSize},set:function(e){if(!this._boundingBoxSize||!this._boundingBoxSize.equals(e)){this._boundingBoxSize=e;var t=this.getScene();t&&t.markAllMaterialsAsDirty(Qd.MATERIAL_TextureDirtyFlag)}},enumerable:!1,configurable:!0}),Object.defineProperty(jN.prototype,"depthStencilTexture",{get:function(){var e,t;return null!==(t=null===(e=this._renderTarget)||void 0===e?void 0:e._depthStencilTexture)&&void 0!==t?t:null},enumerable:!1,configurable:!0}),jN.prototype.createDepthStencilTexture=function(e,t,r,n,i){var o;void 0===e&&(e=0),void 0===t&&(t=!0),void 0===r&&(r=!1),void 0===n&&(n=1),void 0===i&&(i=Qd.TEXTUREFORMAT_DEPTH32_FLOAT),null===(o=this._renderTarget)||void 0===o||o.createDepthStencilTexture(e,t,r,n,i)},jN.prototype._releaseRenderPassId=function(){if(this._scene)for(var e=this._scene.getEngine(),t=0;t<this._renderPassIds.length;++t)e.releaseRenderPassId(this._renderPassIds[t]);this._renderPassIds=[]},jN.prototype._createRenderPassId=function(){this._releaseRenderPassId();for(var e=this._scene.getEngine(),t=this._isCubeData?6:this.getRenderLayers()||1,r=0;r<t;++r)this._renderPassIds[r]=e.createRenderPassId("RenderTargetTexture - ".concat(this.name,"#").concat(r))},jN.prototype._processSizeParameter=function(e){if(e.ratio){this._sizeRatio=e.ratio;var t=this._getEngine();this._size={width:this._bestReflectionRenderTargetDimension(t.getRenderWidth(),this._sizeRatio),height:this._bestReflectionRenderTargetDimension(t.getRenderHeight(),this._sizeRatio)}}else this._size=e;this._createRenderPassId()},Object.defineProperty(jN.prototype,"samples",{get:function(){var e,t;return null!==(t=null===(e=this._renderTarget)||void 0===e?void 0:e.samples)&&void 0!==t?t:this._samples},set:function(e){this._renderTarget&&(this._samples=this._renderTarget.setSamples(e))},enumerable:!1,configurable:!0}),jN.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},Object.defineProperty(jN.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(e){this._refreshRate=e,this.resetRefreshCounter()},enumerable:!1,configurable:!0}),jN.prototype.addPostProcess=function(e){if(!this._postProcessManager){var t=this.getScene();if(!t)return;this._postProcessManager=new _PostProcesses_postProcessManager__WEBPACK_IMPORTED_MODULE_5__.PostProcessManager(t),this._postProcesses=new Array}this._postProcesses.push(e),this._postProcesses[0].autoClear=!1},jN.prototype.clearPostProcesses=function(e){if(void 0===e&&(e=!1),this._postProcesses){if(e)for(var t=0,r=this._postProcesses;t<r.length;t++){r[t].dispose()}this._postProcesses=[]}},jN.prototype.removePostProcess=function(e){if(this._postProcesses){var t=this._postProcesses.indexOf(e);-1!==t&&(this._postProcesses.splice(t,1),this._postProcesses.length>0&&(this._postProcesses[0].autoClear=!1))}},jN.prototype._shouldRender=function(){return-1===this._currentRefreshId||this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)},jN.prototype.getRenderSize=function(){return this.getRenderWidth()},jN.prototype.getRenderWidth=function(){return this._size.width?this._size.width:this._size},jN.prototype.getRenderHeight=function(){return this._size.width?this._size.height:this._size},jN.prototype.getRenderLayers=function(){var e=this._size.layers;return e||0},jN.prototype.disableRescaling=function(){this._canRescale=!1},Object.defineProperty(jN.prototype,"canRescale",{get:function(){return this._canRescale},enumerable:!1,configurable:!0}),jN.prototype.scale=function(e){var t=Math.max(1,this.getRenderSize()*e);this.resize(t)},jN.prototype.getReflectionTextureMatrix=function(){return this.isCube?this._textureMatrix:_super.prototype.getReflectionTextureMatrix.call(this)},jN.prototype.resize=function(e){var t,r=this.isCube;null===(t=this._renderTarget)||void 0===t||t.dispose(),this._renderTarget=null;var n=this.getScene();n&&(this._processSizeParameter(e),this._renderTarget=r?n.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):n.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,void 0!==this._renderTargetOptions.samples&&(this.samples=this._renderTargetOptions.samples),this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this))},jN.prototype.render=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this._render(e,t)},jN.prototype.isReadyForRendering=function(){return this._render(!1,!1,!0)},jN.prototype._render=function(e,t,r){var n;void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===r&&(r=!1);var i=this.getScene();if(!i)return r;var o=i.getEngine();if(void 0!==this.useCameraPostProcesses&&(e=this.useCameraPostProcesses),this._waitingRenderList){this.renderList=[];for(var s=0;s<this._waitingRenderList.length;s++){var a=this._waitingRenderList[s];(l=i.getMeshById(a))&&this.renderList.push(l)}this._waitingRenderList=void 0}if(this.renderListPredicate){this.renderList?this.renderList.length=0:this.renderList=[];var u=this.getScene();if(!u)return r;var c=u.meshes;for(s=0;s<c.length;s++){var l=c[s];this.renderListPredicate(l)&&this.renderList.push(l)}}var h=o.currentRenderPassId;this.onBeforeBindObservable.notifyObservers(this);var p=null!==(n=this.activeCamera)&&void 0!==n?n:i.activeCamera;p&&(p!==i.activeCamera&&i.setTransformMatrix(p.getViewMatrix(),p.getProjectionMatrix(!0)),o.setViewport(p.viewport,this.getRenderWidth(),this.getRenderHeight())),this._defaultRenderListPrepared=!1;var f=r;if(r){!i.getViewMatrix()&&i.updateTransformMatrix();var d=this.is2DArray?this.getRenderLayers():this.isCube?6:1;for(y=0;y<d&&f;y++){var A=null,g=this.renderList?this.renderList:i.getActiveMeshes().data,_=this.renderList?this.renderList.length:i.getActiveMeshes().length;o.currentRenderPassId=this._renderPassIds[y],this.onBeforeRenderObservable.notifyObservers(y),this.getCustomRenderList&&(A=this.getCustomRenderList(y,g,_)),!A&&(A=g),!this._doNotChangeAspectRatio&&i.updateTransformMatrix(!0);for(var m=0;m<A.length&&f;++m){if((l=A[m]).isEnabled()&&!l.isBlocked&&l.isVisible&&l.subMeshes)if(this.customIsReadyFunction){if(!this.customIsReadyFunction(l,this.refreshRate)){f=!1;break}}else if(!l.isReady(!0)){f=!1;break}}this.onAfterRenderObservable.notifyObservers(y)}}else if(this.is2DArray)for(var y=0;y<this.getRenderLayers();y++)this._renderToTarget(0,e,t,y,p),i.incrementRenderId(),i.resetCachedMaterial();else if(this.isCube)for(var E=0;E<6;E++)this._renderToTarget(E,e,t,void 0,p),i.incrementRenderId(),i.resetCachedMaterial();else this._renderToTarget(0,e,t,void 0,p);return this.onAfterUnbindObservable.notifyObservers(this),o.currentRenderPassId=h,i.activeCamera&&((i.getEngine().scenes.length>1||this.activeCamera&&this.activeCamera!==i.activeCamera)&&i.setTransformMatrix(i.activeCamera.getViewMatrix(),i.activeCamera.getProjectionMatrix(!0)),o.setViewport(i.activeCamera.viewport)),i.resetCachedMaterial(),f},jN.prototype._bestReflectionRenderTargetDimension=function(e,t){var r=e*t,n=_Engines_engine__WEBPACK_IMPORTED_MODULE_10__.Engine.NearestPOT(r+16384/(128+r));return Math.min(_Engines_engine__WEBPACK_IMPORTED_MODULE_10__.Engine.FloorPOT(e),n)},jN.prototype._prepareRenderingManager=function(e,t,r,n){var i=this.getScene();if(i){this._renderingManager.reset();for(var o=i.getRenderId(),s=0;s<t;s++){var a=e[s];if(a&&!a.isBlocked){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(a,this.refreshRate)){this.resetRefreshCounter();continue}}else if(!a.isReady(0===this.refreshRate)){this.resetRefreshCounter();continue}if(!a._internalAbstractMeshDataInfo._currentLODIsUpToDate&&i.activeCamera&&(a._internalAbstractMeshDataInfo._currentLOD=i.customLODSelector?i.customLODSelector(a,this.activeCamera||i.activeCamera):a.getLOD(this.activeCamera||i.activeCamera),a._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0),!a._internalAbstractMeshDataInfo._currentLOD)continue;var u=a._internalAbstractMeshDataInfo._currentLOD;u._preActivateForIntermediateRendering(o);var c=void 0;if(c=!(!n||!r)&&!(a.layerMask&r.layerMask),a.isEnabled()&&a.isVisible&&a.subMeshes&&!c&&(u!==a&&u._activate(o,!0),a._activate(o,!0)&&a.subMeshes.length)){a.isAnInstance?a._internalAbstractMeshDataInfo._actAsRegularMesh&&(u=a):u._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!1,u._internalAbstractMeshDataInfo._isActiveIntermediate=!0;for(var l=0;l<u.subMeshes.length;l++){var h=u.subMeshes[l];this._renderingManager.dispatch(h,u)}}}}for(var p=0;p<i.particleSystems.length;p++){var f=i.particleSystems[p],d=f.emitter;f.isStarted()&&d&&d.position&&d.isEnabled()&&(e.indexOf(d)>=0&&this._renderingManager.dispatchParticles(f))}}},jN.prototype._bindFrameBuffer=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var r=this.getScene();if(r){var n=r.getEngine();this._renderTarget&&n.bindFramebuffer(this._renderTarget,this.isCube?e:void 0,void 0,void 0,this.ignoreCameraViewport,0,t)}},jN.prototype._unbindFrameBuffer=function(e,t){var r=this;this._renderTarget&&e.unBindFramebuffer(this._renderTarget,this.isCube,(function(){r.onAfterRenderObservable.notifyObservers(t)}))},jN.prototype._prepareFrame=function(e,t,r,n){this._postProcessManager?!this._prePassEnabled&&this._postProcessManager._prepareFrame(this._texture,this._postProcesses):(!n||!e.postProcessManager._prepareFrame(this._texture))&&this._bindFrameBuffer(t,r)},jN.prototype._renderToTarget=function(e,t,r,n,i){var o,s,a,u,c,l;void 0===n&&(n=0),void 0===i&&(i=null);var h=this.getScene();if(h){var p=h.getEngine();if(null===(o=p._debugPushGroup)||void 0===o||o.call(p,"render to face #".concat(e," layer #").concat(n),1),this._prepareFrame(h,e,n,t),this.is2DArray?(p.currentRenderPassId=this._renderPassIds[n],this.onBeforeRenderObservable.notifyObservers(n)):(p.currentRenderPassId=this._renderPassIds[e],this.onBeforeRenderObservable.notifyObservers(e)),p.snapshotRendering&&p.snapshotRenderingMode===Qd.SNAPSHOTRENDERING_FAST)this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(p):!this.skipInitialClear&&p.clear(this.clearColor||h.clearColor,!0,!0,!0);else{var f=null,d=this.renderList?this.renderList:h.getActiveMeshes().data,A=this.renderList?this.renderList.length:h.getActiveMeshes().length;this.getCustomRenderList&&(f=this.getCustomRenderList(this.is2DArray?n:e,d,A)),f?this._prepareRenderingManager(f,f.length,i,!1):(!this._defaultRenderListPrepared&&(this._prepareRenderingManager(d,A,i,!this.renderList),this._defaultRenderListPrepared=!0),f=d);for(var g=0,_=h._beforeRenderTargetClearStage;g<_.length;g++){_[g].action(this,e,n)}this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(p):!this.skipInitialClear&&p.clear(this.clearColor||h.clearColor,!0,!0,!0),!this._doNotChangeAspectRatio&&h.updateTransformMatrix(!0);for(var m=0,y=h._beforeRenderTargetDrawStage;m<y.length;m++){y[m].action(this,e,n)}this._renderingManager.render(this.customRenderFunction,f,this.renderParticles,this.renderSprites);for(var E=0,x=h._afterRenderTargetDrawStage;E<x.length;E++){x[E].action(this,e,n)}var C=null!==(a=null===(s=this._texture)||void 0===s?void 0:s.generateMipMaps)&&void 0!==a&&a;this._texture&&(this._texture.generateMipMaps=!1),this._postProcessManager?this._postProcessManager._finalizeFrame(!1,null!==(u=this._renderTarget)&&void 0!==u?u:void 0,e,this._postProcesses,this.ignoreCameraViewport):t&&h.postProcessManager._finalizeFrame(!1,null!==(c=this._renderTarget)&&void 0!==c?c:void 0,e),this._texture&&(this._texture.generateMipMaps=C),!this._doNotChangeAspectRatio&&h.updateTransformMatrix(!0),r&&GN.DumpFramebuffer(this.getRenderWidth(),this.getRenderHeight(),p)}this._unbindFrameBuffer(p,e),this._texture&&this.isCube&&5===e&&p.generateMipMapsForCubemap(this._texture),null===(l=p._debugPopGroup)||void 0===l||l.call(p,1)}},jN.prototype.setRenderingOrder=function(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=null),this._renderingManager.setRenderingOrder(e,t,r,n)},jN.prototype.setRenderingAutoClearDepthStencil=function(e,t){this._renderingManager.setRenderingAutoClearDepthStencil(e,t),this._renderingManager._useSceneAutoClearSetup=!1},jN.prototype.clone=function(){var e=this.getSize(),t=new jN(this.name,e,this.getScene(),this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer,void 0,this._renderTargetOptions.format,void 0,this._renderTargetOptions.samples);return t.hasAlpha=this.hasAlpha,t.level=this.level,t.coordinatesMode=this.coordinatesMode,this.renderList&&(t.renderList=this.renderList.slice(0)),t},jN.prototype.serialize=function(){if(!this.name)return null;var e=_super.prototype.serialize.call(this);if(e.renderTargetSize=this.getRenderSize(),e.renderList=[],this.renderList)for(var t=0;t<this.renderList.length;t++)e.renderList.push(this.renderList[t].id);return e},jN.prototype.disposeFramebufferObjects=function(){var e;null===(e=this._renderTarget)||void 0===e||e.dispose(!0)},jN.prototype.releaseInternalTexture=function(){var e;null===(e=this._renderTarget)||void 0===e||e.releaseTextures(),this._texture=null},jN.prototype.dispose=function(){var e;this.onResizeObservable.clear(),this.onClearObservable.clear(),this.onAfterRenderObservable.clear(),this.onAfterUnbindObservable.clear(),this.onBeforeBindObservable.clear(),this.onBeforeRenderObservable.clear(),this._postProcessManager&&(this._postProcessManager.dispose(),this._postProcessManager=null),this._prePassRenderTarget&&this._prePassRenderTarget.dispose(),this._releaseRenderPassId(),this.clearPostProcesses(!0),this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null),this.renderList=null;var t=this.getScene();if(t){var r=t.customRenderTargets.indexOf(this);r>=0&&t.customRenderTargets.splice(r,1);for(var n=0,i=t.cameras;n<i.length;n++){var o=i[n];(r=o.customRenderTargets.indexOf(this))>=0&&o.customRenderTargets.splice(r,1)}null===(e=this._renderTarget)||void 0===e||e.dispose(),this._renderTarget=null,this._texture=null,_super.prototype.dispose.call(this)}},jN.prototype._rebuild=function(){this.refreshRate===jN.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=jN.REFRESHRATE_RENDER_ONCE),this._postProcessManager&&this._postProcessManager._rebuild()},jN.prototype.freeRenderingGroups=function(){this._renderingManager&&this._renderingManager.freeRenderingGroups()},jN.prototype.getViewCount=function(){return 1},jN.REFRESHRATE_RENDER_ONCE=0,jN.REFRESHRATE_RENDER_ONEVERYFRAME=1,jN.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2,PN._CreateRenderTargetTexture=function(e,t,r,n,i){return new jN(e,t,r,n)};var HN,qN,VN,YN=(HN=!0,function(e,t){var r=HN?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return HN=!1,r}),XN=YN(void 0,(function(){return XN.toString().search("(((.+)+)+)+$").toString().constructor(XN).search("(((.+)+)+)+$")}));XN();var WN,KN={CreateResizedCopy:function(e,t,r,n){void 0===n&&(n=!0);var i=e.getScene(),o=i.getEngine(),s=new jN("resized"+e.name,{width:t,height:r},i,!e.noMipmap,!0,e._texture.type,!1,e.samplingMode,!1);s.wrapU=e.wrapU,s.wrapV=e.wrapV,s.uOffset=e.uOffset,s.vOffset=e.vOffset,s.uScale=e.uScale,s.vScale=e.vScale,s.uAng=e.uAng,s.vAng=e.vAng,s.wAng=e.wAng,s.coordinatesIndex=e.coordinatesIndex,s.level=e.level,s.anisotropicFilteringLevel=e.anisotropicFilteringLevel,s._texture.isReady=!1,e.wrapU=PN.CLAMP_ADDRESSMODE,e.wrapV=PN.CLAMP_ADDRESSMODE;var a=new _PostProcesses_passPostProcess__WEBPACK_IMPORTED_MODULE_2__.PassPostProcess("pass",1,null,n?PN.BILINEAR_SAMPLINGMODE:PN.NEAREST_SAMPLINGMODE,o,!1,Qd.TEXTURETYPE_UNSIGNED_INT);return a.externalTextureSamplerBinding=!0,a.getEffect().executeWhenCompiled((function(){a.onApply=function(t){t.setTexture("textureSampler",e)};var t=s.renderTarget;t&&(i.postProcessManager.directRender([a],t),o.unBindFramebuffer(t),s.disposeFramebufferObjects(),a.dispose(),s.getInternalTexture().isReady=!0)})),s},ApplyPostProcess:function(e,t,r,n,i,o){var s=t.getEngine();return t.isReady=!1,i=null!=i?i:t.samplingMode,n=null!=n?n:t.type,o=null!=o?o:t.format,-1===n&&(n=Qd.TEXTURETYPE_UNSIGNED_BYTE),new Promise((function(a){var u=new _PostProcesses_postProcess__WEBPACK_IMPORTED_MODULE_4__.PostProcess("postprocess",e,null,null,1,null,i,s,!1,void 0,n,void 0,null,!1,o);u.externalTextureSamplerBinding=!0;var c=s.createRenderTargetTexture({width:t.width,height:t.height},{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:i,type:n,format:o});u.getEffect().executeWhenCompiled((function(){u.onApply=function(e){e._bindTexture("textureSampler",t),e.setFloat2("scale",1,1)},r.postProcessManager.directRender([u],c,!0),s.restoreDefaultFramebuffer(),s._releaseTexture(t),u&&u.dispose(),c._swapAndDie(t),t.type=n,t.format=Qd.TEXTUREFORMAT_RGBA,t.isReady=!0,a(t)}))}))},ToHalfFloat:function(e){!qN&&(qN=new Float32Array(1),VN=new Int32Array(qN.buffer)),qN[0]=e;var t=VN[0],r=t>>16&32768,n=t>>12&2047,i=t>>23&255;return i<103?r:i>142?(r|=31744,r|=(255==i?0:1)&&8388607&t):i<113?r|=((n|=2048)>>114-i)+(n>>113-i&1):(r|=i-112<<10|n>>1,r+=1&n)},FromHalfFloat:function(e){var t=(32768&e)>>15,r=(31744&e)>>10,n=1023&e;return 0===r?(t?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):31==r?n?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}},$N=(WN=!0,function(e,t){var r=WN?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return WN=!1,r}),JN=$N(void 0,(function(){return JN.toString().search("(((.+)+)+)+$").toString().constructor(JN).search("(((.+)+)+)+$")}));function ZN(e){void 0===e&&(e=!0),this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,e&&this.reset()}JN(),Object.defineProperty(ZN.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty},enumerable:!1,configurable:!0}),Object.defineProperty(ZN.prototype,"zOffset",{get:function(){return this._zOffset},set:function(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ZN.prototype,"zOffsetUnits",{get:function(){return this._zOffsetUnits},set:function(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ZN.prototype,"cullFace",{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ZN.prototype,"cull",{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ZN.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ZN.prototype,"depthMask",{get:function(){return this._depthMask},set:function(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ZN.prototype,"depthTest",{get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ZN.prototype,"frontFace",{get:function(){return this._frontFace},set:function(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)},enumerable:!1,configurable:!0}),ZN.prototype.reset=function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1},ZN.prototype.apply=function(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))};var eL,tL=(eL=!0,function(e,t){var r=eL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return eL=!1,r}),rL=tL(void 0,(function(){return rL.toString().search("(((.+)+)+)+$").toString().constructor(rL).search("(((.+)+)+)+$")}));function nL(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}rL(),Object.defineProperty(nL.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty},enumerable:!1,configurable:!0}),Object.defineProperty(nL.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)},enumerable:!1,configurable:!0}),nL.prototype.setAlphaBlendConstants=function(e,t,r,n){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===r&&this._blendConstants[3]===n||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=r,this._blendConstants[3]=n,this._isBlendConstantsDirty=!0)},nL.prototype.setAlphaBlendFunctionParameters=function(e,t,r,n){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===r&&this._blendFunctionParameters[3]===n||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=r,this._blendFunctionParameters[3]=n,this._isBlendFunctionParametersDirty=!0)},nL.prototype.setAlphaEquationParameters=function(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)},nL.prototype.reset=function(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1},nL.prototype.apply=function(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))};var iL,oL=(iL=!0,function(e,t){var r=iL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return iL=!1,r}),sL=oL(void 0,(function(){return sL.toString().search("(((.+)+)+)+$").toString().constructor(sL).search("(((.+)+)+)+$")}));function aL(){}sL(),aL._CheckLimit=function(e,t){var r=aL._LogLimitOutputs[e];return r?r.current++:(r={limit:t,current:1},aL._LogLimitOutputs[e]=r),r.current<=r.limit},aL._GenerateLimitMessage=function(e,t){var r=aL._LogLimitOutputs[e];if(r&&aL.MessageLimitReached&&r.current===r.limit)switch(t){case 0:aL.Log(aL.MessageLimitReached.replace(/%LIMIT%/g,""+r.limit).replace(/%TYPE%/g,"log"));break;case 1:aL.Warn(aL.MessageLimitReached.replace(/%LIMIT%/g,""+r.limit).replace(/%TYPE%/g,"warning"));break;case 2:aL.Error(aL.MessageLimitReached.replace(/%LIMIT%/g,""+r.limit).replace(/%TYPE%/g,"error"))}},aL._AddLogEntry=function(e){aL._LogCache=e+aL._LogCache,aL.OnNewCacheEntry&&aL.OnNewCacheEntry(e)},aL._FormatMessage=function(e){var t=function(e){return e<10?"0"+e:""+e},r=new Date;return"["+t(r.getHours())+":"+t(r.getMinutes())+":"+t(r.getSeconds())+"]: "+e},aL._LogDisabled=function(e,t){},aL._LogEnabled=function(e,t){if(void 0===t||aL._CheckLimit(e,t)){var r=aL._FormatMessage(e);console.log("BJS - "+r);var n="<div style='color:white'>"+r+"</div><br>";aL._AddLogEntry(n),aL._GenerateLimitMessage(e,0)}},aL._WarnDisabled=function(e,t){},aL._WarnEnabled=function(e,t){if(void 0===t||aL._CheckLimit(e,t)){var r=aL._FormatMessage(e);console.warn("BJS - "+r);var n="<div style='color:orange'>"+e+"</div><br>";aL._AddLogEntry(n),aL._GenerateLimitMessage(e,1)}},aL._ErrorDisabled=function(e,t){},aL._ErrorEnabled=function(e,t){if(void 0===t||aL._CheckLimit(e,t)){var r=aL._FormatMessage(e);aL.errorsCount++,console.error("BJS - "+r);var n="<div style='color:red'>"+r+"</div><br>";aL._AddLogEntry(n),aL._GenerateLimitMessage(e,2)}},Object.defineProperty(aL,"LogCache",{get:function(){return aL._LogCache},enumerable:!1,configurable:!0}),aL.ClearLogCache=function(){aL._LogCache="",aL._LogLimitOutputs={},aL.errorsCount=0},Object.defineProperty(aL,"LogLevels",{set:function(e){(e&aL.MessageLogLevel)===aL.MessageLogLevel?aL.Log=aL._LogEnabled:aL.Log=aL._LogDisabled,(e&aL.WarningLogLevel)===aL.WarningLogLevel?aL.Warn=aL._WarnEnabled:aL.Warn=aL._WarnDisabled,(e&aL.ErrorLogLevel)===aL.ErrorLogLevel?aL.Error=aL._ErrorEnabled:aL.Error=aL._ErrorDisabled},enumerable:!1,configurable:!0}),aL.NoneLogLevel=0,aL.MessageLogLevel=1,aL.WarningLogLevel=2,aL.ErrorLogLevel=4,aL.AllLogLevel=7,aL.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",aL._LogCache="",aL._LogLimitOutputs={},aL.errorsCount=0,aL.Log=aL._LogEnabled,aL.Warn=aL._WarnEnabled,aL.Error=aL._ErrorEnabled;var uL,cL=(uL=!0,function(e,t){var r=uL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return uL=!1,r}),lL=cL(void 0,(function(){return lL.toString().search("(((.+)+)+)+$").toString().constructor(lL).search("(((.+)+)+)+$")}));function hL(){return"undefined"!=typeof window}function pL(){return"undefined"!=typeof document}lL();var fL,dL=(fL=!0,function(e,t){var r=fL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return fL=!1,r}),AL=dL(void 0,(function(){return AL.toString().search("(((.+)+)+)+$").toString().constructor(AL).search("(((.+)+)+)+$")}));function gL(){}AL(),gL.SetMatrixPrecision=function(e){if(gL.MatrixTrackPrecisionChange=!1,e&&!gL.MatrixUse64Bits&&gL.MatrixTrackedMatrices)for(var t=0;t<gL.MatrixTrackedMatrices.length;++t){var r=gL.MatrixTrackedMatrices[t],n=r._m;r._m=new Array(16);for(var i=0;i<16;++i)r._m[i]=n[i]}gL.MatrixUse64Bits=e,gL.MatrixCurrentType=gL.MatrixUse64Bits?Array:Float32Array,gL.MatrixTrackedMatrices=null},gL.MatrixUse64Bits=!1,gL.MatrixTrackPrecisionChange=!0,gL.MatrixCurrentType=Float32Array,gL.MatrixTrackedMatrices=[];var _L,mL=(_L=!0,function(e,t){var r=_L?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return _L=!1,r}),yL=mL(void 0,(function(){return yL.toString().search("(((.+)+)+)+$").toString().constructor(yL).search("(((.+)+)+)+$")}));function EL(e){void 0===e&&(e=!0),this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,e&&this.reset()}yL(),Object.defineProperty(EL.prototype,"isDirty",{get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty},enumerable:!1,configurable:!0}),Object.defineProperty(EL.prototype,"func",{get:function(){return this._func},set:function(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(EL.prototype,"funcRef",{get:function(){return this._funcRef},set:function(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(EL.prototype,"funcMask",{get:function(){return this._funcMask},set:function(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(EL.prototype,"opStencilFail",{get:function(){return this._opStencilFail},set:function(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(EL.prototype,"opDepthFail",{get:function(){return this._opDepthFail},set:function(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(EL.prototype,"opStencilDepthPass",{get:function(){return this._opStencilDepthPass},set:function(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(EL.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(EL.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)},enumerable:!1,configurable:!0}),EL.prototype.reset=function(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0},EL.prototype.apply=function(e){var t;if(e){var r=!this.useStencilGlobalOnly&&!!(null===(t=this.stencilMaterial)||void 0===t?void 0:t.enabled);this.enabled=r?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=r?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=r?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=r?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=r?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=r?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=r?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=r?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}};var xL=function(){var e,t=(e=!0,function(t,r){var n=e?function(){if(r){var e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}),r=t(this,(function(){return r.toString().search("(((.+)+)+)+$").toString().constructor(r).search("(((.+)+)+)+$")}));return r(),function(){}}();function CL(e,t,r,n){var i=this;this._name="WebGL",this.forcePOTTextures=!1,this.isFullscreen=!1,this.cullBackFaces=null,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this.validateShaderPrograms=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this.disableUniformBuffers=!1,this.onDisposeObservable=new vF,this._frameId=0,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._webGLVersion=1,this._windowIsBackground=!1,this._highPrecisionShadersAllowed=!0,this._badOS=!1,this._badDesktopOS=!1,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onContextLostObservable=new vF,this.onContextRestoredObservable=new vF,this._contextWasLost=!1,this._doNotHandleContextLost=!1,this.disableVertexArrayObjects=!1,this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new ZN,this._stencilStateComposer=new EL,this._stencilState=new xA,this._alphaState=new nL,this._alphaMode=Qd.ALPHA_ADD,this._alphaEquation=Qd.ALPHA_DISABLE,this._internalTexturesCache=new Array,this._renderTargetWrapperCache=new Array,this._activeChannel=0,this._currentTextureChannel=-1,this._boundTexturesCache={},this._compiledEffects={},this._vertexAttribArraysEnabled=[],this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._maxMSAASamplesOverride=null,this._activeRequests=new Array,this._adaptToDeviceRatio=!1,this._transformTextureUrl=null,this.hostInformation={isMobile:!1},this.premultipliedAlpha=!0,this.onBeforeTextureInitObservable=new vF,this._isWebGPU=!1,this._snapshotRenderingMode=Qd.SNAPSHOTRENDERING_STANDARD,this._viewportCached={x:0,y:0,z:0,w:0},this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._boundUniforms={};var o=null;if(r=r||{},this._creationOptions=r,this._adaptToDeviceRatio=null!=n&&n,this._stencilStateComposer.stencilGlobal=this._stencilState,gL.SetMatrixPrecision(!!r.useHighPrecisionMatrix),e){if(n=n||r.adaptToDeviceRatio||!1,e.getContext){if(o=e,this._renderingCanvas=o,void 0!==t&&(r.antialias=t),void 0===r.deterministicLockstep&&(r.deterministicLockstep=!1),void 0===r.lockstepMaxSteps&&(r.lockstepMaxSteps=4),void 0===r.timeStep&&(r.timeStep=1/60),void 0===r.preserveDrawingBuffer&&(r.preserveDrawingBuffer=!1),void 0===r.audioEngine&&(r.audioEngine=!0),void 0!==r.audioEngineOptions&&void 0!==r.audioEngineOptions.audioContext&&(this._audioContext=r.audioEngineOptions.audioContext),void 0!==r.audioEngineOptions&&void 0!==r.audioEngineOptions.audioDestination&&(this._audioDestination=r.audioEngineOptions.audioDestination),void 0===r.stencil&&(r.stencil=!0),!1===r.premultipliedAlpha&&(this.premultipliedAlpha=!1),void 0===r.xrCompatible&&(r.xrCompatible=!0),this._doNotHandleContextLost=!!r.doNotHandleContextLost,navigator&&navigator.userAgent){this._checkForMobile=function(){var e=navigator.userAgent;i.hostInformation.isMobile=-1!==e.indexOf("Mobile")||-1!==e.indexOf("Mac")&&pL()&&"ontouchend"in document},this._checkForMobile(),hL()&&window.addEventListener("resize",this._checkForMobile);for(var s=navigator.userAgent,a=0,u=CL.ExceptionList;a<u.length;a++){var c=u[a],l=c.key,h=c.targets;if(new RegExp(l).test(s)){if(c.capture&&c.captureConstraint){var p=c.capture,f=c.captureConstraint,d=new RegExp(p).exec(s);if(d&&d.length>0)if(parseInt(d[d.length-1])>=f)continue}for(var A=0,g=h;A<g.length;A++){switch(g[A]){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0;break;case"antialias":r.antialias=!1;break;case"maxMSAASamples":this._maxMSAASamplesOverride=1}}}}}if(!this._doNotHandleContextLost&&(this._onContextLost=function(e){e.preventDefault(),i._contextWasLost=!0,aL.Warn("WebGL context lost."),i.onContextLostObservable.notifyObservers(i)},this._onContextRestored=function(){i._restoreEngineAfterContextLost(i._initGLContext.bind(i))},o.addEventListener("webglcontextlost",this._onContextLost,!1),o.addEventListener("webglcontextrestored",this._onContextRestored,!1),r.powerPreference="high-performance"),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this._badDesktopOS&&(r.xrCompatible=!1),!r.disableWebGL2Support)try{this._gl=o.getContext("webgl2",r)||o.getContext("experimental-webgl2",r),this._gl&&(this._webGLVersion=2,this._shaderPlatformName="WEBGL2",!this._gl.deleteQuery&&(this._webGLVersion=1,this._shaderPlatformName="WEBGL1"))}catch(e){}if(!this._gl){if(!o)throw new Error("The provided canvas is null or undefined.");try{this._gl=o.getContext("webgl",r)||o.getContext("experimental-webgl",r)}catch(e){throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=e,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample?(this._webGLVersion=2,this._shaderPlatformName="WEBGL2"):this._shaderPlatformName="WEBGL1";var _=this._gl.getContextAttributes();_&&(r.stencil=_.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),void 0!==r.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=r.useHighPrecisionFloats);var m=hL()&&window.devicePixelRatio||1,y=r.limitDeviceRatio||m;this._hardwareScalingLevel=n?1/Math.min(y,m):1,this.resize(),this._isStencilEnable=!!r.stencil,this._initGLContext(),this._initFeatures();for(var E=0;E<this._caps.maxVertexAttribs;E++)this._currentBufferPointers[E]=new xL;this._shaderProcessor=this.webGLVersion>1?new _WebGL_webGL2ShaderProcessors__WEBPACK_IMPORTED_MODULE_13__.WebGL2ShaderProcessor:new _WebGL_webGLShaderProcessors__WEBPACK_IMPORTED_MODULE_12__.WebGLShaderProcessor,this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent);var x="Babylon.js v".concat(CL.Version);console.log(x+" - ".concat(this.description)),this._renderingCanvas&&this._renderingCanvas.setAttribute&&this._renderingCanvas.setAttribute("data-engine",x)}}Object.defineProperty(CL,"NpmPackage",{get:function(){return"babylonjs@5.9.0"},enumerable:!1,configurable:!0}),Object.defineProperty(CL,"Version",{get:function(){return"5.9.0"},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"description",{get:function(){var e=this.name+this.webGLVersion;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"version",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),Object.defineProperty(CL,"ShadersRepository",{get:function(){return _Materials_effect__WEBPACK_IMPORTED_MODULE_2__.Effect.ShadersRepository},set:function(e){_Materials_effect__WEBPACK_IMPORTED_MODULE_2__.Effect.ShadersRepository=e},enumerable:!1,configurable:!0}),CL.prototype._getShaderProcessor=function(e){return this._shaderProcessor},Object.defineProperty(CL.prototype,"useReverseDepthBuffer",{get:function(){return this._useReverseDepthBuffer},set:function(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,this._depthCullingState.depthFunc=e?Qd.GEQUAL:Qd.LEQUAL)},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"frameId",{get:function(){return this._frameId},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"supportsUniformBuffers",{get:function(){return this.webGLVersion>1&&!this.disableUniformBuffers},enumerable:!1,configurable:!0}),CL.prototype.getCreationOptions=function(){return this._creationOptions},Object.defineProperty(CL.prototype,"_shouldUseHighPrecisionShader",{get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"needPOTTextures",{get:function(){return this._webGLVersion<2||this.forcePOTTextures},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"activeRenderLoops",{get:function(){return this._activeRenderLoops},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"doNotHandleContextLost",{get:function(){return this._doNotHandleContextLost},set:function(e){this._doNotHandleContextLost=e},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"framebufferDimensionsObject",{set:function(e){this._framebufferDimensionsObject=e},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"currentViewport",{get:function(){return this._cachedViewport},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"emptyTexture",{get:function(){return!this._emptyTexture&&(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,Qd.TEXTUREFORMAT_RGBA,!1,!1,Qd.TEXTURE_NEAREST_SAMPLINGMODE)),this._emptyTexture},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"emptyTexture3D",{get:function(){return!this._emptyTexture3D&&(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,Qd.TEXTUREFORMAT_RGBA,!1,!1,Qd.TEXTURE_NEAREST_SAMPLINGMODE)),this._emptyTexture3D},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"emptyTexture2DArray",{get:function(){return!this._emptyTexture2DArray&&(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,Qd.TEXTUREFORMAT_RGBA,!1,!1,Qd.TEXTURE_NEAREST_SAMPLINGMODE)),this._emptyTexture2DArray},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"emptyCubeTexture",{get:function(){if(!this._emptyCubeTexture){var e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,Qd.TEXTUREFORMAT_RGBA,Qd.TEXTURETYPE_UNSIGNED_INT,!1,!1,Qd.TEXTURE_NEAREST_SAMPLINGMODE)}return this._emptyCubeTexture},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"isWebGPU",{get:function(){return this._isWebGPU},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"shaderPlatformName",{get:function(){return this._shaderPlatformName},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"snapshotRendering",{get:function(){return!1},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"snapshotRenderingMode",{get:function(){return this._snapshotRenderingMode},set:function(e){this._snapshotRenderingMode=e},enumerable:!1,configurable:!0}),CL.prototype.snapshotRenderingReset=function(){this.snapshotRendering=!1},CL._CreateCanvas=function(e,t){if("undefined"==typeof document)return new OffscreenCanvas(e,t);var r=document.createElement("canvas");return r.width=e,r.height=t,r},CL.prototype.createCanvas=function(e,t){return CL._CreateCanvas(e,t)},CL.prototype.createCanvasImage=function(){return document.createElement("img")},CL.prototype._restoreEngineAfterContextLost=function(e){var t=this;setTimeout((function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(t,void 0,void 0,(function(){var t,r,n,i,o;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this,(function(s){switch(s.label){case 0:return this._dummyFramebuffer=null,t=this._depthCullingState.depthTest,r=this._depthCullingState.depthFunc,n=this._depthCullingState.depthMask,i=this._stencilState.stencilTest,[4,e()];case 1:return s.sent(),this._rebuildEffects(),null===(o=this._rebuildComputeEffects)||void 0===o||o.call(this),this._rebuildInternalTextures(),this._rebuildRenderTargetWrappers(),this._rebuildBuffers(),this.wipeCaches(!0),this._depthCullingState.depthTest=t,this._depthCullingState.depthFunc=r,this._depthCullingState.depthMask=n,this._stencilState.stencilTest=i,aL.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1,[2]}}))}))}),0)},CL.prototype._sharedInit=function(e,t,r){this._renderingCanvas=e},CL.prototype._getShaderProcessingContext=function(e){return null},CL.prototype._rebuildInternalTextures=function(){for(var e=0,t=this._internalTexturesCache.slice();e<t.length;e++){t[e]._rebuild()}},CL.prototype._rebuildRenderTargetWrappers=function(){for(var e=0,t=this._renderTargetWrapperCache.slice();e<t.length;e++){t[e]._rebuild()}},CL.prototype._rebuildEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e];t._pipelineContext=null,t._wasPreviouslyReady=!1,t._prepareEffect()}_Materials_effect__WEBPACK_IMPORTED_MODULE_2__.Effect.ResetCache()},CL.prototype.areAllEffectsReady=function(){for(var e in this._compiledEffects){if(!this._compiledEffects[e].isReady())return!1}return!0},CL.prototype._rebuildBuffers=function(){for(var e=0,t=this._uniformBuffers;e<t.length;e++){t[e]._rebuild()}for(var r=0,n=this._storageBuffers;r<n.length;r++){n[r]._rebuild()}},CL.prototype._initGLContext=function(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1,texture2DArrayMaxLayerCount:this._webGLVersion>1?256:128},this._glVersion=this._gl.getParameter(this._gl.VERSION);var e=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=e&&(this._glRenderer=this._gl.getParameter(e.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(e.UNMASKED_VENDOR_WEBGL)),!this._glVendor&&(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),!this._glRenderer&&(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._caps.etc2&&(this._gl.COMPRESSED_SRGB8_ETC2=this._caps.etc2.COMPRESSED_SRGB8_ETC2,this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=null!==this._maxMSAASamplesOverride?this._maxMSAASamplesOverride:this._gl.getParameter(this._gl.MAX_SAMPLES);else{var t=this._gl.getExtension("WEBGL_draw_buffers");if(null!==t){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=t.drawBuffersWEBGL.bind(t),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var r=0;r<16;r++)this._gl["COLOR_ATTACHMENT"+r+"_WEBGL"]=t["COLOR_ATTACHMENT"+r+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var n=this._gl.getExtension("WEBGL_depth_texture");null!=n&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=n.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var i=this._gl.getExtension("OES_vertex_array_object");null!=i&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=i.createVertexArrayOES.bind(i),this._gl.bindVertexArray=i.bindVertexArrayOES.bind(i),this._gl.deleteVertexArray=i.deleteVertexArrayOES.bind(i))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var o=this._gl.getExtension("ANGLE_instanced_arrays");null!=o?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=o.drawArraysInstancedANGLE.bind(o),this._gl.drawElementsInstanced=o.drawElementsInstancedANGLE.bind(o),this._gl.vertexAttribDivisor=o.vertexAttribDivisorANGLE.bind(o)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var s=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),a=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);s&&a&&(this._caps.highPrecisionShaderSupported=0!==s.precision&&0!==a.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var u=this._gl.getExtension("EXT_blend_minmax");null!=u&&(this._caps.blendMinMax=!0,this._gl.MAX=u.MAX_EXT,this._gl.MIN=u.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0;else{var c=this._gl.getExtension("EXT_sRGB");null!=c&&(this._caps.supportSRGBBuffers=!0,this._gl.SRGB=c.SRGB_EXT,this._gl.SRGB8=c.SRGB_ALPHA_EXT,this._gl.SRGB8_ALPHA8=c.SRGB_ALPHA_EXT)}this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!(!this._creationOptions||!this._creationOptions.forceSRGBBufferSupportState)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(var l=0;l<this._maxSimultaneousTextures;l++)this._nextFreeTextureSlots.push(l)},CL.prototype._initFeatures=function(){this._features={forceBitmapOverHTMLImageElement:!1,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,_collectUbosUpdatedInFrame:!1}},Object.defineProperty(CL.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),CL.prototype.getClassName=function(){return"ThinEngine"},Object.defineProperty(CL.prototype,"isStencilEnable",{get:function(){return this._isStencilEnable},enumerable:!1,configurable:!0}),CL.prototype._prepareWorkingCanvas=function(){if(!this._workingCanvas){this._workingCanvas=this.createCanvas(1,1);var e=this._workingCanvas.getContext("2d");e&&(this._workingContext=e)}},CL.prototype.resetTextureCache=function(){for(var e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1},CL.prototype.getInfo=function(){return this.getGlInfo()},CL.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}},CL.prototype.setHardwareScalingLevel=function(e){this._hardwareScalingLevel=e,this.resize()},CL.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel},CL.prototype.getLoadedTexturesCache=function(){return this._internalTexturesCache},CL.prototype.getCaps=function(){return this._caps},CL.prototype.stopRenderLoop=function(e){if(e){var t=this._activeRenderLoops.indexOf(e);t>=0&&this._activeRenderLoops.splice(t,1)}else this._activeRenderLoops=[]},CL.prototype._renderLoop=function(){if(!this._contextWasLost){var e=!0;if(!this.renderEvenInBackground&&this._windowIsBackground&&(e=!1),e){this.beginFrame();for(var t=0;t<this._activeRenderLoops.length;t++){(0,this._activeRenderLoops[t])()}this.endFrame()}}this._activeRenderLoops.length>0?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1},CL.prototype.getRenderingCanvas=function(){return this._renderingCanvas},CL.prototype.getAudioContext=function(){return this._audioContext},CL.prototype.getAudioDestination=function(){return this._audioDestination},CL.prototype.getHostWindow=function(){return hL()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null},CL.prototype.getRenderWidth=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth},CL.prototype.getRenderHeight=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight},CL.prototype._queueNewFrame=function(e,t){return CL.QueueNewFrame(e,t)},CL.prototype.runRenderLoop=function(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),!this._renderingQueueLaunched&&(this._renderingQueueLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))},CL.prototype.clear=function(e,t,r,n){void 0===n&&(n=!1);var i=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=i;var o=0;t&&e&&(this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1),o|=this._gl.COLOR_BUFFER_BIT),r&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),o|=this._gl.DEPTH_BUFFER_BIT),n&&(this._gl.clearStencil(0),o|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(o)},CL.prototype._viewport=function(e,t,r,n){(e!==this._viewportCached.x||t!==this._viewportCached.y||r!==this._viewportCached.z||n!==this._viewportCached.w)&&(this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=r,this._viewportCached.w=n,this._gl.viewport(e,t,r,n))},CL.prototype.setViewport=function(e,t,r){var n=t||this.getRenderWidth(),i=r||this.getRenderHeight(),o=e.x||0,s=e.y||0;this._cachedViewport=e,this._viewport(o*n,s*i,n*e.width,i*e.height)},CL.prototype.beginFrame=function(){},CL.prototype.endFrame=function(){this._badOS&&this.flushFramebuffer(),this._frameId++},CL.prototype.resize=function(e){var t,r;if(void 0===e&&(e=!1),this._adaptToDeviceRatio){var n=hL()&&window.devicePixelRatio||1,i=this._creationOptions.limitDeviceRatio||n;this._hardwareScalingLevel=this._adaptToDeviceRatio?1/Math.min(i,n):1}hL()?(t=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth,r=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:window.innerHeight):(t=this._renderingCanvas?this._renderingCanvas.width:100,r=this._renderingCanvas?this._renderingCanvas.height:100),this.setSize(t/this._hardwareScalingLevel,r/this._hardwareScalingLevel,e)},CL.prototype.setSize=function(e,t,r){return void 0===r&&(r=!1),!!this._renderingCanvas&&(e|=0,t|=0,!(!r&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t)&&(this._renderingCanvas.width=e,this._renderingCanvas.height=t,!0))},CL.prototype.bindFramebuffer=function(e,t,r,n,i,o,s){var a,u,c,l,h;void 0===t&&(t=0),void 0===o&&(o=0),void 0===s&&(s=0);var p=e;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,this._bindUnboundFramebuffer(p._MSAAFramebuffer?p._MSAAFramebuffer:p._framebuffer);var f=this._gl;e.is2DArray?f.framebufferTextureLayer(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,null===(a=e.texture._hardwareTexture)||void 0===a?void 0:a.underlyingResource,o,s):e.isCube&&f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(u=e.texture._hardwareTexture)||void 0===u?void 0:u.underlyingResource,o);var d=e._depthStencilTexture;if(d){var A=e._depthStencilTextureWithStencil?f.DEPTH_STENCIL_ATTACHMENT:f.DEPTH_ATTACHMENT;e.is2DArray?f.framebufferTextureLayer(f.FRAMEBUFFER,A,null===(c=d._hardwareTexture)||void 0===c?void 0:c.underlyingResource,o,s):e.isCube?f.framebufferTexture2D(f.FRAMEBUFFER,A,f.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(l=d._hardwareTexture)||void 0===l?void 0:l.underlyingResource,o):f.framebufferTexture2D(f.FRAMEBUFFER,A,f.TEXTURE_2D,null===(h=d._hardwareTexture)||void 0===h?void 0:h.underlyingResource,o)}this._cachedViewport&&!i?this.setViewport(this._cachedViewport,r,n):(!r&&(r=e.width,o&&(r/=Math.pow(2,o))),!n&&(n=e.height,o&&(n/=Math.pow(2,o))),this._viewport(0,0,r,n)),this.wipeCaches()},CL.prototype.setState=function(e,t,r,n,i,o,s){var a,u;void 0===t&&(t=0),void 0===n&&(n=!1),void 0===s&&(s=0),(this._depthCullingState.cull!==e||r)&&(this._depthCullingState.cull=e);var c=null===(u=null!==(a=this.cullBackFaces)&&void 0!==a?a:i)||void 0===u||u?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==c||r)&&(this._depthCullingState.cullFace=c),this.setZOffset(t),this.setZOffsetUnits(s);var l=n?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==l||r)&&(this._depthCullingState.frontFace=l),this._stencilStateComposer.stencilMaterial=o},CL.prototype.setZOffset=function(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e},CL.prototype.getZOffset=function(){var e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e},CL.prototype.setZOffsetUnits=function(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e},CL.prototype.getZOffsetUnits=function(){var e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e},CL.prototype._bindUnboundFramebuffer=function(e){this._currentFramebuffer!==e&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e),this._currentFramebuffer=e)},CL.prototype._currentFrameBufferIsDefaultFrameBuffer=function(){return null===this._currentFramebuffer},CL.prototype.generateMipmaps=function(e){this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)},CL.prototype.unBindFramebuffer=function(e,t,r){var n;void 0===t&&(t=!1);var i=e;this._currentRenderTarget=null;var o=this._gl;if(i._MSAAFramebuffer){if(e.isMulti)return void this.unBindMultiColorAttachmentFramebuffer(e,t,r);o.bindFramebuffer(o.READ_FRAMEBUFFER,i._MSAAFramebuffer),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,i._framebuffer),o.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,o.COLOR_BUFFER_BIT,o.NEAREST)}(null===(n=e.texture)||void 0===n?void 0:n.generateMipMaps)&&!t&&!e.isCube&&this.generateMipmaps(e.texture),r&&(i._MSAAFramebuffer&&this._bindUnboundFramebuffer(i._framebuffer),r()),this._bindUnboundFramebuffer(null)},CL.prototype.flushFramebuffer=function(){this._gl.flush()},CL.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()},CL.prototype._resetVertexBufferBinding=function(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null},CL.prototype.createVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)},CL.prototype._createVertexBuffer=function(e,t){var r=this._gl.createBuffer();if(!r)throw new Error("Unable to create vertex buffer");var n=new _Meshes_WebGL_webGLDataBuffer__WEBPACK_IMPORTED_MODULE_14__.WebGLDataBuffer(r);return this.bindArrayBuffer(n),e instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),t):this._gl.bufferData(this._gl.ARRAY_BUFFER,e,t),this._resetVertexBufferBinding(),n.references=1,n},CL.prototype.createDynamicVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)},CL.prototype._resetIndexBufferBinding=function(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null},CL.prototype.createIndexBuffer=function(e,t){var r=this._gl.createBuffer(),n=new _Meshes_WebGL_webGLDataBuffer__WEBPACK_IMPORTED_MODULE_14__.WebGLDataBuffer(r);if(!r)throw new Error("Unable to create index buffer");this.bindIndexBuffer(n);var i=this._normalizeIndexData(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,i,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),n.references=1,n.is32Bits=4===i.BYTES_PER_ELEMENT,n},CL.prototype._normalizeIndexData=function(e){if(2===e.BYTES_PER_ELEMENT)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(var t=0;t<e.length;t++)if(e[t]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)},CL.prototype.bindArrayBuffer=function(e){!this._vaoRecordInProgress&&this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ARRAY_BUFFER)},CL.prototype.bindUniformBlock=function(e,t,r){var n=e.program,i=this._gl.getUniformBlockIndex(n,t);this._gl.uniformBlockBinding(n,i,r)},CL.prototype.bindIndexBuffer=function(e){!this._vaoRecordInProgress&&this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)},CL.prototype._bindBuffer=function(e,t){(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e)&&(this._gl.bindBuffer(t,e?e.underlyingResource:null),this._currentBoundBuffer[t]=e)},CL.prototype.updateArrayBuffer=function(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)},CL.prototype._vertexAttribPointer=function(e,t,r,n,i,o,s){var a=this._currentBufferPointers[t];if(a){var u=!1;a.active?(a.buffer!==e&&(a.buffer=e,u=!0),a.size!==r&&(a.size=r,u=!0),a.type!==n&&(a.type=n,u=!0),a.normalized!==i&&(a.normalized=i,u=!0),a.stride!==o&&(a.stride=o,u=!0),a.offset!==s&&(a.offset=s,u=!0)):(u=!0,a.active=!0,a.index=t,a.size=r,a.type=n,a.normalized=i,a.stride=o,a.offset=s,a.buffer=e),(u||this._vaoRecordInProgress)&&(this.bindArrayBuffer(e),this._gl.vertexAttribPointer(t,r,n,i,o,s))}},CL.prototype._bindIndexBufferWithCache=function(e){null!=e&&this._cachedIndexBuffer!==e&&(this._cachedIndexBuffer=e,this.bindIndexBuffer(e),this._uintIndicesCurrentlySet=e.is32Bits)},CL.prototype._bindVertexBuffersAttributes=function(e,t,r){var n=t.getAttributesNames();!this._vaoRecordInProgress&&this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var i=0;i<n.length;i++){var o=t.getAttributeLocation(i);if(o>=0){var s=n[i],a=null;if(r&&(a=r[s]),!a&&(a=e[s]),!a)continue;this._gl.enableVertexAttribArray(o),!this._vaoRecordInProgress&&(this._vertexAttribArraysEnabled[o]=!0);var u=a.getBuffer();u&&(this._vertexAttribPointer(u,o,a.getSize(),a.type,a.normalized,a.byteStride,a.byteOffset),a.getIsInstanced()&&(this._gl.vertexAttribDivisor(o,a.getInstanceDivisor()),!this._vaoRecordInProgress&&(this._currentInstanceLocations.push(o),this._currentInstanceBuffers.push(u))))}}},CL.prototype.recordVertexArrayObject=function(e,t,r,n){var i=this._gl.createVertexArray();return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(i),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(e,r,n),this.bindIndexBuffer(t),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),i},CL.prototype.bindVertexArrayObject=function(e,t){this._cachedVertexArrayObject!==e&&(this._cachedVertexArrayObject=e,this._gl.bindVertexArray(e),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=t&&t.is32Bits,this._mustWipeVertexAttributes=!0)},CL.prototype.bindBuffersDirectly=function(e,t,r,n,i){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==i){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=i;var o=i.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var s=0,a=0;a<o;a++)if(a<r.length){var u=i.getAttributeLocation(a);u>=0&&(this._gl.enableVertexAttribArray(u),this._vertexAttribArraysEnabled[u]=!0,this._vertexAttribPointer(e,u,r[a],this._gl.FLOAT,!1,n,s)),s+=4*r[a]}}this._bindIndexBufferWithCache(t)},CL.prototype._unbindVertexArrayObject=function(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))},CL.prototype.bindBuffers=function(e,t,r,n){(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==r)&&(this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=r,this._bindVertexBuffersAttributes(e,r,n)),this._bindIndexBufferWithCache(t)},CL.prototype.unbindInstanceAttributes=function(){for(var e,t=0,r=this._currentInstanceLocations.length;t<r;t++){var n=this._currentInstanceBuffers[t];e!=n&&n.references&&(e=n,this.bindArrayBuffer(n));var i=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(i,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0},CL.prototype.releaseVertexArrayObject=function(e){this._gl.deleteVertexArray(e)},CL.prototype._releaseBuffer=function(e){return e.references--,0===e.references&&(this._deleteBuffer(e),!0)},CL.prototype._deleteBuffer=function(e){this._gl.deleteBuffer(e.underlyingResource)},CL.prototype.updateAndBindInstancesBuffer=function(e,t,r){if(this.bindArrayBuffer(e),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),void 0!==r[0].index)this.bindInstancesBuffer(e,r,!0);else for(var n=0;n<4;n++){var i=r[n];!this._vertexAttribArraysEnabled[i]&&(this._gl.enableVertexAttribArray(i),this._vertexAttribArraysEnabled[i]=!0),this._vertexAttribPointer(e,i,4,this._gl.FLOAT,!1,64,16*n),this._gl.vertexAttribDivisor(i,1),this._currentInstanceLocations.push(i),this._currentInstanceBuffers.push(e)}},CL.prototype.bindInstancesBuffer=function(e,t,r){void 0===r&&(r=!0),this.bindArrayBuffer(e);var n=0;if(r)for(var i=0;i<t.length;i++){n+=4*(o=t[i]).attributeSize}for(i=0;i<t.length;i++){var o;void 0===(o=t[i]).index&&(o.index=this._currentEffect.getAttributeLocationByName(o.attributeName)),o.index<0||(!this._vertexAttribArraysEnabled[o.index]&&(this._gl.enableVertexAttribArray(o.index),this._vertexAttribArraysEnabled[o.index]=!0),this._vertexAttribPointer(e,o.index,o.attributeSize,o.attributeType||this._gl.FLOAT,o.normalized||!1,n,o.offset),this._gl.vertexAttribDivisor(o.index,void 0===o.divisor?1:o.divisor),this._currentInstanceLocations.push(o.index),this._currentInstanceBuffers.push(e))}},CL.prototype.disableInstanceAttributeByName=function(e){if(this._currentEffect){var t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}},CL.prototype.disableInstanceAttribute=function(e){for(var t,r=!1;-1!==(t=this._currentInstanceLocations.indexOf(e));)this._currentInstanceLocations.splice(t,1),this._currentInstanceBuffers.splice(t,1),r=!0,t=this._currentInstanceLocations.indexOf(e);r&&(this._gl.vertexAttribDivisor(e,0),this.disableAttributeByIndex(e))},CL.prototype.disableAttributeByIndex=function(e){this._gl.disableVertexAttribArray(e),this._vertexAttribArraysEnabled[e]=!1,this._currentBufferPointers[e].active=!1},CL.prototype.draw=function(e,t,r,n){this.drawElementsType(e?Qd.MATERIAL_TriangleFillMode:Qd.MATERIAL_WireFrameFillMode,t,r,n)},CL.prototype.drawPointClouds=function(e,t,r){this.drawArraysType(Qd.MATERIAL_PointFillMode,e,t,r)},CL.prototype.drawUnIndexed=function(e,t,r,n){this.drawArraysType(e?Qd.MATERIAL_TriangleFillMode:Qd.MATERIAL_WireFrameFillMode,t,r,n)},CL.prototype.drawElementsType=function(e,t,r,n){this.applyStates(),this._reportDrawCall();var i=this._drawMode(e),o=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,s=this._uintIndicesCurrentlySet?4:2;n?this._gl.drawElementsInstanced(i,r,o,t*s,n):this._gl.drawElements(i,r,o,t*s)},CL.prototype.drawArraysType=function(e,t,r,n){this.applyStates(),this._reportDrawCall();var i=this._drawMode(e);n?this._gl.drawArraysInstanced(i,t,r,n):this._gl.drawArrays(i,t,r)},CL.prototype._drawMode=function(e){switch(e){case Qd.MATERIAL_TriangleFillMode:return this._gl.TRIANGLES;case Qd.MATERIAL_PointFillMode:return this._gl.POINTS;case Qd.MATERIAL_WireFrameFillMode:return this._gl.LINES;case Qd.MATERIAL_PointListDrawMode:return this._gl.POINTS;case Qd.MATERIAL_LineListDrawMode:return this._gl.LINES;case Qd.MATERIAL_LineLoopDrawMode:return this._gl.LINE_LOOP;case Qd.MATERIAL_LineStripDrawMode:return this._gl.LINE_STRIP;case Qd.MATERIAL_TriangleStripDrawMode:return this._gl.TRIANGLE_STRIP;case Qd.MATERIAL_TriangleFanDrawMode:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}},CL.prototype._reportDrawCall=function(){},CL.prototype._releaseEffect=function(e){if(this._compiledEffects[e._key]){delete this._compiledEffects[e._key];var t=e.getPipelineContext();t&&this._deletePipelineContext(t)}},CL.prototype._deletePipelineContext=function(e){var t=e;t&&t.program&&(t.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(t.program))},CL.prototype._getGlobalDefines=function(e){if(e)return this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,void(this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER);var t="";return this.isNDCHalfZRange&&(t+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(t&&(t+="\n"),t+="#define USE_REVERSE_DEPTHBUFFER"),t},CL.prototype.createEffect=function(e,t,r,n,i,o,s,a,u,c){var l;void 0===c&&(c=_Materials_shaderLanguage__WEBPACK_IMPORTED_MODULE_20__.ShaderLanguage.GLSL);var h=e.vertexElement||e.vertex||e.vertexToken||e.vertexSource||e,p=e.fragmentElement||e.fragment||e.fragmentToken||e.fragmentSource||e,f=this._getGlobalDefines(),d=null!==(l=null!=i?i:t.defines)&&void 0!==l?l:"";f&&(d+=f);var A=h+"+"+p+"@"+d;if(this._compiledEffects[A]){var g=this._compiledEffects[A];return s&&g.isReady()&&s(g),g}var _=new _Materials_effect__WEBPACK_IMPORTED_MODULE_2__.Effect(e,t,r,n,this,i,o,s,a,u,A,c);return this._compiledEffects[A]=_,_},CL._ConcatenateShader=function(e,t,r){return void 0===r&&(r=""),r+(t?t+"\n":"")+e},CL.prototype._compileShader=function(e,t,r,n){return this._compileRawShader(CL._ConcatenateShader(e,r,n),t)},CL.prototype._compileRawShader=function(e,t){var r=this._gl,n=r.createShader("vertex"===t?r.VERTEX_SHADER:r.FRAGMENT_SHADER);if(!n){for(var i=r.NO_ERROR,o=r.NO_ERROR;(o=r.getError())!==r.NO_ERROR;)i=o;throw new Error("Something went wrong while creating a gl ".concat(t," shader object. gl error=").concat(i,", gl isContextLost=").concat(r.isContextLost(),", _contextWasLost=").concat(this._contextWasLost))}return r.shaderSource(n,e),r.compileShader(n),n},CL.prototype._getShaderSource=function(e){return this._gl.getShaderSource(e)},CL.prototype.createRawShaderProgram=function(e,t,r,n,i){void 0===i&&(i=null),n=n||this._gl;var o=this._compileRawShader(t,"vertex"),s=this._compileRawShader(r,"fragment");return this._createShaderProgram(e,o,s,n,i)},CL.prototype.createShaderProgram=function(e,t,r,n,i,o){void 0===o&&(o=null),i=i||this._gl;var s=this._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"",a=this._compileShader(t,"vertex",n,s),u=this._compileShader(r,"fragment",n,s);return this._createShaderProgram(e,a,u,i,o)},CL.prototype.inlineShaderCode=function(e){return e},CL.prototype.createPipelineContext=function(e){var t=new _WebGL_webGLPipelineContext__WEBPACK_IMPORTED_MODULE_15__.WebGLPipelineContext;return t.engine=this,this._caps.parallelShaderCompile&&(t.isParallelCompiled=!0),t},CL.prototype.createMaterialContext=function(){},CL.prototype.createDrawContext=function(){},CL.prototype._createShaderProgram=function(e,t,r,n,i){var o=n.createProgram();if(e.program=o,!o)throw new Error("Unable to create program");return n.attachShader(o,t),n.attachShader(o,r),n.linkProgram(o),e.context=n,e.vertexShader=t,e.fragmentShader=r,!e.isParallelCompiled&&this._finalizePipelineContext(e),o},CL.prototype._finalizePipelineContext=function(e){var t=e.context,r=e.vertexShader,n=e.fragmentShader,i=e.program;if(!t.getProgramParameter(i,t.LINK_STATUS)){var o,s;if(!this._gl.getShaderParameter(r,this._gl.COMPILE_STATUS))if(o=this._gl.getShaderInfoLog(r))throw e.vertexCompilationError=o,new Error("VERTEX SHADER "+o);if(!this._gl.getShaderParameter(n,this._gl.COMPILE_STATUS))if(o=this._gl.getShaderInfoLog(n))throw e.fragmentCompilationError=o,new Error("FRAGMENT SHADER "+o);if(s=t.getProgramInfoLog(i))throw e.programLinkError=s,new Error(s)}if(this.validateShaderPrograms&&(t.validateProgram(i),!t.getProgramParameter(i,t.VALIDATE_STATUS)&&(s=t.getProgramInfoLog(i))))throw e.programValidationError=s,new Error(s);t.deleteShader(r),t.deleteShader(n),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)},CL.prototype._preparePipelineContext=function(e,t,r,n,i,o,s,a,u,c){var l=e;l.program=n?this.createRawShaderProgram(l,t,r,void 0,u):this.createShaderProgram(l,t,r,a,void 0,u),l.program.__SPECTOR_rebuildProgram=s},CL.prototype._isRenderingStateCompiled=function(e){var t=e;return!!this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)&&(this._finalizePipelineContext(t),!0)},CL.prototype._executeWhenRenderingStateIsCompiled=function(e,t){var r=e;if(r.isParallelCompiled){var n=r.onCompiled;r.onCompiled=n?function(){n(),t()}:t}else t()},CL.prototype.getUniforms=function(e,t){for(var r=new Array,n=e,i=0;i<t.length;i++)r.push(this._gl.getUniformLocation(n.program,t[i]));return r},CL.prototype.getAttributes=function(e,t){for(var r=[],n=e,i=0;i<t.length;i++)try{r.push(this._gl.getAttribLocation(n.program,t[i]))}catch(e){r.push(-1)}return r},CL.prototype.enableEffect=function(e){(e=null!==e&&_Materials_drawWrapper__WEBPACK_IMPORTED_MODULE_18__.DrawWrapper.IsWrapper(e)?e.effect:e)&&e!==this._currentEffect&&(this._stencilStateComposer.stencilMaterial=void 0,this.bindSamplers(e),this._currentEffect=e,e.onBind&&e.onBind(e),e._onBindObservable&&e._onBindObservable.notifyObservers(e))},CL.prototype.setInt=function(e,t){return!!e&&(this._gl.uniform1i(e,t),!0)},CL.prototype.setInt2=function(e,t,r){return!!e&&(this._gl.uniform2i(e,t,r),!0)},CL.prototype.setInt3=function(e,t,r,n){return!!e&&(this._gl.uniform3i(e,t,r,n),!0)},CL.prototype.setInt4=function(e,t,r,n,i){return!!e&&(this._gl.uniform4i(e,t,r,n,i),!0)},CL.prototype.setIntArray=function(e,t){return!!e&&(this._gl.uniform1iv(e,t),!0)},CL.prototype.setIntArray2=function(e,t){return!(!e||t.length%2!=0)&&(this._gl.uniform2iv(e,t),!0)},CL.prototype.setIntArray3=function(e,t){return!(!e||t.length%3!=0)&&(this._gl.uniform3iv(e,t),!0)},CL.prototype.setIntArray4=function(e,t){return!(!e||t.length%4!=0)&&(this._gl.uniform4iv(e,t),!0)},CL.prototype.setArray=function(e,t){return!!e&&(!(t.length<1)&&(this._gl.uniform1fv(e,t),!0))},CL.prototype.setArray2=function(e,t){return!(!e||t.length%2!=0)&&(this._gl.uniform2fv(e,t),!0)},CL.prototype.setArray3=function(e,t){return!(!e||t.length%3!=0)&&(this._gl.uniform3fv(e,t),!0)},CL.prototype.setArray4=function(e,t){return!(!e||t.length%4!=0)&&(this._gl.uniform4fv(e,t),!0)},CL.prototype.setMatrices=function(e,t){return!!e&&(this._gl.uniformMatrix4fv(e,!1,t),!0)},CL.prototype.setMatrix3x3=function(e,t){return!!e&&(this._gl.uniformMatrix3fv(e,!1,t),!0)},CL.prototype.setMatrix2x2=function(e,t){return!!e&&(this._gl.uniformMatrix2fv(e,!1,t),!0)},CL.prototype.setFloat=function(e,t){return!!e&&(this._gl.uniform1f(e,t),!0)},CL.prototype.setFloat2=function(e,t,r){return!!e&&(this._gl.uniform2f(e,t,r),!0)},CL.prototype.setFloat3=function(e,t,r,n){return!!e&&(this._gl.uniform3f(e,t,r,n),!0)},CL.prototype.setFloat4=function(e,t,r,n,i){return!!e&&(this._gl.uniform4f(e,t,r,n,i),!0)},CL.prototype.applyStates=function(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;var e=this._colorWrite;this._gl.colorMask(e,e,e,e)}},CL.prototype.setColorWrite=function(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)},CL.prototype.getColorWrite=function(){return this._colorWrite},Object.defineProperty(CL.prototype,"depthCullingState",{get:function(){return this._depthCullingState},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"alphaState",{get:function(){return this._alphaState},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"stencilState",{get:function(){return this._stencilState},enumerable:!1,configurable:!0}),Object.defineProperty(CL.prototype,"stencilStateComposer",{get:function(){return this._stencilStateComposer},enumerable:!1,configurable:!0}),CL.prototype.clearInternalTexturesCache=function(){this._internalTexturesCache=[]},CL.prototype.wipeCaches=function(e){this.preventCacheWipeBetweenFrames&&!e||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),e&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=Qd.ALPHA_ADD,this._alphaEquation=Qd.ALPHA_DISABLE,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))},CL.prototype._getSamplingParameters=function(e,t){var r=this._gl,n=r.NEAREST,i=r.NEAREST;switch(e){case Qd.TEXTURE_LINEAR_LINEAR_MIPNEAREST:n=r.LINEAR,i=t?r.LINEAR_MIPMAP_NEAREST:r.LINEAR;break;case Qd.TEXTURE_LINEAR_LINEAR_MIPLINEAR:n=r.LINEAR,i=t?r.LINEAR_MIPMAP_LINEAR:r.LINEAR;break;case Qd.TEXTURE_NEAREST_NEAREST_MIPLINEAR:n=r.NEAREST,i=t?r.NEAREST_MIPMAP_LINEAR:r.NEAREST;break;case Qd.TEXTURE_NEAREST_NEAREST_MIPNEAREST:n=r.NEAREST,i=t?r.NEAREST_MIPMAP_NEAREST:r.NEAREST;break;case Qd.TEXTURE_NEAREST_LINEAR_MIPNEAREST:n=r.NEAREST,i=t?r.LINEAR_MIPMAP_NEAREST:r.LINEAR;break;case Qd.TEXTURE_NEAREST_LINEAR_MIPLINEAR:n=r.NEAREST,i=t?r.LINEAR_MIPMAP_LINEAR:r.LINEAR;break;case Qd.TEXTURE_NEAREST_LINEAR:n=r.NEAREST,i=r.LINEAR;break;case Qd.TEXTURE_NEAREST_NEAREST:n=r.NEAREST,i=r.NEAREST;break;case Qd.TEXTURE_LINEAR_NEAREST_MIPNEAREST:n=r.LINEAR,i=t?r.NEAREST_MIPMAP_NEAREST:r.NEAREST;break;case Qd.TEXTURE_LINEAR_NEAREST_MIPLINEAR:n=r.LINEAR,i=t?r.NEAREST_MIPMAP_LINEAR:r.NEAREST;break;case Qd.TEXTURE_LINEAR_LINEAR:n=r.LINEAR,i=r.LINEAR;break;case Qd.TEXTURE_LINEAR_NEAREST:n=r.LINEAR,i=r.NEAREST}return{min:i,mag:n}},CL.prototype._createTexture=function(){var e=this._gl.createTexture();if(!e)throw new Error("Unable to create texture");return e},CL.prototype._createHardwareTexture=function(){return new _WebGL_webGLHardwareTexture__WEBPACK_IMPORTED_MODULE_17__.WebGLHardwareTexture(this._createTexture(),this._gl)},CL.prototype._createInternalTexture=function(e,t,r,n){void 0===n&&(n=BF.Unknown);var i={};void 0!==t&&"object"==typeof t?(i.generateMipMaps=t.generateMipMaps,i.type=void 0===t.type?Qd.TEXTURETYPE_UNSIGNED_INT:t.type,i.samplingMode=void 0===t.samplingMode?Qd.TEXTURE_TRILINEAR_SAMPLINGMODE:t.samplingMode,i.format=void 0===t.format?Qd.TEXTUREFORMAT_RGBA:t.format,i.useSRGBBuffer=void 0!==t.useSRGBBuffer&&t.useSRGBBuffer):(i.generateMipMaps=t,i.type=Qd.TEXTURETYPE_UNSIGNED_INT,i.samplingMode=Qd.TEXTURE_TRILINEAR_SAMPLINGMODE,i.format=Qd.TEXTUREFORMAT_RGBA,i.useSRGBBuffer=!1),i.useSRGBBuffer=i.useSRGBBuffer&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU),i.type!==Qd.TEXTURETYPE_FLOAT||this._caps.textureFloatLinearFiltering?i.type===Qd.TEXTURETYPE_HALF_FLOAT&&!this._caps.textureHalfFloatLinearFiltering&&(i.samplingMode=Qd.TEXTURE_NEAREST_SAMPLINGMODE):i.samplingMode=Qd.TEXTURE_NEAREST_SAMPLINGMODE,i.type===Qd.TEXTURETYPE_FLOAT&&!this._caps.textureFloat&&(i.type=Qd.TEXTURETYPE_UNSIGNED_INT,aL.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));var o=this._gl,s=new OF(this,n);s._useSRGBBuffer=!!i.useSRGBBuffer;var a=e.width||e,u=e.height||e,c=e.layers||0,l=this._getSamplingParameters(i.samplingMode,!!i.generateMipMaps),h=0!==c?o.TEXTURE_2D_ARRAY:o.TEXTURE_2D,p=this._getRGBABufferInternalSizedFormat(i.type,i.format,i.useSRGBBuffer),f=this._getInternalFormat(i.format),d=this._getWebGLTextureType(i.type);return this._bindTextureDirectly(h,s),0!==c?(s.is2DArray=!0,o.texImage3D(h,0,p,a,u,c,0,f,d,null)):o.texImage2D(h,0,p,a,u,0,f,d,null),o.texParameteri(h,o.TEXTURE_MAG_FILTER,l.mag),o.texParameteri(h,o.TEXTURE_MIN_FILTER,l.min),o.texParameteri(h,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(h,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),i.generateMipMaps&&this._gl.generateMipmap(h),this._bindTextureDirectly(h,null),s.baseWidth=a,s.baseHeight=u,s.width=a,s.height=u,s.depth=c,s.isReady=!0,s.samples=1,s.generateMipMaps=!!i.generateMipMaps,s.samplingMode=i.samplingMode,s.type=i.type,s.format=i.format,this._internalTexturesCache.push(s),s},CL.prototype._getUseSRGBBuffer=function(e,t){return e&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU||t)},CL.prototype._createTextureBase=function(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d,A){var g=this;void 0===i&&(i=Qd.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===o&&(o=null),void 0===s&&(s=null),void 0===c&&(c=null),void 0===l&&(l=null),void 0===h&&(h=null),void 0===p&&(p=null);var _="data:"===(e=e||"").substr(0,5),m="blob:"===e.substr(0,5),y=_&&-1!==e.indexOf(";base64,"),E=l||new OF(this,BF.Url),x=e;this._transformTextureUrl&&!y&&!l&&!c&&(e=this._transformTextureUrl(e)),x!==e&&(E._originalUrl=x);var C=e.lastIndexOf("."),b=p||(C>-1?e.substring(C).toLowerCase():""),I=null;b.indexOf("?")>-1&&(b=b.split("?")[0]);for(var v=0,T=CL._TextureLoaders;v<T.length;v++){var R=T[v];if(R.canLoad(b,f)){I=R;break}}n&&n._addPendingData(E),E.url=e,E.generateMipMaps=!t,E.samplingMode=i,E.invertY=r,E._useSRGBBuffer=this._getUseSRGBBuffer(!!A,t),!this._doNotHandleContextLost&&(E._buffer=c);var S=null;o&&!l&&(S=E.onLoadedObservable.add(o)),!l&&this._internalTexturesCache.push(E);var M=function(r,l){n&&n._removePendingData(E),e===x?(S&&E.onLoadedObservable.remove(S),_engineStore__WEBPACK_IMPORTED_MODULE_1__.EngineStore.UseFallbackTexture&&g._createTextureBase(_engineStore__WEBPACK_IMPORTED_MODULE_1__.EngineStore.FallbackTexture,t,E.invertY,n,i,null,s,a,u,c,E),r=(r||"Unknown error")+(_engineStore__WEBPACK_IMPORTED_MODULE_1__.EngineStore.UseFallbackTexture?" - Fallback texture was used":""),E.onErrorObservable.notifyObservers({message:r,exception:l}),s&&s(r,l)):(aL.Warn("Failed to load ".concat(e,", falling back to ").concat(x)),g._createTextureBase(x,t,E.invertY,n,i,o,s,a,u,c,E,h,p,f,d,A))};if(I){var w=function(e){I.loadData(e,E,(function(e,t,r,o,s,u){u?M("TextureLoader failed to load data"):a(E,b,n,{width:e,height:t},E.invertY,!r,o,(function(){return s(),!1}),i)}),d)};c?c instanceof ArrayBuffer?w(new Uint8Array(c)):ArrayBuffer.isView(c)?w(c):s&&s("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(e,(function(e){return w(new Uint8Array(e))}),void 0,n?n.offlineProvider:void 0,!0,(function(e,t){M("Unable to load "+(e&&e.responseURL,t))}))}else{var B=function(e){m&&!g._doNotHandleContextLost&&(E._buffer=e),a(E,b,n,e,E.invertY,t,!1,u,i)};!_||y?c&&("string"==typeof c.decoding||c.close)&&B(c):"string"==typeof c||c instanceof ArrayBuffer||ArrayBuffer.isView(c)||c instanceof Blob||c&&B(c)}return E},CL.prototype.createTexture=function(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d){var A=this;return void 0===i&&(i=Qd.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===c&&(c=null),void 0===l&&(l=null),this._createTextureBase(e,t,r,n,i,o,s,this._prepareWebGLTexture.bind(this),(function(e,t,r,i,o,s){var a=A._gl,u=r.width===e&&r.height===t,l=c?A._getInternalFormat(c,o._useSRGBBuffer):".jpg"!==i||o._useSRGBBuffer?o._useSRGBBuffer?a.SRGB8_ALPHA8:a.RGBA:a.RGB,h=c?A._getInternalFormat(c):".jpg"!==i||o._useSRGBBuffer?a.RGBA:a.RGB;if(o._useSRGBBuffer&&1===A.webGLVersion&&(h=l),u)return a.texImage2D(a.TEXTURE_2D,0,l,h,a.UNSIGNED_BYTE,r),!1;var p=A._caps.maxTextureSize;if(r.width>p||r.height>p||!A._supportsHardwareTextureRescaling)return A._prepareWorkingCanvas(),!(!A._workingCanvas||!A._workingContext)&&(A._workingCanvas.width=e,A._workingCanvas.height=t,A._workingContext.drawImage(r,0,0,r.width,r.height,0,0,e,t),a.texImage2D(a.TEXTURE_2D,0,l,h,a.UNSIGNED_BYTE,A._workingCanvas),o.width=e,o.height=t,!1);var f=new OF(A,BF.Temp);return A._bindTextureDirectly(a.TEXTURE_2D,f,!0),a.texImage2D(a.TEXTURE_2D,0,l,h,a.UNSIGNED_BYTE,r),A._rescaleTexture(f,o,n,l,(function(){A._releaseTexture(f),A._bindTextureDirectly(a.TEXTURE_2D,o,!0),s()})),!0}),a,u,c,l,h,p,d)},CL._FileToolsLoadImage=function(e,t,r,n,i,o){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_3__._WarnImport)("FileTools")},CL.prototype._rescaleTexture=function(e,t,r,n,i){},CL.prototype.createRawTexture=function(e,t,r,n,i,o,s,a,u,c,l){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_3__._WarnImport)("Engine.RawTexture")},CL.prototype.createRawCubeTexture=function(e,t,r,n,i,o,s,a){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_3__._WarnImport)("Engine.RawTexture")},CL.prototype.createRawTexture3D=function(e,t,r,n,i,o,s,a,u,c){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_3__._WarnImport)("Engine.RawTexture")},CL.prototype.createRawTexture2DArray=function(e,t,r,n,i,o,s,a,u,c){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_3__._WarnImport)("Engine.RawTexture")},CL.prototype._unpackFlipY=function(e){this._unpackFlipYCached!==e&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e))},CL.prototype._getUnpackAlignement=function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)},CL.prototype._getTextureTarget=function(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D},CL.prototype.updateTextureSamplingMode=function(e,t,r){void 0===r&&(r=!1);var n=this._getTextureTarget(t),i=this._getSamplingParameters(e,t.generateMipMaps||r);this._setTextureParameterInteger(n,this._gl.TEXTURE_MAG_FILTER,i.mag,t),this._setTextureParameterInteger(n,this._gl.TEXTURE_MIN_FILTER,i.min),r&&(t.generateMipMaps=!0,this._gl.generateMipmap(n)),this._bindTextureDirectly(n,null),t.samplingMode=e},CL.prototype.updateTextureDimensions=function(e,t,r,n){},CL.prototype.updateTextureWrappingMode=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=this._getTextureTarget(e);null!==t&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e),e._cachedWrapU=t),null!==r&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(r),e),e._cachedWrapV=r),(e.is2DArray||e.is3D)&&null!==n&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(n),e),e._cachedWrapR=n),this._bindTextureDirectly(i,null)},CL.prototype._setupDepthStencilTexture=function(e,t,r,n,i,o){void 0===o&&(o=1);var s=t.width||t,a=t.height||t,u=t.layers||0;e.baseWidth=s,e.baseHeight=a,e.width=s,e.height=a,e.is2DArray=u>0,e.depth=u,e.isReady=!0,e.samples=o,e.generateMipMaps=!1,e.samplingMode=n?Qd.TEXTURE_BILINEAR_SAMPLINGMODE:Qd.TEXTURE_NEAREST_SAMPLINGMODE,e.type=Qd.TEXTURETYPE_UNSIGNED_INT,e._comparisonFunction=i;var c=this._gl,l=this._getTextureTarget(e),h=this._getSamplingParameters(e.samplingMode,!1);c.texParameteri(l,c.TEXTURE_MAG_FILTER,h.mag),c.texParameteri(l,c.TEXTURE_MIN_FILTER,h.min),c.texParameteri(l,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(l,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),0===i?(c.texParameteri(l,c.TEXTURE_COMPARE_FUNC,Qd.LEQUAL),c.texParameteri(l,c.TEXTURE_COMPARE_MODE,c.NONE)):(c.texParameteri(l,c.TEXTURE_COMPARE_FUNC,i),c.texParameteri(l,c.TEXTURE_COMPARE_MODE,c.COMPARE_REF_TO_TEXTURE))},CL.prototype._uploadCompressedDataToTextureDirectly=function(e,t,r,n,i,o,s){void 0===o&&(o=0),void 0===s&&(s=0);var a=this._gl,u=a.TEXTURE_2D;if(e.isCube&&(u=a.TEXTURE_CUBE_MAP_POSITIVE_X+o),e._useSRGBBuffer)switch(t){case Qd.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2:case Qd.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL:this._caps.etc2?t=a.COMPRESSED_SRGB8_ETC2:e._useSRGBBuffer=!1;break;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC:this._caps.etc2?t=a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:e._useSRGBBuffer=!1;break;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM:t=a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4:t=a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case Qd.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1:this._caps.s3tc_srgb?t=a.COMPRESSED_SRGB_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1:this._caps.s3tc_srgb?t=a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5:this._caps.s3tc_srgb?t=a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:e._useSRGBBuffer=!1;break;default:e._useSRGBBuffer=!1}this._gl.compressedTexImage2D(u,s,t,r,n,0,i)},CL.prototype._uploadDataToTextureDirectly=function(e,t,r,n,i,o){void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=!1);var s=this._gl,a=this._getWebGLTextureType(e.type),u=this._getInternalFormat(e.format),c=void 0===i?this._getRGBABufferInternalSizedFormat(e.type,e.format,e._useSRGBBuffer):this._getInternalFormat(i,e._useSRGBBuffer);this._unpackFlipY(e.invertY);var l=s.TEXTURE_2D;e.isCube&&(l=s.TEXTURE_CUBE_MAP_POSITIVE_X+r);var h=Math.round(Math.log(e.width)*Math.LOG2E),p=Math.round(Math.log(e.height)*Math.LOG2E),f=o?e.width:Math.pow(2,Math.max(h-n,0)),d=o?e.height:Math.pow(2,Math.max(p-n,0));s.texImage2D(l,n,c,f,d,0,u,a,t)},CL.prototype.updateTextureData=function(e,t,r,n,i,o,s,a,u){void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=!1);var c=this._gl,l=this._getWebGLTextureType(e.type),h=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);var p=c.TEXTURE_2D;e.isCube&&(p=c.TEXTURE_CUBE_MAP_POSITIVE_X+s),this._bindTextureDirectly(p,e,!0),c.texSubImage2D(p,a,r,n,i,o,h,l,t),u&&this._gl.generateMipmap(p),this._bindTextureDirectly(p,null)},CL.prototype._uploadArrayBufferViewToTexture=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=this._gl,o=e.isCube?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D;this._bindTextureDirectly(o,e,!0),this._uploadDataToTextureDirectly(e,t,r,n),this._bindTextureDirectly(o,null,!0)},CL.prototype._prepareWebGLTextureContinuation=function(e,t,r,n,i){var o=this._gl;if(o){var s=this._getSamplingParameters(i,!r);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,s.mag),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,s.min),!r&&!n&&o.generateMipmap(o.TEXTURE_2D),this._bindTextureDirectly(o.TEXTURE_2D,null),t&&t._removePendingData(e),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}},CL.prototype._prepareWebGLTexture=function(e,t,r,n,i,o,s,a,u){var c=this;void 0===u&&(u=Qd.TEXTURE_TRILINEAR_SAMPLINGMODE);var l=this.getCaps().maxTextureSize,h=Math.min(l,this.needPOTTextures?CL.GetExponentOfTwo(n.width,l):n.width),p=Math.min(l,this.needPOTTextures?CL.GetExponentOfTwo(n.height,l):n.height),f=this._gl;f&&(e._hardwareTexture?(this._bindTextureDirectly(f.TEXTURE_2D,e,!0),this._unpackFlipY(void 0===i||!!i),e.baseWidth=n.width,e.baseHeight=n.height,e.width=h,e.height=p,e.isReady=!0,a(h,p,n,t,e,(function(){c._prepareWebGLTextureContinuation(e,r,o,s,u)}))||this._prepareWebGLTextureContinuation(e,r,o,s,u)):r&&r._removePendingData(e))},CL.prototype._setupFramebufferDepthAttachments=function(e,t,r,n,i){void 0===i&&(i=1);var o=this._gl;if(e&&t)return this._createRenderBuffer(r,n,i,o.DEPTH_STENCIL,o.DEPTH24_STENCIL8,o.DEPTH_STENCIL_ATTACHMENT);if(t){var s=o.DEPTH_COMPONENT16;return this._webGLVersion>1&&(s=o.DEPTH_COMPONENT32F),this._createRenderBuffer(r,n,i,s,s,o.DEPTH_ATTACHMENT)}return e?this._createRenderBuffer(r,n,i,o.STENCIL_INDEX8,o.STENCIL_INDEX8,o.STENCIL_ATTACHMENT):null},CL.prototype._createRenderBuffer=function(e,t,r,n,i,o,s){void 0===s&&(s=!0);var a=this._gl,u=a.createRenderbuffer();return a.bindRenderbuffer(a.RENDERBUFFER,u),r>1&&a.renderbufferStorageMultisample?a.renderbufferStorageMultisample(a.RENDERBUFFER,r,i,e,t):a.renderbufferStorage(a.RENDERBUFFER,n,e,t),a.framebufferRenderbuffer(a.FRAMEBUFFER,o,a.RENDERBUFFER,u),s&&a.bindRenderbuffer(a.RENDERBUFFER,null),u},CL.prototype._releaseTexture=function(e){var t;this._deleteTexture(null===(t=e._hardwareTexture)||void 0===t?void 0:t.underlyingResource),this.unbindAllTextures();var r=this._internalTexturesCache.indexOf(e);-1!==r&&this._internalTexturesCache.splice(r,1),e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureLow&&e._lodTextureLow.dispose(),e._irradianceTexture&&e._irradianceTexture.dispose()},CL.prototype._releaseRenderTargetWrapper=function(e){var t=this._renderTargetWrapperCache.indexOf(e);-1!==t&&this._renderTargetWrapperCache.splice(t,1)},CL.prototype._deleteTexture=function(e){e&&this._gl.deleteTexture(e)},CL.prototype._setProgram=function(e){this._currentProgram!==e&&(this._gl.useProgram(e),this._currentProgram=e)},CL.prototype.bindSamplers=function(e){var t=e.getPipelineContext();this._setProgram(t.program);for(var r=e.getSamplers(),n=0;n<r.length;n++){var i=e.getUniform(r[n]);i&&(this._boundUniforms[n]=i)}this._currentEffect=null},CL.prototype._activateCurrentTexture=function(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)},CL.prototype._bindTextureDirectly=function(e,t,r,n){var i,o;void 0===r&&(r=!1),void 0===n&&(n=!1);var s=!1,a=t&&t._associatedChannel>-1;if(r&&a&&(this._activeChannel=t._associatedChannel),this._boundTexturesCache[this._activeChannel]!==t||n){if(this._activateCurrentTexture(),t&&t.isMultiview)throw console.error(e,t),"_bindTextureDirectly called with a multiview texture!";this._gl.bindTexture(e,null!==(o=null===(i=null==t?void 0:t._hardwareTexture)||void 0===i?void 0:i.underlyingResource)&&void 0!==o?o:null),this._boundTexturesCache[this._activeChannel]=t,t&&(t._associatedChannel=this._activeChannel)}else r&&(s=!0,this._activateCurrentTexture());return a&&!r&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel),s},CL.prototype._bindTexture=function(e,t,r){if(void 0!==e){t&&(t._associatedChannel=e),this._activeChannel=e;var n=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(n,t)}},CL.prototype.unbindAllTextures=function(){for(var e=0;e<this._maxSimultaneousTextures;e++)this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))},CL.prototype.setTexture=function(e,t,r,n){void 0!==e&&(t&&(this._boundUniforms[e]=t),this._setTexture(e,r))},CL.prototype._bindSamplerUniformToChannel=function(e,t){var r=this._boundUniforms[e];r&&r._currentState!==t&&(this._gl.uniform1i(r,t),r._currentState=t)},CL.prototype._getTextureWrapMode=function(e){switch(e){case Qd.TEXTURE_WRAP_ADDRESSMODE:return this._gl.REPEAT;case Qd.TEXTURE_CLAMP_ADDRESSMODE:return this._gl.CLAMP_TO_EDGE;case Qd.TEXTURE_MIRROR_ADDRESSMODE:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT},CL.prototype._setTexture=function(e,t,r,n,i){if(void 0===r&&(r=!1),void 0===n&&(n=!1),!t)return null!=this._boundTexturesCache[e]&&(this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(t.video)this._activeChannel=e,t.update();else if(t.delayLoadState===Qd.DELAYLOADSTATE_NOTLOADED)return t.delayLoad(),!1;var o;o=n?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!r&&o&&(o._associatedChannel=e);var s=!0;this._boundTexturesCache[e]===o&&(!r&&this._bindSamplerUniformToChannel(o._associatedChannel,e),s=!1),this._activeChannel=e;var a=this._getTextureTarget(o);if(s&&this._bindTextureDirectly(a,o,r),o&&!o.isMultiview){if(o.isCube&&o._cachedCoordinatesMode!==t.coordinatesMode){o._cachedCoordinatesMode=t.coordinatesMode;var u=t.coordinatesMode!==Qd.TEXTURE_CUBIC_MODE&&t.coordinatesMode!==Qd.TEXTURE_SKYBOX_MODE?Qd.TEXTURE_WRAP_ADDRESSMODE:Qd.TEXTURE_CLAMP_ADDRESSMODE;t.wrapU=u,t.wrapV=u}o._cachedWrapU!==t.wrapU&&(o._cachedWrapU=t.wrapU,this._setTextureParameterInteger(a,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),o)),o._cachedWrapV!==t.wrapV&&(o._cachedWrapV=t.wrapV,this._setTextureParameterInteger(a,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),o)),o.is3D&&o._cachedWrapR!==t.wrapR&&(o._cachedWrapR=t.wrapR,this._setTextureParameterInteger(a,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),o)),this._setAnisotropicLevel(a,o,t.anisotropicFilteringLevel)}return!0},CL.prototype.setTextureArray=function(e,t,r,n){if(void 0!==e&&t){(!this._textureUnits||this._textureUnits.length!==r.length)&&(this._textureUnits=new Int32Array(r.length));for(var i=0;i<r.length;i++){var o=r[i].getInternalTexture();o?(this._textureUnits[i]=e+i,o._associatedChannel=e+i):this._textureUnits[i]=-1}this._gl.uniform1iv(t,this._textureUnits);for(var s=0;s<r.length;s++)this._setTexture(this._textureUnits[s],r[s],!0)}},CL.prototype._setAnisotropicLevel=function(e,t,r){var n=this._caps.textureAnisotropicFilterExtension;t.samplingMode!==Qd.TEXTURE_LINEAR_LINEAR_MIPNEAREST&&t.samplingMode!==Qd.TEXTURE_LINEAR_LINEAR_MIPLINEAR&&t.samplingMode!==Qd.TEXTURE_LINEAR_LINEAR&&(r=1),n&&t._cachedAnisotropicFilteringLevel!==r&&(this._setTextureParameterFloat(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r,this._caps.maxAnisotropy),t),t._cachedAnisotropicFilteringLevel=r)},CL.prototype._setTextureParameterFloat=function(e,t,r,n){this._bindTextureDirectly(e,n,!0,!0),this._gl.texParameterf(e,t,r)},CL.prototype._setTextureParameterInteger=function(e,t,r,n){n&&this._bindTextureDirectly(e,n,!0,!0),this._gl.texParameteri(e,t,r)},CL.prototype.unbindAllAttributes=function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e)}else{e=0;for(var t=this._vertexAttribArraysEnabled.length;e<t;e++)e>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[e]||this.disableAttributeByIndex(e)}},CL.prototype.releaseEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e].getPipelineContext();this._deletePipelineContext(t)}this._compiledEffects={}},CL.prototype.dispose=function(){var e;this.stopRenderLoop(),this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.releaseEffects(),null===(e=this.releaseComputeEffects)||void 0===e||e.call(this),this.unbindAllAttributes(),this._boundUniforms=[],hL()&&this._renderingCanvas&&(!this._doNotHandleContextLost&&(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored)),window.removeEventListener("resize",this._checkForMobile)),this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers=[],this._renderingCanvas=null,this._currentProgram=null,this._boundRenderFunction=null;for(var t=0,r=this._activeRequests;t<r.length;t++){r[t].abort()}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},CL.prototype.attachContextLostEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",e,!1)},CL.prototype.attachContextRestoredEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",e,!1)},CL.prototype.getError=function(){return this._gl.getError()},CL.prototype._canRenderToFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(Qd.TEXTURETYPE_FLOAT)},CL.prototype._canRenderToHalfFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(Qd.TEXTURETYPE_HALF_FLOAT)},CL.prototype._canRenderToFramebuffer=function(e){for(var t=this._gl;t.getError()!==t.NO_ERROR;);var r=!0,n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER);if((r=(r=r&&o===t.FRAMEBUFFER_COMPLETE)&&t.getError()===t.NO_ERROR)&&(t.clear(t.COLOR_BUFFER_BIT),r=r&&t.getError()===t.NO_ERROR),r){t.bindFramebuffer(t.FRAMEBUFFER,null);var s=t.RGBA,a=t.UNSIGNED_BYTE,u=new Uint8Array(4);t.readPixels(0,0,1,1,s,a,u),r=r&&t.getError()===t.NO_ERROR}for(t.deleteTexture(n),t.deleteFramebuffer(i),t.bindFramebuffer(t.FRAMEBUFFER,null);!r&&t.getError()!==t.NO_ERROR;);return r},CL.prototype._getWebGLTextureType=function(e){if(1===this._webGLVersion){switch(e){case Qd.TEXTURETYPE_FLOAT:return this._gl.FLOAT;case Qd.TEXTURETYPE_HALF_FLOAT:return this._gl.HALF_FLOAT_OES;case Qd.TEXTURETYPE_UNSIGNED_BYTE:return this._gl.UNSIGNED_BYTE;case Qd.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:return this._gl.UNSIGNED_SHORT_4_4_4_4;case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:return this._gl.UNSIGNED_SHORT_5_5_5_1;case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case Qd.TEXTURETYPE_BYTE:return this._gl.BYTE;case Qd.TEXTURETYPE_UNSIGNED_BYTE:return this._gl.UNSIGNED_BYTE;case Qd.TEXTURETYPE_SHORT:return this._gl.SHORT;case Qd.TEXTURETYPE_UNSIGNED_SHORT:return this._gl.UNSIGNED_SHORT;case Qd.TEXTURETYPE_INT:return this._gl.INT;case Qd.TEXTURETYPE_UNSIGNED_INTEGER:return this._gl.UNSIGNED_INT;case Qd.TEXTURETYPE_FLOAT:return this._gl.FLOAT;case Qd.TEXTURETYPE_HALF_FLOAT:return this._gl.HALF_FLOAT;case Qd.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:return this._gl.UNSIGNED_SHORT_4_4_4_4;case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:return this._gl.UNSIGNED_SHORT_5_5_5_1;case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:return this._gl.UNSIGNED_SHORT_5_6_5;case Qd.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case Qd.TEXTURETYPE_UNSIGNED_INT_24_8:return this._gl.UNSIGNED_INT_24_8;case Qd.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case Qd.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case Qd.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE},CL.prototype._getInternalFormat=function(e,t){void 0===t&&(t=!1);var r=t?this._gl.SRGB8_ALPHA8:this._gl.RGBA;switch(e){case Qd.TEXTUREFORMAT_ALPHA:r=this._gl.ALPHA;break;case Qd.TEXTUREFORMAT_LUMINANCE:r=this._gl.LUMINANCE;break;case Qd.TEXTUREFORMAT_LUMINANCE_ALPHA:r=this._gl.LUMINANCE_ALPHA;break;case Qd.TEXTUREFORMAT_RED:r=this._gl.RED;break;case Qd.TEXTUREFORMAT_RG:r=this._gl.RG;break;case Qd.TEXTUREFORMAT_RGB:r=t?this._gl.SRGB:this._gl.RGB;break;case Qd.TEXTUREFORMAT_RGBA:r=t?this._gl.SRGB8_ALPHA8:this._gl.RGBA}if(this._webGLVersion>1)switch(e){case Qd.TEXTUREFORMAT_RED_INTEGER:r=this._gl.RED_INTEGER;break;case Qd.TEXTUREFORMAT_RG_INTEGER:r=this._gl.RG_INTEGER;break;case Qd.TEXTUREFORMAT_RGB_INTEGER:r=this._gl.RGB_INTEGER;break;case Qd.TEXTUREFORMAT_RGBA_INTEGER:r=this._gl.RGBA_INTEGER}return r},CL.prototype._getRGBABufferInternalSizedFormat=function(e,t,r){if(void 0===r&&(r=!1),1===this._webGLVersion){if(void 0!==t)switch(t){case Qd.TEXTUREFORMAT_ALPHA:return this._gl.ALPHA;case Qd.TEXTUREFORMAT_LUMINANCE:return this._gl.LUMINANCE;case Qd.TEXTUREFORMAT_LUMINANCE_ALPHA:return this._gl.LUMINANCE_ALPHA;case Qd.TEXTUREFORMAT_RGB:return r?this._gl.SRGB:this._gl.RGB}return this._gl.RGBA}switch(e){case Qd.TEXTURETYPE_BYTE:switch(t){case Qd.TEXTUREFORMAT_RED:return this._gl.R8_SNORM;case Qd.TEXTUREFORMAT_RG:return this._gl.RG8_SNORM;case Qd.TEXTUREFORMAT_RGB:return this._gl.RGB8_SNORM;case Qd.TEXTUREFORMAT_RED_INTEGER:return this._gl.R8I;case Qd.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG8I;case Qd.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB8I;case Qd.TEXTUREFORMAT_RGBA_INTEGER:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case Qd.TEXTURETYPE_UNSIGNED_BYTE:switch(t){case Qd.TEXTUREFORMAT_RED:return this._gl.R8;case Qd.TEXTUREFORMAT_RG:return this._gl.RG8;case Qd.TEXTUREFORMAT_RGB:return r?this._gl.SRGB8:this._gl.RGB8;case Qd.TEXTUREFORMAT_RGBA:return r?this._gl.SRGB8_ALPHA8:this._gl.RGBA8;case Qd.TEXTUREFORMAT_RED_INTEGER:return this._gl.R8UI;case Qd.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG8UI;case Qd.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB8UI;case Qd.TEXTUREFORMAT_RGBA_INTEGER:return this._gl.RGBA8UI;case Qd.TEXTUREFORMAT_ALPHA:return this._gl.ALPHA;case Qd.TEXTUREFORMAT_LUMINANCE:return this._gl.LUMINANCE;case Qd.TEXTUREFORMAT_LUMINANCE_ALPHA:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case Qd.TEXTURETYPE_SHORT:switch(t){case Qd.TEXTUREFORMAT_RED_INTEGER:return this._gl.R16I;case Qd.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG16I;case Qd.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB16I;case Qd.TEXTUREFORMAT_RGBA_INTEGER:default:return this._gl.RGBA16I}case Qd.TEXTURETYPE_UNSIGNED_SHORT:switch(t){case Qd.TEXTUREFORMAT_RED_INTEGER:return this._gl.R16UI;case Qd.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG16UI;case Qd.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB16UI;case Qd.TEXTUREFORMAT_RGBA_INTEGER:default:return this._gl.RGBA16UI}case Qd.TEXTURETYPE_INT:switch(t){case Qd.TEXTUREFORMAT_RED_INTEGER:return this._gl.R32I;case Qd.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG32I;case Qd.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB32I;case Qd.TEXTUREFORMAT_RGBA_INTEGER:default:return this._gl.RGBA32I}case Qd.TEXTURETYPE_UNSIGNED_INTEGER:switch(t){case Qd.TEXTUREFORMAT_RED_INTEGER:return this._gl.R32UI;case Qd.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG32UI;case Qd.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB32UI;case Qd.TEXTUREFORMAT_RGBA_INTEGER:default:return this._gl.RGBA32UI}case Qd.TEXTURETYPE_FLOAT:switch(t){case Qd.TEXTUREFORMAT_RED:return this._gl.R32F;case Qd.TEXTUREFORMAT_RG:return this._gl.RG32F;case Qd.TEXTUREFORMAT_RGB:return this._gl.RGB32F;case Qd.TEXTUREFORMAT_RGBA:default:return this._gl.RGBA32F}case Qd.TEXTURETYPE_HALF_FLOAT:switch(t){case Qd.TEXTUREFORMAT_RED:return this._gl.R16F;case Qd.TEXTUREFORMAT_RG:return this._gl.RG16F;case Qd.TEXTUREFORMAT_RGB:return this._gl.RGB16F;case Qd.TEXTUREFORMAT_RGBA:default:return this._gl.RGBA16F}case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:return this._gl.RGB565;case Qd.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV:return this._gl.R11F_G11F_B10F;case Qd.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV:return this._gl.RGB9_E5;case Qd.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:return this._gl.RGBA4;case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:return this._gl.RGB5_A1;case Qd.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV:switch(t){case Qd.TEXTUREFORMAT_RGBA:return this._gl.RGB10_A2;case Qd.TEXTUREFORMAT_RGBA_INTEGER:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return r?this._gl.SRGB8_ALPHA8:this._gl.RGBA8},CL.prototype._getRGBAMultiSampleBufferFormat=function(e){return e===Qd.TEXTURETYPE_FLOAT?this._gl.RGBA32F:e===Qd.TEXTURETYPE_HALF_FLOAT?this._gl.RGBA16F:this._gl.RGBA8},CL.prototype._loadFile=function(e,t,r,n,i,o){var s=this,a=CL._FileToolsLoadFile(e,t,r,n,i,o);return this._activeRequests.push(a),a.onCompleteObservable.add((function(e){s._activeRequests.splice(s._activeRequests.indexOf(e),1)})),a},CL._FileToolsLoadFile=function(e,t,r,n,i,o){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_3__._WarnImport)("FileTools")},CL.prototype.readPixels=function(e,t,r,n,i,o){void 0===i&&(i=!0),void 0===o&&(o=!0);var s=i?4:3,a=i?this._gl.RGBA:this._gl.RGB,u=new Uint8Array(n*r*s);return o&&this.flushFramebuffer(),this._gl.readPixels(e,t,r,n,a,this._gl.UNSIGNED_BYTE,u),Promise.resolve(u)},Object.defineProperty(CL,"IsSupportedAsync",{get:function(){return Promise.resolve(this.isSupported())},enumerable:!1,configurable:!0}),Object.defineProperty(CL,"IsSupported",{get:function(){return this.isSupported()},enumerable:!1,configurable:!0}),CL.isSupported=function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var e=this._CreateCanvas(1,1),t=e.getContext("webgl")||e.getContext("experimental-webgl");this._IsSupported=null!=t&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported},Object.defineProperty(CL,"HasMajorPerformanceCaveat",{get:function(){if(null===this._HasMajorPerformanceCaveat)try{var e=this._CreateCanvas(1,1),t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat},enumerable:!1,configurable:!0}),CL.CeilingPOT=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},CL.FloorPOT=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)},CL.NearestPOT=function(e){var t=CL.CeilingPOT(e),r=CL.FloorPOT(e);return t-e>e-r?r:t},CL.GetExponentOfTwo=function(e,t,r){var n;switch(void 0===r&&(r=Qd.SCALEMODE_NEAREST),r){case Qd.SCALEMODE_FLOOR:n=CL.FloorPOT(e);break;case Qd.SCALEMODE_NEAREST:n=CL.NearestPOT(e);break;case Qd.SCALEMODE_CEILING:default:n=CL.CeilingPOT(e)}return Math.min(n,t)},CL.QueueNewFrame=function(e,t){return hL()?(!t&&(t=window),t.requestPostAnimationFrame?t.requestPostAnimationFrame(e):t.requestAnimationFrame?t.requestAnimationFrame(e):t.msRequestAnimationFrame?t.msRequestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.mozRequestAnimationFrame?t.mozRequestAnimationFrame(e):t.oRequestAnimationFrame?t.oRequestAnimationFrame(e):window.setTimeout(e,16)):"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(e):setTimeout(e,16)},CL.prototype.getHostDocument=function(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:pL()?document:null},CL.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:".*AppleWebKit.*(15.4).*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]},{key:".*(15.4).*AppleWebKit.*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]}],CL._TextureLoaders=[],CL.CollisionsEpsilon=.001,CL._IsSupported=null,CL._HasMajorPerformanceCaveat=null,CL.prototype._createHardwareRenderTargetWrapper=function(e,t,r){var n=new _WebGL_webGLRenderTargetWrapper__WEBPACK_IMPORTED_MODULE_4__.WebGLRenderTargetWrapper(e,t,r,this,this._gl);return this._renderTargetWrapperCache.push(n),n},CL.prototype.createDepthStencilTexture=function(e,t,r){if(t.isCube){var n=e.width||e;return this._createDepthStencilCubeTexture(n,t,r)}return this._createDepthStencilTexture(e,t,r)};var bL,IL=(bL=!0,function(e,t){var r=bL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return bL=!1,r}),vL=IL(void 0,(function(){return vL.toString().search("(((.+)+)+)+$").toString().constructor(vL).search("(((.+)+)+)+$")}));function TL(e,t,r,n){switch(void 0===r&&(r=!1),e){case Qd.TEXTURETYPE_BYTE:var i=(ArrayBuffer,new Int8Array(t));return n&&i.set(new Int8Array(n)),i;case Qd.TEXTURETYPE_UNSIGNED_BYTE:var o=(ArrayBuffer,new Uint8Array(t));return n&&o.set(new Uint8Array(n)),o;case Qd.TEXTURETYPE_SHORT:var s=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(r?t/2:t);return n&&s.set(new Int16Array(n)),s;case Qd.TEXTURETYPE_UNSIGNED_SHORT:case Qd.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:case Qd.TEXTURETYPE_HALF_FLOAT:var a=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(r?t/2:t);return n&&a.set(new Uint16Array(n)),a;case Qd.TEXTURETYPE_INT:var u=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(r?t/4:t);return n&&u.set(new Int32Array(n)),u;case Qd.TEXTURETYPE_UNSIGNED_INTEGER:case Qd.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV:case Qd.TEXTURETYPE_UNSIGNED_INT_24_8:case Qd.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV:case Qd.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV:case Qd.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV:var c=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(r?t/4:t);return n&&c.set(new Uint32Array(n)),c;case Qd.TEXTURETYPE_FLOAT:var l=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(r?t/4:t);return n&&l.set(new Float32Array(n)),l}var h=(ArrayBuffer,new Uint8Array(t));return n&&h.set(new Uint8Array(n)),h}vL(),CL.prototype._readTexturePixelsSync=function(e,t,r,n,i,o,s,a,u,c){var l,h;void 0===n&&(n=-1),void 0===i&&(i=0),void 0===o&&(o=null),void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===u&&(u=0),void 0===c&&(c=0);var p=this._gl;if(!p)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){var f=p.createFramebuffer();if(!f)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=f}p.bindFramebuffer(p.FRAMEBUFFER,this._dummyFramebuffer),n>-1?p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+n,null===(l=e._hardwareTexture)||void 0===l?void 0:l.underlyingResource,i):p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,null===(h=e._hardwareTexture)||void 0===h?void 0:h.underlyingResource,i);var d=void 0!==e.type?this._getWebGLTextureType(e.type):p.UNSIGNED_BYTE;if(a)!o&&(o=TL(e.type,4*t*r));else if(d===p.UNSIGNED_BYTE)!o&&(o=new Uint8Array(4*t*r)),d=p.UNSIGNED_BYTE;else!o&&(o=new Float32Array(4*t*r)),d=p.FLOAT;return s&&this.flushFramebuffer(),p.readPixels(u,c,t,r,p.RGBA,d,o),p.bindFramebuffer(p.FRAMEBUFFER,this._currentFramebuffer),o},CL.prototype._readTexturePixels=function(e,t,r,n,i,o,s,a,u,c){return void 0===n&&(n=-1),void 0===i&&(i=0),void 0===o&&(o=null),void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===u&&(u=0),void 0===c&&(c=0),Promise.resolve(this._readTexturePixelsSync(e,t,r,n,i,o,s,a,u,c))};var RL,SL=(RL=!0,function(e,t){var r=RL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return RL=!1,r}),ML=SL(void 0,(function(){return ML.toString().search("(((.+)+)+)+$").toString().constructor(ML).search("(((.+)+)+)+$")}));function wL(e){this._deferredReleaseBuffers=[],this._device=e}ML(),wL._IsGPUBuffer=function(e){return void 0===e.underlyingResource},wL.prototype.createRawBuffer=function(e,t,r){void 0===r&&(r=!1);var n={mappedAtCreation:r,size:void 0!==e.byteLength?e.byteLength+3&-4:e+3&-4,usage:t};return this._device.createBuffer(n)},wL.prototype.createBuffer=function(e,t){var r=void 0!==e.byteLength,n=new IN(this.createRawBuffer(e,t));return n.references=1,n.capacity=r?e.byteLength:e,r&&this.setSubData(n,0,e),n},wL.prototype.setRawData=function(e,t,r,n,i){this._device.queue.writeBuffer(e,t,r.buffer,n,i)},wL.prototype.setSubData=function(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var o=e.underlyingResource;i=i||r.byteLength,i=Math.min(i,e.capacity-t);var s=r.byteOffset+n,a=s+i,u=i+3&-4;if(u!==i){var c=new Uint8Array(r.buffer.slice(s,a));(r=new Uint8Array(u)).set(c),n=0,s=0,a=u,i=u}for(var l=15728640,h=0;a-(s+h)>l;)this._device.queue.writeBuffer(o,t+h,r.buffer,s+h,l),h+=l;this._device.queue.writeBuffer(o,t+h,r.buffer,s+h,i-h)},wL.prototype.createBufferByMap=function(e,t){var r=void 0!==e.byteLength,n=new IN(o=this.createRawBuffer(e,t,!0));if(n.references=1,n.capacity=r?e.byteLength:e,r){var i=e,o=n.underlyingResource,s=i.byteLength;s=Math.min(s,n.capacity-0);var a=i.byteOffset,u=a+s,c=s+3&-4;if(c!==s){var l=new Uint8Array(i.buffer.slice(a,u));(i=new Uint8Array(c)).set(l),a=0,u=c,s=c}var h=o.getMappedRange();new(0,i.constructor)(h).set(i),o.unmap()}return n},wL.prototype._getHalfFloatAsFloatRGBAArrayBuffer=function(e,t,r){!r&&(r=new Float32Array(e));for(var n=new Uint16Array(t);e--;)r[e]=KN(n[e]);return r},wL.prototype.readDataFromBuffer=function(e,t,r,n,i,o,s,a,u,c,l){var h=this;void 0===s&&(s=Qd.TEXTURETYPE_UNSIGNED_BYTE),void 0===a&&(a=0),void 0===u&&(u=null),void 0===c&&(c=!0),void 0===l&&(l=!1);var p=s===Qd.TEXTURETYPE_FLOAT?2:s===Qd.TEXTURETYPE_HALF_FLOAT?1:0;return new Promise((function(r,f){e.mapAsync(_N.MapMode.Read,a,t).then((function(){var f=e.getMappedRange(a,t),d=u;if(l)d=null===d?TL(s,t,!0,f):TL(s,d.buffer,void 0,f);else if(null===d)switch(p){case 0:(d=new Uint8Array(t)).set(new Uint8Array(f));break;case 1:d=h._getHalfFloatAsFloatRGBAArrayBuffer(t/2,f);break;case 2:(d=new Float32Array(t/4)).set(new Float32Array(f))}else switch(p){case 0:(d=new Uint8Array(d.buffer)).set(new Uint8Array(f));break;case 1:d=h._getHalfFloatAsFloatRGBAArrayBuffer(t/2,f,u);break;case 2:(d=new Float32Array(d.buffer)).set(new Float32Array(f))}if(i!==o){1===p&&!l&&(i*=2,o*=2);for(var A=new Uint8Array(d.buffer),g=i,_=0,m=1;m<n;++m){_=m*o;for(var y=0;y<i;++y)A[g++]=A[_++]}d=0===p||l?new Uint8Array(A.buffer,0,g):new Float32Array(A.buffer,0,g/4)}e.unmap(),c&&h.releaseBuffer(e),r(d)}),(function(e){return f(e)}))}))},wL.prototype.releaseBuffer=function(e){return wL._IsGPUBuffer(e)?(this._deferredReleaseBuffers.push(e),!0):(e.references--,0===e.references&&(this._deferredReleaseBuffers.push(e.underlyingResource),!0))},wL.prototype.destroyDeferredBuffers=function(){for(var e=0;e<this._deferredReleaseBuffers.length;++e)this._deferredReleaseBuffers[e].destroy();this._deferredReleaseBuffers.length=0};var BL,OL=(BL=!0,function(e,t){var r=BL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return BL=!1,r}),DL=OL(void 0,(function(){return DL.toString().search("(((.+)+)+)+$").toString().constructor(DL).search("(((.+)+)+)+$")}));function FL(e){void 0===e&&(e=null),this.format=_N.TextureFormat.RGBA8Unorm,this.textureUsages=0,this.textureAdditionalUsages=0,this._webgpuTexture=e,this._webgpuMSAATexture=null,this.view=null,this.viewForWriting=null,this.msaaView=null}DL(),Object.defineProperty(FL.prototype,"underlyingResource",{get:function(){return this._webgpuTexture},enumerable:!1,configurable:!0}),Object.defineProperty(FL.prototype,"msaaTexture",{get:function(){return this._webgpuMSAATexture},set:function(e){this._webgpuMSAATexture=e},enumerable:!1,configurable:!0}),FL.prototype.set=function(e){this._webgpuTexture=e},FL.prototype.setUsage=function(e,t,r,n,i){t=e!==_Materials_Textures_internalTexture__WEBPACK_IMPORTED_MODULE_0__.InternalTextureSource.RenderTarget&&t,this.createView({format:this.format,dimension:r?_N.TextureViewDimension.Cube:_N.TextureViewDimension.E2d,mipLevelCount:t?_Maths_math_scalar__WEBPACK_IMPORTED_MODULE_1__.Scalar.ILog2(Math.max(n,i))+1:1,baseArrayLayer:0,baseMipLevel:0,arrayLayerCount:r?6:1,aspect:_N.TextureAspect.All})},FL.prototype.createView=function(e,t){if(void 0===t&&(t=!1),this.view=this._webgpuTexture.createView(e),t&&e){var r=e.mipLevelCount;e.mipLevelCount=1,this.viewForWriting=this._webgpuTexture.createView(e),e.mipLevelCount=r}},FL.prototype.createMSAAView=function(e){this.msaaView=this._webgpuMSAATexture.createView(e)},FL.prototype.reset=function(){this._webgpuTexture=null,this._webgpuMSAATexture=null,this.view=null,this.viewForWriting=null,this.msaaView=null},FL.prototype.release=function(){var e,t,r;null===(e=this._webgpuTexture)||void 0===e||e.destroy(),null===(t=this._webgpuMSAATexture)||void 0===t||t.destroy(),null===(r=this._copyInvertYTempTexture)||void 0===r||r.destroy(),this.reset()};var PL,NL=(PL=!0,function(e,t){var r=PL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return PL=!1,r}),LL=NL(void 0,(function(){return LL.toString().search("(((.+)+)+)+$").toString().constructor(LL).search("(((.+)+)+)+$")}));function UL(){}LL(),Object.defineProperty(UL.prototype,"UniqueId",{get:function(){var e=this._UniqueIdCounter;return this._UniqueIdCounter++,e},enumerable:!1,configurable:!0}),UL._UniqueIdCounter=0,UL.add=function(){};var GL,QL=(GL=!0,function(e,t){var r=GL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return GL=!1,r}),kL=QL(void 0,(function(){return kL.toString().search("(((.+)+)+)+$").toString().constructor(kL).search("(((.+)+)+)+$")}));function zL(){this.children=[]}kL(),zL.prototype.isValid=function(e){return!0},zL.prototype.process=function(e,t){var r="";if(this.line){var n=this.line,i=t.processor;if(i){if(i.lineProcessor&&(n=i.lineProcessor(n,t.isFragment,t.processingContext)),i.attributeProcessor&&this.line.startsWith("attribute"))n=i.attributeProcessor(this.line,e,t.processingContext);else if(i.varyingProcessor&&this.line.startsWith("varying"))n=i.varyingProcessor(this.line,t.isFragment,e,t.processingContext);else if(i.uniformProcessor&&i.uniformRegexp&&i.uniformRegexp.test(this.line))!t.lookForClosingBracketForUniformBuffer&&(n=i.uniformProcessor(this.line,t.isFragment,e,t.processingContext));else if(i.uniformBufferProcessor&&i.uniformBufferRegexp&&i.uniformBufferRegexp.test(this.line))!t.lookForClosingBracketForUniformBuffer&&(n=i.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0);else if(i.textureProcessor&&i.textureRegexp&&i.textureRegexp.test(this.line))n=i.textureProcessor(this.line,t.isFragment,e,t.processingContext);else if((i.uniformProcessor||i.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!t.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:mediump)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?i.uniformProcessor&&(n=i.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):i.uniformBufferProcessor&&(n=i.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)}t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,i.endOfUniformBufferProcessor&&(n=i.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}r+=n+"\r\n"}return this.children.forEach((function(n){r+=n.process(e,t)})),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),r};var jL,HL=(jL=!0,function(e,t){var r=jL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return jL=!1,r}),qL=HL(void 0,(function(){return qL.toString().search("(((.+)+)+)+$").toString().constructor(qL).search("(((.+)+)+)+$")}));function VL(){}qL(),Object.defineProperty(VL.prototype,"currentLine",{get:function(){return this._lines[this.lineIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(VL.prototype,"canRead",{get:function(){return this.lineIndex<this._lines.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(VL.prototype,"lines",{set:function(e){this._lines=[];for(var t=0,r=e;t<r.length;t++){var n=r[t];if("#"!==n[0])if(n.trim().startsWith("//"))this._lines.push(n);else for(var i=n.split(";"),o=0;o<i.length;o++){var s=i[o];(s=s.trim())&&this._lines.push(s+(o!==i.length-1?";":""))}else this._lines.push(n)}},enumerable:!1,configurable:!0});var YL,XL=(YL=!0,function(e,t){var r=YL?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return YL=!1,r}),WL=XL(void 0,(function(){return WL.toString().search("(((.+)+)+)+$").toString().constructor(WL).search("(((.+)+)+)+$")}));function KL(){return null!==zL&&zL.apply(this,arguments)||this}WL(),zL&&(KL.__proto__=zL),KL.prototype=Object.create(zL&&zL.prototype),KL.prototype.constructor=zL,KL.prototype.process=function(e,t){for(var r=0;r<this.children.length;r++){var n=this.children[r];if(n.isValid(e))return n.process(e,t)}return""};var $L,JL=($L=!0,function(e,t){var r=$L?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return $L=!1,r}),ZL=JL(void 0,(function(){return ZL.toString().search("(((.+)+)+)+$").toString().constructor(ZL).search("(((.+)+)+)+$")}));function eU(){return null!==zL&&zL.apply(this,arguments)||this}ZL(),zL&&(eU.__proto__=zL),eU.prototype=Object.create(zL&&zL.prototype),eU.prototype.constructor=zL,eU.prototype.isValid=function(e){return this.testExpression.isTrue(e)};var tU,rU=(tU=!0,function(e,t){var r=tU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return tU=!1,r}),nU=rU(void 0,(function(){return nU.toString().search("(((.+)+)+)+$").toString().constructor(nU).search("(((.+)+)+)+$")}));function iU(){}nU(),iU.prototype.isTrue=function(e){return!0},iU.postfixToInfix=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];if(void 0===iU._OperatorPriority[i])t.push(i);else{var o=t[t.length-1],s=t[t.length-2];t.length-=2,t.push("(".concat(s).concat(i).concat(o,")"))}}return t[t.length-1]},iU.infixToPostfix=function(e){for(var t=[],r=-1,n=function(){""!==(u=u.trim())&&(t.push(u),u="")},i=function(e){r<iU._Stack.length-1&&(iU._Stack[++r]=e)},o=function(){return iU._Stack[r]},s=function(){return-1===r?"!!INVALID EXPRESSION!!":iU._Stack[r--]},a=0,u="";a<e.length;){var c=e.charAt(a),l=a<e.length-1?e.substr(a,2):"";if("("===c)u="",i(c);else if(")"===c){for(n();-1!==r&&"("!==o();)t.push(s());s()}else if(iU._OperatorPriority[l]>1){for(n();-1!==r&&iU._OperatorPriority[o()]>=iU._OperatorPriority[l];)t.push(s());i(l),a++}else u+=c;a++}for(n();-1!==r;)"("===o()?s():t.push(s());return t},iU._OperatorPriority={")":0,"(":1,"||":2,"&&":3},iU._Stack=["","","","","","","","","","","","","","","","","","","",""];var oU,sU=(oU=!0,function(e,t){var r=oU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return oU=!1,r}),aU=sU(void 0,(function(){return aU.toString().search("(((.+)+)+)+$").toString().constructor(aU).search("(((.+)+)+)+$")}));function uU(e,t){void 0===t&&(t=!1);var r=iU.call(this)||this;return r.define=e,r.not=t,r}aU(),iU&&(uU.__proto__=iU),uU.prototype=Object.create(iU&&iU.prototype),uU.prototype.constructor=iU,uU.prototype.isTrue=function(e){var t=void 0!==e[this.define];return this.not&&(t=!t),t};var cU,lU=(cU=!0,function(e,t){var r=cU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return cU=!1,r}),hU=lU(void 0,(function(){return hU.toString().search("(((.+)+)+)+$").toString().constructor(hU).search("(((.+)+)+)+$")}));function pU(){return null!==iU&&iU.apply(this,arguments)||this}hU(),iU&&(pU.__proto__=iU),pU.prototype=Object.create(iU&&iU.prototype),pU.prototype.constructor=iU,pU.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)};var fU,dU=(fU=!0,function(e,t){var r=fU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return fU=!1,r}),AU=dU(void 0,(function(){return AU.toString().search("(((.+)+)+)+$").toString().constructor(AU).search("(((.+)+)+)+$")}));function gU(){return null!==iU&&iU.apply(this,arguments)||this}AU(),iU&&(gU.__proto__=iU),gU.prototype=Object.create(iU&&iU.prototype),gU.prototype.constructor=iU,gU.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)};var _U,mU=(_U=!0,function(e,t){var r=_U?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return _U=!1,r}),yU=mU(void 0,(function(){return yU.toString().search("(((.+)+)+)+$").toString().constructor(yU).search("(((.+)+)+)+$")}));function EU(e,t,r){var n=iU.call(this)||this;return n.define=e,n.operand=t,n.testValue=r,n}yU(),iU&&(EU.__proto__=iU),EU.prototype=Object.create(iU&&iU.prototype),EU.prototype.constructor=iU,EU.prototype.isTrue=function(e){var t=e[this.define];void 0===t&&(t=this.define);var r=!1,n=parseInt(t),i=parseInt(this.testValue);switch(this.operand){case">":r=n>i;break;case"<":r=n<i;break;case"<=":r=n<=i;break;case">=":r=n>=i;break;case"==":r=n===i}return r};var xU,CU=(xU=!0,function(e,t){var r=xU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return xU=!1,r}),bU=CU(void 0,(function(){return bU.toString().search("(((.+)+)+)+$").toString().constructor(bU).search("(((.+)+)+)+$")}));bU();var IU,vU=Object.freeze({GLSL:0,WGSL:1,0:"GLSL",1:"WGSL"}),TU=(IU=!0,function(e,t){var r=IU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return IU=!1,r}),RU=TU(void 0,(function(){return RU.toString().search("(((.+)+)+)+$").toString().constructor(RU).search("(((.+)+)+)+$")}));RU();var SU=/defined\s*?\((.+?)\)/g,MU=/defined\s*?\[(.+?)\]/g,wU=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g;function BU(){}BU.Initialize=function(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)},BU.Process=function(e,t,r,n){var i,o=this;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,(function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var i=o._ProcessShaderConversion(e,t,n);r(i)}))},BU.PreProcess=function(e,t,r,n){var i,o=this;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,(function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var i=o._ApplyPreProcessing(e,t,n);r(i)}))},BU.Finalize=function(e,t,r){return r.processor&&r.processor.finalizeShaders?r.processor.finalizeShaders(e,t,r.processingContext):{vertexCode:e,fragmentCode:t}},BU._ProcessPrecision=function(e,t){var r;if(null===(r=t.processor)||void 0===r?void 0:r.noPrecision)return e;var n=t.shouldUseHighPrecisionShader;return-1===e.indexOf("precision highp float")?e=n?"precision highp float;\n"+e:"precision mediump float;\n"+e:!n&&(e=e.replace("precision highp float","precision mediump float")),e},BU._ExtractOperation=function(e){var t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new uU(t[1].trim(),"!"===e[0]);for(var r="",n=0,i=0,o=["==",">=","<=","<",">"];i<o.length&&(r=o[i],!((n=e.indexOf(r))>-1));i++);return-1===n?new uU(e):new EU(e.substring(0,n).trim(),r,e.substring(n+r.length).trim())},BU._BuildSubExpression=function(e){e=e.replace(SU,"defined[$1]");for(var t=[],r=0,n=iU.infixToPostfix(e);r<n.length;r++){var i=n[r];if("||"!==i&&"&&"!==i)t.push(i);else if(t.length>=2){var o=t[t.length-1],s=t[t.length-2];t.length-=2;var a="&&"==i?new gU:new pU;"string"==typeof o&&(o=o.replace(MU,"defined($1)")),"string"==typeof s&&(s=s.replace(MU,"defined($1)")),a.leftOperand="string"==typeof s?this._ExtractOperation(s):s,a.rightOperand="string"==typeof o?this._ExtractOperation(o):o,t.push(a)}}var u=t[t.length-1];return"string"==typeof u&&(u=u.replace(MU,"defined($1)")),"string"==typeof u?this._ExtractOperation(u):u},BU._BuildExpression=function(e,t){var r=new eU,n=e.substring(0,t),i=e.substring(t);return i=i.substring(0,(i.indexOf("//")+1||i.length+1)-1).trim(),r.testExpression="#ifdef"===n?new uU(i):"#ifndef"===n?new uU(i,!0):this._BuildSubExpression(i),r},BU._MoveCursorWithinIf=function(e,t,r){for(var n=e.currentLine;this._MoveCursor(e,r);){var i=(n=e.currentLine).substring(0,5).toLowerCase();if("#else"===i){var o=new zL;return t.children.push(o),void this._MoveCursor(e,o)}if("#elif"===i){var s=this._BuildExpression(n,5);t.children.push(s),r=s}}},BU._MoveCursor=function(e,t){for(;e.canRead;){e.lineIndex++;var r=e.currentLine,n=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(r);if(n&&n.length){switch(n[0]){case"#ifdef":var i=new KL;t.children.push(i);var o=this._BuildExpression(r,6);i.children.push(o),this._MoveCursorWithinIf(e,i,o);break;case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":i=new KL;t.children.push(i);o=this._BuildExpression(r,7);i.children.push(o),this._MoveCursorWithinIf(e,i,o);break;case"#if":i=new KL,o=this._BuildExpression(r,3);t.children.push(i),i.children.push(o),this._MoveCursorWithinIf(e,i,o)}}else{var s=new zL;if(s.line=r,t.children.push(s),"#"===r[0]&&"d"===r[1]){var a=r.replace(";","").split(" ");s.additionalDefineKey=a[1],3===a.length&&(s.additionalDefineValue=a[2])}}}return!1},BU._EvaluatePreProcessors=function(e,t,r){var n=new zL,i=new VL;return i.lineIndex=-1,i.lines=e.split("\n"),this._MoveCursor(i,n),n.process(t,r)},BU.removeUnuseCode=function(e,t,r){for(var n={},i=0,o=t.concat(r);i<o.length;i++){var s=o[i].replace("#define","").replace(";","").trim().split(" ");n[s[0]]=s.length>1?s[1]:""}var a=new zL,u=new VL;return u.lineIndex=-1,u.lines=e.split("\n"),this._MoveCursor(u,a),a.process(n,{processor:{}})},BU._PreparePreProcessors=function(e,t){for(var r,n={},i=0,o=e.defines;i<o.length;i++){var s=o[i].replace("#define","").replace(";","").trim().split(" ");n[s[0]]=s.length>1?s[1]:""}return(null===(r=e.processor)||void 0===r?void 0:r.shaderLanguage)===vU.GLSL&&(n.GL_ES="true"),n.__VERSION__=e.version,n[e.platformName]="true",t._getGlobalDefines(n),n},BU._ProcessShaderConversion=function(e,t,r){var n=this._ProcessPrecision(e,t);if(!t.processor)return n;if(t.processor.shaderLanguage===vU.GLSL&&-1!==n.indexOf("#version 3"))return n.replace("#version 300 es","");var i=t.defines,o=this._PreparePreProcessors(t,r);return t.processor.preProcessor&&(n=t.processor.preProcessor(n,i,t.isFragment,t.processingContext)),n=this._EvaluatePreProcessors(n,o,t),t.processor.postProcessor&&(n=t.processor.postProcessor(n,i,t.isFragment,t.processingContext,r)),r._features.needShaderCodeInlining&&(n=r.inlineShaderCode(n)),n},BU._ApplyPreProcessing=function(e,t,r){var n,i,o=e,s=t.defines,a=this._PreparePreProcessors(t,r);return(null===(n=t.processor)||void 0===n?void 0:n.preProcessor)&&(o=t.processor.preProcessor(o,s,t.isFragment,t.processingContext)),o=this._EvaluatePreProcessors(o,a,t),(null===(i=t.processor)||void 0===i?void 0:i.postProcessor)&&(o=t.processor.postProcessor(o,s,t.isFragment,t.processingContext,r)),r._features.needShaderCodeInlining&&(o=r.inlineShaderCode(o)),o},BU._ProcessIncludes=function(e,t,r){for(var n=this,i=wU.exec(e),o=new String(e),s=!1,a=function(){var a=i[1];if(-1!==a.indexOf("__decl__")&&(a=a.replace(/__decl__/,""),t.supportsUniformBuffers&&(a=(a=a.replace(/Vertex/,"Ubo")).replace(/Fragment/,"Ubo")),a+="Declaration"),!t.includesShadersStore[a]){var u=t.shadersRepository+"ShadersInclude/"+a+".fx";return BU._FileToolsLoadFile(u,(function(e){t.includesShadersStore[a]=e,n._ProcessIncludes(o,t,r)})),{value:void 0}}var c=t.includesShadersStore[a];if(i[2])for(var l=i[3].split(","),h=0;h<l.length;h+=2){var p=new RegExp(l[h],"g"),f=l[h+1];c=c.replace(p,f)}if(i[4]){var d=i[5];if(-1!==d.indexOf("..")){var A=d.split(".."),g=parseInt(A[0]),_=parseInt(A[1]),m=c.slice(0);c="",isNaN(_)&&(_=t.indexParameters[A[1]]);for(var y=g;y<_;y++)!t.supportsUniformBuffers&&(m=m.replace(/light\{X\}.(\w*)/g,(function(e,t){return t+"{X}"}))),c+=m.replace(/\{X\}/g,y.toString())+"\n"}else!t.supportsUniformBuffers&&(c=c.replace(/light\{X\}.(\w*)/g,(function(e,t){return t+"{X}"}))),c=c.replace(/\{X\}/g,d)}o=o.replace(i[0],c),s=s||c.indexOf("#include<")>=0||c.indexOf("#include <")>=0,i=wU.exec(e)};null!=i;){var u=a();if("object"==typeof u)return u.value}s?this._ProcessIncludes(o.toString(),t,r):r(o)},BU._FileToolsLoadFile=function(e,t,r,n,i,o){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_9__._WarnImport)("FileTools")};var OU,DU=(OU=!0,function(e,t){var r=OU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return OU=!1,r}),FU=DU(void 0,(function(){return FU.toString().search("(((.+)+)+)+$").toString().constructor(FU).search("(((.+)+)+)+$")}));function PU(){}FU(),PU.GetShadersRepository=function(e){return void 0===e&&(e=vU.GLSL),e===vU.GLSL?PU.ShadersRepository:PU.ShadersRepositoryWGSL},PU.GetShadersStore=function(e){return void 0===e&&(e=vU.GLSL),e===vU.GLSL?PU.ShadersStore:PU.ShadersStoreWGSL},PU.GetIncludesShadersStore=function(e){return void 0===e&&(e=vU.GLSL),e===vU.GLSL?PU.IncludesShadersStore:PU.IncludesShadersStoreWGSL},PU.ShadersRepository="Source/Shaders/",PU.ShadersStore={},PU.IncludesShadersStore={},PU.ShadersRepositoryWGSL="Source/ShadersWGSL/",PU.ShadersStoreWGSL={},PU.IncludesShadersStoreWGSL={};var NU,LU=(NU=!0,function(e,t){var r=NU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return NU=!1,r}),UU=LU(void 0,(function(){return UU.toString().search("(((.+)+)+)+$").toString().constructor(UU).search("(((.+)+)+)+$")}));function GU(e,t,r,n){var i,o,s=this;void 0===n&&(n=""),this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.uniqueId=0,this.onCompileObservable=new vF,this.onErrorObservable=new vF,this.onBindObservable=new vF,this._wasPreviouslyReady=!1,this._isReady=!1,this._compilationError="",this._key="",this._computeSourceCodeOverride="",this._pipelineContext=null,this._computeSourceCode="",this._rawComputeSourceCode="",this._shaderLanguage=vU.WGSL,this.name=e,this._key=n,this._engine=r,this.uniqueId=GU._uniqueIdSeed++,this.defines=null!==(i=t.defines)&&void 0!==i?i:"",this.onError=t.onError,this.onCompiled=t.onCompiled,this._entryPoint=null!==(o=t.entryPoint)&&void 0!==o?o:"main",this._shaderStore=PU.GetShadersStore(this._shaderLanguage),this._shaderRepository=PU.GetShadersRepository(this._shaderLanguage),this._includeShaderStore=PU.GetIncludesShadersStore(this._shaderLanguage);var a,u=hL()?this._engine.getHostDocument():null;e.computeSource?a="source:"+e.computeSource:e.computeElement?!(a=u?u.getElementById(e.computeElement):null)&&(a=e.computeElement):a=e.compute||e;var c={defines:this.defines.split("\n"),indexParameters:void 0,isFragment:!1,shouldUseHighPrecisionShader:!1,processor:null,supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:this._shaderRepository,includesShadersStore:this._includeShaderStore,version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:null,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer};this._loadShader(a,"Compute","",(r=>{BU.Initialize(c),BU.PreProcess(r,c,(function(n){s._rawComputeSourceCode=r,t.processFinalCode&&(n=t.processFinalCode(n));var i=BU.Finalize(n,"",c);s._useFinalCode(i.vertexCode,e)}),s._engine)}))}UU(),GU.prototype._useFinalCode=function(e,t){if(t){var r=t.computeElement||t.compute||t.spectorName||t;this._computeSourceCode="//#define SHADER_NAME compute:"+r+"\n"+e}else this._computeSourceCode=e;this._prepareEffect()},Object.defineProperty(GU.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),GU.prototype.isReady=function(){try{return this._isReadyInternal()}catch(e){return!1}},GU.prototype._isReadyInternal=function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady},GU.prototype.getEngine=function(){return this._engine},GU.prototype.getPipelineContext=function(){return this._pipelineContext},GU.prototype.getCompilationError=function(){return this._compilationError},GU.prototype.executeWhenCompiled=function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add((function(t){e(t)})),(!this._pipelineContext||this._pipelineContext.isAsync)&&setTimeout((function(){t._checkIsReady(null)}),16))},GU.prototype._checkIsReady=function(e){var t=this;try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}setTimeout((function(){t._checkIsReady(e)}),16)},GU.prototype._loadShader=function(e,t,r,n){var i;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return void n(Object(_Misc_domManagement__WEBPACK_IMPORTED_MODULE_2__.GetDOMTextContent)(e));"source:"!==e.substr(0,7)?"base64:"!==e.substr(0,7)?this._shaderStore[e+t+"Shader"]?n(this._shaderStore[e+t+"Shader"]):r&&this._shaderStore[e+r+"Shader"]?n(this._shaderStore[e+r+"Shader"]):(i="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:this._shaderRepository+e,this._engine._loadFile(i+"."+t.toLowerCase()+".fx",n)):n(window.atob(e.substr(7))):n(e.substr(7))},Object.defineProperty(GU.prototype,"computeSourceCode",{get:function(){var e,t;return this._computeSourceCodeOverride?this._computeSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getComputeShaderCode())&&void 0!==t?t:this._computeSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(GU.prototype,"rawComputeSourceCode",{get:function(){return this._rawComputeSourceCode},enumerable:!1,configurable:!0}),GU.prototype._prepareEffect=function(){var e=this,t=this.defines,r=this._pipelineContext;this._isReady=!1;try{var n=this._engine;this._pipelineContext=n.createComputePipelineContext(),this._pipelineContext._name=this._key,n._prepareComputePipelineContext(this._pipelineContext,this._computeSourceCodeOverride?this._computeSourceCodeOverride:this._computeSourceCode,this._rawComputeSourceCode,this._computeSourceCodeOverride?null:t,this._entryPoint),n._executeWhenComputeStateIsCompiled(this._pipelineContext,(function(){e._compilationError="",e._isReady=!0,e.onCompiled&&e.onCompiled(e),e.onCompileObservable.notifyObservers(e),e.onCompileObservable.clear(),r&&e.getEngine()._deleteComputePipelineContext(r)})),this._pipelineContext.isAsync&&this._checkIsReady(r)}catch(e){this._processCompilationErrors(e,r)}},GU.prototype._getShaderCodeAndErrorLine=function(e,t){var r=null;if(t&&e){var n=t.match(/COMPUTE SHADER ERROR: 0:(\d+?):/);if(n&&2===n.length){var i=parseInt(n[1]),o=e.split("\n",-1);o.length>=i&&(r="Offending line ["+i+"] in compute code: "+o[i-1])}}return[e,r]},GU.prototype._processCompilationErrors=function(e,t){var r,n;if(void 0===t&&(t=null),this._compilationError=e.message,aL.Error("Unable to compile compute effect:"),aL.Error("Defines:\r\n"+this.defines),GU.LogShaderCodeOnCompilationError){var i=null,o=null;(null===(n=this._pipelineContext)||void 0===n?void 0:n._getComputeShaderCode())&&(o=(r=this._getShaderCodeAndErrorLine(this._pipelineContext._getComputeShaderCode(),this._compilationError))[0],i=r[1],o&&(aL.Error("Compute code:"),aL.Error(o))),i&&aL.Error(i)}aL.Error("Error: "+this._compilationError),t&&(this._pipelineContext=t,this._isReady=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this))},GU.prototype.dispose=function(){this._pipelineContext&&this._pipelineContext.dispose(),this._engine._releaseComputeEffect(this)},GU.RegisterShader=function(e,t){PU.GetShadersStore(vU.WGSL)[e+"ComputeShader"]=t},GU._uniqueIdSeed=0,GU.LogShaderCodeOnCompilationError=!0;var QU,kU=(QU=!0,function(e,t){var r=QU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return QU=!1,r}),zU=kU(void 0,(function(){return zU.toString().search("(((.+)+)+)+$").toString().constructor(zU).search("(((.+)+)+)+$")}));function jU(){}zU(),Object.defineProperty(jU,"LastCreatedEngine",{get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(jU,"LastCreatedScene",{get:function(){return this._LastCreatedScene},enumerable:!1,configurable:!0}),jU.Instances=new Array,jU._LastCreatedScene=null,jU.UseFallbackTexture=!0,jU.FallbackTexture="";var HU,qU=(HU=!0,function(e,t){var r=HU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return HU=!1,r}),VU=qU(void 0,(function(){return VU.toString().search("(((.+)+)+)+$").toString().constructor(VU).search("(((.+)+)+)+$")}));function YU(){}VU(),Object.defineProperty(YU,"Now",{get:function(){return"undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now():Date.now()},enumerable:!1,configurable:!0});var XU,WU=(XU=!0,function(e,t){var r=XU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return XU=!1,r}),KU=WU(void 0,(function(){return KU.toString().search("(((.+)+)+)+$").toString().constructor(KU).search("(((.+)+)+)+$")}));function $U(e){void 0===e&&(e=30),this._enabled=!0,this._rollingFrameTime=new JU(e)}function JU(e){this._samples=new Array(e),this.reset()}KU(),$U.prototype.sampleFrame=function(e){if(void 0===e&&(e=YU.Now),this._enabled){if(null!=this._lastFrameTimeMs){var t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}},Object.defineProperty($U.prototype,"averageFrameTime",{get:function(){return this._rollingFrameTime.average},enumerable:!1,configurable:!0}),Object.defineProperty($U.prototype,"averageFrameTimeVariance",{get:function(){return this._rollingFrameTime.variance},enumerable:!1,configurable:!0}),Object.defineProperty($U.prototype,"instantaneousFrameTime",{get:function(){return this._rollingFrameTime.history(0)},enumerable:!1,configurable:!0}),Object.defineProperty($U.prototype,"averageFPS",{get:function(){return 1e3/this._rollingFrameTime.average},enumerable:!1,configurable:!0}),Object.defineProperty($U.prototype,"instantaneousFPS",{get:function(){var e=this._rollingFrameTime.history(0);return 0===e?0:1e3/e},enumerable:!1,configurable:!0}),Object.defineProperty($U.prototype,"isSaturated",{get:function(){return this._rollingFrameTime.isSaturated()},enumerable:!1,configurable:!0}),$U.prototype.enable=function(){this._enabled=!0},$U.prototype.disable=function(){this._enabled=!1,this._lastFrameTimeMs=null},Object.defineProperty($U.prototype,"isEnabled",{get:function(){return this._enabled},enumerable:!1,configurable:!0}),$U.prototype.reset=function(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()},JU.prototype.add=function(e){var t;if(this.isSaturated()){var r=this._samples[this._pos];t=r-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(r-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length},JU.prototype.history=function(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;var t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]},JU.prototype.isSaturated=function(){return this._sampleCount>=this._samples.length},JU.prototype.reset=function(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0},JU.prototype._wrapPosition=function(e){var t=this._samples.length;return(e%t+t)%t};var ZU,eG=(ZU=!0,function(e,t){var r=ZU?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return ZU=!1,r}),tG=eG(void 0,(function(){return tG.toString().search("(((.+)+)+)+$").toString().constructor(tG).search("(((.+)+)+)+$")}));function rG(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}tG(),Object.defineProperty(rG.prototype,"min",{get:function(){return this._min},enumerable:!1,configurable:!0}),Object.defineProperty(rG.prototype,"max",{get:function(){return this._max},enumerable:!1,configurable:!0}),Object.defineProperty(rG.prototype,"average",{get:function(){return this._average},enumerable:!1,configurable:!0}),Object.defineProperty(rG.prototype,"lastSecAverage",{get:function(){return this._lastSecAverage},enumerable:!1,configurable:!0}),Object.defineProperty(rG.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(rG.prototype,"total",{get:function(){return this._totalAccumulated},enumerable:!1,configurable:!0}),Object.defineProperty(rG.prototype,"count",{get:function(){return this._totalValueCount},enumerable:!1,configurable:!0}),rG.prototype.fetchNewFrame=function(){this._totalValueCount++,this._current=0,this._lastSecValueCount++},rG.prototype.addCount=function(e,t){rG.Enabled&&(this._current+=e,t&&this._fetchResult())},rG.prototype.beginMonitoring=function(){rG.Enabled&&(this._startMonitoringTime=YU.Now)},rG.prototype.endMonitoring=function(e){if(void 0===e&&(e=!0),rG.Enabled){e&&this.fetchNewFrame();var t=YU.Now;this._current=t-this._startMonitoringTime,e&&this._fetchResult()}},rG.prototype._fetchResult=function(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;var e=YU.Now;e-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=e,this._lastSecAccumulated=0,this._lastSecValueCount=0)},rG.Enabled=!0;var nG,iG=(nG=!0,function(e,t){var r=nG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return nG=!1,r}),oG=iG(void 0,(function(){return oG.toString().search("(((.+)+)+)+$").toString().constructor(oG).search("(((.+)+)+)+$")}));function sG(e,t,r,n){void 0===n&&(n=!1);var i=CL.call(this,e,t,r,n)||this;if(i.enableOfflineSupport=!1,i.disableManifestCheck=!1,i.scenes=new Array,i._virtualScenes=new Array,i.onNewSceneAddedObservable=new vF,i.postProcesses=new Array,i.isPointerLock=!1,i.onResizeObservable=new vF,i.onCanvasBlurObservable=new vF,i.onCanvasFocusObservable=new vF,i.onCanvasPointerOutObservable=new vF,i.onBeginFrameObservable=new vF,i.customAnimationFrameRequester=null,i.onEndFrameObservable=new vF,i.onBeforeShaderCompilationObservable=new vF,i.onAfterShaderCompilationObservable=new vF,i._deterministicLockstep=!1,i._lockstepMaxSteps=4,i._timeStep=1/60,i._fps=60,i._deltaTime=0,i._drawCalls=new rG,i.canvasTabIndex=1,i.disablePerformanceMonitorInBackground=!1,i._performanceMonitor=new $U,i._compatibilityMode=!0,i.currentRenderPassId=Qd.RENDERPASS_MAIN,i._renderPassNames=["main"],sG.Instances.push(i),!e)return i;if(i._features.supportRenderPasses=!0,r=i._creationOptions,e.getContext){var o=e;if(i._sharedInit(o,!!r.doNotHandleTouchAction,r.audioEngine),(0,_Misc_domManagement__WEBPACK_IMPORTED_MODULE_3__.IsWindowObjectExist)()){var s=document;i._onFullscreenChange=function(){void 0!==s.fullscreen?i.isFullscreen=s.fullscreen:void 0!==s.mozFullScreen?i.isFullscreen=s.mozFullScreen:void 0!==s.webkitIsFullScreen?i.isFullscreen=s.webkitIsFullScreen:void 0!==s.msIsFullScreen&&(i.isFullscreen=s.msIsFullScreen),i.isFullscreen&&i._pointerLockRequested&&o&&sG._RequestPointerlock(o)},document.addEventListener("fullscreenchange",i._onFullscreenChange,!1),document.addEventListener("mozfullscreenchange",i._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",i._onFullscreenChange,!1),document.addEventListener("msfullscreenchange",i._onFullscreenChange,!1),i._onPointerLockChange=function(){i.isPointerLock=s.mozPointerLockElement===o||s.webkitPointerLockElement===o||s.msPointerLockElement===o||s.pointerLockElement===o},document.addEventListener("pointerlockchange",i._onPointerLockChange,!1),document.addEventListener("mspointerlockchange",i._onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",i._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",i._onPointerLockChange,!1),!sG.audioEngine&&r.audioEngine&&sG.AudioEngineFactory&&(sG.audioEngine=sG.AudioEngineFactory(i.getRenderingCanvas(),i.getAudioContext(),i.getAudioDestination()))}i._connectVREvents(),i.enableOfflineSupport=void 0!==sG.OfflineProviderFactory,i._deterministicLockstep=!!r.deterministicLockstep,i._lockstepMaxSteps=r.lockstepMaxSteps||0,i._timeStep=r.timeStep||1/60}return i._prepareVRComponent(),r.autoEnableWebVR&&i.initWebVR(),i}oG(),CL&&(sG.__proto__=CL),sG.prototype=Object.create(CL&&CL.prototype),sG.prototype.constructor=CL,Object.defineProperty(sG,"NpmPackage",{get:function(){return _thinEngine__WEBPACK_IMPORTED_MODULE_6__.ThinEngine.NpmPackage},enumerable:!1,configurable:!0}),Object.defineProperty(sG,"Version",{get:function(){return CL.Version},enumerable:!1,configurable:!0}),Object.defineProperty(sG,"Instances",{get:function(){return jU.Instances},enumerable:!1,configurable:!0}),Object.defineProperty(sG,"LastCreatedEngine",{get:function(){return jU.LastCreatedEngine},enumerable:!1,configurable:!0}),Object.defineProperty(sG,"LastCreatedScene",{get:function(){return jU.LastCreatedScene},enumerable:!1,configurable:!0}),sG.prototype._createImageBitmapFromSource=function(e,t){var r=this;return new Promise((function(n,i){var o=new Image;o.onload=function(){o.decode().then((function(){r.createImageBitmap(o,t).then((function(e){n(e)}))}))},o.onerror=function(){i("Error loading image ".concat(o.src))},o.src=e}))},sG.prototype.createImageBitmap=function(e,t){return createImageBitmap(e,t)},sG.prototype.resizeImageBitmap=function(e,t,r){var n=this.createCanvas(t,r).getContext("2d");if(!n)throw new Error("Unable to get 2d context for resizeImageBitmap");return n.drawImage(e,0,0),n.getImageData(0,0,t,r).data},sG.MarkAllMaterialsAsDirty=function(e,t){for(var r=0;r<sG.Instances.length;r++)for(var n=sG.Instances[r],i=0;i<n.scenes.length;i++)n.scenes[i].markAllMaterialsAsDirty(e,t)},sG.DefaultLoadingScreenFactory=function(e){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_5__._WarnImport)("LoadingScreen")},Object.defineProperty(sG.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!!sG._RescalePostProcessFactory},enumerable:!1,configurable:!0}),Object.defineProperty(sG.prototype,"performanceMonitor",{get:function(){return this._performanceMonitor},enumerable:!1,configurable:!0}),Object.defineProperty(sG.prototype,"compatibilityMode",{get:function(){return this._compatibilityMode},set:function(e){this._compatibilityMode=!0},enumerable:!1,configurable:!0}),sG.prototype.getInputElement=function(){return this._renderingCanvas},sG.prototype._sharedInit=function(e,t,r){var n=this;if(CL.prototype._sharedInit.call(this,e,t,r),this._onCanvasFocus=function(){n.onCanvasFocusObservable.notifyObservers(n)},this._onCanvasBlur=function(){n.onCanvasBlurObservable.notifyObservers(n)},e.addEventListener("focus",this._onCanvasFocus),e.addEventListener("blur",this._onCanvasBlur),this._onBlur=function(){n.disablePerformanceMonitorInBackground&&n._performanceMonitor.disable(),n._windowIsBackground=!0},this._onFocus=function(){n.disablePerformanceMonitorInBackground&&n._performanceMonitor.enable(),n._windowIsBackground=!1},this._onCanvasPointerOut=function(t){document.elementFromPoint(t.clientX,t.clientY)!==e&&n.onCanvasPointerOutObservable.notifyObservers(t)},(0,_Misc_domManagement__WEBPACK_IMPORTED_MODULE_3__.IsWindowObjectExist)()){var i=this.getHostWindow();i&&(i.addEventListener("blur",this._onBlur),i.addEventListener("focus",this._onFocus))}e.addEventListener("pointerout",this._onCanvasPointerOut),!t&&this._disableTouchAction(),!sG.audioEngine&&r&&sG.AudioEngineFactory&&(sG.audioEngine=sG.AudioEngineFactory(this.getRenderingCanvas(),this.getAudioContext(),this.getAudioDestination()))},sG.prototype.getAspectRatio=function(e,t){void 0===t&&(t=!1);var r=e.viewport;return this.getRenderWidth(t)*r.width/(this.getRenderHeight(t)*r.height)},sG.prototype.getScreenAspectRatio=function(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)},sG.prototype.getRenderingCanvasClientRect=function(){return this._renderingCanvas?this._renderingCanvas.getBoundingClientRect():null},sG.prototype.getInputElementClientRect=function(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null},sG.prototype.isDeterministicLockStep=function(){return this._deterministicLockstep},sG.prototype.getLockstepMaxSteps=function(){return this._lockstepMaxSteps},sG.prototype.getTimeStep=function(){return 1e3*this._timeStep},sG.prototype.generateMipMapsForCubemap=function(e,t){if(void 0===t&&(t=!0),e.generateMipMaps){var r=this._gl;this._bindTextureDirectly(r.TEXTURE_CUBE_MAP,e,!0),r.generateMipmap(r.TEXTURE_CUBE_MAP),t&&this._bindTextureDirectly(r.TEXTURE_CUBE_MAP,null)}},sG.prototype.getDepthBuffer=function(){return this._depthCullingState.depthTest},sG.prototype.setDepthBuffer=function(e){this._depthCullingState.depthTest=e},sG.prototype.getDepthWrite=function(){return this._depthCullingState.depthMask},sG.prototype.setDepthWrite=function(e){this._depthCullingState.depthMask=e},sG.prototype.getStencilBuffer=function(){return this._stencilState.stencilTest},sG.prototype.setStencilBuffer=function(e){this._stencilState.stencilTest=e},sG.prototype.getStencilMask=function(){return this._stencilState.stencilMask},sG.prototype.setStencilMask=function(e){this._stencilState.stencilMask=e},sG.prototype.getStencilFunction=function(e){return e===Qd.FRONT?this._stencilState.frontStencilFunc:this._stencilState.backStencilFunc},sG.prototype.getStencilFunctionReference=function(){return this._stencilState.stencilFuncRef},sG.prototype.getStencilFunctionMask=function(){return this._stencilState.stencilFuncMask},sG.prototype.setStencilFunction=function(e,t){e===Qd.FRONT?this._stencilState.frontStencilFunc=t:this._stencilState.backStencilFunc=t},sG.prototype.setStencilFunctionReference=function(e){this._stencilState.stencilFuncRef=e},sG.prototype.setStencilFunctionMask=function(e){this._stencilState.stencilFuncMask=e},sG.prototype.getStencilOperationFail=function(e){return e===Qd.FRONT?this._stencilState.frontStencilOpStencilFail:this._stencilState.backStencilOpStencilFail},sG.prototype.getStencilOperationDepthFail=function(e){return e===Qd.FRONT?this._stencilState.frontStencilOpDepthFail:this._stencilState.backStencilOpDepthFail},sG.prototype.getStencilOperationPass=function(e){return e===Qd.FRONT?this._stencilState.frontStencilOpStencilDepthPass:this._stencilState.backStencilOpStencilDepthPass},sG.prototype.setStencilOperationFail=function(e,t){e===Qd.FRONT?this._stencilState.frontStencilOpStencilFail=t:this._stencilState.backStencilOpStencilFail=t},sG.prototype.setStencilOperationDepthFail=function(e,t){e===Qd.FRONT?this._stencilState.frontStencilOpDepthFail=t:this._stencilState.backStencilOpDepthFail=t},sG.prototype.setStencilOperationPass=function(e,t){e===Qd.FRONT?this._stencilState.frontStencilOpStencilDepthPass=t:this._stencilState.backStencilOpStencilDepthPass=t},sG.prototype.setDitheringState=function(e){e?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)},sG.prototype.setRasterizerState=function(e){e?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)},sG.prototype.getDepthFunction=function(){return this._depthCullingState.depthFunc},sG.prototype.setDepthFunction=function(e){this._depthCullingState.depthFunc=e},sG.prototype.setDepthFunctionToGreater=function(){this.setDepthFunction(Qd.GREATER)},sG.prototype.setDepthFunctionToGreaterOrEqual=function(){this.setDepthFunction(Qd.GEQUAL)},sG.prototype.setDepthFunctionToLess=function(){this.setDepthFunction(Qd.LESS)},sG.prototype.setDepthFunctionToLessOrEqual=function(){this.setDepthFunction(Qd.LEQUAL)},sG.prototype.setDirectViewport=function(e,t,r,n){var i=this._cachedViewport;return this._cachedViewport=null,this._viewport(e,t,r,n),i},sG.prototype.scissorClear=function(e,t,r,n,i){this.enableScissor(e,t,r,n),this.clear(i,!0,!0,!0),this.disableScissor()},sG.prototype.enableScissor=function(e,t,r,n){var i=this._gl;i.enable(i.SCISSOR_TEST),i.scissor(e,t,r,n)},sG.prototype.disableScissor=function(){var e=this._gl;e.disable(e.SCISSOR_TEST)},sG.prototype._reportDrawCall=function(e){void 0===e&&(e=1),this._drawCalls.addCount(e,!1)},sG.prototype.initWebVR=function(){throw(0,_Misc_devTools__WEBPACK_IMPORTED_MODULE_5__._WarnImport)("WebVRCamera")},sG.prototype._prepareVRComponent=function(){},sG.prototype._connectVREvents=function(e,t){},sG.prototype._submitVRFrame=function(){},sG.prototype.disableVR=function(){},sG.prototype.isVRPresenting=function(){return!1},sG.prototype._requestVRFrame=function(){},sG.prototype._loadFileAsync=function(e,t,r){var n=this;return new Promise((function(i,o){n._loadFile(e,(function(e){i(e)}),void 0,t,r,(function(e,t){o(t)}))}))},sG.prototype.getVertexShaderSource=function(e){var t=this._gl.getAttachedShaders(e);return t?this._gl.getShaderSource(t[0]):null},sG.prototype.getFragmentShaderSource=function(e){var t=this._gl.getAttachedShaders(e);return t?this._gl.getShaderSource(t[1]):null},sG.prototype.setDepthStencilTexture=function(e,t,r,n){void 0!==e&&(t&&(this._boundUniforms[e]=t),r&&r.depthStencilTexture?this._setTexture(e,r,!1,!0,n):this._setTexture(e,null,void 0,void 0,n))},sG.prototype.setTextureFromPostProcess=function(e,t,r){var n,i=null;t&&(t._textures.data[t._currentRenderTextureInd]?i=t._textures.data[t._currentRenderTextureInd]:t._forcedOutputTexture&&(i=t._forcedOutputTexture)),this._bindTexture(e,null!==(n=null==i?void 0:i.texture)&&void 0!==n?n:null,r)},sG.prototype.setTextureFromPostProcessOutput=function(e,t,r){var n,i;this._bindTexture(e,null!==(i=null===(n=null==t?void 0:t._outputTexture)||void 0===n?void 0:n.texture)&&void 0!==i?i:null,r)},sG.prototype._rebuildBuffers=function(){for(var e=0,t=this.scenes;e<t.length;e++){(i=t[e]).resetCachedMaterial(),i._rebuildGeometries(),i._rebuildTextures()}for(var r=0,n=this._virtualScenes;r<n.length;r++){var i;(i=n[r]).resetCachedMaterial(),i._rebuildGeometries(),i._rebuildTextures()}CL.prototype._rebuildBuffers.call(this)},sG.prototype._renderFrame=function(){for(var e=0;e<this._activeRenderLoops.length;e++){(0,this._activeRenderLoops[e])()}},sG.prototype._renderLoop=function(){if(!this._contextWasLost){var e=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(e=!1),e&&(this.beginFrame(),!this._renderViews()&&this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0?this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),this._frameHandler=this.customAnimationFrameRequester.requestID):this.isVRPresenting()?this._requestVRFrame():this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1},sG.prototype._renderViews=function(){return!1},sG.prototype.switchFullscreen=function(e){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(e)},sG.prototype.enterFullscreen=function(e){!this.isFullscreen&&(this._pointerLockRequested=e,this._renderingCanvas&&sG._RequestFullscreen(this._renderingCanvas))},sG.prototype.exitFullscreen=function(){this.isFullscreen&&sG._ExitFullscreen()},sG.prototype.enterPointerlock=function(){this._renderingCanvas&&sG._RequestPointerlock(this._renderingCanvas)},sG.prototype.exitPointerlock=function(){sG._ExitPointerlock()},sG.prototype.beginFrame=function(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this),CL.prototype.beginFrame.call(this)},sG.prototype.endFrame=function(){CL.prototype.endFrame.call(this),this._submitVRFrame(),this.onEndFrameObservable.notifyObservers(this)},sG.prototype.resize=function(e){void 0===e&&(e=!1),this.isVRPresenting()||CL.prototype.resize.call(this,e)},sG.prototype.setSize=function(e,t,r){if(void 0===r&&(r=!1),!this._renderingCanvas)return!1;if(!CL.prototype.setSize.call(this,e,t,r))return!1;if(this.scenes){for(var n=0;n<this.scenes.length;n++)for(var i=this.scenes[n],o=0;o<i.cameras.length;o++){i.cameras[o]._currentRenderId=0}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0},sG.prototype._deletePipelineContext=function(e){var t=e;t&&t.program&&t.transformFeedback&&(this.deleteTransformFeedback(t.transformFeedback),t.transformFeedback=null),CL.prototype._deletePipelineContext.call(this,e)},sG.prototype.createShaderProgram=function(e,t,r,n,i,o){void 0===o&&(o=null),i=i||this._gl,this.onBeforeShaderCompilationObservable.notifyObservers(this);var s=CL.prototype.createShaderProgram.call(this,e,t,r,n,i,o);return this.onAfterShaderCompilationObservable.notifyObservers(this),s},sG.prototype._createShaderProgram=function(e,t,r,n,i){void 0===i&&(i=null);var o=n.createProgram();if(e.program=o,!o)throw new Error("Unable to create program");if(n.attachShader(o,t),n.attachShader(o,r),this.webGLVersion>1&&i){var s=this.createTransformFeedback();this.bindTransformFeedback(s),this.setTranformFeedbackVaryings(o,i),e.transformFeedback=s}return n.linkProgram(o),this.webGLVersion>1&&i&&this.bindTransformFeedback(null),e.context=n,e.vertexShader=t,e.fragmentShader=r,!e.isParallelCompiled&&this._finalizePipelineContext(e),o},sG.prototype._releaseTexture=function(e){CL.prototype._releaseTexture.call(this,e)},sG.prototype._releaseRenderTargetWrapper=function(e){CL.prototype._releaseRenderTargetWrapper.call(this,e),this.scenes.forEach((function(t){t.postProcesses.forEach((function(t){t._outputTexture===e&&(t._outputTexture=null)})),t.cameras.forEach((function(t){t._postProcesses.forEach((function(t){t&&t._outputTexture===e&&(t._outputTexture=null)}))}))}))},sG.prototype.getRenderPassNames=function(){return this._renderPassNames},sG.prototype.getCurrentRenderPassName=function(){return this._renderPassNames[this.currentRenderPassId]},sG.prototype.createRenderPassId=function(e){var t=++sG._RenderPassIdCounter;return this._renderPassNames[t]=null!=e?e:"NONAME",t},sG.prototype.releaseRenderPassId=function(e){this._renderPassNames[e]=void 0;for(var t=0;t<this.scenes.length;++t)for(var r=this.scenes[t],n=0;n<r.meshes.length;++n){var i=r.meshes[n];if(i.subMeshes)for(var o=0;o<i.subMeshes.length;++o){i.subMeshes[o]._removeDrawWrapper(e)}}},sG.prototype._rescaleTexture=function(e,t,r,n,i){var o=this;this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);var s=this.createRenderTargetTexture({width:t.width,height:t.height},{generateMipMaps:!1,type:Qd.TEXTURETYPE_UNSIGNED_INT,samplingMode:Qd.TEXTURE_BILINEAR_SAMPLINGMODE,generateDepthBuffer:!1,generateStencilBuffer:!1});!this._rescalePostProcess&&sG._RescalePostProcessFactory&&(this._rescalePostProcess=sG._RescalePostProcessFactory(this)),this._rescalePostProcess.externalTextureSamplerBinding=!0,this._rescalePostProcess.getEffect().executeWhenCompiled((function(){o._rescalePostProcess.onApply=function(t){t._bindTexture("textureSampler",e)};var a=r;!a&&(a=o.scenes[o.scenes.length-1]),a.postProcessManager.directRender([o._rescalePostProcess],s,!0),o._bindTextureDirectly(o._gl.TEXTURE_2D,t,!0),o._gl.copyTexImage2D(o._gl.TEXTURE_2D,0,n,0,0,t.width,t.height,0),o.unBindFramebuffer(s),s.dispose(),i&&i()}))},sG.prototype.getFps=function(){return this._fps},sG.prototype.getDeltaTime=function(){return this._deltaTime},sG.prototype._measureFps=function(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0},sG.prototype.wrapWebGLTexture=function(e){var t=new _WebGL_webGLHardwareTexture__WEBPACK_IMPORTED_MODULE_12__.WebGLHardwareTexture(e,this._gl),r=new _Materials_Textures_internalTexture__WEBPACK_IMPORTED_MODULE_2__.InternalTexture(this,_Materials_Textures_internalTexture__WEBPACK_IMPORTED_MODULE_2__.InternalTextureSource.Unknown,!0);return r._hardwareTexture=t,r.isReady=!0,r},sG.prototype._uploadImageToTexture=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=this._gl,o=this._getWebGLTextureType(e.type),s=this._getInternalFormat(e.format),a=this._getRGBABufferInternalSizedFormat(e.type,s),u=e.isCube?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D;this._bindTextureDirectly(u,e,!0),this._unpackFlipY(e.invertY);var c=i.TEXTURE_2D;e.isCube&&(c=i.TEXTURE_CUBE_MAP_POSITIVE_X+r),i.texImage2D(c,n,a,s,o,t),this._bindTextureDirectly(u,null,!0)},sG.prototype.updateTextureComparisonFunction=function(e,t){if(1!==this.webGLVersion){var r=this._gl;e.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,e,!0),0===t?(r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_COMPARE_FUNC,Qd.LEQUAL),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_COMPARE_MODE,r.NONE)):(r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_COMPARE_FUNC,t),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),0===t?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_COMPARE_FUNC,Qd.LEQUAL),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_COMPARE_MODE,r.NONE)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_COMPARE_FUNC,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)),e._comparisonFunction=t}else aL.Error("WebGL 1 does not support texture comparison.")},sG.prototype.createInstancesBuffer=function(e){var t=this._gl.createBuffer();if(!t)throw new Error("Unable to create instance buffer");var r=new _Meshes_WebGL_webGLDataBuffer__WEBPACK_IMPORTED_MODULE_10__.WebGLDataBuffer(t);return r.capacity=e,this.bindArrayBuffer(r),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.DYNAMIC_DRAW),r.references=1,r},sG.prototype.deleteInstancesBuffer=function(e){this._gl.deleteBuffer(e)},sG.prototype._clientWaitAsync=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=10);var n=this._gl;return new Promise((function(i,o){var s=function(){var a=n.clientWaitSync(e,t,0);a!=n.WAIT_FAILED?a!=n.TIMEOUT_EXPIRED?i():setTimeout(s,r):o()};s()}))},sG.prototype._readPixelsAsync=function(e,t,r,n,i,o,s){if(this._webGLVersion<2)throw new Error("_readPixelsAsync only work on WebGL2+");var a=this._gl,u=a.createBuffer();a.bindBuffer(a.PIXEL_PACK_BUFFER,u),a.bufferData(a.PIXEL_PACK_BUFFER,s.byteLength,a.STREAM_READ),a.readPixels(e,t,r,n,i,o,0),a.bindBuffer(a.PIXEL_PACK_BUFFER,null);var c=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);return c?(a.flush(),this._clientWaitAsync(c,0,10).then((function(){return a.deleteSync(c),a.bindBuffer(a.PIXEL_PACK_BUFFER,u),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,s),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),a.deleteBuffer(u),s}))):null},sG.prototype.dispose=function(){for(this.hideLoadingUI(),this.onNewSceneAddedObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(this._rescalePostProcess&&this._rescalePostProcess.dispose();this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();1===sG.Instances.length&&sG.audioEngine&&(sG.audioEngine.dispose(),sG.audioEngine=null),this.disableVR(),CL.prototype.dispose.call(this);var e=sG.Instances.indexOf(this);e>=0&&sG.Instances.splice(e,1),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()},sG.prototype._disableTouchAction=function(){this._renderingCanvas&&this._renderingCanvas.setAttribute&&(this._renderingCanvas.setAttribute("touch-action","none"),this._renderingCanvas.style.touchAction="none",this._renderingCanvas.style.msTouchAction="none")},sG.prototype.displayLoadingUI=function(){if((0,_Misc_domManagement__WEBPACK_IMPORTED_MODULE_3__.IsWindowObjectExist)()){var e=this.loadingScreen;e&&e.displayLoadingUI()}},sG.prototype.hideLoadingUI=function(){var e=this._loadingScreen;e&&e.hideLoadingUI()},Object.defineProperty(sG.prototype,"loadingScreen",{get:function(){return!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=sG.DefaultLoadingScreenFactory(this._renderingCanvas)),this._loadingScreen},set:function(e){this._loadingScreen=e},enumerable:!1,configurable:!0}),Object.defineProperty(sG.prototype,"loadingUIText",{set:function(e){this.loadingScreen.loadingUIText=e},enumerable:!1,configurable:!0}),Object.defineProperty(sG.prototype,"loadingUIBackgroundColor",{set:function(e){this.loadingScreen.loadingUIBackgroundColor=e},enumerable:!1,configurable:!0}),sG.prototype.createVideoElement=function(e){return document.createElement("video")},sG._RequestPointerlock=function(e){e.requestPointerLock=e.requestPointerLock||e.msRequestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock&&(e.requestPointerLock(),e.focus())},sG._ExitPointerlock=function(){var e=document;document.exitPointerLock=document.exitPointerLock||e.msExitPointerLock||e.mozExitPointerLock||e.webkitExitPointerLock,document.exitPointerLock&&document.exitPointerLock()},sG._RequestFullscreen=function(e){var t=e.requestFullscreen||e.msRequestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen;t&&t.call(e)},sG._ExitFullscreen=function(){var e=document;document.exitFullscreen?document.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitCancelFullScreen?e.webkitCancelFullScreen():e.msCancelFullScreen&&e.msCancelFullScreen()},sG.prototype.getFontOffset=function(e){var t=document.createElement("span");t.innerHTML="Hg",t.setAttribute("style","font: ".concat(e," !important"));var r=document.createElement("div");r.style.display="inline-block",r.style.width="1px",r.style.height="0px",r.style.verticalAlign="bottom";var n=document.createElement("div");n.style.whiteSpace="nowrap",n.appendChild(t),n.appendChild(r),document.body.appendChild(n);var i=0,o=0;try{o=r.getBoundingClientRect().top-t.getBoundingClientRect().top,r.style.verticalAlign="baseline",i=r.getBoundingClientRect().top-t.getBoundingClientRect().top}finally{document.body.removeChild(n)}return{ascent:i,height:o,descent:o-i}},sG.ALPHA_DISABLE=Qd.ALPHA_DISABLE,sG.ALPHA_ADD=Qd.ALPHA_ADD,sG.ALPHA_COMBINE=Qd.ALPHA_COMBINE,sG.ALPHA_SUBTRACT=Qd.ALPHA_SUBTRACT,sG.ALPHA_MULTIPLY=Qd.ALPHA_MULTIPLY,sG.ALPHA_MAXIMIZED=Qd.ALPHA_MAXIMIZED,sG.ALPHA_ONEONE=Qd.ALPHA_ONEONE,sG.ALPHA_PREMULTIPLIED=Qd.ALPHA_PREMULTIPLIED,sG.ALPHA_PREMULTIPLIED_PORTERDUFF=Qd.ALPHA_PREMULTIPLIED_PORTERDUFF,sG.ALPHA_INTERPOLATE=Qd.ALPHA_INTERPOLATE,sG.ALPHA_SCREENMODE=Qd.ALPHA_SCREENMODE,sG.DELAYLOADSTATE_NONE=Qd.DELAYLOADSTATE_NONE,sG.DELAYLOADSTATE_LOADED=Qd.DELAYLOADSTATE_LOADED,sG.DELAYLOADSTATE_LOADING=Qd.DELAYLOADSTATE_LOADING,sG.DELAYLOADSTATE_NOTLOADED=Qd.DELAYLOADSTATE_NOTLOADED,sG.NEVER=Qd.NEVER,sG.ALWAYS=Qd.ALWAYS,sG.LESS=Qd.LESS,sG.EQUAL=Qd.EQUAL,sG.LEQUAL=Qd.LEQUAL,sG.GREATER=Qd.GREATER,sG.GEQUAL=Qd.GEQUAL,sG.NOTEQUAL=Qd.NOTEQUAL,sG.KEEP=Qd.KEEP,sG.REPLACE=Qd.REPLACE,sG.INCR=Qd.INCR,sG.DECR=Qd.DECR,sG.INVERT=Qd.INVERT,sG.INCR_WRAP=Qd.INCR_WRAP,sG.DECR_WRAP=Qd.DECR_WRAP,sG.TEXTURE_CLAMP_ADDRESSMODE=Qd.TEXTURE_CLAMP_ADDRESSMODE,sG.TEXTURE_WRAP_ADDRESSMODE=Qd.TEXTURE_WRAP_ADDRESSMODE,sG.TEXTURE_MIRROR_ADDRESSMODE=Qd.TEXTURE_MIRROR_ADDRESSMODE,sG.TEXTUREFORMAT_ALPHA=Qd.TEXTUREFORMAT_ALPHA,sG.TEXTUREFORMAT_LUMINANCE=Qd.TEXTUREFORMAT_LUMINANCE,sG.TEXTUREFORMAT_LUMINANCE_ALPHA=Qd.TEXTUREFORMAT_LUMINANCE_ALPHA,sG.TEXTUREFORMAT_RGB=Qd.TEXTUREFORMAT_RGB,sG.TEXTUREFORMAT_RGBA=Qd.TEXTUREFORMAT_RGBA,sG.TEXTUREFORMAT_RED=Qd.TEXTUREFORMAT_RED,sG.TEXTUREFORMAT_R=Qd.TEXTUREFORMAT_R,sG.TEXTUREFORMAT_RG=Qd.TEXTUREFORMAT_RG,sG.TEXTUREFORMAT_RED_INTEGER=Qd.TEXTUREFORMAT_RED_INTEGER,sG.TEXTUREFORMAT_R_INTEGER=Qd.TEXTUREFORMAT_R_INTEGER,sG.TEXTUREFORMAT_RG_INTEGER=Qd.TEXTUREFORMAT_RG_INTEGER,sG.TEXTUREFORMAT_RGB_INTEGER=Qd.TEXTUREFORMAT_RGB_INTEGER,sG.TEXTUREFORMAT_RGBA_INTEGER=Qd.TEXTUREFORMAT_RGBA_INTEGER,sG.TEXTURETYPE_UNSIGNED_BYTE=Qd.TEXTURETYPE_UNSIGNED_BYTE,sG.TEXTURETYPE_UNSIGNED_INT=Qd.TEXTURETYPE_UNSIGNED_INT,sG.TEXTURETYPE_FLOAT=Qd.TEXTURETYPE_FLOAT,sG.TEXTURETYPE_HALF_FLOAT=Qd.TEXTURETYPE_HALF_FLOAT,sG.TEXTURETYPE_BYTE=Qd.TEXTURETYPE_BYTE,sG.TEXTURETYPE_SHORT=Qd.TEXTURETYPE_SHORT,sG.TEXTURETYPE_UNSIGNED_SHORT=Qd.TEXTURETYPE_UNSIGNED_SHORT,sG.TEXTURETYPE_INT=Qd.TEXTURETYPE_INT,sG.TEXTURETYPE_UNSIGNED_INTEGER=Qd.TEXTURETYPE_UNSIGNED_INTEGER,sG.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=Qd.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4,sG.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=Qd.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1,sG.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=Qd.TEXTURETYPE_UNSIGNED_SHORT_5_6_5,sG.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=Qd.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV,sG.TEXTURETYPE_UNSIGNED_INT_24_8=Qd.TEXTURETYPE_UNSIGNED_INT_24_8,sG.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=Qd.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV,sG.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=Qd.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV,sG.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=Qd.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV,sG.TEXTURE_NEAREST_SAMPLINGMODE=Qd.TEXTURE_NEAREST_SAMPLINGMODE,sG.TEXTURE_BILINEAR_SAMPLINGMODE=Qd.TEXTURE_BILINEAR_SAMPLINGMODE,sG.TEXTURE_TRILINEAR_SAMPLINGMODE=Qd.TEXTURE_TRILINEAR_SAMPLINGMODE,sG.TEXTURE_NEAREST_NEAREST_MIPLINEAR=Qd.TEXTURE_NEAREST_NEAREST_MIPLINEAR,sG.TEXTURE_LINEAR_LINEAR_MIPNEAREST=Qd.TEXTURE_LINEAR_LINEAR_MIPNEAREST,sG.TEXTURE_LINEAR_LINEAR_MIPLINEAR=Qd.TEXTURE_LINEAR_LINEAR_MIPLINEAR,sG.TEXTURE_NEAREST_NEAREST_MIPNEAREST=Qd.TEXTURE_NEAREST_NEAREST_MIPNEAREST,sG.TEXTURE_NEAREST_LINEAR_MIPNEAREST=Qd.TEXTURE_NEAREST_LINEAR_MIPNEAREST,sG.TEXTURE_NEAREST_LINEAR_MIPLINEAR=Qd.TEXTURE_NEAREST_LINEAR_MIPLINEAR,sG.TEXTURE_NEAREST_LINEAR=Qd.TEXTURE_NEAREST_LINEAR,sG.TEXTURE_NEAREST_NEAREST=Qd.TEXTURE_NEAREST_NEAREST,sG.TEXTURE_LINEAR_NEAREST_MIPNEAREST=Qd.TEXTURE_LINEAR_NEAREST_MIPNEAREST,sG.TEXTURE_LINEAR_NEAREST_MIPLINEAR=Qd.TEXTURE_LINEAR_NEAREST_MIPLINEAR,sG.TEXTURE_LINEAR_LINEAR=Qd.TEXTURE_LINEAR_LINEAR,sG.TEXTURE_LINEAR_NEAREST=Qd.TEXTURE_LINEAR_NEAREST,sG.TEXTURE_EXPLICIT_MODE=Qd.TEXTURE_EXPLICIT_MODE,sG.TEXTURE_SPHERICAL_MODE=Qd.TEXTURE_SPHERICAL_MODE,sG.TEXTURE_PLANAR_MODE=Qd.TEXTURE_PLANAR_MODE,sG.TEXTURE_CUBIC_MODE=Qd.TEXTURE_CUBIC_MODE,sG.TEXTURE_PROJECTION_MODE=Qd.TEXTURE_PROJECTION_MODE,sG.TEXTURE_SKYBOX_MODE=Qd.TEXTURE_SKYBOX_MODE,sG.TEXTURE_INVCUBIC_MODE=Qd.TEXTURE_INVCUBIC_MODE,sG.TEXTURE_EQUIRECTANGULAR_MODE=Qd.TEXTURE_EQUIRECTANGULAR_MODE,sG.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=Qd.TEXTURE_FIXED_EQUIRECTANGULAR_MODE,sG.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=Qd.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE,sG.SCALEMODE_FLOOR=Qd.SCALEMODE_FLOOR,sG.SCALEMODE_NEAREST=Qd.SCALEMODE_NEAREST,sG.SCALEMODE_CEILING=Qd.SCALEMODE_CEILING,sG._RescalePostProcessFactory=null,sG._RenderPassIdCounter=0;var aG,uG=(aG=!0,function(e,t){var r=aG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return aG=!1,r}),cG=uG(void 0,(function(){return cG.toString().search("(((.+)+)+)+$").toString().constructor(cG).search("(((.+)+)+)+$")}));function lG(e,t,r,n,i,o,s,a,u,c,l,h){void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===l&&(l=""),void 0===h&&(h=vU.GLSL);var p,f,d,A=this;this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new vF,this.onErrorObservable=new vF,this._onBindObservable=null,this._wasPreviouslyReady=!1,this._isDisposed=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._compiledVertexWGSL="",this._compiledFragmentWGSL="",this.name=e,this._key=l;var g=void 0,_=null;if(t.attributes){var m=t;if(this._engine=r,this._attributesNames=m.attributes,this._uniformsNames=m.uniformsNames.concat(m.samplers),this._samplerList=m.samplers.slice(),this.defines=m.defines,this.onError=m.onError,this.onCompiled=m.onCompiled,this._fallbacks=m.fallbacks,this._indexParameters=m.indexParameters,this._transformFeedbackVaryings=m.transformFeedbackVaryings||null,this._multiTarget=!!m.multiTarget,this._shaderLanguage=null!==(p=m.shaderLanguage)&&void 0!==p?p:vU.GLSL,m.uniformBuffersNames){this._uniformBuffersNamesList=m.uniformBuffersNames.slice();for(var y=0;y<m.uniformBuffersNames.length;y++)this._uniformBuffersNames[m.uniformBuffersNames[y]]=y}_=null!==(f=m.processFinalCode)&&void 0!==f?f:null,g=null!==(d=m.processCodeAfterIncludes)&&void 0!==d?d:void 0}else this._engine=i,this.defines=null==o?"":o,this._uniformsNames=r.concat(n),this._samplerList=n?n.slice():[],this._attributesNames=t,this._uniformBuffersNamesList=[],this._shaderLanguage=h,this.onError=u,this.onCompiled=a,this._indexParameters=c,this._fallbacks=s;this._attributeLocationByName={},this.uniqueId=lG._UniqueIdSeed++;var E,x,C=hL()?this._engine.getHostDocument():null;e.vertexSource?E="source:"+e.vertexSource:e.vertexElement?!(E=C?C.getElementById(e.vertexElement):null)&&(E=e.vertexElement):E=e.vertex||e,e.fragmentSource?x="source:"+e.fragmentSource:e.fragmentElement?!(x=C?C.getElementById(e.fragmentElement):null)&&(x=e.fragmentElement):x=e.fragment||e,this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);var b={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:PU.GetShadersRepository(this._shaderLanguage),includesShadersStore:PU.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:g};this._engine._getCompiledShaderFromIndexDB(this._shaderLanguage,l,((r,n,i)=>{r&&(A._compiledVertexWGSL=n,A._compiledFragmentWGSL=i),this._loadShaderAsNormal(e,E,x,_,t,b)}))}cG(),lG.prototype._loadShaderAsNormal=function(e,t,r,n,i,o){var s=this,a=[void 0,void 0],u=function(){if(a[0]&&a[1]){o.isFragment=!0;var t=a[0],r=a[1];BU.Process(r,o,(function(r){n&&(r=n("fragment",r));var i=BU.Finalize(t,r,o);s._useFinalCode(i.vertexCode,i.fragmentCode,e)}),s._engine)}};i.vertexCode?(BU.Initialize(o),BU.Process(i.vertexCode,o,(function(e){s._rawVertexSourceCode=i.vertexCode,n&&(e=n("vertex",e)),a[0]=e,u()}),s._engine)):this._loadShader(t,"Vertex","",(function(e){BU.Initialize(o),BU.Process(e,o,(function(t){s._rawVertexSourceCode=e,n&&(t=n("vertex",t)),a[0]=t,u()}),s._engine)})),i.fragmentCode?(s._rawFragmentSourceCode=i.fragmentCode,a[1]=i.fragmentCode,u()):this._loadShader(r,"Fragment","Pixel",(function(e){s._rawFragmentSourceCode=e,a[1]=e,u()}))},Object.defineProperty(lG,"ShadersRepository",{get:function(){return PU.ShadersRepository},set:function(e){PU.ShadersRepository=e},enumerable:!1,configurable:!0}),Object.defineProperty(lG.prototype,"onBindObservable",{get:function(){return!this._onBindObservable&&(this._onBindObservable=new _Misc_observable__WEBPACK_IMPORTED_MODULE_0__.Observable),this._onBindObservable},enumerable:!1,configurable:!0}),lG.prototype._useFinalCode=function(e,t,r){if(r){var n=r.vertexElement||r.vertex||r.spectorName||r,i=r.fragmentElement||r.fragment||r.spectorName||r;this._vertexSourceCode=(this._shaderLanguage===vU.WGSL?"//":"")+"#define SHADER_NAME vertex:"+n+"\n"+e,this._fragmentSourceCode=(this._shaderLanguage===vU.WGSL?"//":"")+"#define SHADER_NAME fragment:"+i+"\n"+t}else this._vertexSourceCode=e,this._fragmentSourceCode=t;this._prepareEffect()},Object.defineProperty(lG.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),lG.prototype.isReady=function(){try{return this._isReadyInternal()}catch(e){return!1}},lG.prototype._isReadyInternal=function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady},lG.prototype.getEngine=function(){return this._engine},lG.prototype.getPipelineContext=function(){return this._pipelineContext},lG.prototype.getAttributesNames=function(){return this._attributesNames},lG.prototype.getAttributeLocation=function(e){return this._attributes[e]},lG.prototype.getAttributeLocationByName=function(e){return this._attributeLocationByName[e]},lG.prototype.getAttributesCount=function(){return this._attributes.length},lG.prototype.getUniformIndex=function(e){return this._uniformsNames.indexOf(e)},lG.prototype.getUniform=function(e){return this._uniforms[e]},lG.prototype.getSamplers=function(){return this._samplerList},lG.prototype.getUniformNames=function(){return this._uniformsNames},lG.prototype.getUniformBuffersNames=function(){return this._uniformBuffersNamesList},lG.prototype.getIndexParameters=function(){return this._indexParameters},lG.prototype.getCompilationError=function(){return this._compilationError},lG.prototype.allFallbacksProcessed=function(){return this._allFallbacksProcessed},lG.prototype.executeWhenCompiled=function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add((function(t){e(t)})),(!this._pipelineContext||this._pipelineContext.isAsync)&&setTimeout((function(){t._checkIsReady(null)}),16))},lG.prototype._checkIsReady=function(e){var t=this;try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}this._isDisposed||setTimeout((function(){t._checkIsReady(e)}),16)},lG.prototype._loadShader=function(e,t,r,n){if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return void n(function(e){for(var t="",r=e.firstChild;r;)3===r.nodeType&&(t+=r.textContent),r=r.nextSibling;return t}(e));if("source:"!==e.substr(0,7))if("base64:"!==e.substr(0,7)){var i,o=PU.GetShadersStore(this._shaderLanguage);if(o[e+t+"Shader"])n(o[e+t+"Shader"]);else if(r&&o[e+r+"Shader"])n(o[e+r+"Shader"]);else i="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:PU.GetShadersRepository(this._shaderLanguage)+e,this._engine._loadFile(i+"."+t.toLowerCase()+".fx",n)}else{n(window.atob(e.substr(7)))}else n(e.substr(7))},Object.defineProperty(lG.prototype,"vertexSourceCode",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getVertexShaderCode())&&void 0!==t?t:this._vertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(lG.prototype,"fragmentSourceCode",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode())&&void 0!==t?t:this._fragmentSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(lG.prototype,"rawVertexSourceCode",{get:function(){return this._rawVertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(lG.prototype,"rawFragmentSourceCode",{get:function(){return this._rawFragmentSourceCode},enumerable:!1,configurable:!0}),lG.prototype._rebuildProgram=function(e,t,r,n){var i=this;this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=function(e,t){n&&n(t)},this.onCompiled=function(){var e=i.getEngine().scenes;if(e)for(var t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(Qd.MATERIAL_AllDirtyFlag);i._pipelineContext._handlesSpectorRebuildCallback(r)},this._fallbacks=null,this._prepareEffect()},lG.prototype._prepareEffect=function(){var e=this,t=this._attributesNames,r=this.defines,n=this._pipelineContext;this._isReady=!1;try{var i=this._engine;this._pipelineContext=i.createPipelineContext(this._processingContext),this._pipelineContext._name=this._key;var o=this._rebuildProgram.bind(this);this._compiledVertexWGSL&&this._compiledFragmentWGSL?i._preparePipelineContext(this._pipelineContext,this._compiledVertexWGSL,this._compiledFragmentWGSL,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,o,null,this._transformFeedbackVaryings,this._key,vU.WGSL):this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?i._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,o,null,this._transformFeedbackVaryings,this._key):i._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,o,r,this._transformFeedbackVaryings,this._key),i._executeWhenRenderingStateIsCompiled(this._pipelineContext,(function(){if(e._attributes=[],e._pipelineContext._fillEffectInformation(e,e._uniformBuffersNames,e._uniformsNames,e._uniforms,e._samplerList,e._samplers,t,e._attributes),t)for(var r=0;r<t.length;r++){var o=t[r];e._attributeLocationByName[o]=e._attributes[r]}i.bindSamplers(e),e._compilationError="",e._isReady=!0,e.onCompiled&&e.onCompiled(e),e.onCompileObservable.notifyObservers(e),e.onCompileObservable.clear(),e._fallbacks&&e._fallbacks.unBindMesh(),n&&e.getEngine()._deletePipelineContext(n)})),this._pipelineContext.isAsync&&this._checkIsReady(n)}catch(e){this._processCompilationErrors(e,n)}},lG.prototype._getShaderCodeAndErrorLine=function(e,t,r){var n=r?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/,i=null;if(t&&e){var o=t.match(n);if(o&&2===o.length){var s=parseInt(o[1]),a=e.split("\n",-1);a.length>=s&&(i="Offending line [".concat(s,"] in ").concat(r?"fragment":"vertex"," code: ").concat(a[s-1]))}}return[e,i]},lG.prototype._processCompilationErrors=function(e,t){var r,n,i,o,s;void 0===t&&(t=null),this._compilationError=e.message;var a=this._attributesNames,u=this._fallbacks;if(aL.Error("Unable to compile compute effect:"),aL.Error("Uniforms: "+this._uniformsNames.map((function(e){return" "+e}))),aL.Error("Attributes: "+a.map((function(e){return" "+e}))),aL.Error("Defines:\r\n"+this.defines),lG.LogShaderCodeOnCompilationError){var c=null,l=null,h=null;(null===(i=this._pipelineContext)||void 0===i?void 0:i._getVertexShaderCode())&&(h=(r=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1))[0],c=r[1],h&&(aL.Error("Vertex code:"),aL.Error(h))),(null===(o=this._pipelineContext)||void 0===o?void 0:o._getFragmentShaderCode())&&(h=(n=this._getShaderCodeAndErrorLine(null===(s=this._pipelineContext)||void 0===s?void 0:s._getFragmentShaderCode(),this._compilationError,!0))[0],l=n[1],h&&(aL.Error("Fragment code:"),aL.Error(h))),c&&aL.Error(c),l&&aL.Error(l)}aL.Error("Error: "+this._compilationError),t&&(this._pipelineContext=t,this._isReady=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)),u?(this._pipelineContext=null,u.hasMoreFallbacks?(this._allFallbacksProcessed=!1,aL.Error("Trying next fallback."),this.defines=u.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):this._allFallbacksProcessed=!0},Object.defineProperty(lG.prototype,"isSupported",{get:function(){return""===this._compilationError},enumerable:!1,configurable:!0}),lG.prototype._bindTexture=function(e,t){this._engine._bindTexture(this._samplers[e],t,e)},lG.prototype.setTexture=function(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)},lG.prototype.setDepthStencilTexture=function(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t,e)},lG.prototype.setTextureArray=function(e,t){var r=e+"Ex";if(-1===this._samplerList.indexOf(r+"0")){for(var n=this._samplerList.indexOf(e),i=1;i<t.length;i++){var o=r+(i-1).toString();this._samplerList.splice(n+i,0,o)}for(var s=0,a=0,u=this._samplerList;a<u.length;a++){var c=u[a];this._samplers[c]=s,s+=1}}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)},lG.prototype.setTextureFromPostProcess=function(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t,e)},lG.prototype.setTextureFromPostProcessOutput=function(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t,e)},lG.prototype.bindUniformBuffer=function(e,t){var r=this._uniformBuffersNames[t];void 0===r||lG._BaseCache[r]===e&&this._engine._features.useUBOBindingCache||(lG._BaseCache[r]=e,this._engine.bindUniformBufferBase(e,r,t))},lG.prototype.bindUniformBlock=function(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)},lG.prototype.setInt=function(e,t){return this._pipelineContext.setInt(e,t),this},lG.prototype.setInt2=function(e,t,r){return this._pipelineContext.setInt2(e,t,r),this},lG.prototype.setInt3=function(e,t,r,n){return this._pipelineContext.setInt3(e,t,r,n),this},lG.prototype.setInt4=function(e,t,r,n,i){return this._pipelineContext.setInt4(e,t,r,n,i),this},lG.prototype.setIntArray=function(e,t){return this._pipelineContext.setIntArray(e,t),this},lG.prototype.setIntArray2=function(e,t){return this._pipelineContext.setIntArray2(e,t),this},lG.prototype.setIntArray3=function(e,t){return this._pipelineContext.setIntArray3(e,t),this},lG.prototype.setIntArray4=function(e,t){return this._pipelineContext.setIntArray4(e,t),this},lG.prototype.setFloatArray=function(e,t){return this._pipelineContext.setArray(e,t),this},lG.prototype.setFloatArray2=function(e,t){return this._pipelineContext.setArray2(e,t),this},lG.prototype.setFloatArray3=function(e,t){return this._pipelineContext.setArray3(e,t),this},lG.prototype.setFloatArray4=function(e,t){return this._pipelineContext.setArray4(e,t),this},lG.prototype.setArray=function(e,t){return this._pipelineContext.setArray(e,t),this},lG.prototype.setArray2=function(e,t){return this._pipelineContext.setArray2(e,t),this},lG.prototype.setArray3=function(e,t){return this._pipelineContext.setArray3(e,t),this},lG.prototype.setArray4=function(e,t){return this._pipelineContext.setArray4(e,t),this},lG.prototype.setMatrices=function(e,t){return this._pipelineContext.setMatrices(e,t),this},lG.prototype.setMatrix=function(e,t){return this._pipelineContext.setMatrix(e,t),this},lG.prototype.setMatrix3x3=function(e,t){return this._pipelineContext.setMatrix3x3(e,t),this},lG.prototype.setMatrix2x2=function(e,t){return this._pipelineContext.setMatrix2x2(e,t),this},lG.prototype.setFloat=function(e,t){return this._pipelineContext.setFloat(e,t),this},lG.prototype.setBool=function(e,t){return this._pipelineContext.setInt(e,t?1:0),this},lG.prototype.setVector2=function(e,t){return this._pipelineContext.setVector2(e,t),this},lG.prototype.setFloat2=function(e,t,r){return this._pipelineContext.setFloat2(e,t,r),this},lG.prototype.setVector3=function(e,t){return this._pipelineContext.setVector3(e,t),this},lG.prototype.setFloat3=function(e,t,r,n){return this._pipelineContext.setFloat3(e,t,r,n),this},lG.prototype.setVector4=function(e,t){return this._pipelineContext.setVector4(e,t),this},lG.prototype.setFloat4=function(e,t,r,n,i){return this._pipelineContext.setFloat4(e,t,r,n,i),this},lG.prototype.setColor3=function(e,t){return this._pipelineContext.setColor3(e,t),this},lG.prototype.setColor4=function(e,t,r){return this._pipelineContext.setColor4(e,t,r),this},lG.prototype.setDirectColor4=function(e,t){return this._pipelineContext.setDirectColor4(e,t),this},lG.prototype.dispose=function(){this._pipelineContext&&this._pipelineContext.dispose(),this._engine._releaseEffect(this),this._isDisposed=!0},lG.RegisterShader=function(e,t,r,n){void 0===n&&(n=vU.GLSL),t&&(PU.GetShadersStore(n)["".concat(e,"PixelShader")]=t),r&&(PU.GetShadersStore(n)["".concat(e,"VertexShader")]=r)},lG.ResetCache=function(){lG._BaseCache={}},lG.LogShaderCodeOnCompilationError=!0,lG._UniqueIdSeed=0,lG._BaseCache={},lG.ShadersStore=PU.ShadersStore,lG.IncludesShadersStore=PU.IncludesShadersStore;var hG,pG=(hG=!0,function(e,t){var r=hG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return hG=!1,r}),fG=pG(void 0,(function(){return fG.toString().search("(((.+)+)+)+$").toString().constructor(fG).search("(((.+)+)+)+$")}));function dG(e,t,r,n,i,o){void 0===i&&(i=!1),this._valueCache={},this._engine=e,this._noUBO=!e.supportsUniformBuffers||i,this._dynamic=r,this._name=null!=n?n:"no-name",this._data=t||[],this._uniformLocations={},this._uniformSizes={},this._uniformArraySizes={},this._uniformLocationPointer=0,this._needSync=!1,this._trackUbosInFrame=null!=o?o:this._engine._features.trackUbosInFrame,this._trackUbosInFrame&&(this._buffers=[],this._bufferIndex=-1,this._createBufferOnWrite=!1,this._currentFrameId=0),this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateFloatArray=this._updateFloatArrayForEffect,this.updateArray=this._updateArrayForEffect,this.updateIntArray=this._updateIntArrayForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateMatrices=this._updateMatricesForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect,this.updateDirectColor4=this._updateDirectColor4ForEffect,this.updateInt=this._updateIntForEffect,this.updateInt2=this._updateInt2ForEffect,this.updateInt3=this._updateInt3ForEffect,this.updateInt4=this._updateInt4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateFloatArray=this._updateFloatArrayForUniform,this.updateArray=this._updateArrayForUniform,this.updateIntArray=this._updateIntArrayForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateMatrices=this._updateMatricesForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform,this.updateDirectColor4=this._updateDirectColor4ForUniform,this.updateInt=this._updateIntForUniform,this.updateInt2=this._updateInt2ForUniform,this.updateInt3=this._updateInt3ForUniform,this.updateInt4=this._updateInt4ForUniform)}fG(),Object.defineProperty(dG.prototype,"useUbo",{get:function(){return!this._noUBO},enumerable:!1,configurable:!0}),Object.defineProperty(dG.prototype,"isSync",{get:function(){return!this._needSync},enumerable:!1,configurable:!0}),dG.prototype.isDynamic=function(){return void 0!==this._dynamic},dG.prototype.getData=function(){return this._bufferData},dG.prototype.getBuffer=function(){return this._buffer},dG.prototype._fillAlignment=function(e){var t;if(t=e<=2?e:4,this._uniformLocationPointer%t!=0){var r=this._uniformLocationPointer;this._uniformLocationPointer+=t-this._uniformLocationPointer%t;for(var n=this._uniformLocationPointer-r,i=0;i<n;i++)this._data.push(0)}},dG.prototype.addUniform=function(e,t,r){if(void 0===r&&(r=0),!this._noUBO&&void 0===this._uniformLocations[e]){var n;if(r>0){if(t instanceof Array)throw"addUniform should not be use with Array in UBO: "+e;if(this._fillAlignment(4),this._uniformArraySizes[e]={strideSize:t,arraySize:r},16==t)t*=r;else t=t*r+(4-t)*r;n=[];for(var i=0;i<t;i++)n.push(0)}else{if(t instanceof Array)t=(n=t).length;else{n=[];for(i=0;i<t;i++)n.push(0)}this._fillAlignment(t)}this._uniformSizes[e]=t,this._uniformLocations[e]=this._uniformLocationPointer,this._uniformLocationPointer+=t;for(i=0;i<t;i++)this._data.push(n[i]);this._needSync=!0}},dG.prototype.addMatrix=function(e,t){this.addUniform(e,Array.prototype.slice.call(t.toArray()))},dG.prototype.addFloat2=function(e,t,r){var n=[t,r];this.addUniform(e,n)},dG.prototype.addFloat3=function(e,t,r,n){var i=[t,r,n];this.addUniform(e,i)},dG.prototype.addColor3=function(e,t){var r=[t.r,t.g,t.b];this.addUniform(e,r)},dG.prototype.addColor4=function(e,t,r){var n=[t.r,t.g,t.b,r];this.addUniform(e,n)},dG.prototype.addVector3=function(e,t){var r=[t.x,t.y,t.z];this.addUniform(e,r)},dG.prototype.addMatrix3x3=function(e){this.addUniform(e,12)},dG.prototype.addMatrix2x2=function(e){this.addUniform(e,8)},dG.prototype.create=function(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)},dG.prototype._rebuild=function(){!this._noUBO&&this._bufferData&&(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData):this._buffer=this._engine.createUniformBuffer(this._bufferData),this._trackUbosInFrame&&(this._buffers.push([this._buffer,this._engine._features.checkUbosContentBeforeUpload?this._bufferData.slice():void 0]),this._bufferIndex=this._buffers.length-1,this._createBufferOnWrite=!1))},Object.defineProperty(dG.prototype,"_numBuffers",{get:function(){return this._buffers.length},enumerable:!1,configurable:!0}),Object.defineProperty(dG.prototype,"_indexBuffer",{get:function(){return this._bufferIndex},enumerable:!1,configurable:!0}),Object.defineProperty(dG.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),dG.prototype._buffersEqual=function(e,t){for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0},dG.prototype._copyBuffer=function(e,t){for(var r=0;r<e.length;++r)t[r]=e[r]},dG.prototype.update=function(){if(!this._noUBO)if(this.bindUniformBuffer(),this._buffer)if(this._dynamic||this._needSync){if(this._buffers&&this._buffers.length>1&&this._buffers[this._bufferIndex][1]){if(this._buffersEqual(this._bufferData,this._buffers[this._bufferIndex][1]))return this._needSync=!1,void(this._createBufferOnWrite=this._trackUbosInFrame);this._copyBuffer(this._bufferData,this._buffers[this._bufferIndex][1])}this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._engine._features._collectUbosUpdatedInFrame&&(!dG._UpdatedUbosInFrame[this._name]&&(dG._UpdatedUbosInFrame[this._name]=0),dG._UpdatedUbosInFrame[this._name]++),this._needSync=!1,this._createBufferOnWrite=this._trackUbosInFrame}else this._createBufferOnWrite=this._trackUbosInFrame;else this.create()},dG.prototype._createNewBuffer=function(){this._bufferIndex+1<this._buffers.length?(this._bufferIndex++,this._buffer=this._buffers[this._bufferIndex][0],this._createBufferOnWrite=!1,this._needSync=!0):this._rebuild()},dG.prototype._checkNewFrame=function(){this._trackUbosInFrame&&this._currentFrameId!==this._engine.frameId&&(this._currentFrameId=this._engine.frameId,this._createBufferOnWrite=!1,this._buffers&&this._buffers.length>0?(this._needSync=0!==this._bufferIndex,this._bufferIndex=0,this._buffer=this._buffers[this._bufferIndex][0]):this._bufferIndex=-1)},dG.prototype.updateUniform=function(e,t,r){this._checkNewFrame();var n=this._uniformLocations[e];if(void 0===n){if(this._buffer)return void aL.Error("Cannot add an uniform after UBO has been created.");this.addUniform(e,r),n=this._uniformLocations[e]}if(!this._buffer&&this.create(),this._dynamic)for(o=0;o<r;o++)this._bufferData[n+o]=t[o];else{for(var i=!1,o=0;o<r;o++)(16===r&&!this._engine._features.uniformBufferHardCheckMatrix||this._bufferData[n+o]!==GN.FloatRound(t[o]))&&(i=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[n+o]=t[o]);this._needSync=this._needSync||i}},dG.prototype.updateUniformArray=function(e,t,r){this._checkNewFrame();var n=this._uniformLocations[e];if(void 0!==n){!this._buffer&&this.create();var i=this._uniformArraySizes[e];if(this._dynamic)for(u=0;u<r;u++)this._bufferData[n+u]=t[u];else{for(var o=!1,s=0,a=0,u=0;u<r;u++)if(this._bufferData[n+4*a+s]!==GN.FloatRound(t[u])&&(o=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[n+4*a+s]=t[u]),++s===i.strideSize){for(;s<4;s++)this._bufferData[n+4*a+s]=0;s=0,a++}this._needSync=this._needSync||o}}else aL.Error("Cannot add an uniform Array dynamically. Please, add it using addUniform.")},dG.prototype._cacheMatrix=function(e,t){this._checkNewFrame();var r=this._valueCache[e],n=t.updateFlag;return(void 0===r||r!==n)&&(this._valueCache[e]=n,!0)},dG.prototype._updateMatrix3x3ForUniform=function(e,t){for(var r=0;r<3;r++)dG._TempBuffer[4*r]=t[3*r],dG._TempBuffer[4*r+1]=t[3*r+1],dG._TempBuffer[4*r+2]=t[3*r+2],dG._TempBuffer[4*r+3]=0;this.updateUniform(e,dG._TempBuffer,12)},dG.prototype._updateMatrix3x3ForEffect=function(e,t){this._currentEffect.setMatrix3x3(e,t)},dG.prototype._updateMatrix2x2ForEffect=function(e,t){this._currentEffect.setMatrix2x2(e,t)},dG.prototype._updateMatrix2x2ForUniform=function(e,t){for(var r=0;r<2;r++)dG._TempBuffer[4*r]=t[2*r],dG._TempBuffer[4*r+1]=t[2*r+1],dG._TempBuffer[4*r+2]=0,dG._TempBuffer[4*r+3]=0;this.updateUniform(e,dG._TempBuffer,8)},dG.prototype._updateFloatForEffect=function(e,t){this._currentEffect.setFloat(e,t)},dG.prototype._updateFloatForUniform=function(e,t){dG._TempBuffer[0]=t,this.updateUniform(e,dG._TempBuffer,1)},dG.prototype._updateFloat2ForEffect=function(e,t,r,n){void 0===n&&(n=""),this._currentEffect.setFloat2(e+n,t,r)},dG.prototype._updateFloat2ForUniform=function(e,t,r){dG._TempBuffer[0]=t,dG._TempBuffer[1]=r,this.updateUniform(e,dG._TempBuffer,2)},dG.prototype._updateFloat3ForEffect=function(e,t,r,n,i){void 0===i&&(i=""),this._currentEffect.setFloat3(e+i,t,r,n)},dG.prototype._updateFloat3ForUniform=function(e,t,r,n){dG._TempBuffer[0]=t,dG._TempBuffer[1]=r,dG._TempBuffer[2]=n,this.updateUniform(e,dG._TempBuffer,3)},dG.prototype._updateFloat4ForEffect=function(e,t,r,n,i,o){void 0===o&&(o=""),this._currentEffect.setFloat4(e+o,t,r,n,i)},dG.prototype._updateFloat4ForUniform=function(e,t,r,n,i){dG._TempBuffer[0]=t,dG._TempBuffer[1]=r,dG._TempBuffer[2]=n,dG._TempBuffer[3]=i,this.updateUniform(e,dG._TempBuffer,4)},dG.prototype._updateFloatArrayForEffect=function(e,t){this._currentEffect.setFloatArray(e,t)},dG.prototype._updateFloatArrayForUniform=function(e,t){this.updateUniformArray(e,t,t.length)},dG.prototype._updateArrayForEffect=function(e,t){this._currentEffect.setArray(e,t)},dG.prototype._updateArrayForUniform=function(e,t){this.updateUniformArray(e,t,t.length)},dG.prototype._updateIntArrayForEffect=function(e,t){this._currentEffect.setIntArray(e,t)},dG.prototype._updateIntArrayForUniform=function(e,t){dG._TempBufferInt32View.set(t),this.updateUniformArray(e,dG._TempBuffer,t.length)},dG.prototype._updateMatrixForEffect=function(e,t){this._currentEffect.setMatrix(e,t)},dG.prototype._updateMatrixForUniform=function(e,t){this._cacheMatrix(e,t)&&this.updateUniform(e,t.toArray(),16)},dG.prototype._updateMatricesForEffect=function(e,t){this._currentEffect.setMatrices(e,t)},dG.prototype._updateMatricesForUniform=function(e,t){this.updateUniform(e,t,t.length)},dG.prototype._updateVector3ForEffect=function(e,t){this._currentEffect.setVector3(e,t)},dG.prototype._updateVector3ForUniform=function(e,t){dG._TempBuffer[0]=t.x,dG._TempBuffer[1]=t.y,dG._TempBuffer[2]=t.z,this.updateUniform(e,dG._TempBuffer,3)},dG.prototype._updateVector4ForEffect=function(e,t){this._currentEffect.setVector4(e,t)},dG.prototype._updateVector4ForUniform=function(e,t){dG._TempBuffer[0]=t.x,dG._TempBuffer[1]=t.y,dG._TempBuffer[2]=t.z,dG._TempBuffer[3]=t.w,this.updateUniform(e,dG._TempBuffer,4)},dG.prototype._updateColor3ForEffect=function(e,t,r){void 0===r&&(r=""),this._currentEffect.setColor3(e+r,t)},dG.prototype._updateColor3ForUniform=function(e,t){dG._TempBuffer[0]=t.r,dG._TempBuffer[1]=t.g,dG._TempBuffer[2]=t.b,this.updateUniform(e,dG._TempBuffer,3)},dG.prototype._updateColor4ForEffect=function(e,t,r,n){void 0===n&&(n=""),this._currentEffect.setColor4(e+n,t,r)},dG.prototype._updateDirectColor4ForEffect=function(e,t,r){void 0===r&&(r=""),this._currentEffect.setDirectColor4(e+r,t)},dG.prototype._updateColor4ForUniform=function(e,t,r){dG._TempBuffer[0]=t.r,dG._TempBuffer[1]=t.g,dG._TempBuffer[2]=t.b,dG._TempBuffer[3]=r,this.updateUniform(e,dG._TempBuffer,4)},dG.prototype._updateDirectColor4ForUniform=function(e,t){t.red?(dG._TempBuffer[0]=t.red,dG._TempBuffer[1]=t.green,dG._TempBuffer[2]=t.blue,dG._TempBuffer[3]=t.alpha):(dG._TempBuffer[0]=t.r,dG._TempBuffer[1]=t.g,dG._TempBuffer[2]=t.b,dG._TempBuffer[3]=t.a),this.updateUniform(e,dG._TempBuffer,4)},dG.prototype._updateIntForEffect=function(e,t,r){void 0===r&&(r=""),this._currentEffect.setInt(e+r,t)},dG.prototype._updateIntForUniform=function(e,t){dG._TempBufferInt32View[0]=t,this.updateUniform(e,dG._TempBuffer,1)},dG.prototype._updateInt2ForEffect=function(e,t,r,n){void 0===n&&(n=""),this._currentEffect.setInt2(e+n,t,r)},dG.prototype._updateInt2ForUniform=function(e,t,r){dG._TempBufferInt32View[0]=t,dG._TempBufferInt32View[1]=r,this.updateUniform(e,dG._TempBuffer,2)},dG.prototype._updateInt3ForEffect=function(e,t,r,n,i){void 0===i&&(i=""),this._currentEffect.setInt3(e+i,t,r,n)},dG.prototype._updateInt3ForUniform=function(e,t,r,n){dG._TempBufferInt32View[0]=t,dG._TempBufferInt32View[1]=r,dG._TempBufferInt32View[2]=n,this.updateUniform(e,dG._TempBuffer,3)},dG.prototype._updateInt4ForEffect=function(e,t,r,n,i,o){void 0===o&&(o=""),this._currentEffect.setInt4(e+o,t,r,n,i)},dG.prototype._updateInt4ForUniform=function(e,t,r,n,i){dG._TempBufferInt32View[0]=t,dG._TempBufferInt32View[1]=r,dG._TempBufferInt32View[2]=n,dG._TempBufferInt32View[3]=i,this.updateUniform(e,dG._TempBuffer,4)},dG.prototype.setTexture=function(e,t){this._currentEffect.setTexture(e,t)},dG.prototype.updateUniformDirectly=function(e,t){this.updateUniform(e,t,t.length),this.update()},dG.prototype.bindToEffect=function(e,t){this._currentEffect=e,this._currentEffectName=t},dG.prototype.bindUniformBuffer=function(){!this._noUBO&&this._buffer&&this._currentEffect&&this._currentEffect.bindUniformBuffer(this._buffer,this._currentEffectName)},dG.prototype.unbindEffect=function(){this._currentEffect=void 0,this._currentEffectName=void 0},dG.prototype.setDataBuffer=function(e){if(!this._buffers)return this._buffer===e;for(var t=0;t<this._buffers.length;++t){if(this._buffers[t][0]===e)return this._bufferIndex=t,this._buffer=e,this._createBufferOnWrite=!1,this._currentEffect=void 0,!0}return!1},dG.prototype.dispose=function(){if(!this._noUBO){var e=this._engine._uniformBuffers,t=e.indexOf(this);if(-1!==t&&(e[t]=e[e.length-1],e.pop()),this._trackUbosInFrame&&this._buffers)for(var r=0;r<this._buffers.length;++r){var n=this._buffers[r][0];this._engine._releaseBuffer(n)}else this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}},dG._UpdatedUbosInFrame={},dG._MAX_UNIFORM_SIZE=256,dG._TempBuffer=new Float32Array(dG._MAX_UNIFORM_SIZE),dG._TempBufferInt32View=new Uint32Array(dG._TempBuffer.buffer);var AG,gG=(AG=!0,function(e,t){var r=AG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return AG=!1,r}),_G=gG(void 0,(function(){return _G.toString().search("(((.+)+)+)+$").toString().constructor(_G).search("(((.+)+)+)+$")}));function mG(){}_G(),mG.prototype._addUniformToLeftOverUBO=function(e,t,r){var n,i;e=(n=this._getArraySize(e,t,r))[0],t=n[1],i=n[2];for(var o=0;o<this._webgpuProcessingContext.leftOverUniforms.length;o++)if(this._webgpuProcessingContext.leftOverUniforms[o].name===e)return;this._webgpuProcessingContext.leftOverUniforms.push({name:e,type:t,length:i})},mG.prototype._buildLeftOverUBO=function(){if(!this._webgpuProcessingContext.leftOverUniforms.length)return"";var e=mG.LeftOvertUBOName,t=this._webgpuProcessingContext.availableBuffers[e];return!t&&(t={binding:this._webgpuProcessingContext.getNextFreeUBOBinding()},this._webgpuProcessingContext.availableBuffers[e]=t,this._addBufferBindingDescription(e,t,_N.BufferBindingType.Uniform,!0),this._addBufferBindingDescription(e,t,_N.BufferBindingType.Uniform,!1)),this._generateLeftOverUBOCode(e,t)},mG.prototype._collectBindingNames=function(){for(var e=0;e<this._webgpuProcessingContext.bindGroupLayoutEntries.length;e++){var t=this._webgpuProcessingContext.bindGroupLayoutEntries[e];if(void 0!==t)for(var r=0;r<t.length;r++){var n=this._webgpuProcessingContext.bindGroupLayoutEntries[e][r],i=this._webgpuProcessingContext.bindGroupLayoutEntryInfo[e][n.binding].name,o=this._webgpuProcessingContext.bindGroupLayoutEntryInfo[e][n.binding].nameInArrayOfTexture;n&&(n.texture||n.externalTexture||n.storageTexture?this._webgpuProcessingContext.textureNames.push(o):n.sampler?this._webgpuProcessingContext.samplerNames.push(i):n.buffer&&this._webgpuProcessingContext.bufferNames.push(i))}else this._webgpuProcessingContext.bindGroupLayoutEntries[e]=[]}},mG.prototype._preCreateBindGroupEntries=function(){for(var e=this._webgpuProcessingContext.bindGroupEntries,t=0;t<this._webgpuProcessingContext.bindGroupLayoutEntries.length;t++){for(var r=this._webgpuProcessingContext.bindGroupLayoutEntries[t],n=[],i=0;i<r.length;i++){var o=this._webgpuProcessingContext.bindGroupLayoutEntries[t][i];o.sampler||o.texture||o.storageTexture||o.externalTexture?n.push({binding:o.binding,resource:void 0}):o.buffer&&n.push({binding:o.binding,resource:{buffer:void 0,offset:0,size:0}})}e[t]=n}},mG.prototype._addTextureBindingDescription=function(e,t,r,n,i,o){var s=t.textures[r],a=s.groupIndex,u=s.bindingIndex;if(!this._webgpuProcessingContext.bindGroupLayoutEntries[a]&&(this._webgpuProcessingContext.bindGroupLayoutEntries[a]=[],this._webgpuProcessingContext.bindGroupLayoutEntryInfo[a]=[]),!this._webgpuProcessingContext.bindGroupLayoutEntryInfo[a][u]){var c=void 0;c=null===n?this._webgpuProcessingContext.bindGroupLayoutEntries[a].push({binding:u,visibility:0,externalTexture:{}}):i?this._webgpuProcessingContext.bindGroupLayoutEntries[a].push({binding:u,visibility:0,storageTexture:{access:_N.StorageTextureAccess.WriteOnly,format:i,viewDimension:n}}):this._webgpuProcessingContext.bindGroupLayoutEntries[a].push({binding:u,visibility:0,texture:{sampleType:t.sampleType,viewDimension:n,multisampled:t.isMultisampled}});var l=t.isTextureArray?e+r:e;this._webgpuProcessingContext.bindGroupLayoutEntryInfo[a][u]={name:e,index:c-1,nameInArrayOfTexture:l}}u=this._webgpuProcessingContext.bindGroupLayoutEntryInfo[a][u].index,this._webgpuProcessingContext.bindGroupLayoutEntries[a][u].visibility|=o?_N.ShaderStage.Vertex:_N.ShaderStage.Fragment},mG.prototype._addSamplerBindingDescription=function(e,t,r){var n=t.binding,i=n.groupIndex,o=n.bindingIndex;if(!this._webgpuProcessingContext.bindGroupLayoutEntries[i]&&(this._webgpuProcessingContext.bindGroupLayoutEntries[i]=[],this._webgpuProcessingContext.bindGroupLayoutEntryInfo[i]=[]),!this._webgpuProcessingContext.bindGroupLayoutEntryInfo[i][o]){var s=this._webgpuProcessingContext.bindGroupLayoutEntries[i].push({binding:o,visibility:0,sampler:{type:t.type}});this._webgpuProcessingContext.bindGroupLayoutEntryInfo[i][o]={name:e,index:s-1}}o=this._webgpuProcessingContext.bindGroupLayoutEntryInfo[i][o].index,this._webgpuProcessingContext.bindGroupLayoutEntries[i][o].visibility|=r?_N.ShaderStage.Vertex:_N.ShaderStage.Fragment},mG.prototype._addBufferBindingDescription=function(e,t,r,n){var i=t.binding,o=i.groupIndex,s=i.bindingIndex;if(!this._webgpuProcessingContext.bindGroupLayoutEntries[o]&&(this._webgpuProcessingContext.bindGroupLayoutEntries[o]=[],this._webgpuProcessingContext.bindGroupLayoutEntryInfo[o]=[]),!this._webgpuProcessingContext.bindGroupLayoutEntryInfo[o][s]){var a=this._webgpuProcessingContext.bindGroupLayoutEntries[o].push({binding:s,visibility:0,buffer:{type:r}});this._webgpuProcessingContext.bindGroupLayoutEntryInfo[o][s]={name:e,index:a-1}}s=this._webgpuProcessingContext.bindGroupLayoutEntryInfo[o][s].index,this._webgpuProcessingContext.bindGroupLayoutEntries[o][s].visibility|=n?_N.ShaderStage.Vertex:_N.ShaderStage.Fragment},mG.prototype._injectStartingAndEndingCode=function(e,t,r,n){if(r){var i=e.indexOf(t);if(i>=0){for(;i++<e.length&&"{"!=e.charAt(i););if(i<e.length){for(;i++<e.length&&"\n"!=e.charAt(i););if(i<e.length){var o=e.substring(0,i+1),s=e.substring(i+1);e=o+r+s}}}}if(n){var a=e.lastIndexOf("}");e=e.substring(0,a),e+=n+"\n}"}return e},mG.AutoSamplerSuffix="Sampler",mG.LeftOvertUBOName="LeftOver",mG.InternalsUBOName="Internals",mG.UniformSizes={bool:1,int:1,float:1,vec2:2,ivec2:2,vec3:3,ivec3:3,vec4:4,ivec4:4,mat2:4,mat3:12,mat4:16,i32:1,u32:1,f32:1,mat2x2:4,mat3x3:12,mat4x4:16},mG._SamplerFunctionByWebGLSamplerType={sampler2D:"sampler2D",sampler2DArray:"sampler2DArray",sampler2DShadow:"sampler2DShadow",sampler2DArrayShadow:"sampler2DArrayShadow",samplerCube:"samplerCube",sampler3D:"sampler3D"},mG._TextureTypeByWebGLSamplerType={sampler2D:"texture2D",sampler2DArray:"texture2DArray",sampler2DShadow:"texture2D",sampler2DArrayShadow:"texture2DArray",samplerCube:"textureCube",samplerCubeArray:"textureCubeArray",sampler3D:"texture3D"},mG._GpuTextureViewDimensionByWebGPUTextureType={textureCube:_N.TextureViewDimension.Cube,textureCubeArray:_N.TextureViewDimension.CubeArray,texture2D:_N.TextureViewDimension.E2d,texture2DArray:_N.TextureViewDimension.E2dArray,texture3D:_N.TextureViewDimension.E3d},mG._SamplerTypeByWebGLSamplerType={sampler2DShadow:"samplerShadow",sampler2DArrayShadow:"samplerShadow"},mG._IsComparisonSamplerByWebGPUSamplerType={samplerShadow:!0,samplerArrayShadow:!0,sampler:!1};var yG,EG=(yG=!0,function(e,t){var r=yG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return yG=!1,r}),xG=EG(void 0,(function(){return xG.toString().search("(((.+)+)+)+$").toString().constructor(xG).search("(((.+)+)+)+$")}));function CG(e,t){this._name="unnamed",this.shaderProcessingContext=e,this._leftOverUniformsByName={},this.engine=t}xG(),Object.defineProperty(CG.prototype,"isAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(CG.prototype,"isReady",{get:function(){return!!this.stages},enumerable:!1,configurable:!0}),CG.prototype._handlesSpectorRebuildCallback=function(){},CG.prototype._fillEffectInformation=function(e,t,r,n,i,o,s,a){var u=this.engine;e._fragmentSourceCode="",e._vertexSourceCode="";var c,l=this.shaderProcessingContext.availableTextures;for(c=0;c<i.length;c++){var h=i[c],p=l[i[c]];null==p||null==p?(i.splice(c,1),c--):o[h]=c}for(var f=0,d=u.getAttributes(this,s);f<d.length;f++){var A=d[f];a.push(A)}this.buildUniformLayout();var g=[],_=[];for(c=0;c<s.length;c++){var m=a[c];m>=0&&(g.push(s[c]),_.push(m))}this.shaderProcessingContext.attributeNamesFromEffect=g,this.shaderProcessingContext.attributeLocationsFromEffect=_},CG.prototype.buildUniformLayout=function(){if(this.shaderProcessingContext.leftOverUniforms.length){this.uniformBuffer=new dG(this.engine,void 0,void 0,"leftOver-"+this._name);for(var e=0,t=this.shaderProcessingContext.leftOverUniforms;e<t.length;e++){var r=t[e],n=r.type.replace(/^(.*?)(<.*>)?$/,"$1"),i=mG.UniformSizes[n];this.uniformBuffer.addUniform(r.name,i,r.length),this._leftOverUniformsByName[r.name]=r.type}this.uniformBuffer.create()}},CG.prototype.dispose=function(){this.uniformBuffer&&this.uniformBuffer.dispose()},CG.prototype.setInt=function(e,t){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateInt(e,t)},CG.prototype.setInt2=function(e,t,r){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateInt2(e,t,r)},CG.prototype.setInt3=function(e,t,r,n){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateInt3(e,t,r,n)},CG.prototype.setInt4=function(e,t,r,n,i){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateInt4(e,t,r,n,i)},CG.prototype.setIntArray=function(e,t){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateIntArray(e,t)},CG.prototype.setIntArray2=function(e,t){this.setIntArray(e,t)},CG.prototype.setIntArray3=function(e,t){this.setIntArray(e,t)},CG.prototype.setIntArray4=function(e,t){this.setIntArray(e,t)},CG.prototype.setArray=function(e,t){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateArray(e,t)},CG.prototype.setArray2=function(e,t){this.setArray(e,t)},CG.prototype.setArray3=function(e,t){this.setArray(e,t)},CG.prototype.setArray4=function(e,t){this.setArray(e,t)},CG.prototype.setMatrices=function(e,t){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateMatrices(e,t)},CG.prototype.setMatrix=function(e,t){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateMatrix(e,t)},CG.prototype.setMatrix3x3=function(e,t){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateMatrix3x3(e,t)},CG.prototype.setMatrix2x2=function(e,t){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateMatrix2x2(e,t)},CG.prototype.setFloat=function(e,t){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateFloat(e,t)},CG.prototype.setVector2=function(e,t){this.setFloat2(e,t.x,t.y)},CG.prototype.setFloat2=function(e,t,r){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateFloat2(e,t,r)},CG.prototype.setVector3=function(e,t){this.setFloat3(e,t.x,t.y,t.z)},CG.prototype.setFloat3=function(e,t,r,n){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateFloat3(e,t,r,n)},CG.prototype.setVector4=function(e,t){this.setFloat4(e,t.x,t.y,t.z,t.w)},CG.prototype.setFloat4=function(e,t,r,n,i){this.uniformBuffer&&this._leftOverUniformsByName[e]&&this.uniformBuffer.updateFloat4(e,t,r,n,i)},CG.prototype.setColor3=function(e,t){this.setFloat3(e,t.r,t.g,t.b)},CG.prototype.setColor4=function(e,t,r){this.setFloat4(e,t.r,t.g,t.b,r)},CG.prototype.setDirectColor4=function(e,t){this.setFloat4(e,t.r,t.g,t.b,t.a)},CG.prototype._getVertexShaderCode=function(){var e;return null===(e=this.sources)||void 0===e?void 0:e.vertex},CG.prototype._getFragmentShaderCode=function(){var e;return null===(e=this.sources)||void 0===e?void 0:e.fragment};var bG,IG=(bG=!0,function(e,t){var r=bG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return bG=!1,r}),vG=IG(void 0,(function(){return vG.toString().search("(((.+)+)+)+$").toString().constructor(vG).search("(((.+)+)+)+$")}));vG();var TG={mat2:2,mat3:3,mat4:4,mat2x2:2,mat3x3:3,mat4x4:4};function RG(e){this.shaderLanguage=e,this._attributeNextLocation=0,this._varyingNextLocation=0,this.freeGroupIndex=0,this.freeBindingIndex=0,this.availableVaryings={},this.availableAttributes={},this.availableBuffers={},this.availableTextures={},this.availableSamplers={},this.orderedAttributes=[],this.bindGroupLayoutEntries=[],this.bindGroupLayoutEntryInfo=[],this.bindGroupEntries=[],this.bufferNames=[],this.textureNames=[],this.samplerNames=[],this.leftOverUniforms=[],this._findStartingGroupBinding()}Object.defineProperty(RG,"KnownUBOs",{get:function(){return RG._SimplifiedKnownBindings?RG._SimplifiedKnownUBOs:RG._KnownUBOs},enumerable:!1,configurable:!0}),RG.prototype._findStartingGroupBinding=function(){var e=RG.KnownUBOs,t=[];for(var r in e){var n=e[r].binding;-1!==n.groupIndex&&(void 0===t[n.groupIndex]?t[n.groupIndex]=n.bindingIndex:t[n.groupIndex]=Math.max(t[n.groupIndex],n.bindingIndex))}this.freeGroupIndex=t.length-1,0===this.freeGroupIndex?(this.freeGroupIndex++,this.freeBindingIndex=0):this.freeBindingIndex=t[t.length-1]+1},RG.prototype.getAttributeNextLocation=function(e,t){var r;void 0===t&&(t=0);var n=this._attributeNextLocation;return this._attributeNextLocation+=(null!==(r=TG[e])&&void 0!==r?r:1)*(t||1),n},RG.prototype.getVaryingNextLocation=function(e,t){var r;void 0===t&&(t=0);var n=this._varyingNextLocation;return this._varyingNextLocation+=(null!==(r=TG[e])&&void 0!==r?r:1)*(t||1),n},RG.prototype.getNextFreeUBOBinding=function(){return this._getNextFreeBinding(1)},RG.prototype._getNextFreeBinding=function(e){if(this.freeBindingIndex>65536-e&&(this.freeGroupIndex++,this.freeBindingIndex=0),4===this.freeGroupIndex)throw"Too many textures or UBOs have been declared and it is not supported in WebGPU.";var t={groupIndex:this.freeGroupIndex,bindingIndex:this.freeBindingIndex};return this.freeBindingIndex+=e,t},RG._SimplifiedKnownBindings=!0,RG._SimplifiedKnownUBOs={Scene:{binding:{groupIndex:0,bindingIndex:0}},Light0:{binding:{groupIndex:-1,bindingIndex:-1}},Light1:{binding:{groupIndex:-1,bindingIndex:-1}},Light2:{binding:{groupIndex:-1,bindingIndex:-1}},Light3:{binding:{groupIndex:-1,bindingIndex:-1}},Light4:{binding:{groupIndex:-1,bindingIndex:-1}},Light5:{binding:{groupIndex:-1,bindingIndex:-1}},Light6:{binding:{groupIndex:-1,bindingIndex:-1}},Light7:{binding:{groupIndex:-1,bindingIndex:-1}},Light8:{binding:{groupIndex:-1,bindingIndex:-1}},Light9:{binding:{groupIndex:-1,bindingIndex:-1}},Light10:{binding:{groupIndex:-1,bindingIndex:-1}},Light11:{binding:{groupIndex:-1,bindingIndex:-1}},Light12:{binding:{groupIndex:-1,bindingIndex:-1}},Light13:{binding:{groupIndex:-1,bindingIndex:-1}},Light14:{binding:{groupIndex:-1,bindingIndex:-1}},Light15:{binding:{groupIndex:-1,bindingIndex:-1}},Light16:{binding:{groupIndex:-1,bindingIndex:-1}},Light17:{binding:{groupIndex:-1,bindingIndex:-1}},Light18:{binding:{groupIndex:-1,bindingIndex:-1}},Light19:{binding:{groupIndex:-1,bindingIndex:-1}},Light20:{binding:{groupIndex:-1,bindingIndex:-1}},Light21:{binding:{groupIndex:-1,bindingIndex:-1}},Light22:{binding:{groupIndex:-1,bindingIndex:-1}},Light23:{binding:{groupIndex:-1,bindingIndex:-1}},Light24:{binding:{groupIndex:-1,bindingIndex:-1}},Light25:{binding:{groupIndex:-1,bindingIndex:-1}},Light26:{binding:{groupIndex:-1,bindingIndex:-1}},Light27:{binding:{groupIndex:-1,bindingIndex:-1}},Light28:{binding:{groupIndex:-1,bindingIndex:-1}},Light29:{binding:{groupIndex:-1,bindingIndex:-1}},Light30:{binding:{groupIndex:-1,bindingIndex:-1}},Light31:{binding:{groupIndex:-1,bindingIndex:-1}},Material:{binding:{groupIndex:-1,bindingIndex:-1}},Mesh:{binding:{groupIndex:-1,bindingIndex:-1}},Internals:{binding:{groupIndex:-1,bindingIndex:-1}}},RG._KnownUBOs={Scene:{binding:{groupIndex:0,bindingIndex:0}},Light0:{binding:{groupIndex:1,bindingIndex:0}},Light1:{binding:{groupIndex:1,bindingIndex:1}},Light2:{binding:{groupIndex:1,bindingIndex:2}},Light3:{binding:{groupIndex:1,bindingIndex:3}},Light4:{binding:{groupIndex:1,bindingIndex:4}},Light5:{binding:{groupIndex:1,bindingIndex:5}},Light6:{binding:{groupIndex:1,bindingIndex:6}},Light7:{binding:{groupIndex:1,bindingIndex:7}},Light8:{binding:{groupIndex:1,bindingIndex:8}},Light9:{binding:{groupIndex:1,bindingIndex:9}},Light10:{binding:{groupIndex:1,bindingIndex:10}},Light11:{binding:{groupIndex:1,bindingIndex:11}},Light12:{binding:{groupIndex:1,bindingIndex:12}},Light13:{binding:{groupIndex:1,bindingIndex:13}},Light14:{binding:{groupIndex:1,bindingIndex:14}},Light15:{binding:{groupIndex:1,bindingIndex:15}},Light16:{binding:{groupIndex:1,bindingIndex:16}},Light17:{binding:{groupIndex:1,bindingIndex:17}},Light18:{binding:{groupIndex:1,bindingIndex:18}},Light19:{binding:{groupIndex:1,bindingIndex:19}},Light20:{binding:{groupIndex:1,bindingIndex:20}},Light21:{binding:{groupIndex:1,bindingIndex:21}},Light22:{binding:{groupIndex:1,bindingIndex:22}},Light23:{binding:{groupIndex:1,bindingIndex:23}},Light24:{binding:{groupIndex:1,bindingIndex:24}},Light25:{binding:{groupIndex:1,bindingIndex:25}},Light26:{binding:{groupIndex:1,bindingIndex:26}},Light27:{binding:{groupIndex:1,bindingIndex:27}},Light28:{binding:{groupIndex:1,bindingIndex:28}},Light29:{binding:{groupIndex:1,bindingIndex:29}},Light30:{binding:{groupIndex:1,bindingIndex:30}},Light31:{binding:{groupIndex:1,bindingIndex:31}},Material:{binding:{groupIndex:2,bindingIndex:0}},Mesh:{binding:{groupIndex:2,bindingIndex:1}},Internals:{binding:{groupIndex:2,bindingIndex:2}}};var SG,MG=(SG=!0,function(e,t){var r=SG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return SG=!1,r}),wG=MG(void 0,(function(){return wG.toString().search("(((.+)+)+)+$").toString().constructor(wG).search("(((.+)+)+)+$")}));function BG(){var e=mG.call(this,arguments)||this;return e._missingVaryings=[],e._textureArrayProcessing=[],e.shaderLanguage=vU.GLSL,e}wG(),BG.prototype=Object.create(mG.prototype),BG.prototype.constructor=mG,BG.prototype._getArraySize=function(e,t,r){var n=0,i=e.indexOf("["),o=e.indexOf("]");if(i>0&&o>0){var s=e.substring(i+1,o);n=+s,isNaN(n)&&(n=+r[s.trim()]),e=e.substr(0,i)}return[e,t,n]},BG.prototype.initializeShaders=function(e){this._webgpuProcessingContext=e,this._missingVaryings.length=0,this._textureArrayProcessing.length=0},BG.prototype.preProcessShaderCode=function(e,t){var r="uniform ".concat(mG.InternalsUBOName," {\nfloat yFactor__;\nfloat textureOutputHeight__;\n};\n");return t?r+"##INJECTCODE##\n"+e:r+e},BG.prototype.varyingProcessor=function(e,t,r){this._preProcessors=r;var n=/\s*varying\s+(?:(?:highp)?|(?:mediump)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/gm.exec(e);if(null!=n){var i,o=n[1],s=n[2];t?(i=this._webgpuProcessingContext.availableVaryings[s],this._missingVaryings[i]="",void 0===i&&aL.Warn('Invalid fragment shader: The varying named "'.concat(s,'" is not declared in the vertex shader! This declaration will be ignored.'))):(i=this._webgpuProcessingContext.getVaryingNextLocation(o,this._getArraySize(s,o,r)[2]),this._webgpuProcessingContext.availableVaryings[s]=i,this._missingVaryings[i]="layout(location = ".concat(i,") in ").concat(o," ").concat(s,";")),e=e.replace(n[0],void 0===i?"":"layout(location = ".concat(i,") ").concat(t?"in":"out"," ").concat(o," ").concat(s,";"))}return e},BG.prototype.attributeProcessor=function(e,t){this._preProcessors=t;var r=/\s*attribute\s+(?:(?:highp)?|(?:mediump)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/gm.exec(e);if(null!=r){var n=r[1],i=r[2],o=this._webgpuProcessingContext.getAttributeNextLocation(n,this._getArraySize(i,n,t)[2]);this._webgpuProcessingContext.availableAttributes[i]=o,this._webgpuProcessingContext.orderedAttributes[o]=i,e=e.replace(r[0],"layout(location = ".concat(o,") in ").concat(n," ").concat(i,";"))}return e},BG.prototype.uniformProcessor=function(e,t,r){var n,i;this._preProcessors=r;var o=/\s*uniform\s+(?:(?:highp)?|(?:mediump)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/gm.exec(e);if(null!=o){var s=o[1],a=o[2];if(0===s.indexOf("sampler")||1===s.indexOf("sampler")){var u=0;a=(n=this._getArraySize(a,s,r))[0],s=n[1],u=n[2];var c=this._webgpuProcessingContext.availableTextures[a];if(!c){c={autoBindSampler:!0,isTextureArray:u>0,isStorageTexture:!1,textures:[],sampleType:_N.TextureSampleType.Float};for(var l=0;l<(u||1);++l)c.textures.push(this._webgpuProcessingContext.getNextFreeUBOBinding())}var h=null!==(i=mG._SamplerTypeByWebGLSamplerType[s])&&void 0!==i?i:"sampler",p=!!mG._IsComparisonSamplerByWebGPUSamplerType[h];a.indexOf("depth")>=0&&(p=!0);var f=p?_N.SamplerBindingType.Comparison:_N.SamplerBindingType.Filtering,d=a+mG.AutoSamplerSuffix,A=this._webgpuProcessingContext.availableSamplers[d];!A&&(A={binding:this._webgpuProcessingContext.getNextFreeUBOBinding(),type:f});var g="u"===s.charAt(0)?"u":"i"===s.charAt(0)?"i":"";g&&(s=s.substr(1));var _=p?_N.TextureSampleType.Depth:"u"===g?_N.TextureSampleType.Uint:"i"===g?_N.TextureSampleType.Sint:_N.TextureSampleType.Float;c.sampleType=_;var m=u>0,y=A.binding.groupIndex,E=A.binding.bindingIndex,x=mG._SamplerFunctionByWebGLSamplerType[s],C=mG._TextureTypeByWebGLSamplerType[s],b=mG._GpuTextureViewDimensionByWebGPUTextureType[C];if(m){var I=[];I.push("layout(set = ".concat(y,", binding = ").concat(E,") uniform ").concat(g).concat(h," ").concat(d,";")),e="\r\n";for(l=0;l<u;++l){var v=c.textures[l].groupIndex,T=c.textures[l].bindingIndex;I.push("layout(set = ".concat(v,", binding = ").concat(T,") uniform ").concat(C," ").concat(a,"Texture").concat(l,";")),e+="".concat(l>0?"\r\n":"","#define ").concat(a).concat(l," ").concat(g).concat(x,"(").concat(a,"Texture").concat(l,", ").concat(d,")")}e=I.join("\r\n")+e,this._textureArrayProcessing.push(a)}else u=1,e="layout(set = ".concat(y,", binding = ").concat(E,") uniform ").concat(g).concat(h," ").concat(d,";\n                        layout(set = ").concat(c.textures[0].groupIndex,", binding = ").concat(c.textures[0].bindingIndex,") uniform ").concat(C," ").concat(a,"Texture;\n                        #define ").concat(a," ").concat(g).concat(x,"(").concat(a,"Texture, ").concat(d,")");this._webgpuProcessingContext.availableTextures[a]=c,this._webgpuProcessingContext.availableSamplers[d]=A,this._addSamplerBindingDescription(d,A,!t);for(l=0;l<u;++l)this._addTextureBindingDescription(a,c,l,b,null,!t)}else this._addUniformToLeftOverUBO(a,s,r),e=""}return e},BG.prototype.uniformBufferProcessor=function(e,t){var r=/uniform\s+(\w+)/gm.exec(e);if(null!=r){var n=r[1],i=this._webgpuProcessingContext.availableBuffers[n];if(!i){var o=RG.KnownUBOs[n];i={binding:o&&-1!==o.binding.groupIndex?o.binding:this._webgpuProcessingContext.getNextFreeUBOBinding()},this._webgpuProcessingContext.availableBuffers[n]=i}this._addBufferBindingDescription(n,i,_N.BufferBindingType.Uniform,!t),e=e.replace("uniform","layout(set = ".concat(i.binding.groupIndex,", binding = ").concat(i.binding.bindingIndex,") uniform"))}return e},BG.prototype.postProcessor=function(e,t,r,n,i){var o=e.search(/#extension.+GL_EXT_draw_buffers.+require/);o=-1!==e.search(/glFragData/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),r){var s,a,u=/##INJECTCODE##/,c=e.split("\n"),l=-1;for(s=0;s<c.length;++s)if(a=c[s],u.test(a)){l=s+1;break}if(l>-1&&function(e,t){for(var r=new RegExp("(^|[^\\w])("+e+")($|[^\\w])","g"),n=t.length,i=0;i<n;++i){var o=t[i];if(r.test(o))return!0}return!1}("gl_FragColor",c)){var h=o?"":"layout(location = 0) out vec4 glFragColor;";c.splice(l,0,h),e=c.join("\n")}var p=e.indexOf("gl_FragCoord")>=0,f=p?"vec4 glFragCoord__;\n":"";e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/gl_FragCoord/g,"glFragCoord__")).replace(/dFdy/g,"(-yFactor__)*dFdy")).replace("##INJECTCODE##",f),p&&(e=this._injectStartingAndEndingCode(e,"void main","\n                glFragCoord__ = gl_FragCoord;\n                if (yFactor__ == 1.) {\n                    glFragCoord__.y = textureOutputHeight__ - glFragCoord__.y;\n                }\n            "))}else{if(e=(e=e.replace(/gl_InstanceID/g,"gl_InstanceIndex")).replace(/gl_VertexID/g,"gl_VertexIndex"),-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e}if(!r&&-1==e.indexOf("gl_Position.y *= yFactor__")){var d=e.lastIndexOf("}");e=e.substring(0,d),e+="gl_Position.y *= yFactor__;\n",!i.isNDCHalfZRange&&(e+="gl_Position.z = (gl_Position.z + gl_Position.w) / 2.0;\n"),e+="}"}return e},BG.prototype._applyTextureArrayProcessing=function(e,t){for(var r=new RegExp(t+"\\s*\\[(.+)?\\]","gm"),n=r.exec(e);null!=n;){var i=n[1],o=+i;this._preProcessors&&isNaN(o)&&(o=+this._preProcessors[i.trim()]),e=e.replace(n[0],t+o),n=r.exec(e)}return e},BG.prototype._generateLeftOverUBOCode=function(e,t){for(var r="layout(set = ".concat(t.binding.groupIndex,", binding = ").concat(t.binding.bindingIndex,") uniform ").concat(e," {\n    "),n=0,i=this._webgpuProcessingContext.leftOverUniforms;n<i.length;n++){var o=i[n];o.length>0?r+="    ".concat(o.type," ").concat(o.name,"[").concat(o.length,"];\n"):r+="    ".concat(o.type," ").concat(o.name,";\n")}return r+="};\n\n"},BG.prototype.finalizeShaders=function(e,t){for(var r=0;r<this._textureArrayProcessing.length;++r){var n=this._textureArrayProcessing[r];e=this._applyTextureArrayProcessing(e,n),t=this._applyTextureArrayProcessing(t,n)}for(r=0;r<this._missingVaryings.length;++r){var i=this._missingVaryings[r];i&&i.length>0&&(t=i+"\n"+t)}var o=this._buildLeftOverUBO();return e=o+e,t=o+t,this._collectBindingNames(),this._preCreateBindGroupEntries(),this._preProcessors=null,{vertexCode:e,fragmentCode:t}};var OG,DG=(OG=!0,function(e,t){var r=OG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return OG=!1,r}),FG=DG(void 0,(function(){return FG.toString().search("(((.+)+)+)+$").toString().constructor(FG).search("(((.+)+)+)+$")}));function PG(e,t,r,n){for(var i=n,o=0,s="";i<r.length;){var a=r.charAt(i);if(s)a===s?'"'===s||"'"===s?"\\"!==r.charAt(i-1)&&(s=""):s="":"*/"===s&&"*"===a&&i+1<r.length&&("/"===r.charAt(i+1)&&(s=""),""===s&&i++);else switch(a){case e:o++;break;case t:o--;break;case'"':case"'":case"`":s=a;break;case"/":if(i+1<r.length){var u=r.charAt(i+1);"/"===u?s="\n":"*"===u&&(s="*/")}}if(i++,0===o)break}return 0===o?i-1:-1}function NG(e,t){for(;t<e.length;){var r=e[t];if(" "!==r&&"\n"!==r&&"\r"!==r&&"\t"!==r&&"\n"!==r&&" "!==r)break;t++}return t}function LG(e){var t=e.charCodeAt(0);return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||95==t}function UG(e){for(var t=0,r="",n=!1,i=[];t<e.length;){var o=e.charAt(t);if(r)o===r?'"'===r||"'"===r?("\\"!==e.charAt(t-1)&&(r=""),i.push(o)):(r="",n=!1):"*/"===r&&"*"===o&&t+1<e.length?("/"===e.charAt(t+1)&&(r=""),""===r&&(n=!1,t++)):!n&&i.push(o);else{switch(o){case'"':case"'":case"`":r=o;break;case"/":if(t+1<e.length){var s=e.charAt(t+1);"/"===s?(r="\n",n=!0):"*"===s&&(r="*/",n=!0)}}!n&&i.push(o)}t++}return i.join("")}function GG(e,t,r){for(;t>=0&&e.charAt(t)!==r;)t--;return t}FG();var QG,kG=(QG=!0,function(e,t){var r=QG?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return QG=!1,r}),zG=kG(void 0,(function(){return zG.toString().search("(((.+)+)+)+$").toString().constructor(zG).search("(((.+)+)+)+$")}));zG();var jG="gl_VertexID",HG="gl_InstanceID",qG="gl_Position",VG="gl_FragCoord",YG="gl_FrontFacing",XG="gl_FragDepth",WG="gl_FragColor",KG="gl_FragData",$G=["gl_FragData0","gl_FragData1","gl_FragData2","gl_FragData3","gl_FragData4","gl_FragData5","gl_FragData6","gl_FragData7"],JG={texture_1d:_N.TextureViewDimension.E1d,texture_2d:_N.TextureViewDimension.E2d,texture_2d_array:_N.TextureViewDimension.E2dArray,texture_3d:_N.TextureViewDimension.E3d,texture_cube:_N.TextureViewDimension.Cube,texture_cube_array:_N.TextureViewDimension.CubeArray,texture_multisampled_2d:_N.TextureViewDimension.E2d,texture_depth_2d:_N.TextureViewDimension.E2d,texture_depth_2d_array:_N.TextureViewDimension.E2dArray,texture_depth_cube:_N.TextureViewDimension.Cube,texture_depth_cube_array:_N.TextureViewDimension.CubeArray,texture_depth_multisampled_2d:_N.TextureViewDimension.E2d,texture_storage_1d:_N.TextureViewDimension.E1d,texture_storage_2d:_N.TextureViewDimension.E2d,texture_storage_2d_array:_N.TextureViewDimension.E2dArray,texture_storage_3d:_N.TextureViewDimension.E3d,texture_external:null};function ZG(){var e=mG.call(this,arguments)||this;return e.shaderLanguage=vU.WGSL,e.uniformRegexp=/uniform\s+(\w+)\s*:\s*(.+)\s*;/,e.textureRegexp=/var\s+(\w+)\s*:\s*((array<\s*)?(texture_\w+)\s*(<\s*(.+)\s*>)?\s*(,\s*\w+\s*>\s*)?);/,e.noPrecision=!0,e}ZG.prototype=Object.create(mG.prototype),ZG.prototype.constructor=mG,ZG.prototype._getArraySize=function(e,t,r){var n=0,i=t.lastIndexOf(">");if(t.indexOf("array")>=0&&i>0){for(var o=i;o>0&&" "!==t.charAt(o)&&","!==t.charAt(o);)o--;var s=t.substring(o+1,i);for(n=+s,isNaN(n)&&(n=+r[s.trim()]);o>0&&(" "===t.charAt(o)||","===t.charAt(o));)o--;t=t.substring(t.indexOf("<")+1,o+1)}return[e,t,n]},ZG.prototype.initializeShaders=function(e){this._webgpuProcessingContext=e,this._attributesWGSL=[],this._attributesDeclWGSL=[],this._attributeNamesWGSL=[],this._varyingsWGSL=[],this._varyingsDeclWGSL=[],this._varyingNamesWGSL=[],this._stridedUniformArrays=[]},ZG.prototype.preProcessShaderCode=function(e){return"struct ".concat(mG.InternalsUBOName," {\nyFactor__: f32,\ntextureOutputHeight__: f32,\n};\nvar<uniform> ").concat("internals"," : ").concat(mG.InternalsUBOName,";\n")+UG(e)},ZG.prototype.varyingProcessor=function(e,t,r){var n=/\s*varying\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s*:\s*(.+)\s*;/gm.exec(e);if(null!==n){var i,o=n[2],s=n[1];t?void 0===(i=this._webgpuProcessingContext.availableVaryings[s])&&aL.Warn('Invalid fragment shader: The varying named "'.concat(s,'" is not declared in the vertex shader! This declaration will be ignored.')):(i=this._webgpuProcessingContext.getVaryingNextLocation(o,this._getArraySize(s,o,r)[2]),this._webgpuProcessingContext.availableVaryings[s]=i,this._varyingsWGSL.push("@location(".concat(i,") ").concat(s," : ").concat(o,",")),this._varyingsDeclWGSL.push("var<private> ".concat(s," : ").concat(o,";")),this._varyingNamesWGSL.push(s)),e=""}return e},ZG.prototype.attributeProcessor=function(e,t){var r=/\s*attribute\s+(\S+)\s*:\s*(.+)\s*;/gm.exec(e);if(null!==r){var n=r[2],i=r[1],o=this._webgpuProcessingContext.getAttributeNextLocation(n,this._getArraySize(i,n,t)[2]);this._webgpuProcessingContext.availableAttributes[i]=o,this._webgpuProcessingContext.orderedAttributes[o]=i,this._attributesWGSL.push("@location(".concat(o,") ").concat(i," : ").concat(n,",")),this._attributesDeclWGSL.push("var<private> ".concat(i," : ").concat(n,";")),this._attributeNamesWGSL.push(i),e=""}return e},ZG.prototype.uniformProcessor=function(e,t,r){var n=this.uniformRegexp.exec(e);if(null!==n){var i=n[2],o=n[1];this._addUniformToLeftOverUBO(o,i,r),e=""}return e},ZG.prototype.textureProcessor=function(e,t,r){var n=this.textureRegexp.exec(e);if(null!==n){var i=n[1],o=n[2],s=!!n[3],a=n[4],u=a.indexOf("storage")>0,c=n[6],l=u?c.substring(0,c.indexOf(",")).trim():null,h=s?this._getArraySize(i,o,r)[2]:0,p=this._webgpuProcessingContext.availableTextures[i];if(p)h=p.textures.length;else{p={isTextureArray:h>0,isStorageTexture:u,textures:[],sampleType:_N.TextureSampleType.Float,isMultisampled:!1},h=h||1;for(var f=0;f<h;++f)p.textures.push(this._webgpuProcessingContext.getNextFreeUBOBinding())}this._webgpuProcessingContext.availableTextures[i]=p;var d=a.indexOf("depth")>0,A=JG[a],g=d?_N.TextureSampleType.Depth:"u32"===c?_N.TextureSampleType.Uint:"i32"===c?_N.TextureSampleType.Sint:_N.TextureSampleType.Float;p.sampleType=g;var _=!!d&&a.indexOf("multisampled")>0;if(p.isMultisampled=_,void 0===A)throw"Can't get the texture dimension corresponding to the texture function \"".concat(a,'"!');if(s){var m=[];for(f=0;f<h;++f){var y=p.textures[f].groupIndex,E=p.textures[f].bindingIndex;m.push("@group(".concat(y,") @binding(").concat(E,") ").concat("var ",i).concat(f," : ").concat(a,"<f32>;"))}e=m.join("\r\n")}else{h=1;var x=p.textures[0],C=x.groupIndex,b=x.bindingIndex;e="@group(".concat(C,") @binding(").concat(b,") ").concat(e)}for(f=0;f<h;++f)this._addTextureBindingDescription(i,p,f,A,l,!t)}return e},ZG.prototype.postProcessor=function(e){return e},ZG.prototype.finalizeShaders=function(e,t){var r=t.indexOf("gl_FragCoord")>=0?"\n            if (internals.yFactor__ == 1.) {\n                gl_FragCoord.y = internals.textureOutputHeight__ - gl_FragCoord.y;\n            }\n        ":"";e=this._processSamplers(e,!0),t=this._processSamplers(t,!1),e=this._processCustomBuffers(e,!0),t=this._processCustomBuffers(t,!1);var n=this._buildLeftOverUBO();t=n+t,e=(e=n+e).replace(/#define /g,"//#define "),e=this._processStridedUniformArrays(e);var i=this._varyingsDeclWGSL.join("\n")+"\n",o="var<private> ".concat(jG," : u32;\nvar<private> ").concat(HG," : u32;\nvar<private> ").concat(qG," : vec4<f32>;\n"),s=this._attributesDeclWGSL.join("\n")+"\n",a="struct VertexInputs {\n  @builtin(vertex_index) vertexIndex : u32,\n  @builtin(instance_index) instanceIndex : u32,\n";this._attributesWGSL.length>0&&(a+=this._attributesWGSL.join("\n")),a+="\n};\n";var u="struct FragmentInputs {\n  @builtin(position) position : vec4<f32>,\n";this._varyingsWGSL.length>0&&(u+=this._varyingsWGSL.join("\n")),e=o+a+s+(u+="\n};\n")+i+e;for(var c="  var output : FragmentInputs;\n  ".concat(jG," = input.vertexIndex;\n  ").concat(HG," = input.instanceIndex;\n"),l=0;l<this._attributeNamesWGSL.length;++l){var h=this._attributeNamesWGSL[l];c+="  ".concat(h," = input.").concat(h,";\n")}var p="  output.position = ".concat(qG,";\n  output.position.y = output.position.y * internals.yFactor__;\n");for(l=0;l<this._varyingNamesWGSL.length;++l){var f=this._varyingNamesWGSL[l];p+="  output.".concat(f," = ").concat(f,";\n")}p+="  return output;",e=this._injectStartingAndEndingCode(e,"fn main",c,p),t=t.replace(/#define /g,"//#define "),t=(t=this._processStridedUniformArrays(t)).replace(/dpdy/g,"(-internals.yFactor__)*dpdy");var d="var<private> ".concat(VG," : vec4<f32>;\nvar<private> ").concat(YG," : bool;\nvar<private> ").concat(WG," : vec4<f32>;\nvar<private> ").concat(XG," : f32;\n");d+="var<private> ".concat($G[0]," : vec4<f32>;\nvar<private> ").concat($G[1]," : vec4<f32>;\nvar<private> ").concat($G[2]," : vec4<f32>;\nvar<private> ").concat($G[3]," : vec4<f32>;\nvar<private> ").concat($G[4]," : vec4<f32>;\nvar<private> ").concat($G[5]," : vec4<f32>;\nvar<private> ").concat($G[6]," : vec4<f32>;\nvar<private> ").concat($G[7]," : vec4<f32>;\n");var A="struct FragmentInputs {\n  @builtin(position) position : vec4<f32>,\n  @builtin(front_facing) frontFacing : bool,\n";this._varyingsWGSL.length>0&&(A+=this._varyingsWGSL.join("\n")),A+="\n};\n";for(var g,_=!1,m=0,y=-1;m>=0;)if((m=t.indexOf(KG,m))>=0){var E=m+11,x=t.substring(E,E+1);x=parseInt(x),y=Math.max(x,y),_=!0,m+=11}if(_){g="struct FragmentOutputs {\n";for(var C=0;C<y+1;C++)g+="  @location ("+C+") "+$G[C]+" : vec4<f32>,\n"}else g="struct FragmentOutputs {\n  @location(0) color : vec4<f32>,\n";for(var b=!1,I=0;!(b||(I=t.indexOf(XG,I))<0);){var v=I;for(b=!0;I>1&&"\n"!==t.charAt(I);){if("/"===t.charAt(I)&&"/"===t.charAt(I-1)){b=!1;break}I--}I=v+12}b&&(g+="  @builtin(frag_depth) fragDepth: f32,\n"),t=d+A+i+(g+="};\n")+t;var T="  var output : FragmentOutputs;\n  ".concat(VG," = input.position;\n  ").concat(YG," = input.frontFacing;\n")+r;for(l=0;l<this._varyingNamesWGSL.length;++l){var R=this._varyingNamesWGSL[l];T+="  ".concat(R," = input.").concat(R,";\n")}var S="";if(_)for(C=0;C<y+1;C++)S+="  output."+$G[C]+" = "+$G[C]+";\n";else S="  output.color = ".concat(WG,";\n");return b&&(S+="  output.fragDepth = ".concat(XG,";\n")),S+="  return output;",t=this._injectStartingAndEndingCode(t,"fn main",T,S),this._collectBindingNames(),this._preCreateBindGroupEntries(),{vertexCode:e,fragmentCode:t}},ZG.prototype._generateLeftOverUBOCode=function(e,t){for(var r="",n="struct ".concat(e," {\n"),i=0,o=this._webgpuProcessingContext.leftOverUniforms;i<o.length;i++){var s=o[i],a=s.type.replace(/^(.*?)(<.*>)?$/,"$1"),u=mG.UniformSizes[a];if(s.length>0)if(u<=2){var c="".concat(e,"_").concat(this._stridedUniformArrays.length,"_strided_arr");r+="struct ".concat(c," {\n                        @size(16)\n                        el: ").concat(a,",\n                    }"),this._stridedUniformArrays.push(s.name),n+=" @align(16) ".concat(s.name," : array<").concat(c,", ").concat(s.length,">,\n")}else n+=" ".concat(s.name," : array<").concat(s.type,", ").concat(s.length,">,\n");else n+="  ".concat(s.name," : ").concat(s.type,",\n")}return n+="};\n",n="".concat(r,"\n").concat(n),n+="@group(".concat(t.binding.groupIndex,") @binding(").concat(t.binding.bindingIndex,") var<uniform> ").concat("uniforms"," : ").concat(e,";\n")},ZG.prototype._processSamplers=function(e,t){for(var r=/var\s+(\w+Sampler)\s*:\s*(sampler|sampler_comparison)\s*;/gm;;){var n=r.exec(e);if(null===n)break;var i,o=n[1],s=n[2],a=o.indexOf(mG.AutoSamplerSuffix)===o.length-mG.AutoSamplerSuffix.length?o.substring(0,o.indexOf(mG.AutoSamplerSuffix)):null,u=(i=this._webgpuProcessingContext.availableTextures[a])&&i.sampleType===_N.TextureSampleType.Depth,c="sampler_comparison"===s?_N.SamplerBindingType.Comparison:u?_N.SamplerBindingType.NonFiltering:_N.SamplerBindingType.Filtering;if(a)(i=this._webgpuProcessingContext.availableTextures[a])&&(i.autoBindSampler=!0);var l=this._webgpuProcessingContext.availableSamplers[o];!l&&(l={binding:this._webgpuProcessingContext.getNextFreeUBOBinding(),type:c},this._webgpuProcessingContext.availableSamplers[o]=l),this._addSamplerBindingDescription(o,l,t);var h=e.substring(0,n.index),p="@group(".concat(l.binding.groupIndex,") @binding(").concat(l.binding.bindingIndex,") "),f=e.substring(n.index);e=h+p+f,r.lastIndex+=p.length}return e},ZG.prototype._processCustomBuffers=function(e,t){for(var r=/var<\s*(uniform|storage)\s*(,\s*(read|read_write)\s*)?>\s+(\S+)\s*:\s*(\S+)\s*;/gm;;){var n=r.exec(e);if(null===n)break;var i=n[1],o=n[3],s=n[4],a=n[5],u=this._webgpuProcessingContext.availableBuffers[s];if(!u){var c="uniform"===i?RG.KnownUBOs[a]:null,l=void 0;c?(s=a,-1===(l=c.binding).groupIndex&&(l=this._webgpuProcessingContext.getNextFreeUBOBinding())):l=this._webgpuProcessingContext.getNextFreeUBOBinding(),u={binding:l},this._webgpuProcessingContext.availableBuffers[s]=u}this._addBufferBindingDescription(s,this._webgpuProcessingContext.availableBuffers[s],"read_write"===o?_N.BufferBindingType.Storage:"storage"===i?_N.BufferBindingType.ReadOnlyStorage:_N.BufferBindingType.Uniform,t);var h=u.binding.groupIndex,p=u.binding.bindingIndex,f=e.substring(0,n.index),d="@group(".concat(h,") @binding(").concat(p,") "),A=e.substring(n.index);e=f+d+A,r.lastIndex+=d.length}return e},ZG.prototype._processStridedUniformArrays=function(e){for(var t=0,r=this._stridedUniformArrays;t<r.length;t++){var n=r[t];e=e.replace(new RegExp("".concat(n,"\\s*\\[(.*)\\]"),"g"),"".concat(n,"[$1].el"))}return e};var eQ,tQ=(eQ=!0,function(e,t){var r=eQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return eQ=!1,r}),rQ=tQ(void 0,(function(){return rQ.toString().search("(((.+)+)+)+$").toString().constructor(rQ).search("(((.+)+)+)+$")}));function nQ(){this.colorAttachmentGPUTextures=[],this.reset()}rQ(),nQ.prototype.reset=function(e){void 0===e&&(e=!1),this.renderPass=null,e&&(this.renderPassDescriptor=null,this.colorAttachmentViewDescriptor=null,this.depthAttachmentViewDescriptor=null,this.colorAttachmentGPUTextures=[],this.depthTextureFormat=void 0)};var iQ,oQ=(iQ=!0,function(e,t){var r=iQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return iQ=!1,r}),sQ=oQ(void 0,(function(){return sQ.toString().search("(((.+)+)+)+$").toString().constructor(sQ).search("(((.+)+)+)+$")}));sQ();var aQ,uQ=[0,0,3,7,0,2,6,2,4,1,5,3,1],cQ=[0,64,32,96,16,80,48,112,8],lQ=[0,128,128,0,0,0,0,128,0,0,0,0,128];function hQ(e){this._samplers={},this._device=e,this.disabled=!1}hQ.GetSamplerHashCode=function(e){var t,r,n,i=e._cachedAnisotropicFilteringLevel&&e._cachedAnisotropicFilteringLevel>1?4:1;return uQ[e.samplingMode]+cQ[(e._comparisonFunction||514)-512+1]+lQ[e.samplingMode]+((null!==(t=e._cachedWrapU)&&void 0!==t?t:1)<<8)+((null!==(r=e._cachedWrapV)&&void 0!==r?r:1)<<10)+((null!==(n=e._cachedWrapR)&&void 0!==n?n:1)<<12)+((e.useMipMaps?1:0)<<14)+(i<<15)},hQ._GetSamplerFilterDescriptor=function(e,t){var r,n,i,o,s,a=e.useMipMaps;switch(e.samplingMode){case Qd.TEXTURE_LINEAR_LINEAR_MIPNEAREST:r=_N.FilterMode.Linear,n=_N.FilterMode.Linear,i=_N.FilterMode.Nearest,!a&&(o=s=0);break;case Qd.TEXTURE_LINEAR_LINEAR_MIPLINEAR:case Qd.TEXTURE_TRILINEAR_SAMPLINGMODE:r=_N.FilterMode.Linear,n=_N.FilterMode.Linear,a?i=_N.FilterMode.Linear:(i=_N.FilterMode.Nearest,o=s=0);break;case Qd.TEXTURE_NEAREST_NEAREST_MIPLINEAR:r=_N.FilterMode.Nearest,n=_N.FilterMode.Nearest,a?i=_N.FilterMode.Linear:(i=_N.FilterMode.Nearest,o=s=0);break;case Qd.TEXTURE_NEAREST_NEAREST_MIPNEAREST:r=_N.FilterMode.Nearest,n=_N.FilterMode.Nearest,i=_N.FilterMode.Nearest,!a&&(o=s=0);break;case Qd.TEXTURE_NEAREST_LINEAR_MIPNEAREST:r=_N.FilterMode.Nearest,n=_N.FilterMode.Linear,i=_N.FilterMode.Nearest,!a&&(o=s=0);break;case Qd.TEXTURE_NEAREST_LINEAR_MIPLINEAR:r=_N.FilterMode.Nearest,n=_N.FilterMode.Linear,a?i=_N.FilterMode.Linear:(i=_N.FilterMode.Nearest,o=s=0);break;case Qd.TEXTURE_NEAREST_LINEAR:r=_N.FilterMode.Nearest,n=_N.FilterMode.Linear,i=_N.FilterMode.Nearest,o=s=0;break;case Qd.TEXTURE_NEAREST_NEAREST:case Qd.TEXTURE_NEAREST_SAMPLINGMODE:r=_N.FilterMode.Nearest,n=_N.FilterMode.Nearest,i=_N.FilterMode.Nearest,o=s=0;break;case Qd.TEXTURE_LINEAR_NEAREST_MIPNEAREST:r=_N.FilterMode.Linear,n=_N.FilterMode.Nearest,i=_N.FilterMode.Nearest,!a&&(o=s=0);break;case Qd.TEXTURE_LINEAR_NEAREST_MIPLINEAR:r=_N.FilterMode.Linear,n=_N.FilterMode.Nearest,a?i=_N.FilterMode.Linear:(i=_N.FilterMode.Nearest,o=s=0);break;case Qd.TEXTURE_LINEAR_LINEAR:case Qd.TEXTURE_BILINEAR_SAMPLINGMODE:r=_N.FilterMode.Linear,n=_N.FilterMode.Linear,i=_N.FilterMode.Nearest,o=s=0;break;case Qd.TEXTURE_LINEAR_NEAREST:r=_N.FilterMode.Linear,n=_N.FilterMode.Nearest,i=_N.FilterMode.Nearest,o=s=0;break;default:r=_N.FilterMode.Nearest,n=_N.FilterMode.Nearest,i=_N.FilterMode.Nearest,o=s=0}return t>1&&(0!==o||0!==s)?{magFilter:_N.FilterMode.Linear,minFilter:_N.FilterMode.Linear,mipmapFilter:_N.FilterMode.Linear,anisotropyEnabled:!0}:{magFilter:r,minFilter:n,mipmapFilter:i,lodMinClamp:o,lodMaxClamp:s}},hQ._GetWrappingMode=function(e){switch(e){case Qd.TEXTURE_WRAP_ADDRESSMODE:return _N.AddressMode.Repeat;case Qd.TEXTURE_CLAMP_ADDRESSMODE:return _N.AddressMode.ClampToEdge;case Qd.TEXTURE_MIRROR_ADDRESSMODE:return _N.AddressMode.MirrorRepeat}return _N.AddressMode.Repeat},hQ._GetSamplerWrappingDescriptor=function(e){return{addressModeU:this._GetWrappingMode(e._cachedWrapU),addressModeV:this._GetWrappingMode(e._cachedWrapV),addressModeW:this._GetWrappingMode(e._cachedWrapR)}},hQ._GetSamplerDescriptor=function(e){var t=e.useMipMaps&&e._cachedAnisotropicFilteringLevel&&e._cachedAnisotropicFilteringLevel>1?4:1,r=this._GetSamplerFilterDescriptor(e,t),n=go(r,this._GetSamplerWrappingDescriptor(e));return n=go(n,{compare:e._comparisonFunction?hQ.GetCompareFunction(e._comparisonFunction):void 0,maxAnisotropy:r.anisotropyEnabled?t:1})},hQ.GetCompareFunction=function(e){switch(e){case Qd.ALWAYS:return _N.CompareFunction.Always;case Qd.EQUAL:return _N.CompareFunction.Equal;case Qd.GREATER:return _N.CompareFunction.Greater;case Qd.GEQUAL:return _N.CompareFunction.GreaterEqual;case Qd.LESS:return _N.CompareFunction.Less;case Qd.LEQUAL:return _N.CompareFunction.LessEqual;case Qd.NEVER:return _N.CompareFunction.Never;case Qd.NOTEQUAL:return _N.CompareFunction.NotEqual;default:return _N.CompareFunction.Less}},hQ.prototype.getSampler=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=0),this.disabled)return this._device.createSampler(hQ._GetSamplerDescriptor(e));t?r=0:0===r&&(r=hQ.GetSamplerHashCode(e));var n=t?void 0:this._samplers[r];return!n&&(n=this._device.createSampler(hQ._GetSamplerDescriptor(e)),!t&&(this._samplers[r]=n)),n},function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));n(),e[e.StencilReadMask=0]="StencilReadMask",e[e.StencilWriteMask=1]="StencilWriteMask",e[e.DepthBias=2]="DepthBias",e[e.DepthBiasSlopeScale=3]="DepthBiasSlopeScale",e[e.DepthStencilState=4]="DepthStencilState",e[e.MRTAttachments1=5]="MRTAttachments1",e[e.MRTAttachments2=6]="MRTAttachments2",e[e.RasterizationState=7]="RasterizationState",e[e.ColorStates=8]="ColorStates",e[e.ShaderStage=9]="ShaderStage",e[e.TextureStage=10]="TextureStage",e[e.VertexState=11]="VertexState",e[e.NumStates=12]="NumStates"}(aQ||(aQ={}));var pQ={0:1,1:2,768:3,769:4,770:5,771:6,772:7,773:8,774:9,775:10,776:11,32769:12,32770:13,32771:12,32772:13},fQ={0:0,7680:1,7681:2,7682:3,7683:4,5386:5,34055:6,34056:7};function dQ(e,t,r){this.mrtTextureCount=0,this._device=e,this._useTextureStage=r,this._states=new Array(30),this._statesLength=0,this._stateDirtyLowestIndex=0,this._emptyVertexBuffer=t,this._mrtFormats=[],this._parameter={token:void 0,pipeline:null},this.disabled=!1,this.vertexBuffers=[],this._kMaxVertexBufferStride=e.limits.maxVertexBufferArrayStride||2048,this.reset()}dQ.prototype.reset=function(){this._isDirty=!0,this.vertexBuffers.length=0,this.setAlphaToCoverage(!1),this.resetDepthCullingState(),this.setClampDepth(!1),this.setDepthBias(0),this._webgpuColorFormat=[_N.TextureFormat.BGRA8Unorm],this.setColorFormat(_N.TextureFormat.BGRA8Unorm),this.setMRT([]),this.setAlphaBlendEnabled(!1),this.setAlphaBlendFactors([null,null,null,null],[null,null]),this.setWriteMask(15),this.setDepthStencilFormat(_N.TextureFormat.Depth24PlusStencil8),this.setStencilEnabled(!1),this.resetStencilState(),this.setBuffers(null,null,null),this._setTextureState(0)},Object.defineProperty(dQ.prototype,"colorFormats",{get:function(){return this._mrtAttachments1>0?this._mrtFormats:this._webgpuColorFormat},enumerable:!1,configurable:!0}),dQ.prototype.getRenderPipeline=function(e,t,r,n){if(void 0===n&&(n=0),r>1&&(r=4),this.disabled){var i=dQ._GetTopology(e);return this._setVertexState(t),this._parameter.pipeline=this._createRenderPipeline(t,i,r),dQ.NumCacheMiss++,dQ._NumPipelineCreationCurrentFrame++,this._parameter.pipeline}if(this._setShaderStage(t.uniqueId),this._setRasterizationState(e,r),this._setColorStates(),this._setDepthStencilState(),this._setVertexState(t),this._setTextureState(n),this.lastStateDirtyLowestIndex=this._stateDirtyLowestIndex,!this._isDirty&&this._parameter.pipeline)return this._stateDirtyLowestIndex=this._statesLength,dQ.NumCacheHitWithoutHash++,this._parameter.pipeline;if(this._getRenderPipeline(this._parameter),this._isDirty=!1,this._stateDirtyLowestIndex=this._statesLength,this._parameter.pipeline)return dQ.NumCacheHitWithHash++,this._parameter.pipeline;var o=dQ._GetTopology(e);return this._parameter.pipeline=this._createRenderPipeline(t,o,r),this._setRenderPipeline(this._parameter),dQ.NumCacheMiss++,dQ._NumPipelineCreationCurrentFrame++,this._parameter.pipeline},dQ.prototype.endFrame=function(){dQ.NumPipelineCreationLastFrame=dQ._NumPipelineCreationCurrentFrame,dQ._NumPipelineCreationCurrentFrame=0},dQ.prototype.setAlphaToCoverage=function(e){this._alphaToCoverageEnabled=e},dQ.prototype.setFrontFace=function(e){this._frontFace=e},dQ.prototype.setCullEnabled=function(e){this._cullEnabled=e},dQ.prototype.setCullFace=function(e){this._cullFace=e},dQ.prototype.setClampDepth=function(e){this._clampDepth=e},dQ.prototype.resetDepthCullingState=function(){this.setDepthCullingState(!1,2,1,0,0,!0,!0,Qd.ALWAYS)},dQ.prototype.setDepthCullingState=function(e,t,r,n,i,o,s,a){this._depthWriteEnabled=s,this._depthTestEnabled=o,this._depthCompare=(null!=a?a:Qd.ALWAYS)-512,this._cullFace=r,this._cullEnabled=e,this._frontFace=t,this.setDepthBiasSlopeScale(n),this.setDepthBias(i)},dQ.prototype.setDepthBias=function(e){this._depthBias!==e&&(this._depthBias=e,this._states[aQ.DepthBias]=e,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.DepthBias))},dQ.prototype.setDepthBiasSlopeScale=function(e){this._depthBiasSlopeScale!==e&&(this._depthBiasSlopeScale=e,this._states[aQ.DepthBiasSlopeScale]=e,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.DepthBiasSlopeScale))},dQ.prototype.setColorFormat=function(e){this._webgpuColorFormat[0]=e,this._colorFormat=Az[null!=e?e:""]},dQ.prototype.setMRTAttachments=function(e){this.mrtAttachments=e;for(var t=0,r=0;r<e.length;++r)0!==e[r]&&(t+=1<<r);this._mrtEnabledMask!==t&&(this._mrtEnabledMask=t,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.MRTAttachments1))},dQ.prototype.setMRT=function(e,t){var r,n;if((t=null!=t?t:e.length)>10)throw"Can't handle more than 10 attachments for a MRT in cache render pipeline!";this.mrtTextureArray=e,this.mrtTextureCount=t,this._mrtEnabledMask=65535;for(var i=[0,0],o=0,s=0,a=0,u=0;u<t;++u){var c=e[u],l=null==c?void 0:c._hardwareTexture;this._mrtFormats[a]=null!==(r=null==l?void 0:l.format)&&void 0!==r?r:this._webgpuColorFormat[0],i[o]+=Az[null!==(n=this._mrtFormats[a])&&void 0!==n?n:""]<<s,a++,(s+=6)>=32&&(s=0,o++)}this._mrtFormats.length=a,(this._mrtAttachments1!==i[0]||this._mrtAttachments2!==i[1])&&(this._mrtAttachments1=i[0],this._mrtAttachments2=i[1],this._states[aQ.MRTAttachments1]=i[0],this._states[aQ.MRTAttachments2]=i[1],this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.MRTAttachments1))},dQ.prototype.setAlphaBlendEnabled=function(e){this._alphaBlendEnabled=e},dQ.prototype.setAlphaBlendFactors=function(e,t){this._alphaBlendFuncParams=e,this._alphaBlendEqParams=t},dQ.prototype.setWriteMask=function(e){this._writeMask=e},dQ.prototype.setDepthStencilFormat=function(e){this._webgpuDepthStencilFormat=e,this._depthStencilFormat=void 0===e?0:Az[e]},dQ.prototype.setDepthTestEnabled=function(e){this._depthTestEnabled=e},dQ.prototype.setDepthWriteEnabled=function(e){this._depthWriteEnabled=e},dQ.prototype.setDepthCompare=function(e){this._depthCompare=(null!=e?e:Qd.ALWAYS)-512},dQ.prototype.setStencilEnabled=function(e){this._stencilEnabled=e},dQ.prototype.setStencilCompare=function(e,t){e===Qd.FRONT?this._stencilFrontCompare=(null!=t?t:Qd.ALWAYS)-512:this._stencilBackCompare=(null!=t?t:Qd.ALWAYS)-512},dQ.prototype.setStencilDepthFailOp=function(e,t){e===Qd.FRONT?this._stencilFrontDepthFailOp=null===t?1:fQ[t]:this._stencilBackDepthFailOp=null===t?1:fQ[t]},dQ.prototype.setStencilPassOp=function(e,t){e===Qd.FRONT?this._stencilFrontPassOp=null===t?2:fQ[t]:this._stencilBackPassOp=null===t?2:fQ[t]},dQ.prototype.setStencilFailOp=function(e,t){e===Qd.FRONT?this._stencilFrontFailOp=null===t?1:fQ[t]:this._stencilBackFailOp=null===t?1:fQ[t]},dQ.prototype.setStencilReadMask=function(e){this._stencilReadMask!==e&&(this._stencilReadMask=e,this._states[aQ.StencilReadMask]=e,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.StencilReadMask))},dQ.prototype.setStencilWriteMask=function(e){this._stencilWriteMask!==e&&(this._stencilWriteMask=e,this._states[aQ.StencilWriteMask]=e,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.StencilWriteMask))},dQ.prototype.resetStencilState=function(){this.setStencilState(Qd.FRONT,!1,Qd.ALWAYS,Qd.KEEP,Qd.REPLACE,Qd.KEEP,255,255),this.setStencilState(Qd.BACK,!1,Qd.ALWAYS,Qd.KEEP,Qd.REPLACE,Qd.KEEP,255,255)},dQ.prototype.setStencilState=function(e,t,r,n,i,o,s,a){this._stencilEnabled=t,e===Qd.FRONT?(this._stencilFrontCompare=(null!=r?r:Qd.ALWAYS)-512,this._stencilFrontDepthFailOp=null===n?1:fQ[n],this._stencilFrontPassOp=null===i?2:fQ[i],this._stencilFrontFailOp=null===o?1:fQ[o]):(this._stencilBackCompare=(null!=r?r:Qd.ALWAYS)-512,this._stencilBackDepthFailOp=null===n?1:fQ[n],this._stencilBackPassOp=null===i?2:fQ[i],this._stencilBackFailOp=null===o?1:fQ[o]),this.setStencilReadMask(s),this.setStencilWriteMask(a)},dQ.prototype.setBuffers=function(e,t,r){this._vertexBuffers=e,this._overrideVertexBuffers=r,this._indexBuffer=t},dQ._GetTopology=function(e){switch(e){case Qd.MATERIAL_TriangleFillMode:return _N.PrimitiveTopology.TriangleList;case Qd.MATERIAL_PointFillMode:return _N.PrimitiveTopology.PointList;case Qd.MATERIAL_WireFrameFillMode:return _N.PrimitiveTopology.LineList;case Qd.MATERIAL_PointListDrawMode:return _N.PrimitiveTopology.PointList;case Qd.MATERIAL_LineListDrawMode:return _N.PrimitiveTopology.LineList;case Qd.MATERIAL_LineLoopDrawMode:throw"LineLoop is an unsupported fillmode in WebGPU";case Qd.MATERIAL_LineStripDrawMode:return _N.PrimitiveTopology.LineStrip;case Qd.MATERIAL_TriangleStripDrawMode:return _N.PrimitiveTopology.TriangleStrip;case Qd.MATERIAL_TriangleFanDrawMode:throw"TriangleFan is an unsupported fillmode in WebGPU";default:return _N.PrimitiveTopology.TriangleList}},dQ._GetAphaBlendOperation=function(e){switch(e){case Qd.GL_ALPHA_EQUATION_ADD:return _N.BlendOperation.Add;case Qd.GL_ALPHA_EQUATION_SUBTRACT:return _N.BlendOperation.Subtract;case Qd.GL_ALPHA_EQUATION_REVERSE_SUBTRACT:return _N.BlendOperation.ReverseSubtract;case Qd.GL_ALPHA_EQUATION_MIN:return _N.BlendOperation.Min;case Qd.GL_ALPHA_EQUATION_MAX:return _N.BlendOperation.Max;default:return _N.BlendOperation.Add}},dQ._GetAphaBlendFactor=function(e){switch(e){case 0:return _N.BlendFactor.Zero;case 1:return _N.BlendFactor.One;case Qd.GL_ALPHA_FUNCTION_SRC:return _N.BlendFactor.Src;case Qd.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_COLOR:return _N.BlendFactor.OneMinusSrc;case Qd.GL_ALPHA_FUNCTION_SRC_ALPHA:return _N.BlendFactor.SrcAlpha;case Qd.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_ALPHA:return _N.BlendFactor.OneMinusSrcAlpha;case Qd.GL_ALPHA_FUNCTION_DST_ALPHA:return _N.BlendFactor.DstAlpha;case Qd.GL_ALPHA_FUNCTION_ONE_MINUS_DST_ALPHA:return _N.BlendFactor.OneMinusDstAlpha;case Qd.GL_ALPHA_FUNCTION_DST_COLOR:return _N.BlendFactor.Dst;case Qd.GL_ALPHA_FUNCTION_ONE_MINUS_DST_COLOR:return _N.BlendFactor.OneMinusDst;case Qd.GL_ALPHA_FUNCTION_SRC_ALPHA_SATURATED:return _N.BlendFactor.SrcAlphaSaturated;case Qd.GL_ALPHA_FUNCTION_CONSTANT_COLOR:return _N.BlendFactor.Constant;case Qd.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_COLOR:return _N.BlendFactor.OneMinusConstant;case Qd.GL_ALPHA_FUNCTION_CONSTANT_ALPHA:return _N.BlendFactor.Constant;case Qd.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_ALPHA:return _N.BlendFactor.OneMinusConstant;default:return _N.BlendFactor.One}},dQ._GetCompareFunction=function(e){switch(e){case 0:return _N.CompareFunction.Never;case 1:return _N.CompareFunction.Less;case 2:return _N.CompareFunction.Equal;case 3:return _N.CompareFunction.LessEqual;case 4:return _N.CompareFunction.Greater;case 5:return _N.CompareFunction.NotEqual;case 6:return _N.CompareFunction.GreaterEqual;case 7:return _N.CompareFunction.Always}return _N.CompareFunction.Never},dQ._GetStencilOpFunction=function(e){switch(e){case 0:return _N.StencilOperation.Zero;case 1:return _N.StencilOperation.Keep;case 2:return _N.StencilOperation.Replace;case 3:return _N.StencilOperation.IncrementClamp;case 4:return _N.StencilOperation.DecrementClamp;case 5:return _N.StencilOperation.Invert;case 6:return _N.StencilOperation.IncrementWrap;case 7:return _N.StencilOperation.DecrementWrap}return _N.StencilOperation.Keep},dQ._GetVertexInputDescriptorFormat=function(e){var t=e.type,r=e.normalized,n=e.getSize();switch(t){case Wd.BYTE:switch(n){case 1:case 2:return r?_N.VertexFormat.Snorm8x2:_N.VertexFormat.Sint8x2;case 3:case 4:return r?_N.VertexFormat.Snorm8x4:_N.VertexFormat.Sint8x4}break;case Wd.UNSIGNED_BYTE:switch(n){case 1:case 2:return r?_N.VertexFormat.Unorm8x2:_N.VertexFormat.Uint8x2;case 3:case 4:return r?_N.VertexFormat.Unorm8x4:_N.VertexFormat.Uint8x4}break;case Wd.SHORT:switch(n){case 1:case 2:return r?_N.VertexFormat.Snorm16x2:_N.VertexFormat.Sint16x2;case 3:case 4:return r?_N.VertexFormat.Snorm16x4:_N.VertexFormat.Sint16x4}break;case Wd.UNSIGNED_SHORT:switch(n){case 1:case 2:return r?_N.VertexFormat.Unorm16x2:_N.VertexFormat.Uint16x2;case 3:case 4:return r?_N.VertexFormat.Unorm16x4:_N.VertexFormat.Uint16x4}break;case Wd.INT:switch(n){case 1:return _N.VertexFormat.Sint32;case 2:return _N.VertexFormat.Sint32x2;case 3:return _N.VertexFormat.Sint32x3;case 4:return _N.VertexFormat.Sint32x4}break;case Wd.UNSIGNED_INT:switch(n){case 1:return _N.VertexFormat.Uint32;case 2:return _N.VertexFormat.Uint32x2;case 3:return _N.VertexFormat.Uint32x3;case 4:return _N.VertexFormat.Uint32x4}break;case Wd.FLOAT:switch(n){case 1:return _N.VertexFormat.Float32;case 2:return _N.VertexFormat.Float32x2;case 3:return _N.VertexFormat.Float32x3;case 4:return _N.VertexFormat.Float32x4}}throw new Error("Invalid Format '".concat(e.getKind(),"' - type=").concat(t,", normalized=").concat(r,", size=").concat(n))},dQ.prototype._getAphaBlendState=function(){return this._alphaBlendEnabled?{srcFactor:dQ._GetAphaBlendFactor(this._alphaBlendFuncParams[2]),dstFactor:dQ._GetAphaBlendFactor(this._alphaBlendFuncParams[3]),operation:dQ._GetAphaBlendOperation(this._alphaBlendEqParams[1])}:null},dQ.prototype._getColorBlendState=function(){return this._alphaBlendEnabled?{srcFactor:dQ._GetAphaBlendFactor(this._alphaBlendFuncParams[0]),dstFactor:dQ._GetAphaBlendFactor(this._alphaBlendFuncParams[1]),operation:dQ._GetAphaBlendOperation(this._alphaBlendEqParams[0])}:null},dQ.prototype._setShaderStage=function(e){this._shaderId!==e&&(this._shaderId=e,this._states[aQ.ShaderStage]=e,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.ShaderStage))},dQ.prototype._setRasterizationState=function(e,t){var r=this._frontFace-1+((this._cullEnabled?this._cullFace:0)<<1)+((this._clampDepth?1:0)<<3)+((this._alphaToCoverageEnabled?1:0)<<4)+(e<<5)+(t<<8);this._rasterizationState!==r&&(this._rasterizationState=r,this._states[aQ.RasterizationState]=this._rasterizationState,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.RasterizationState))},dQ.prototype._setColorStates=function(){var e=((this._writeMask?1:0)<<22)+(this._colorFormat<<23)+((this._depthWriteEnabled?1:0)<<29);this._alphaBlendEnabled&&(e+=((null===this._alphaBlendFuncParams[0]?2:pQ[this._alphaBlendFuncParams[0]])|0)+((null===this._alphaBlendFuncParams[1]?2:pQ[this._alphaBlendFuncParams[1]])<<4)+((null===this._alphaBlendFuncParams[2]?2:pQ[this._alphaBlendFuncParams[2]])<<8)+((null===this._alphaBlendFuncParams[3]?2:pQ[this._alphaBlendFuncParams[3]])<<12)+((null===this._alphaBlendEqParams[0]?1:this._alphaBlendEqParams[0]-32773)<<16)+((null===this._alphaBlendEqParams[1]?1:this._alphaBlendEqParams[1]-32773)<<19)),e!==this._colorStates&&(this._colorStates=e,this._states[aQ.ColorStates]=this._colorStates,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.ColorStates))},dQ.prototype._setDepthStencilState=function(){var e=this._stencilEnabled?this._stencilFrontCompare+(this._stencilFrontDepthFailOp<<3)+(this._stencilFrontPassOp<<6)+(this._stencilFrontFailOp<<9)+(this._stencilBackCompare<<12)+(this._stencilBackDepthFailOp<<15)+(this._stencilBackPassOp<<18)+(this._stencilBackFailOp<<21):2449408,t=this._depthStencilFormat+((this._depthTestEnabled?this._depthCompare:7)<<6)+(e<<10);this._depthStencilState!==t&&(this._depthStencilState=t,this._states[aQ.DepthStencilState]=this._depthStencilState,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.DepthStencilState))},dQ.prototype._setVertexState=function(e){for(var t,r,n,i=this._statesLength,o=aQ.VertexState,s=e._pipelineContext,a=s.shaderProcessingContext.attributeNamesFromEffect,u=s.shaderProcessingContext.attributeLocationsFromEffect,c=0,l=0;l<a.length;l++){var h=u[l],p=null!==(t=this._overrideVertexBuffers&&this._overrideVertexBuffers[a[l]])&&void 0!==t?t:this._vertexBuffers[a[l]];!p&&(p=this._emptyVertexBuffer);var f=null===(r=p.getBuffer())||void 0===r?void 0:r.underlyingResource;if(void 0===p._validOffsetRange){var d=p.byteOffset,A=p.getSize(!0),g=p.byteStride;p._validOffsetRange=d<=this._kMaxVertexBufferStride-A&&(0===g||d+A<=g)}(!n||n!==f||!p._validOffsetRange)&&(this.vertexBuffers[c++]=p,n=p._validOffsetRange?f:null);var _=p.hashCode+(h<<7);this._isDirty=this._isDirty||this._states[o]!==_,this._states[o++]=_}this.vertexBuffers.length=c,this._statesLength=o,this._isDirty=this._isDirty||o!==i,this._isDirty&&(this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.VertexState))},dQ.prototype._setTextureState=function(e){this._textureState!==e&&(this._textureState=e,this._states[aQ.TextureStage]=this._textureState,this._isDirty=!0,this._stateDirtyLowestIndex=Math.min(this._stateDirtyLowestIndex,aQ.TextureStage))},dQ.prototype._createPipelineLayout=function(e){if(this._useTextureStage)return this._createPipelineLayoutWithTextureStage(e);for(var t=[],r=e.shaderProcessingContext.bindGroupLayoutEntries,n=0;n<r.length;n++){var i=r[n];t[n]=this._device.createBindGroupLayout({entries:i})}return e.bindGroupLayouts=t,this._device.createPipelineLayout({bindGroupLayouts:t})},dQ.prototype._createPipelineLayoutWithTextureStage=function(e){for(var t,r=e.shaderProcessingContext,n=r.bindGroupLayoutEntries,i=1,o=0;o<n.length;o++)for(var s=n[o],a=0;a<s.length;a++){var u=n[o][a];if(u.texture){var c=r.bindGroupLayoutEntryInfo[o][u.binding].name,l=r.availableTextures[c],h=l.autoBindSampler?r.availableSamplers[c+mG.AutoSamplerSuffix]:null,p=l.sampleType,f=null!==(t=null==h?void 0:h.type)&&void 0!==t?t:_N.SamplerBindingType.Filtering;if(this._textureState&i&&p!==_N.TextureSampleType.Depth&&(l.autoBindSampler&&(f=_N.SamplerBindingType.NonFiltering),p=_N.TextureSampleType.UnfilterableFloat),u.texture.sampleType=p,h){var d=r.bindGroupLayoutEntryInfo[h.binding.groupIndex][h.binding.bindingIndex].index;n[h.binding.groupIndex][d].sampler.type=f}i<<=1}}var A=[];for(o=0;o<n.length;++o)A[o]=this._device.createBindGroupLayout({entries:n[o]});return e.bindGroupLayouts=A,this._device.createPipelineLayout({bindGroupLayouts:A})},dQ.prototype._getVertexInputDescriptor=function(e){for(var t,r,n,i,o=[],s=e._pipelineContext,a=s.shaderProcessingContext.attributeNamesFromEffect,u=s.shaderProcessingContext.attributeLocationsFromEffect,c=0;c<a.length;c++){var l=u[c],h=null!==(t=this._overrideVertexBuffers&&this._overrideVertexBuffers[a[c]])&&void 0!==t?t:this._vertexBuffers[a[c]];!h&&(h=this._emptyVertexBuffer);var p=null===(r=h.getBuffer())||void 0===r?void 0:r.underlyingResource,f=h.byteOffset,d=!h._validOffsetRange;if(!n||!i||n!==p||d){var A={arrayStride:h.byteStride,stepMode:h.getIsInstanced()?_N.InputStepMode.Instance:_N.InputStepMode.Vertex,attributes:[]};o.push(A),i=A.attributes,d&&(f=0,p=null)}i.push({shaderLocation:l,offset:f,format:dQ._GetVertexInputDescriptorFormat(h)}),n=p}return o},dQ.prototype._createRenderPipeline=function(e,t,r){var n=e._pipelineContext,i=this._getVertexInputDescriptor(e),o=this._createPipelineLayout(n),s=[],a=this._getAphaBlendState(),u=this._getColorBlendState();if(this._mrtAttachments1>0)for(var c=0;c<this._mrtFormats.length;++c){var l=this._mrtFormats[c];if(l){var h={format:l,writeMask:this._mrtEnabledMask&1<<c?this._writeMask:0};a&&u&&(h.blend={alpha:a,color:u}),s.push(h)}else s.push(null)}else if(this._webgpuColorFormat[0]){h={format:this._webgpuColorFormat[0],writeMask:this._writeMask};a&&u&&(h.blend={alpha:a,color:u}),s.push(h)}else s.push(null);var p={compare:dQ._GetCompareFunction(this._stencilEnabled?this._stencilFrontCompare:7),depthFailOp:dQ._GetStencilOpFunction(this._stencilEnabled?this._stencilFrontDepthFailOp:1),failOp:dQ._GetStencilOpFunction(this._stencilEnabled?this._stencilFrontFailOp:1),passOp:dQ._GetStencilOpFunction(this._stencilEnabled?this._stencilFrontPassOp:1)},f={compare:dQ._GetCompareFunction(this._stencilEnabled?this._stencilBackCompare:7),depthFailOp:dQ._GetStencilOpFunction(this._stencilEnabled?this._stencilBackDepthFailOp:1),failOp:dQ._GetStencilOpFunction(this._stencilEnabled?this._stencilBackFailOp:1),passOp:dQ._GetStencilOpFunction(this._stencilEnabled?this._stencilBackPassOp:1)},d=void 0;(t===_N.PrimitiveTopology.LineStrip||t===_N.PrimitiveTopology.TriangleStrip)&&(d=!this._indexBuffer||this._indexBuffer.is32Bits?_N.IndexFormat.Uint32:_N.IndexFormat.Uint16);var A=!!this._webgpuDepthStencilFormat&&gz.HasStencilAspect(this._webgpuDepthStencilFormat);return this._device.createRenderPipeline({layout:o,vertex:{module:n.stages.vertexStage.module,entryPoint:n.stages.vertexStage.entryPoint,buffers:i},primitive:{topology:t,stripIndexFormat:d,frontFace:1===this._frontFace?_N.FrontFace.CCW:_N.FrontFace.CW,cullMode:this._cullEnabled?2===this._cullFace?_N.CullMode.Front:_N.CullMode.Back:_N.CullMode.None},fragment:n.stages.fragmentStage?{module:n.stages.fragmentStage.module,entryPoint:n.stages.fragmentStage.entryPoint,targets:s}:void 0,multisample:{count:r},depthStencil:void 0===this._webgpuDepthStencilFormat?void 0:{depthWriteEnabled:this._depthWriteEnabled,depthCompare:this._depthTestEnabled?dQ._GetCompareFunction(this._depthCompare):_N.CompareFunction.Always,format:this._webgpuDepthStencilFormat,stencilFront:this._stencilEnabled&&A?p:void 0,stencilBack:this._stencilEnabled&&A?f:void 0,stencilReadMask:this._stencilEnabled&&A?this._stencilReadMask:void 0,stencilWriteMask:this._stencilEnabled&&A?this._stencilWriteMask:void 0,depthBias:this._depthBias,depthBiasClamp:this._depthBiasClamp,depthBiasSlopeScale:this._depthBiasSlopeScale}})},dQ.NumCacheHitWithoutHash=0,dQ.NumCacheHitWithHash=0,dQ.NumCacheMiss=0,dQ.NumPipelineCreationLastFrame=0,dQ._NumPipelineCreationCurrentFrame=0;var AQ=function(){var e,t=(e=!0,function(t,r){var n=e?function(){if(r){var e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}),r=t(this,(function(){return r.toString().search("(((.+)+)+)+$").toString().constructor(r).search("(((.+)+)+)+$")}));function n(){this.values={}}return r(),n.prototype.count=function(){var e=0,t=this.pipeline?1:0;for(var r in this.values){var n=this.values[r].count();e+=n[0],t+=n[1],e++}return[e,t]},n}();function gQ(e,t,r){var n=dQ.call(this,e,t,r)||this;return n._nodeStack=[],n._nodeStack[0]=gQ._Cache,n}gQ.prototype=Object.create(dQ.prototype),gQ.prototype.constructor=dQ,gQ.GetNodeCounts=function(){var e=gQ._Cache.count();return{nodeCount:e[0],pipelineCount:e[1]}},gQ._GetPipelines=function(e,t,r,n){if(e.pipeline){var i=r.slice();i.length=n,t.push(i)}for(var o in e.values){var s=e.values[o];r[n]=parseInt(o),gQ._GetPipelines(s,t,r,n+1)}},gQ.GetPipelines=function(){var e=[];return gQ._GetPipelines(gQ._Cache,e,[],0),e},gQ.prototype._getRenderPipeline=function(e){for(var t=this._nodeStack[this._stateDirtyLowestIndex],r=this._stateDirtyLowestIndex;r<this._statesLength;++r){var n=t.values[this._states[r]];!n&&(n=new AQ,t.values[this._states[r]]=n),t=n,this._nodeStack[r+1]=t}e.token=t,e.pipeline=t.pipeline},gQ.prototype._setRenderPipeline=function(e){e.token.pipeline=e.pipeline},gQ._Cache=new AQ;var _Q,mQ=(_Q=!0,function(e,t){var r=_Q?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return _Q=!1,r}),yQ=mQ(void 0,(function(){return yQ.toString().search("(((.+)+)+)+$").toString().constructor(yQ).search("(((.+)+)+)+$")}));function EQ(e){var t=EL.call(this,!1)||this;return t._cache=e,t.reset(),t}yQ(),EQ.prototype=Object.create(EL.prototype),EQ.prototype.constructor=EL,Object.defineProperty(EQ.prototype,"frontFunc",{get:function(){return this._frontFunc},set:function(e){this._frontFunc!==e&&(this._frontFunc=e,this._cache.setStencilCompare(Qd.FRONT,e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"backFunc",{get:function(){return this._backFunc},set:function(e){this._backFunc!==e&&(this._backFunc=e,this._cache.setStencilCompare(Qd.BACK,e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"funcMask",{get:function(){return this._funcMask},set:function(e){this._funcMask!==e&&(this._funcMask=e,this._cache.setStencilReadMask(e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"frontOpStencilFail",{get:function(){return this._frontOpStencilFail},set:function(e){this._frontOpStencilFail!==e&&(this._frontOpStencilFail=e,this._cache.setStencilFailOp(Qd.FRONT,e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"backOpStencilFail",{get:function(){return this._backOpStencilFail},set:function(e){this._backOpStencilFail!==e&&(this._backOpStencilFail=e,this._cache.setStencilFailOp(Qd.BACK,e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"frontOpDepthFail",{get:function(){return this._frontOpDepthFail},set:function(e){this._frontOpDepthFail!==e&&(this._frontOpDepthFail=e,this._cache.setStencilDepthFailOp(Qd.FRONT,e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"backOpDepthFail",{get:function(){return this._backOpDepthFail},set:function(e){this._backOpDepthFail!==e&&(this._backOpDepthFail=e,this._cache.setStencilDepthFailOp(Qd.BACK,e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"frontOpStencilDepthPass",{get:function(){return this._frontOpStencilDepthPass},set:function(e){this._frontOpStencilDepthPass!==e&&(this._frontOpStencilDepthPass=e,this._cache.setStencilPassOp(Qd.FRONT,e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"backOpStencilDepthPass",{get:function(){return this._backOpStencilDepthPass},set:function(e){this._backOpStencilDepthPass!==e&&(this._backOpStencilDepthPass=e,this._cache.setStencilPassOp(Qd.BACK,e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask!==e&&(this._mask=e,this._cache.setStencilWriteMask(e))},enumerable:!1,configurable:!0}),Object.defineProperty(EQ.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._cache.setStencilEnabled(e))},enumerable:!1,configurable:!0}),EQ.prototype.reset=function(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0,this._cache.resetStencilState()},EQ.prototype.apply=function(){var e,t=null===(e=this.stencilMaterial)||void 0===e?void 0:e.enabled;this.enabled=t?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.enabled&&(this.frontFunc=t?this.stencilMaterial.frontFunc:this.stencilGlobal.frontFunc,this.backFunc=t?this.stencilMaterial.backFunc:this.stencilGlobal.backFunc,this.funcRef=t?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=t?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.frontOpStencilFail=t?this.stencilMaterial.frontOpStencilFail:this.stencilGlobal.frontOpStencilFail,this.backOpStencilFail=t?this.stencilMaterial.backOpStencilFail:this.stencilGlobal.backOpStencilFail,this.frontOpDepthFail=t?this.stencilMaterial.frontOpDepthFail:this.stencilGlobal.frontOpDepthFail,this.backOpDepthFail=t?this.stencilMaterial.backOpDepthFail:this.stencilGlobal.backOpDepthFail,this.frontOpStencilDepthPass=t?this.stencilMaterial.frontOpStencilDepthPass:this.stencilGlobal.frontOpStencilDepthPass,this.backOpStencilDepthPass=t?this.stencilMaterial.backOpStencilDepthPass:this.stencilGlobal.backOpStencilDepthPass,this.mask=t?this.stencilMaterial.mask:this.stencilGlobal.mask)};var xQ,CQ=(xQ=!0,function(e,t){var r=xQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return xQ=!1,r}),bQ=CQ(void 0,(function(){return bQ.toString().search("(((.+)+)+)+$").toString().constructor(bQ).search("(((.+)+)+)+$")}));function IQ(e){var t=ZN.call(this,!1)||this;return t._cache=e,t.reset(),t}bQ(),IQ.prototype=Object.create(ZN.prototype),IQ.prototype.constructor=ZN,Object.defineProperty(IQ.prototype,"zOffset",{get:function(){return this._zOffset},set:function(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0,this._cache.setDepthBiasSlopeScale(e))},enumerable:!1,configurable:!0}),Object.defineProperty(IQ.prototype,"zOffsetUnits",{get:function(){return this._zOffsetUnits},set:function(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0,this._cache.setDepthBias(e))},enumerable:!1,configurable:!0}),Object.defineProperty(IQ.prototype,"cullFace",{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0,this._cache.setCullFace(null!=e?e:1))},enumerable:!1,configurable:!0}),Object.defineProperty(IQ.prototype,"cull",{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0,this._cache.setCullEnabled(!!e))},enumerable:!1,configurable:!0}),Object.defineProperty(IQ.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0,this._cache.setDepthCompare(e))},enumerable:!1,configurable:!0}),Object.defineProperty(IQ.prototype,"depthMask",{get:function(){return this._depthMask},set:function(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0,this._cache.setDepthWriteEnabled(e))},enumerable:!1,configurable:!0}),Object.defineProperty(IQ.prototype,"depthTest",{get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0,this._cache.setDepthTestEnabled(e))},enumerable:!1,configurable:!0}),Object.defineProperty(IQ.prototype,"frontFace",{get:function(){return this._frontFace},set:function(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0,this._cache.setFrontFace(null!=e?e:2))},enumerable:!1,configurable:!0}),IQ.prototype.reset=function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1,this._cache.resetDepthCullingState()},IQ.prototype.apply=function(){};var vQ,TQ=(vQ=!0,function(e,t){var r=vQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return vQ=!1,r}),RQ=TQ(void 0,(function(){return RQ.toString().search("(((.+)+)+)+$").toString().constructor(RQ).search("(((.+)+)+)+$")}));function SQ(e,t){void 0===t&&(t=!0),this.effect=null,this.defines=null,this.drawContext=e.createDrawContext(),t&&(this.materialContext=e.createMaterialContext())}RQ(),SQ.IsWrapper=function(e){return void 0===e.getPipelineContext},SQ.GetEffect=function(e){return void 0===e.getPipelineContext?e.effect:e},SQ.prototype.setEffect=function(e,t,r){var n;void 0===r&&(r=!0),this.effect=e,void 0!==t&&(this.defines=t),r&&(null===(n=this.drawContext)||void 0===n||n.reset())},SQ.prototype.dispose=function(){var e;null===(e=this.drawContext)||void 0===e||e.dispose()};var MQ,wQ=(MQ=!0,function(e,t){var r=MQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return MQ=!1,r}),BQ=wQ(void 0,(function(){return BQ.toString().search("(((.+)+)+)+$").toString().constructor(BQ).search("(((.+)+)+)+$")}));function OQ(e){this.useMipMaps=!1,this.type=Qd.TEXTURETYPE_UNDEFINED,this._video=e,this.uniqueId=OF._Counter++}BQ(),OQ.IsExternalTexture=function(e){return void 0!==e.underlyingResource},OQ.prototype.getClassName=function(){return"ExternalTexture"},Object.defineProperty(OQ.prototype,"underlyingResource",{get:function(){return this._video},enumerable:!1,configurable:!0}),OQ.prototype.isReady=function(){return this._video.readyState>=this._video.HAVE_CURRENT_DATA},OQ.prototype.dispose=function(){};var DQ,FQ=(DQ=!0,function(e,t){var r=DQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return DQ=!1,r}),PQ=FQ(void 0,(function(){return PQ.toString().search("(((.+)+)+)+$").toString().constructor(PQ).search("(((.+)+)+)+$")}));function NQ(){this.uniqueId=NQ._Counter++,this.updateId=0,this.reset()}PQ(),Object.defineProperty(NQ.prototype,"forceBindGroupCreation",{get:function(){return this._numExternalTextures>0},enumerable:!1,configurable:!0}),Object.defineProperty(NQ.prototype,"hasFloatTextures",{get:function(){return this._numFloatTextures>0},enumerable:!1,configurable:!0}),NQ.prototype.reset=function(){this.samplers={},this.textures={},this.isDirty=!0,this._numFloatTextures=0,this._numExternalTextures=0},NQ.prototype.setSampler=function(e,t){var r=this.samplers[e],n=-1;r?n=r.hashCode:this.samplers[e]=r={sampler:t,hashCode:0},r.sampler=t,r.hashCode=t?hQ.GetSamplerHashCode(t):0;var i=n!==r.hashCode;i&&this.updateId++,this.isDirty||(this.isDirty=i)},NQ.prototype.setTexture=function(e,t){var r,n,i,o=this.textures[e],s=-1;o?s=null!==(n=null===(r=o.texture)||void 0===r?void 0:r.uniqueId)&&void 0!==n?n:-1:this.textures[e]=o={texture:t,isFloatTexture:!1,isExternalTexture:!1},o.isExternalTexture&&this._numExternalTextures--,o.isFloatTexture&&this._numFloatTextures--,t?(o.isFloatTexture=t.type===Qd.TEXTURETYPE_FLOAT,o.isExternalTexture=OQ.IsExternalTexture(t),o.isFloatTexture&&this._numFloatTextures++,o.isExternalTexture&&this._numExternalTextures++):(o.isFloatTexture=!1,o.isExternalTexture=!1),o.texture=t;var a=s!==(null!==(i=null==t?void 0:t.uniqueId)&&void 0!==i?i:-1);a&&this.updateId++,this.isDirty||(this.isDirty=a)},NQ._Counter=0;var LQ,UQ=(LQ=!0,function(e,t){var r=LQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return LQ=!1,r}),GQ=UQ(void 0,(function(){return GQ.toString().search("(((.+)+)+)+$").toString().constructor(GQ).search("(((.+)+)+)+$")}));function QQ(e){this._bufferManager=e,this.uniqueId=QQ._Counter++,this._useInstancing=!1,this._currentInstanceCount=0,this.reset()}GQ(),QQ.prototype.isDirty=function(e){return this._isDirty||this._materialContextUpdateId!==e},QQ.prototype.resetIsDirty=function(e){this._isDirty=!1,this._materialContextUpdateId=e},Object.defineProperty(QQ.prototype,"useInstancing",{get:function(){return this._useInstancing},set:function(e){this._useInstancing!==e&&(e?(this.indirectDrawBuffer=this._bufferManager.createRawBuffer(40,_N.BufferUsage.CopyDst|_N.BufferUsage.Indirect),this._indirectDrawData=new Uint32Array(5),this._indirectDrawData[3]=0,this._indirectDrawData[4]=0):(this.indirectDrawBuffer&&this._bufferManager.releaseBuffer(this.indirectDrawBuffer),this.indirectDrawBuffer=void 0,this._indirectDrawData=void 0),this._useInstancing=e,this._currentInstanceCount=-1)},enumerable:!1,configurable:!0}),QQ.prototype.reset=function(){this.buffers={},this._isDirty=!0,this._materialContextUpdateId=0,this.fastBundle=void 0,this.bindGroups=void 0},QQ.prototype.setBuffer=function(e,t){var r;this._isDirty||(this._isDirty=(null==t?void 0:t.uniqueId)!==(null===(r=this.buffers[e])||void 0===r?void 0:r.uniqueId)),this.buffers[e]=t},QQ.prototype.setIndirectData=function(e,t,r){t!==this._currentInstanceCount&&this.indirectDrawBuffer&&this._indirectDrawData&&(this._currentInstanceCount=t,this._indirectDrawData[0]=e,this._indirectDrawData[1]=t,this._indirectDrawData[2]=r,this._bufferManager.setRawData(this.indirectDrawBuffer,0,this._indirectDrawData,0,20))},QQ.prototype.dispose=function(){this.indirectDrawBuffer&&(this._bufferManager.releaseBuffer(this.indirectDrawBuffer),this.indirectDrawBuffer=void 0,this._indirectDrawData=void 0),this.fastBundle=void 0,this.bindGroups=void 0,this.buffers=void 0},QQ._Counter=0;var kQ=function(){var e,t=(e=!0,function(t,r){var n=e?function(){if(r){var e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}),r=t(this,(function(){return r.toString().search("(((.+)+)+)+$").toString().constructor(r).search("(((.+)+)+)+$")}));return r(),function(){this.values={}}}();function zQ(e,t,r){this.disabled=!1,this._device=e,this._cacheSampler=t,this._engine=r}Object.defineProperty(zQ,"Statistics",{get:function(){return{totalCreated:zQ.NumBindGroupsCreatedTotal,lastFrameCreated:zQ.NumBindGroupsCreatedLastFrame,lookupLastFrame:zQ.NumBindGroupsLookupLastFrame,noLookupLastFrame:zQ.NumBindGroupsNoLookupLastFrame}},enumerable:!1,configurable:!0}),zQ.prototype.endFrame=function(){zQ.NumBindGroupsCreatedLastFrame=zQ._NumBindGroupsCreatedCurrentFrame,zQ.NumBindGroupsLookupLastFrame=zQ._NumBindGroupsLookupCurrentFrame,zQ.NumBindGroupsNoLookupLastFrame=zQ._NumBindGroupsNoLookupCurrentFrame,zQ._NumBindGroupsCreatedCurrentFrame=0,zQ._NumBindGroupsLookupCurrentFrame=0,zQ._NumBindGroupsNoLookupCurrentFrame=0},zQ.prototype.getBindGroups=function(e,t,r,n){var i,o,s,a=void 0;if(!n&&!t.isDirty(r.updateId)&&!r.isDirty)return zQ._NumBindGroupsNoLookupCurrentFrame++,t.bindGroups;if(t.resetIsDirty(r.updateId),r.isDirty=!1,a)return t.bindGroups=a,zQ._NumBindGroupsLookupCurrentFrame++,a;a=[],t.bindGroups=a,zQ.NumBindGroupsCreatedTotal++,zQ._NumBindGroupsCreatedCurrentFrame++;for(var u=e.bindGroupLayouts,c=0;c<e.shaderProcessingContext.bindGroupLayoutEntries.length;c++){for(var l=e.shaderProcessingContext.bindGroupLayoutEntries[c],h=e.shaderProcessingContext.bindGroupEntries[c],p=0;p<l.length;p++){var f,d=e.shaderProcessingContext.bindGroupLayoutEntries[c][p],A=e.shaderProcessingContext.bindGroupLayoutEntryInfo[c][d.binding],g=null!==(i=A.nameInArrayOfTexture)&&void 0!==i?i:A.name;if(d.sampler)if(f=r.samplers[g]){var _=f.sampler;if(!_){this._engine.dbgSanityChecks&&aL.Error("Trying to bind a null sampler! entry=".concat(JSON.stringify(d),", name=").concat(g,", bindingInfo=").concat(JSON.stringify(f,(function(e,t){return"texture"===e?"<no dump>":t})),", materialContext.uniqueId=").concat(r.uniqueId),50);continue}h[p].resource=this._cacheSampler.getSampler(_,!1,f.hashCode)}else aL.Error('Sampler "'.concat(g,'" could not be bound. entry=').concat(JSON.stringify(d),", materialContext=").concat(JSON.stringify(r,(function(e,t){return"texture"===e||"sampler"===e?"<no dump>":t}))),50);else if(d.texture||d.storageTexture)if(f=r.textures[g]){if(this._engine.dbgSanityChecks&&null===f.texture){aL.Error("Trying to bind a null texture! entry=".concat(JSON.stringify(d),", bindingInfo=").concat(JSON.stringify(f,(function(e,t){return"texture"===e?"<no dump>":t})),", materialContext.uniqueId=").concat(r.uniqueId),50);continue}var m=f.texture._hardwareTexture;if(this._engine.dbgSanityChecks&&(!m||d.texture&&!m.view||d.storageTexture&&!m.viewForWriting)){aL.Error("Trying to bind a null gpu texture or view! entry=".concat(JSON.stringify(d),", name=").concat(g,", bindingInfo=").concat(JSON.stringify(f,(function(e,t){return"texture"===e?"<no dump>":t})),", isReady=").concat(null===(o=f.texture)||void 0===o?void 0:o.isReady,", materialContext.uniqueId=").concat(r.uniqueId),50);continue}h[p].resource=d.storageTexture?m.viewForWriting:d.texture.multisampled?m.msaaView:m.view}else aL.Error('Texture "'.concat(g,'" could not be bound. entry=').concat(JSON.stringify(d),", materialContext=").concat(JSON.stringify(r,(function(e,t){return"texture"===e||"sampler"===e?"<no dump>":t}))),50);else if(d.externalTexture)if(f=r.textures[g]){if(this._engine.dbgSanityChecks&&null===f.texture){aL.Error("Trying to bind a null external texture! entry=".concat(JSON.stringify(d),", name=").concat(g,", bindingInfo=").concat(JSON.stringify(f,(function(e,t){return"texture"===e?"<no dump>":t})),", materialContext.uniqueId=").concat(r.uniqueId),50);continue}var y=f.texture.underlyingResource;if(this._engine.dbgSanityChecks&&!y){aL.Error("Trying to bind a null gpu external texture! entry=".concat(JSON.stringify(d),", name=").concat(g,", bindingInfo=").concat(JSON.stringify(f,(function(e,t){return"texture"===e?"<no dump>":t})),", isReady=").concat(null===(s=f.texture)||void 0===s?void 0:s.isReady,", materialContext.uniqueId=").concat(r.uniqueId),50);continue}h[p].resource=this._device.importExternalTexture({source:y})}else aL.Error('Texture "'.concat(g,'" could not be bound. entry=').concat(JSON.stringify(d),", materialContext=").concat(JSON.stringify(r,(function(e,t){return"texture"===e||"sampler"===e?"<no dump>":t}))),50);else if(d.buffer){var E=t.buffers[g];if(E){var x=E.underlyingResource;h[p].resource.buffer=x,h[p].resource.size=E.capacity}else aL.Error("Can't find buffer \"".concat(g,'". entry=').concat(JSON.stringify(d),", buffers=").concat(JSON.stringify(t.buffers),", drawContext.uniqueId=").concat(t.uniqueId),50)}}var C=u[c];a[c]=this._device.createBindGroup({layout:C,entries:h})}return n&&(n.bindGroups=a),a},zQ.NumBindGroupsCreatedTotal=0,zQ.NumBindGroupsCreatedLastFrame=0,zQ.NumBindGroupsLookupLastFrame=0,zQ.NumBindGroupsNoLookupLastFrame=0,zQ._Cache=new kQ,zQ._NumBindGroupsCreatedCurrentFrame=0,zQ._NumBindGroupsLookupCurrentFrame=0,zQ._NumBindGroupsNoLookupCurrentFrame=0;var jQ,HQ=(jQ=!0,function(e,t){var r=jQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return jQ=!1,r}),qQ=HQ(void 0,(function(){return qQ.toString().search("(((.+)+)+)+$").toString().constructor(qQ).search("(((.+)+)+)+$")}));qQ();PU.ShadersStore.clearQuadVertexShader="uniform float depthValue;\nconst vec2 pos[4]={\nvec2(-1.0,1.0),\n    vec2(1.0,1.0),\nvec2(-1.0,-1.0),\n    vec2(1.0,-1.0)\n};\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n    #define CUSTOM_VERTEX_MAIN_BEGIN\n    gl_Position=vec4(pos[gl_VertexID],depthValue,1.0);\n    #define CUSTOM_VERTEX_MAIN_END\n}\n";var VQ,YQ=(VQ=!0,function(e,t){var r=VQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return VQ=!1,r}),XQ=YQ(void 0,(function(){return XQ.toString().search("(((.+)+)+)+$").toString().constructor(XQ).search("(((.+)+)+)+$")}));XQ();PU.ShadersStore.clearQuadPixelShader="uniform vec4 color;\nvoid main() {\n\tgl_FragColor=color;\n}\n";var WQ,KQ=(WQ=!0,function(e,t){var r=WQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return WQ=!1,r}),$Q=KQ(void 0,(function(){return $Q.toString().search("(((.+)+)+)+$").toString().constructor($Q).search("(((.+)+)+)+$")}));function JQ(e,t,r){this._bindGroups={},this._bundleCache={},this._keyTemp=[],this._device=e,this._engine=t,this._cacheRenderPipeline=new gQ(this._device,r,!t._caps.textureFloatLinearFiltering),this._cacheRenderPipeline.setDepthTestEnabled(!1),this._cacheRenderPipeline.setStencilReadMask(255),this._effect=t.createEffect("clearQuad",[],["color","depthValue"])}$Q(),JQ.prototype.setDepthStencilFormat=function(e){this._depthTextureFormat=e,this._cacheRenderPipeline.setDepthStencilFormat(e)},JQ.prototype.setColorFormat=function(e){this._cacheRenderPipeline.setColorFormat(e)},JQ.prototype.setMRTAttachments=function(e,t,r){this._cacheRenderPipeline.setMRT(t,r),this._cacheRenderPipeline.setMRTAttachments(e)},JQ.prototype.clear=function(e,t,r,n,i){var o,s;void 0===i&&(i=1);var a,u,c=null,l=!!this._engine._currentRenderTarget;if(e)a=e;else{var h=0;this._keyTemp.length=0;for(var p=0;p<this._cacheRenderPipeline.colorFormats.length;++p)this._keyTemp[h++]=Az[null!==(o=this._cacheRenderPipeline.colorFormats[p])&&void 0!==o?o:""];var f=Az[null!==(s=this._depthTextureFormat)&&void 0!==s?s:0];if(this._keyTemp[h]=(t?t.r+256*t.g+256*t.b*256+256*t.a*256*256:0)+(r?Math.pow(2,32):0)+(n?Math.pow(2,33):0)+(this._engine.useReverseDepthBuffer?Math.pow(2,34):0)+(l?Math.pow(2,35):0)+(i>1?Math.pow(2,36):0)+f*Math.pow(2,37),u=this._keyTemp.join("_"),c=this._bundleCache[u])return c;a=this._device.createRenderBundleEncoder({colorFormats:this._cacheRenderPipeline.colorFormats,depthStencilFormat:this._depthTextureFormat,sampleCount:i})}this._cacheRenderPipeline.setDepthWriteEnabled(!!r),this._cacheRenderPipeline.setStencilEnabled(!!n&&!!this._depthTextureFormat&&gz.HasStencilAspect(this._depthTextureFormat)),this._cacheRenderPipeline.setStencilWriteMask(n?255:0),this._cacheRenderPipeline.setStencilCompare(Qd.FRONT,n?Qd.ALWAYS:Qd.NEVER),this._cacheRenderPipeline.setStencilCompare(Qd.BACK,n?Qd.ALWAYS:Qd.NEVER),this._cacheRenderPipeline.setStencilPassOp(Qd.FRONT,n?Qd.REPLACE:Qd.KEEP),this._cacheRenderPipeline.setStencilPassOp(Qd.BACK,n?Qd.REPLACE:Qd.KEEP),this._cacheRenderPipeline.setWriteMask(t?15:0);var d=this._cacheRenderPipeline.getRenderPipeline(Qd.MATERIAL_TriangleStripDrawMode,this._effect,i),A=this._effect._pipelineContext;t&&this._effect.setDirectColor4("color",t),this._effect.setFloat("depthValue",this._engine.useReverseDepthBuffer?this._engine._clearReverseDepthValue:this._engine._clearDepthValue),A.uniformBuffer.update();var g=l?this._engine._ubInvertY:this._engine._ubDontInvertY,_=A.uniformBuffer.getBuffer(),m=_.uniqueId+"-"+g.uniqueId,y=this._bindGroups[m];if(!y){var E=A.bindGroupLayouts;(y=this._bindGroups[m]=[]).push(this._device.createBindGroup({layout:E[0],entries:[]})),!RG._SimplifiedKnownBindings&&y.push(this._device.createBindGroup({layout:E[1],entries:[]})),y.push(this._device.createBindGroup({layout:E[RG._SimplifiedKnownBindings?1:2],entries:[{binding:0,resource:{buffer:g.underlyingResource,size:g.capacity}},{binding:1,resource:{buffer:_.underlyingResource,size:_.capacity}}]}))}a.setPipeline(d);for(p=0;p<y.length;++p)a.setBindGroup(p,y[p]);return a.draw(4,1,0,0),!e&&(c=a.finish(),this._bundleCache[u]=c),c};var ZQ,ek=(ZQ=!0,function(e,t){var r=ZQ?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return ZQ=!1,r}),tk=ek(void 0,(function(){return tk.toString().search("(((.+)+)+)+$").toString().constructor(tk).search("(((.+)+)+)+$")}));function rk(e,t,r,n){this.x=Math.floor(e),this.y=Math.floor(t),this.w=Math.floor(r),this.h=Math.floor(n)}function nk(e,t,r,n){this.x=e,this.y=t,this.w=r,this.h=n}function ik(e){this.ref=e}function ok(e){this.color=e}function sk(){this.bundles=[]}function ak(e){this.numDrawCalls=0,this._device=e,this._list=new Array(10),this._listLength=0}tk(),rk.prototype.run=function(e){e.setViewport(this.x,this.y,this.w,this.h,0,1)},rk.prototype.clone=function(){return new rk(this.x,this.y,this.w,this.h)},nk.prototype.run=function(e){e.setScissorRect(this.x,this.y,this.w,this.h)},nk.prototype.clone=function(){return new nk(this.x,this.y,this.w,this.h)},ik.prototype.run=function(e){e.setStencilReference(this.ref)},ik.prototype.clone=function(){return new ik(this.ref)},ok.prototype.run=function(e){e.setBlendConstant(this.color)},ok.prototype.clone=function(){return new ok(this.color)},sk.prototype.run=function(e){e.executeBundles(this.bundles)},sk.prototype.clone=function(){var e=new sk;return e.bundles=this.bundles,e},ak.prototype.addBundle=function(e){if(!this._currentItemIsBundle){var t=new sk;this._list[this._listLength++]=t,this._currentBundleList=t.bundles,this._currentItemIsBundle=!0}e&&this._currentBundleList.push(e)},ak.prototype._finishBundle=function(){this._currentItemIsBundle&&this._bundleEncoder&&(this._currentBundleList.push(this._bundleEncoder.finish()),this._bundleEncoder=void 0,this._currentItemIsBundle=!1)},ak.prototype.addItem=function(e){this._finishBundle(),this._list[this._listLength++]=e,this._currentItemIsBundle=!1},ak.prototype.getBundleEncoder=function(e,t,r){return!this._currentItemIsBundle&&(this.addBundle(),this._bundleEncoder=this._device.createRenderBundleEncoder({colorFormats:e,depthStencilFormat:t,sampleCount:r})),this._bundleEncoder},ak.prototype.close=function(){this._finishBundle()},ak.prototype.run=function(e){this.close();for(var t=0;t<this._listLength;++t)this._list[t].run(e)},ak.prototype.reset=function(){this._listLength=0,this._currentItemIsBundle=!1,this.numDrawCalls=0},ak.prototype.clone=function(){this.close();var e=new ak(this._device);e._list=new Array(this._listLength),e._listLength=this._listLength,e.numDrawCalls=this.numDrawCalls;for(var t=0;t<this._listLength;++t)e._list[t]=this._list[t].clone();return e};var uk,ck=(uk=!0,function(e,t){var r=uk?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return uk=!1,r}),lk=ck(void 0,(function(){return lk.toString().search("(((.+)+)+)+$").toString().constructor(lk).search("(((.+)+)+)+$")}));function hk(e,t){this._enabled=!1,this._measureDurationState=0,this._device=e,this._bufferManager=t}lk(),Object.defineProperty(hk.prototype,"gpuFrameTimeCounter",{get:function(){return this._gpuFrameTimeCounter},enumerable:!1,configurable:!0}),Object.defineProperty(hk.prototype,"enable",{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._measureDurationState=0,e?this._measureDuration=new WebGPUDurationMeasure(this._device,this._bufferManager):this._measureDuration.dispose())},enumerable:!1,configurable:!0}),hk.prototype.startFrame=function(e){this._enabled&&0===this._measureDurationState&&(this._measureDuration.start(e),this._measureDurationState=1)},hk.prototype.endFrame=function(e){var t=this;1===this._measureDurationState&&(this._measureDurationState=2,this._measureDuration.stop(e).then((function(e){null!==e&&e>=0&&(t._gpuFrameTimeCounter.fetchNewFrame(),t._gpuFrameTimeCounter.addCount(e,!0)),t._measureDurationState=0})))};const pk=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),fk=pk(void 0,(function(){return fk.toString().search("(((.+)+)+)+$").toString().constructor(fk).search("(((.+)+)+)+$")}));function dk(e,t,r,n,i){void 0===i&&(i=!0),this._dstBuffers=[],this._device=r,this._bufferManager=n,this._count=e,this._canUseMultipleBuffers=i,this._querySet=r.createQuerySet({type:t,count:e}),this._queryBuffer=n.createRawBuffer(8*e,_N.BufferUsage.QueryResolve|_N.BufferUsage.CopySrc),!i&&this._dstBuffers.push(this._bufferManager.createRawBuffer(8*this._count,_N.BufferUsage.MapRead|_N.BufferUsage.CopyDst))}fk(),Object.defineProperty(dk.prototype,"querySet",{get:function(){return this._querySet},enumerable:!1,configurable:!0}),dk.prototype._getBuffer=function(e,t){if(!this._canUseMultipleBuffers&&0===this._dstBuffers.length)return null;var r,n=this._device.createCommandEncoder();return 0===this._dstBuffers.length?r=this._bufferManager.createRawBuffer(8*this._count,_N.BufferUsage.MapRead|_N.BufferUsage.CopyDst):(r=this._dstBuffers[this._dstBuffers.length-1],this._dstBuffers.length--),n.resolveQuerySet(this._querySet,e,t,this._queryBuffer,0),n.copyBufferToBuffer(this._queryBuffer,0,r,0,8*t),this._device.queue.submit([n.finish()]),r},dk.prototype.readValues=function(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=1),new Promise(((n,i)=>{var o;return null===(o=this._getBuffer(e,t))?i(null):o.mapAsync(_N.MapMode.Read).then((()=>{const e=new BigUint64Array(o.getMappedRange()).slice();o.unmap(),this._dstBuffers[this._dstBuffers.length]=o,n({data:e,frameId:r})}))}))},dk.prototype.readValue=function(e){return void 0===e&&(e=0),new Promise(((t,r)=>{const n=this._getBuffer(e,1);return null===n?t(null):n.mapAsync(_N.MapMode.Read).then((()=>{const e=new BigUint64Array(n.getMappedRange()),r=Number(e[0]);return n.unmap(),this._dstBuffers[this._dstBuffers.length]=n,t(r)}))}))},dk.prototype.readTwoValuesAndSubtract=async function(e){return void 0===e&&(e=0),new Promise(((t,r)=>{const n=this._getBuffer(e,2);return null===n?t(null):n.mapAsync(_N.MapMode.Read).then((()=>{const e=new BigUint64Array(n.getMappedRange()),r=Number(e[1]-e[0]);return n.unmap(),this._dstBuffers[this._dstBuffers.length]=n,t(r)}))}))},dk.prototype.dispose=function(){this._querySet.destroy(),this._bufferManager.releaseBuffer(this._queryBuffer);for(var e=0;e<this._dstBuffers.length;++e)this._bufferManager.releaseBuffer(this._dstBuffers[e])};var Ak,gk=(Ak=!0,function(e,t){var r=Ak?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Ak=!1,r}),_k=gk(void 0,(function(){return _k.toString().search("(((.+)+)+)+$").toString().constructor(_k).search("(((.+)+)+)+$")}));_k();var mk=0;function yk(e,t,r,n,i){void 0===n&&(n=4096),void 0===i&&(i=100),this._availableIndices=[],this._engine=e,this._device=t,this._bufferManager=r,this._frameLastBuffer=-1,this._lastBufferFrameID=-1,this._currentTotalIndices=0,this._countIncrement=i,this._allocateNewIndices(n)}Object.defineProperty(yk.prototype,"querySet",{get:function(){return this._querySet.querySet},enumerable:!1,configurable:!0}),Object.defineProperty(yk.prototype,"hasQueries",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(yk.prototype,"canBeginQuery",{get:function(){switch(this._engine._getCurrentRenderPassIndex()){case 0:return void 0!==this._engine._mainRenderPassWrapper.renderPassDescriptor.occlusionQuerySet;case 1:return void 0!==this._engine._rttRenderPassWrapper.renderPassDescriptor.occlusionQuerySet}return!1},enumerable:!1,configurable:!0}),yk.prototype.createQuery=function(){0===this._availableIndices.length&&this._allocateNewIndices();var e=this._availableIndices[mk];return mk--,e},yk.prototype.deleteQuery=function(e){mk++,this._availableIndices[mk]=e},yk.prototype.isQueryResultAvailable=function(e){return this._retrieveQueryBuffer(),!!this._lastBuffer&&e<this._lastBuffer.length},yk.prototype.getQueryResult=function(e){var t,r;return Number(null!==(r=null===(t=this._lastBuffer)||void 0===t?void 0:t[e])&&void 0!==r?r:-1)},yk.prototype.getQueryResultFrameID=function(){return this._lastBufferFrameID},yk.prototype._retrieveQueryBuffer=function(){var e=this;this._lastBuffer&&this._frameLastBuffer===this._engine.frameId||this._frameLastBuffer!==this._engine.frameId&&(this._frameLastBuffer=this._engine.frameId,this._querySet.readValues(0,this._currentTotalIndices,this._engine.frameId).then((function(t){e._lastBuffer=t.data,e._lastBufferFrameID=t.frameId})).catch((t=>{e._lastBuffer=null})))},yk.prototype._allocateNewIndices=function(e){e=null!=e?e:this._countIncrement,this._delayQuerySetDispose();for(var t=0;t<e;++t)this._availableIndices.push(this._currentTotalIndices+t);mk=this._availableIndices.length-1,this._currentTotalIndices+=e,this._querySet=new dk(this._currentTotalIndices,_N.QueryType.Occlusion,this._device,this._bufferManager,!1)},yk.prototype._delayQuerySetDispose=function(){var e=this._querySet;e&&setTimeout((function(){return e.dispose}),1e3)},yk.prototype.dispose=function(){var e;null===(e=this._querySet)||void 0===e||e.dispose(),this._availableIndices=[]};var Ek,xk=(Ek=!0,function(e,t){var r=Ek?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Ek=!1,r}),Ck=xk(void 0,(function(){return Ck.toString().search("(((.+)+)+)+$").toString().constructor(Ck).search("(((.+)+)+)+$")}));function bk(e,t){void 0===t&&(t=20),this.debug=!1,this._sourceCode=e,this._numMaxIterations=t,this._functionDescr=[],this.inlineToken="#define inline"}Ck(),Object.defineProperty(bk.prototype,"code",{get:function(){return this._sourceCode},enumerable:!1,configurable:!0}),bk.prototype.processCode=function(){this.debug&&console.log("Start inlining process (code size=".concat(this._sourceCode.length,")...")),this._collectFunctions(),this._processInlining(this._numMaxIterations),this.debug&&console.log("End of inlining process.")},bk.prototype._collectFunctions=function(){for(var e=0;e<this._sourceCode.length;){var t=this._sourceCode.indexOf(this.inlineToken,e);if(t<0)break;var r=this._sourceCode.indexOf("(",t+this.inlineToken.length);if(r<0)this.debug&&console.warn("Could not find the opening parenthesis after the token. startIndex=".concat(e)),e=t+this.inlineToken.length;else{var n=bk._RegexpFindFunctionNameAndType.exec(this._sourceCode.substring(t+this.inlineToken.length,r));if(n){var i=[n[3],n[4]],o=i[0],s=i[1],a=PG("(",")",this._sourceCode,r);if(a<0)this.debug&&console.warn("Could not extract the parameters the function '".concat(s,"' (type=").concat(o,"). funcParamsStartIndex=").concat(r)),e=t+this.inlineToken.length;else{var u=this._sourceCode.substring(r+1,a),c=NG(this._sourceCode,a+1);if(c!==this._sourceCode.length){var l=PG("{","}",this._sourceCode,c);if(l<0)this.debug&&console.warn("Could not extract the body of the function '".concat(s,"' (type=").concat(o,"). funcBodyStartIndex=").concat(c)),e=t+this.inlineToken.length;else{for(var h=this._sourceCode.substring(c,l+1),p=UG(u).split(","),f=[],d=0;d<p.length;++d){var A=p[d].trim(),g=A.lastIndexOf(" ");g>=0&&f.push(A.substring(g+1))}"void"!==o&&f.push("return"),this._functionDescr.push({name:s,type:o,parameters:f,body:h,callIndex:0}),e=l+1;var _=t>0?this._sourceCode.substring(0,t):"",m=l+1<this._sourceCode.length-1?this._sourceCode.substring(l+1):"";this._sourceCode=_+m,e-=l+1-t}}else this.debug&&console.warn("Could not extract the body of the function '".concat(s,"' (type=").concat(o,"). funcParamsEndIndex=").concat(a)),e=t+this.inlineToken.length}}else this.debug&&console.warn("Could not extract the name/type of the function from: ".concat(this._sourceCode.substring(t+this.inlineToken.length,r))),e=t+this.inlineToken.length}}this.debug&&console.log("Collect functions: ".concat(this._functionDescr.length," functions found. functionDescr="),this._functionDescr)},bk.prototype._processInlining=function(e){for(void 0===e&&(e=20);e-- >=0&&this._replaceFunctionCallsByCode(););return this.debug&&console.log("numMaxIterations is ".concat(e," after inlining process")),e>=0},bk.prototype._replaceFunctionCallsByCode=function(){for(var e=!1,t=0,r=this._functionDescr;t<r.length;t++)for(var n=r[t],i=n.name,o=n.type,s=n.parameters,a=n.body,u=0;u<this._sourceCode.length;){var c=this._sourceCode.indexOf(i,u);if(c<0)break;if(0===c||LG(this._sourceCode.charAt(c-1)))u=c+i.length;else{var l=NG(this._sourceCode,c+i.length);if(l!==this._sourceCode.length&&"("===this._sourceCode.charAt(l)){var h=PG("(",")",this._sourceCode,l);if(h<0)this.debug&&console.warn("Could not extract the parameters of the function call. Function '".concat(i,"' (type=").concat(o,"). callParamsStartIndex=").concat(l)),u=c+i.length;else{var p=this._sourceCode.substring(l+1,h),f=function(e){for(var t=[],r=0,n=0;r<e.length;){if("("===e.charAt(r)){var i=PG("(",")",e,r);if(i<0)return null;r=i}else","===e.charAt(r)&&(t.push(e.substring(n,r)),n=r+1);r++}return n<r&&t.push(e.substring(n,r)),t}(UG(p));if(null!==f){for(var d=[],A=0;A<f.length;++A){var g=f[A].trim();d.push(g)}var _="void"!==o?i+"_"+n.callIndex++:null;if(_&&d.push(_+" ="),d.length===s.length){u=h+1;var m=this._replaceNames(a,s,d),y=c>0?this._sourceCode.substring(0,c):"",E=h+1<this._sourceCode.length-1?this._sourceCode.substring(h+1):"";if(_){var x=GG(this._sourceCode,c-1,"\n");y=this._sourceCode.substring(0,x+1);var C=this._sourceCode.substring(x+1,c);this._sourceCode=y+o+" "+_+";\n"+m+"\n"+C+_+E,this.debug&&console.log("Replace function call by code. Function '".concat(i,"' (type=").concat(o,"). injectDeclarationIndex=").concat(x,", call parameters=").concat(d))}else this._sourceCode=y+m+E,u+=m.length-(h+1-c),this.debug&&console.log("Replace function call by code. Function '".concat(i,"' (type=").concat(o,"). functionCallIndex=").concat(c,", call parameters=").concat(d));e=!0}else this.debug&&console.warn("Invalid function call: not the same number of parameters for the call than the number expected by the function. Function '".concat(i,"' (type=").concat(o,"). function parameters=").concat(s,", call parameters=").concat(d)),u=c+i.length}else this.debug&&console.warn("Invalid function call: can't extract the parameters of the function call. Function '".concat(i,"' (type=").concat(o,"). callParamsStartIndex=").concat(l,", callParams=")+p),u=c+i.length}}else u=c+i.length}}return e},bk.prototype._replaceNames=function(e,t,r){for(var n=function(n){var i=new RegExp(t[n].replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),o=t[n].length,s=r[n];e=e.replace(i,(function(r){for(var i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];var u=i[0];return LG(e.charAt(u-1))||LG(e.charAt(u+o))?t[n]:s}))},i=0;i<t.length;++i)n(i);return e},bk._RegexpFindFunctionNameAndType=/((\s+?)(\w+)\s+(\w+)\s*?)$/;var Ik,vk=(Ik=!0,function(e,t){var r=Ik?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Ik=!1,r}),Tk=vk(void 0,(function(){return Tk.toString().search("(((.+)+)+)+$").toString().constructor(Tk).search("(((.+)+)+)+$")}));function Rk(){this._twgsl=null}Tk(),Rk.prototype.initTwgsl=function(e){var t=Xs((e=Rk._TWgslDefaultOptions).jsPath),r=Xs(e.wasmPath),n=this;return GN.LoadScriptAsync(t).then((function(){return self.twgsl(r)})).then((function(e){n._twgsl=e,Promise.resolve()}))},Rk.prototype.convertSpirV2WGSL=function(e){var t=this._twgsl.convertSpirV2WGSL(e);return Rk.ShowWGSLShaderCode&&(console.log(t),console.log("***********************************************")),t},Rk._TWgslDefaultOptions={jsPath:"ThirdParty/twgsl.js",wasmPath:"ThirdParty/twgsl.wasm"},Rk.ShowWGSLShaderCode=!1;var Sk,Mk=(Sk=!0,function(e,t){var r=Sk?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Sk=!1,r}),wk=Mk(void 0,(function(){return wk.toString().search("(((.+)+)+)+$").toString().constructor(wk).search("(((.+)+)+)+$")}));function Bk(e,t,r,n){this._record=!1,this._play=!1,this._mainPassBundleList=[],this._enabled=!1,this._engine=e,this._mode=t,this._bundleList=r,this._bundleListRenderTarget=n}wk(),Object.defineProperty(Bk.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._mainPassBundleList.length=0,this._record=this._enabled=e,this._play=!1,e&&(this._modeSaved=this._mode,this._mode=Constants.SNAPSHOTRENDERING_STANDARD)},enumerable:!1,configurable:!0}),Object.defineProperty(Bk.prototype,"play",{get:function(){return this._play},enumerable:!1,configurable:!0}),Object.defineProperty(Bk.prototype,"record",{get:function(){return this._record},enumerable:!1,configurable:!0}),Object.defineProperty(Bk.prototype,"mode",{get:function(){return this._mode},set:function(e){this._record?this._modeSaved=e:this._mode=e},enumerable:!1,configurable:!0}),Bk.prototype.endMainRenderPass=function(){this._record&&this._mainPassBundleList.push(this._bundleList.clone())},Bk.prototype.endRenderTargetPass=function(e,t){var r,n,i,o;if(this._play)null===(n=null===(r=t._bundleLists)||void 0===r?void 0:r[t._currentLayer])||void 0===n||n.run(e),this._mode===Constants.SNAPSHOTRENDERING_FAST&&this._engine._reportDrawCall(null===(o=null===(i=t._bundleLists)||void 0===i?void 0:i[t._currentLayer])||void 0===o?void 0:o.numDrawCalls);else{if(!this._record)return!1;!t._bundleLists&&(t._bundleLists=[]),t._bundleLists[t._currentLayer]=this._bundleListRenderTarget.clone(),t._bundleLists[t._currentLayer].run(e),this._bundleListRenderTarget.reset()}return!0},Bk.prototype.endFrame=function(e){if(this._record&&(this._mainPassBundleList.push(this._bundleList.clone()),this._record=!1,this._play=!0,this._mode=this._modeSaved),null!==e&&this._play)for(var t=0;t<this._mainPassBundleList.length;++t)this._mainPassBundleList[t].run(e),this._mode===Constants.SNAPSHOTRENDERING_FAST&&this._engine._reportDrawCall(this._mainPassBundleList[t].numDrawCalls)},Bk.prototype.reset=function(){this.enabled=!1,this.enabled=!0};var Ok=1,Dk=2,Fk=3;function Pk(e){if(!Nn(e.name))throw new Ln("options.name is required.");var t=_o();this.dbname=e.name;var r=indexedDB.open(this.dbname),n=this;return r.onsuccess=function(e){n.db=e.target.result,n.version=n.db.version,Nn(n.cachestatus)||(n.cachestatus={}),t.resolve(n)},r.onupgradeneeded=function(e){n.db=e.target.result,n.version=n.db.version,t.resolve(n)},r.onerror=function(e){n.db=null,t.reject("create database fail, error code : "+e.target.errorcode)},this.layer=e.layer||null,this.storageType=e.storageType||"arrayBuffer",this.creatingTable=!1,this.cachestatus={},t.promise}Pk.prototype.checkObjectStoreExit=function(e){return!!Nn(this.db)&&this.db.objectStoreNames.contains(e)},Pk.prototype.createObjectStore=function(e){var t=_o();if(this.creatingTable)t.reject(!1);else{if(this.db.objectStoreNames.contains(e))return t.reject(!1),t.promise;this.creatingTable=!0;var r=this,n=parseInt(r.db.version);r.db.close();var i=indexedDB.open(r.dbname,n+1);i.onupgradeneeded=function(n){var i=n.target.result;r.db=i;var o=i.createObjectStore(e,{keyPath:"id"});Nn(o)?(o.createIndex("value","value",{unique:!1}),r.creatingTable=!1,Nn(r.cachestatus)||(r.cachestatus={}),r.cachestatus[e]={},r.db.close(),indexedDB.open(r.dbname).onsuccess=function(e){var n=e.target.result;r.db=n,t.resolve(!0)}):(r.creatingTable=!1,t.reject(!1))},i.onsuccess=function(e){e.target.result.close(),t.resolve(!0)},i.onerror=function(e){r.creatingTable=!1,t.reject(!1)}}return t.promise},Pk.prototype.putElementInDB=function(e,t,r,n){var i,o=_o();if(!Nn(this.db))return o.reject(!1),o.promise;var s=this;if(Nn(s.cachestatus[e])&&!Nn(n)&&Nn(s.cachestatus[e][t])&&(s.cachestatus[e][t]===Ok||s.cachestatus[e][t]===Dk))return o.resolve(!1),o.promise;if(this.db.objectStoreNames.contains(e)){var a;Nn(s.cachestatus[e])||(s.cachestatus[e]={});try{a=this.db.transaction([e],"readwrite")}catch(e){return o.reject(null),o.promise}if(i=a.objectStore(e),Nn(n))if(n instanceof Array){for(var u=0,c=n.length;u<c;u++)s.cachestatus[e][n[u].key]!==Dk&&(i.add({id:n[u].key,value:n[u].value}),s.cachestatus[e][n[u].key]=Dk);o.resolve(!0)}else{for(var t in n)isNaN(1*t)||i.add({id:t,value:n[t]});o.resolve(!0)}else{if(!Nn(t)||!Nn(r))return;if(t instanceof Array&&r instanceof Array){for(u=0,c=t.length;u<c;u++)s.cachestatus[e][t[u]]!==Dk&&(i.add({id:t[u],value:r[u]}),s.cachestatus[e][t[u]]=Dk);a.oncomplete=function(e){o.resolve(!0)},a.onerror=function(e){o.reject(!1)}}else{var l=i.put({id:t,value:r});s.cachestatus[e][t]=Ok,l.onsuccess=function(r){s.cachestatus[e][t]=Dk,o.resolve(!0)},l.onerror=function(r){s.cachestatus[e][t]=Fk,o.reject(!1)}}}}else this.createObjectStore(e).then((function(a){var u=s.db.transaction([e],"readwrite");if(i=u.objectStore(e),Nn(n)){for(var c=0,l=n.length;c<l;c++)i.add({id:n[c].key,value:n[c].value});o.resolve(!0)}else{var h=i.add({id:t,value:r});h.onsuccess=function(e){o.resolve(!0)},h.onerror=function(e){o.reject(!1)}}}),(function(e){o.reject(!1)}));return o.promise},Pk.prototype.getRangeFromDB=function(e,t){var r,n,i=_o();if(!Nn(this.db))return null;if(!this.db.objectStoreNames.contains(e))return null;try{r=this.db.transaction([e])}catch(e){return i.reject(null),i.promise}try{n=r.objectStore(e)}catch(e){i.reject(null)}var o=n.openCursor(IDBKeyRange.bound(t[0],t[1])),s=[];return o.onsuccess=function(e){var t=e.target.result;Nn(t)?(s.push(t.value),t.continue()):i.resolve(s)},o.onerror=function(e){i.reject(null)},i.promise},Pk.prototype.getElementFromDB=function(e,t){var r,n,i=_o();if(!Nn(this.db))return null;if(!this.db.objectStoreNames.contains(e))return null;try{r=this.db.transaction([e])}catch(e){return i.reject(null),i.promise}try{n=r.objectStore(e)}catch(e){i.reject(null)}var o=n.get(t);return o.onsuccess=function(e){Nn(e.target.result)?i.resolve(e.target.result.value):i.reject(null)},o.onerror=function(e){i.reject(null)},i.promise},Pk.prototype.getAllElementFromDB=function(e){var t,r,n=_o();if(!Nn(this.db))return null;if(!this.db.objectStoreNames.contains(e))return null;if(null!=this.transaction)t=this.transaction;else try{t=this.db.transaction([e])}catch(e){return n.reject(null),n.promise}try{r=t.objectStore(e)}catch(e){n.reject(null)}var i=r.getAll();return i.onsuccess=function(e){Nn(e.target.result)?n.resolve(e.target.result):n.reject(null)},i.onerror=function(e){n.reject(null)},n.promise},Pk.prototype.updateElementInDB=function(e,t,r,n){var i=_o();if(!Nn(this.db))return i.resolve(!1),i.promise;if(!this.db.objectStoreNames.contains(e))return i.resolve(!1),i.promise;var o,s=this.db.transaction([e],"readwrite");try{o=s.objectStore(e)}catch(e){i.resolve(!1)}var a=o.get(t);return a.onsuccess=function(e){var s=e.target.result;Nn(s)||(s={id:t}),s.value=!0===n?Object.assign(s.value,r):r;var a=o.put(s);a.onsuccess=function(e){i.resolve(!0)},a.onerror=function(e){i.resolve(!1)}},a.onerror=function(e){i.resolve(!1)},i.promise},Pk.prototype.removeElementFromDB=function(e,t){var r=_o();if(!Nn(this.db))return r.resolve(!1),r.promise;if(!this.db.objectStoreNames.contains(e))return r.resolve(!1),r.promise;var n,i=this.db.transaction([e],"readwrite");try{n=i.objectStore(e)}catch(e){r.resolve(!1)}var o=n.delete(t);return o.onerror=function(e){r.resolve(!1)},o.onsuccess=function(e){r.resolve(!0)},r.promise},Pk.prototype.clear=function(e){var t=_o();if(!Nn(this.db))return t.resolve(!1),t.promise;if(!this.db.objectStoreNames.contains(e))return t.resolve(!1),t.promise;var r,n=this.db.transaction([e],"readwrite");try{r=n.objectStore(e)}catch(e){t.resolve(!1)}var i=r.clear();return i.onerror=function(e){t.resolve(!1)},i.onsuccess=function(e){t.resolve(!0)},t.promise};var Nk,Lk,Uk=(Nk=!0,function(e,t){var r=Nk?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Nk=!1,r}),Gk=Uk(void 0,(function(){return Gk.toString().search("(((.+)+)+)+$").toString().constructor(Gk).search("(((.+)+)+)+$")}));function Qk(e,t){void 0===t&&(t={});var r,n,i,o,s=sG.call(this,null);if((s=this)._uploadEncoderDescriptor={label:"upload"},s._renderEncoderDescriptor={label:"render"},s._renderTargetEncoderDescriptor={label:"renderTarget"},s._clearDepthValue=1,s._clearReverseDepthValue=0,s._clearStencilValue=0,s._defaultSampleCount=4,s._glslang=null,s._tintWASM=null,s._compiledComputeEffects={},s._counters={numEnableEffects:0,numEnableDrawWrapper:0,numBundleCreationNonCompatMode:0,numBundleReuseNonCompatMode:0},s.countersLastFrame={numEnableEffects:0,numEnableDrawWrapper:0,numBundleCreationNonCompatMode:0,numBundleReuseNonCompatMode:0},s.numMaxUncapturedErrors=20,s._commandBuffers=[null,null,null],s._currentRenderPass=null,s._mainRenderPassWrapper=new nQ,s._rttRenderPassWrapper=new nQ,s._pendingDebugCommands=[],s._onAfterUnbindFrameBufferObservable=new vF,s._currentOverrideVertexBuffers=null,s._currentIndexBuffer=null,s._colorWriteLocal=!0,s._forceEnableEffect=!1,s.dbgShowShaderCode=!1,s.dbgSanityChecks=!0,s.dbgVerboseLogsForFirstFrames=!1,s.dbgVerboseLogsNumFrames=10,s.dbgLogIfNotDrawWrapper=!0,s.dbgShowEmptyEnableEffectCalls=!0,s._viewportsCurrent=[{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0}],s._scissorsCurrent=[{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0}],s._scissorCached={x:0,y:0,z:0,w:0},s._stencilRefsCurrent=[-1,-1],s._blendColorsCurrent=[[null,null,null,null],[null,null,null,null]],s._name="WebGPU",s.isNDCHalfZRange=!0,s.hasOriginBottomLeft=!1,t.deviceDescriptor=t.deviceDescriptor||{},t.swapChainFormat=t.swapChainFormat||_N.TextureFormat.BGRA8Unorm,t.antialiasing=void 0===t.antialiasing||t.antialiasing,t.stencil=null===(r=t.stencil)||void 0===r||r,t.enableGPUDebugMarkers=null!==(n=t.enableGPUDebugMarkers)&&void 0!==n&&n,!navigator.gpu)return console.log("WebGPU is not supported by your browser."),s;s._isWebGPU=!0,s._shaderPlatformName="WEBGPU",void 0===t.deterministicLockstep&&(t.deterministicLockstep=!1),void 0===t.lockstepMaxSteps&&(t.lockstepMaxSteps=4),void 0===t.audioEngine&&(t.audioEngine=!0),s._deterministicLockstep=t.deterministicLockstep,s._lockstepMaxSteps=t.lockstepMaxSteps,s._timeStep=t.timeStep||1/60,s._doNotHandleContextLost=!!t.doNotHandleContextLost,s._canvas=e,s._options=t,s.premultipliedAlpha=null===(i=t.premultipliedAlpha)||void 0===i||i;var a=window.devicePixelRatio||1,u=t.limitDeviceRatio||a,c=null!==(o=t.adaptToDeviceRatio)&&void 0!==o&&o;s._hardwareScalingLevel=c?1/Math.min(u,a):1,s._mainPassSampleCount=t.antialiasing?s._defaultSampleCount:1,s._isStencilEnable=t.stencil,s._shaderProcessor=new BG,s._shaderProcessorWGSL=new ZG;var l=s;return s.saveCompiledShaderInIndexDB=!0,new Pk({name:Qk.COMPILED_WGSL_STORE_NAME}).then((function(e){e.checkObjectStoreExit(Qk.COMPILED_WGSL_TABLE_NAME)?l._indexedDBScheduler=e:e.createObjectStore(Qk.COMPILED_WGSL_TABLE_NAME).then((function(){l._indexedDBScheduler=e})).catch((function(e){}))})),s}Gk(),sG&&(Qk.__proto__=sG),Qk.prototype=Object.create(sG&&sG.prototype),Qk.prototype.constructor=sG,Object.defineProperties(Qk.prototype,{snapshotRenderingMode:{get:function(){return this._snapshotRendering.mode},set:function(e){this._snapshotRendering.mode=e}},snapshotRendering:{get:function(){return this._snapshotRendering.enabled},set:function(e){this._snapshotRendering.enabled=e}},disableCacheSamplers:{get:function(){return!!this._cacheSampler&&this._cacheSampler.disabled},set:function(e){this._cacheSampler&&(this._cacheSampler.disabled=e)}},disableCacheRenderPipelines:{get:function(){return!!this._cacheRenderPipeline&&this._cacheRenderPipeline.disabled},set:function(e){this._cacheRenderPipeline&&(this._cacheRenderPipeline.disabled=e)}},disableCacheBindGroups:{get:function(){return!!this._cacheBindGroups&&this._cacheBindGroups.disabled},set:function(e){this._cacheBindGroups&&(this._cacheBindGroups.disabled=e)}},IsSupportedAsync:{get:function(){return navigator.gpu?navigator.gpu.requestAdapter().then((function(e){return!!e}),(function(){return!1})).catch((function(){return!1})):Promise.resolve(!1)}},IsSupported:{get:function(){return console.log("You must call IsSupportedAsync for WebGPU!"),!1}},supportsUniformBuffers:{get:function(){return!0}},supportedExtensions:{get:function(){return this._adapterSupportedExtensions}},enabledExtensions:{get:function(){return this._deviceEnabledExtensions}},description:{get:function(){return this.name+this.version}},version:{get:function(){return 1}},compatibilityMode:{get:function(){return this._compatibilityMode},set:function(e){this._compatibilityMode=e}},currentSampleCount:{get:function(){return this._currentRenderTarget?this._currentRenderTarget.samples:this._mainPassSampleCount}},caps:{get:function(){return this._caps}}}),Qk.prototype.snapshotRenderingReset=function(){this._snapshotRendering.reset()},Qk.prototype.getInfo=function(){return{vendor:"unknown vendor",renderer:"unknown renderer",version:"unknown version"}},Qk.CreateAsync=function(e,t){void 0===t&&(t={});var r=new Qk(e,t);return new Promise((function(e){r.initAsync(t.glslangOptions,t.twgslOptions).then((function(){return e(r)}))}))},Qk.prototype.initAsync=function(e,t){var r,n=this;return this._initGlslang(null!=e?e:null===(r=this._options)||void 0===r?void 0:r.glslangOptions).then((function(e){var r;return n._glslang=e,n._tintWASM=Qk.UseTWGSL?new Rk:null,n._tintWASM?n._tintWASM.initTwgsl(null!=t?t:null===(r=n._options)||void 0===r?void 0:r.twgslOptions).then((function(){return navigator.gpu.requestAdapter(n._options)}),(function(e){throw console.log("Can not initialize twgsl!"),Error("WebGPU initializations stopped.")})):navigator.gpu.requestAdapter(n._options)}),(function(e){throw console.log("Can not initialize glslang!"),Error("WebGPU initializations stopped.")})).then((function(e){if(e){n._adapter=e,n._adapterSupportedExtensions=[],n._adapter.features.forEach((function(e){return n._adapterSupportedExtensions.push(e)}));var t=n._options.deviceDescriptor;if(null==t?void 0:t.requiredFeatures){for(var r=[],i=0,o=t.requiredFeatures;i<o.length;i++){var s=o[i];-1!==n._adapterSupportedExtensions.indexOf(s)&&r.push(s)}t.requiredFeatures=r}return n._adapter.requestDevice(n._options.deviceDescriptor)}throw"Could not retrieve a WebGPU adapter (adapter is null)."})).then((function(e){var t,r;n._device=e,n._deviceEnabledExtensions=[],null===(t=n._device.features)||void 0===t||t.forEach((function(e){return n._deviceEnabledExtensions.push(e)}));var i=-1;n._device.addEventListener("uncapturederror",(function(e){++i<n.numMaxUncapturedErrors?aL.Warn("WebGPU uncaptured error (".concat(i+1,"): ").concat(e.error," - ").concat(e.error.message)):i++===n.numMaxUncapturedErrors&&aL.Warn("WebGPU uncaptured error: too many warnings (".concat(n.numMaxUncapturedErrors,"), no more warnings will be reported to the console for this engine."))})),!n._doNotHandleContextLost&&(null===(r=n._device.lost)||void 0===r||r.then((function(e){n._contextWasLost=!0,aL.Warn("WebGPU context lost. "+e),n.onContextLostObservable.notifyObservers(n),n._restoreEngineAfterContextLost(n.initAsync.bind(n))})))}),(function(e){console.log("Could not retrieve a WebGPU device.")})).then((function(){n._bufferManager=new wL(n._device),n._textureHelper=new gz(n._device,n._glslang,n._tintWASM,n._bufferManager,n),n._cacheSampler=new hQ(n._device),n._cacheBindGroups=new zQ(n._device,n._cacheSampler,n),n._timestampQuery=new hk(n._device,n._bufferManager),n._occlusionQuery=n._device.createQuerySet?new yk(n,n._device,n._bufferManager):void 0,n._bundleList=new ak(n._device),n._bundleListRenderTarget=new ak(n._device),n._snapshotRendering=new Bk(n,n._snapshotRenderingMode,n._bundleList,n._bundleListRenderTarget),n._ubInvertY=n._bufferManager.createBuffer(new Float32Array([-1,0]),_N.BufferUsage.Uniform|_N.BufferUsage.CopyDst),n._ubDontInvertY=n._bufferManager.createBuffer(new Float32Array([1,0]),_N.BufferUsage.Uniform|_N.BufferUsage.CopyDst),n.dbgVerboseLogsForFirstFrames&&void 0===n._count&&(n._count=0,console.log("%c frame #"+n._count+" - begin","background: #ffff00")),n._uploadEncoder=n._device.createCommandEncoder(n._uploadEncoderDescriptor),n._renderEncoder=n._device.createCommandEncoder(n._renderEncoderDescriptor),n._renderTargetEncoder=n._device.createCommandEncoder(n._renderTargetEncoderDescriptor),n._emptyVertexBuffer=new Wd(n,[0],"",!1,!1,1,!1,0,1),n._initializeLimits(),n._cacheRenderPipeline=new gQ(n._device,n._emptyVertexBuffer,!n._caps.textureFloatLinearFiltering),n._depthCullingState=new IQ(n._cacheRenderPipeline),n._stencilStateComposer=new EQ(n._cacheRenderPipeline),n._stencilStateComposer.stencilGlobal=n._stencilState,n._depthCullingState.depthTest=!0,n._depthCullingState.depthFunc=Qd.LEQUAL,n._depthCullingState.depthMask=!0,n._textureHelper.setCommandEncoder(n._uploadEncoder),n._clearQuad=new JQ(n._device,n,n._emptyVertexBuffer),n._defaultDrawContext=n.createDrawContext(),n._currentDrawContext=n._defaultDrawContext,n._defaultMaterialContext=n.createMaterialContext(),n._currentMaterialContext=n._defaultMaterialContext,n._initializeContextAndSwapChain(),n._initializeMainAttachments(!0)})).catch((function(e){console.log("Can not create WebGPU Device and/or context."),console.trace&&console.trace()}))},Qk.prototype._initGlslang=function(e){if(e=e||{},(e=go(Qk._GLSLslangDefaultOptions,e)).glslang)return Promise.resolve(e.glslang);if(self.glslang)return self.glslang(e.wasmPath);if(e.jsPath&&e.wasmPath){var t=Xs(e.jsPath),r=Xs(e.wasmPath);return"undefined"!=typeof window?GN.LoadScriptAsync(t).then((function(){return self.glslang(r)})):(importScripts(t),self.glslang(r))}return Promise.reject("gslang is not available.")},Qk.prototype._initializeLimits=function(){var e=this._adapter;this._caps={maxTexturesImageUnits:e.maxSampledTexturesPerShaderStage,maxVertexTextureImageUnits:e.maxSampledTexturesPerShaderStage,maxCombinedTexturesImageUnits:32,maxTextureSize:e.maxTextureDimension2D,maxCubemapTextureSize:e.maxTextureDimension3D,maxRenderTextureSize:e.maxTextureDimension2D,maxVertexAttribs:e.maxVertexAttributes,maxVaryingVectors:15,maxFragmentUniformVectors:1024,maxVertexUniformVectors:1024,standardDerivatives:!0,astc:this._deviceEnabledExtensions.indexOf(_N.FeatureName.TextureCompressionASTC)>=0||void 0,s3tc:this._deviceEnabledExtensions.indexOf(_N.FeatureName.TextureCompressionBC)>=0||void 0,pvrtc:null,etc1:null,etc2:this._deviceEnabledExtensions.indexOf(_N.FeatureName.TextureCompressionETC2)>=0||void 0,bptc:this._deviceEnabledExtensions.indexOf(_N.FeatureName.TextureCompressionBC)>=0||void 0,maxAnisotropy:4,uintIndices:!0,fragmentDepthSupported:!0,highPrecisionShaderSupported:!0,colorBufferFloat:!0,textureFloat:!0,textureFloatLinearFiltering:!1,textureFloatRender:!0,textureHalfFloat:!0,textureHalfFloatLinearFiltering:!0,textureHalfFloatRender:!0,textureLOD:!0,drawBuffersExtension:!0,depthTextureExtension:!0,vertexArrayObject:!1,instancedArrays:!0,timerQuery:"undefined"!=typeof BigUint64Array&&-1!==this.enabledExtensions.indexOf(_N.FeatureName.TimestampQuery)||void 0,supportOcclusionQuery:"undefined"!=typeof BigUint64Array,canUseTimestampForTimerQuery:!0,multiview:!1,oculusMultiview:!1,parallelShaderCompile:void 0,blendMinMax:!0,maxMSAASamples:4,canUseGLInstanceID:!0,canUseGLVertexID:!0,supportComputeShaders:!0,supportSRGBBuffers:!0,supportTransformFeedbacks:!1,textureMaxLevel:!0,texture2DArrayMaxLayerCount:e.maxTextureArrayLayers,minUniformBufferOffsetAlignment:e.minUniformBufferOffsetAlignment,maxUniformBufferBindingSize:e.maxUniformBufferBindingSize},this._caps.parallelShaderCompile=null,this._features={forceBitmapOverHTMLImageElement:!0,supportRenderAndCopyToLodForFloatTextures:!0,supportDepthStencilTexture:!0,supportShadowSamplers:!0,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:!0,trackUbosInFrame:!0,checkUbosContentBeforeUpload:!0,supportCSM:!0,basisNeedsPOT:!1,support3DTextures:!0,needTypeSuffixInShaderConstants:!0,supportMSAA:!0,supportSSAO2:!0,supportExtendedTextureFormats:!0,supportSwitchCaseInShader:!0,supportSyncTextureRead:!1,needsInvertingBitmap:!1,useUBOBindingCache:!1,needShaderCodeInlining:!0,needToAlwaysBindUniformBuffers:!0,supportRenderPasses:!0,_collectUbosUpdatedInFrame:!1}},Qk.prototype._initializeContextAndSwapChain=function(){this._context=this._canvas.getContext("webgpu"),this._configureContext(),this._colorFormat=this._options.swapChainFormat,this._mainRenderPassWrapper.colorAttachmentGPUTextures=[new FL],this._mainRenderPassWrapper.colorAttachmentGPUTextures[0].format=this._colorFormat},Qk.prototype._initializeMainAttachments=function(e){var t;void 0===e&&(e=!1),this._mainTextureExtends={width:this.getRenderWidth(e),height:this.getRenderHeight(e),depthOrArrayLayers:1};var r,n=new Float32Array([this.getRenderHeight()]);if(this._bufferManager.setSubData(this._ubInvertY,4,n),this._bufferManager.setSubData(this._ubDontInvertY,4,n),this._options.antialiasing){var i={size:this._mainTextureExtends,mipLevelCount:1,sampleCount:this._mainPassSampleCount,dimension:_N.TextureDimension.E2d,format:this._options.swapChainFormat,usage:_N.TextureUsage.RenderAttachment};null===(t=this._mainTexture)||void 0===t||t.destroy(),this._mainTexture=this._device.createTexture(i),r=[{view:this._mainTexture.createView(),clearValue:new hA(0,0,0,1),loadOp:_N.LoadOp.Clear,storeOp:_N.StoreOp.Store}]}else r=[{view:void 0,clearValue:new hA(0,0,0,1),loadOp:_N.LoadOp.Clear,storeOp:_N.StoreOp.Store}];this._mainRenderPassWrapper.depthTextureFormat=this.isStencilEnable?_N.TextureFormat.Depth24PlusStencil8:_N.TextureFormat.Depth32Float,this._setDepthTextureFormat(this._mainRenderPassWrapper);var o={size:this._mainTextureExtends,mipLevelCount:1,sampleCount:this._mainPassSampleCount,dimension:_N.TextureDimension.E2d,format:this._mainRenderPassWrapper.depthTextureFormat,usage:_N.TextureUsage.RenderAttachment};this._depthTexture&&this._depthTexture.destroy(),this._depthTexture=this._device.createTexture(o);var s={view:this._depthTexture.createView(),depthClearValue:this._clearDepthValue,depthLoadOp:_N.LoadOp.Clear,depthStoreOp:_N.StoreOp.Store,stencilClearValue:this._clearStencilValue,stencilLoadOp:this.isStencilEnable?_N.LoadOp.Clear:void 0,stencilStoreOp:this.isStencilEnable?_N.StoreOp.Store:void 0};this._mainRenderPassWrapper.renderPassDescriptor={colorAttachments:r,depthStencilAttachment:s},null!==this._mainRenderPassWrapper.renderPass&&this._endMainRenderPass()},Qk.prototype._configureContext=function(){this._context.configure({device:this._device,format:this._options.swapChainFormat,usage:_N.TextureUsage.RenderAttachment|_N.TextureUsage.CopySrc,alphaMode:this.premultipliedAlpha?_N.CanvasCompositingAlphaMode.Premultiplied:_N.CanvasCompositingAlphaMode.Opaque})},Qk.prototype.setSize=function(e,t,r){return void 0===r&&(r=!1),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - setSize called -",e,t)),this._initializeMainAttachments(r),this.snapshotRendering&&this.snapshotRenderingReset(),!0},Qk.prototype._getShaderProcessor=function(e){return e===vU.WGSL?this._shaderProcessorWGSL:this._shaderProcessor},Qk.prototype._getShaderProcessingContext=function(e){return new RG(e)},Qk.prototype.applyStates=function(){this._stencilStateComposer.apply(),this._cacheRenderPipeline.setAlphaBlendEnabled(this._alphaState.alphaBlend)},Qk.prototype.wipeCaches=function(e){this.preventCacheWipeBetweenFrames&&!e||(this._forceEnableEffect=!0,this._currentIndexBuffer=null,this._currentOverrideVertexBuffers=null,this._cacheRenderPipeline.setBuffers(null,null,null),e&&(this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=Qd.LEQUAL,this._alphaState.reset(),this._alphaMode=Qd.ALPHA_ADD,this._alphaEquation=Qd.ALPHA_DISABLE,this._cacheRenderPipeline.setAlphaBlendFactors(this._alphaState._blendFunctionParameters,this._alphaState._blendEquationParameters),this._cacheRenderPipeline.setAlphaBlendEnabled(!1),this.setColorWrite(!0)),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null)},Qk.prototype.setColorWrite=function(e){this._colorWriteLocal=e,this._cacheRenderPipeline.setWriteMask(e?15:0)},Qk.prototype.getColorWrite=function(){return this._colorWriteLocal},Qk.prototype._resetCurrentViewport=function(e){this._viewportsCurrent[e].x=0,this._viewportsCurrent[e].y=0,this._viewportsCurrent[e].w=0,this._viewportsCurrent[e].h=0,1===e&&(this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0)},Qk.prototype._mustUpdateViewport=function(e){var t=e===this._mainRenderPassWrapper.renderPass?0:1,r=this._viewportCached.x,n=this._viewportCached.y,i=this._viewportCached.z,o=this._viewportCached.w,s=this._viewportsCurrent[t].x!==r||this._viewportsCurrent[t].y!==n||this._viewportsCurrent[t].w!==i||this._viewportsCurrent[t].h!==o;return s&&(this._viewportsCurrent[t].x=this._viewportCached.x,this._viewportsCurrent[t].y=this._viewportCached.y,this._viewportsCurrent[t].w=this._viewportCached.z,this._viewportsCurrent[t].h=this._viewportCached.w),s},Qk.prototype._applyViewport=function(e){var t=Math.floor(this._viewportCached.y),r=Math.floor(this._viewportCached.w);!this._currentRenderTarget&&(t=this.getRenderHeight()-t-r),e.setViewport(Math.floor(this._viewportCached.x),t,Math.floor(this._viewportCached.z),r,0,1),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - viewport applied - (",this._viewportCached.x,this._viewportCached.y,this._viewportCached.z,this._viewportCached.w,") current pass is main pass="+(e===this._mainRenderPassWrapper.renderPass)))},Qk.prototype._viewport=function(e,t,r,n){this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=r,this._viewportCached.w=n},Qk.prototype._resetCurrentScissor=function(e){this._scissorsCurrent[e].x=0,this._scissorsCurrent[e].y=0,this._scissorsCurrent[e].w=0,this._scissorsCurrent[e].h=0},Qk.prototype._mustUpdateScissor=function(e){var t=e===this._mainRenderPassWrapper.renderPass?0:1,r=this._scissorCached.x,n=this._scissorCached.y,i=this._scissorCached.z,o=this._scissorCached.w,s=this._scissorsCurrent[t].x!==r||this._scissorsCurrent[t].y!==n||this._scissorsCurrent[t].w!==i||this._scissorsCurrent[t].h!==o;return s&&(this._scissorsCurrent[t].x=this._scissorCached.x,this._scissorsCurrent[t].y=this._scissorCached.y,this._scissorsCurrent[t].w=this._scissorCached.z,this._scissorsCurrent[t].h=this._scissorCached.w),s},Qk.prototype._applyScissor=function(e){e.setScissorRect(this._scissorCached.x,this._currentRenderTarget?this._scissorCached.y:this.getRenderHeight()-this._scissorCached.w-this._scissorCached.y,this._scissorCached.z,this._scissorCached.w),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - scissor applied - (",this._scissorCached.x,this._scissorCached.y,this._scissorCached.z,this._scissorCached.w,") current pass is main pass="+(e===this._mainRenderPassWrapper.renderPass)))},Qk.prototype._scissorIsActive=function(){return 0!==this._scissorCached.x||0!==this._scissorCached.y||0!==this._scissorCached.z||0!==this._scissorCached.w},Qk.prototype.enableScissor=function(e,t,r,n){this._scissorCached.x=e,this._scissorCached.y=t,this._scissorCached.z=r,this._scissorCached.w=n},Qk.prototype.disableScissor=function(){this._scissorCached.x=0,this._scissorCached.y=0,this._scissorCached.z=0,this._scissorCached.w=0,this._resetCurrentScissor(0),this._resetCurrentScissor(1)},Qk.prototype._resetCurrentStencilRef=function(e){this._stencilRefsCurrent[e]=-1},Qk.prototype._mustUpdateStencilRef=function(e){var t=e===this._mainRenderPassWrapper.renderPass?0:1,r=this._stencilStateComposer.funcRef!==this._stencilRefsCurrent[t];return r&&(this._stencilRefsCurrent[t]=this._stencilStateComposer.funcRef),r},Qk.prototype._applyStencilRef=function(e){var t;e.setStencilReference(null!==(t=this._stencilStateComposer.funcRef)&&void 0!==t?t:0)},Qk.prototype._resetCurrentColorBlend=function(e){this._blendColorsCurrent[e][0]=this._blendColorsCurrent[e][1]=this._blendColorsCurrent[e][2]=this._blendColorsCurrent[e][3]=null},Qk.prototype._mustUpdateBlendColor=function(e){var t=e===this._mainRenderPassWrapper.renderPass?0:1,r=this._alphaState._blendConstants,n=r[0]!==this._blendColorsCurrent[t][0]||r[1]!==this._blendColorsCurrent[t][1]||r[2]!==this._blendColorsCurrent[t][2]||r[3]!==this._blendColorsCurrent[t][3];return n&&(this._blendColorsCurrent[t][0]=r[0],this._blendColorsCurrent[t][1]=r[1],this._blendColorsCurrent[t][2]=r[2],this._blendColorsCurrent[t][3]=r[3]),n},Qk.prototype._applyBlendColor=function(e){e.setBlendConstant(this._alphaState._blendConstants)},Qk.prototype.clear=function(e,t,r,n){void 0===n&&(n=!1),e&&void 0===e.a&&(e.a=1);var i=this._scissorIsActive();this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - clear called - backBuffer=",t," depth=",r," stencil=",n," scissor is active=",i)),this._currentRenderTarget?i?(!this._rttRenderPassWrapper.renderPass&&this._startRenderTargetRenderPass(this._currentRenderTarget,!1,t?e:null,r,n),this.compatibilityMode?this._applyScissor(this._currentRenderPass):this._bundleListRenderTarget.addItem(new nk(this._scissorCached.x,this._scissorCached.y,this._scissorCached.z,this._scissorCached.w)),this._clearFullQuad(t?e:null,r,n)):(this._currentRenderPass&&this._endRenderTargetRenderPass(),this._startRenderTargetRenderPass(this._currentRenderTarget,!0,t?e:null,r,n)):((!this._mainRenderPassWrapper.renderPass||!i)&&this._startMainRenderPass(!i,t?e:null,r,n),i&&(this.compatibilityMode?this._applyScissor(this._currentRenderPass):this._bundleList.addItem(new nk(this._scissorCached.x,this._scissorCached.y,this._scissorCached.z,this._scissorCached.w)),this._clearFullQuad(t?e:null,r,n)))},Qk.prototype._clearFullQuad=function(e,t,r){var n,i,o,s=this.compatibilityMode?this._getCurrentRenderPass():null,a=0===this._getCurrentRenderPassIndex()?this._bundleList:this._bundleListRenderTarget;this._clearQuad.setColorFormat(this._colorFormat),this._clearQuad.setDepthStencilFormat(this._depthTextureFormat),this._clearQuad.setMRTAttachments(null!==(n=this._cacheRenderPipeline.mrtAttachments)&&void 0!==n?n:[],null!==(i=this._cacheRenderPipeline.mrtTextureArray)&&void 0!==i?i:[],this._cacheRenderPipeline.mrtTextureCount),this.compatibilityMode?s.setStencilReference(this._clearStencilValue):a.addItem(new ik(this._clearStencilValue));var u=this._clearQuad.clear(s,e,t,r,this.currentSampleCount);this.compatibilityMode?this._applyStencilRef(s):(a.addBundle(u),a.addItem(new ik(null!==(o=this._stencilStateComposer.funcRef)&&void 0!==o?o:0)),this._reportDrawCall())},Qk.prototype.createVertexBuffer=function(e){var t;return t=e instanceof Array?new Float32Array(e):e instanceof ArrayBuffer?new Uint8Array(e):e,this._bufferManager.createBufferByMap(t,_N.BufferUsage.Vertex|_N.BufferUsage.CopyDst)},Qk.prototype.createDynamicVertexBuffer=function(e){return this.createVertexBuffer(e)},Qk.prototype.createIndexBuffer=function(e){var t,r=!0;e instanceof Uint32Array||e instanceof Int32Array?t=e:e instanceof Uint16Array?(t=e,r=!1):e.length>65535?t=new Uint32Array(e):(t=new Uint16Array(e),r=!1);var n=this._bufferManager.createBufferByMap(t,_N.BufferUsage.Index|_N.BufferUsage.CopyDst);return n.is32Bits=r,n},Qk.prototype._createBuffer=function(e,t){var r;r=e instanceof Array?new Float32Array(e):e instanceof ArrayBuffer?new Uint8Array(e):e;var n=0;return t&Qd.BUFFER_CREATIONFLAG_READ&&(n|=_N.BufferUsage.CopySrc),t&Qd.BUFFER_CREATIONFLAG_WRITE&&(n|=_N.BufferUsage.CopyDst),t&Qd.BUFFER_CREATIONFLAG_UNIFORM&&(n|=_N.BufferUsage.Uniform),t&Qd.BUFFER_CREATIONFLAG_VERTEX&&(n|=_N.BufferUsage.Vertex),t&Qd.BUFFER_CREATIONFLAG_INDEX&&(n|=_N.BufferUsage.Index),t&Qd.BUFFER_CREATIONFLAG_STORAGE&&(n|=_N.BufferUsage.Storage),this._bufferManager.createBuffer(r,n)},Qk.prototype.bindBuffersDirectly=function(){throw"Not implemented on WebGPU"},Qk.prototype.updateAndBindInstancesBuffer=function(){throw"Not implemented on WebGPU"},Qk.prototype.bindBuffers=function(e,t,r,n){this._currentIndexBuffer=t,this._currentOverrideVertexBuffers=null!=n?n:null,this._cacheRenderPipeline.setBuffers(e,t,this._currentOverrideVertexBuffers)},Qk.prototype._releaseBuffer=function(e){return this._bufferManager.releaseBuffer(e)},Qk.prototype.createEffect=function(e,t,r,n,i,o,s,a,u,c){var l;void 0===c&&(c=vU.GLSL);var h=e.vertexElement||e.vertex||e.vertexToken||e.vertexSource||e,p=e.fragmentElement||e.fragment||e.fragmentToken||e.fragmentSource||e,f=this._getGlobalDefines(),d=null!==(l=null!=i?i:t.defines)&&void 0!==l?l:"";f&&(d+="\n"+f);var A=h+"+"+p+"@"+d;if(this._compiledEffects[A]){var g=this._compiledEffects[A];return s&&g.isReady()&&s(g),g}var _=new lG(e,t,r,n,this,i,o,s,a,u,A,c);return this._compiledEffects[A]=_,_},Qk.prototype._compileRawShaderToSpirV=function(e,t){return this._glslang.compileGLSL(e,t)},Qk.prototype._compileShaderToSpirV=function(e,t,r,n){return this._compileRawShaderToSpirV(n+(r?r+"\n":"")+e,t)},Qk.prototype._getWGSLShader=function(e,t,r){return(r=r?"//"+r.split("\n").join("\n//")+"\n":"")+e},Qk.prototype._getCompiledShaderFromIndexDB=function(e,t,r){this.saveCompiledShaderInIndexDB&&e==vU.GLSL&&this._indexedDBScheduler?this._indexedDBScheduler.getElementFromDB(Qk.COMPILED_WGSL_TABLE_NAME,t).then((e=>{if(null!=e){var t=e[e.length-1],n=e.slice(0,t),i=e.slice(t,e.length-1);r(!0,n,i)}else console.log("shader text from indexDB is null."),r(!1,null,null)}),(e=>{r(!1,null,null)})):r(!1,null,null)},Qk.prototype._saveCompiledShaderToIndexDB=function(e,t,r){if(this._indexedDBScheduler&&this.saveCompiledShaderInIndexDB){var n=t.length+r.length,i=new Uint32Array(n+1);i.set(t,0),i.set(r,t.length),i[n]=t.length,this._indexedDBScheduler.putElementInDB(Qk.COMPILED_WGSL_TABLE_NAME,e,i)}},Qk.prototype._createPipelineStageDescriptor=function(e,t,r,n){return this._tintWASM&&n===vU.GLSL&&(t=this._tintWASM.convertSpirV2WGSL(t),r=this._tintWASM.convertSpirV2WGSL(r),t=t.replace(/type\s/g,"alias "),r=r.replace(/type\s/g,"alias ")),{vertexStage:{module:this._device.createShaderModule({code:t}),entryPoint:"main"},fragmentStage:{module:this._device.createShaderModule({code:r}),entryPoint:"main"}}},Qk.prototype._compileRawPipelineStageDescriptor=function(e,t,r,n){var i=n===vU.GLSL?this._compileRawShaderToSpirV(t,"vertex"):t,o=n===vU.GLSL?this._compileRawShaderToSpirV(r,"fragment"):r;return this._createPipelineStageDescriptor(e,i,o,n)},Qk.prototype._compilePipelineStageDescriptor=function(e,t,r,n,i){this.onBeforeShaderCompilationObservable.notifyObservers(this);var o="#version 450\n",s=i===vU.GLSL?this._compileShaderToSpirV(t,"vertex",n,o):this._getWGSLShader(t,"vertex",n),a=i===vU.GLSL?this._compileShaderToSpirV(r,"fragment",n,o):this._getWGSLShader(r,"fragment",n),u=this._createPipelineStageDescriptor(e,s,a,i);return this.onAfterShaderCompilationObservable.notifyObservers(this),u},Qk.prototype.createRawShaderProgram=function(){throw"Not available on WebGPU"},Qk.prototype.createShaderProgram=function(){throw"Not available on WebGPU"},Qk.prototype.inlineShaderCode=function(e){var t=new bk(e);return t.debug=!1,t.processCode(),t.code},Qk.prototype.createPipelineContext=function(e){return new CG(e,this)},Qk.prototype.createMaterialContext=function(){return new NQ},Qk.prototype.createDrawContext=function(){return new QQ(this._bufferManager)},Qk.prototype._preparePipelineContext=function(e,t,r,n,i,o,s,a,u,c,l){var h=e,p=l||h.shaderProcessingContext.shaderLanguage;this.dbgShowShaderCode&&(console.log(a),console.log(t),console.log(r)),h.sources={fragment:r,vertex:t,rawVertex:i,rawFragment:o};var f=e._name;h.stages=n?this._compileRawPipelineStageDescriptor(f,t,r,p):this._compilePipelineStageDescriptor(f,t,r,a,p)},Qk.prototype.getAttributes=function(e,t){for(var r=new Array(t.length),n=e,i=0;i<t.length;i++){var o=t[i],s=n.shaderProcessingContext.availableAttributes[o];void 0!==s&&(r[i]=s)}return r},Qk.prototype.enableEffect=function(e){if(e){var t=!0;if(SQ.IsWrapper(e)){if(!e.effect||e.effect===this._currentEffect&&e.materialContext===this._currentMaterialContext&&e.drawContext===this._currentDrawContext&&!this._forceEnableEffect){if(!e.effect&&this.dbgShowEmptyEnableEffectCalls)throw console.error("drawWrapper=",e),"Invalid call to enableEffect: the effect property is empty!";return}if(t=e.effect!==this._currentEffect,this._currentEffect=e.effect,this._currentMaterialContext=e.materialContext,this._currentDrawContext=e.drawContext,this._counters.numEnableDrawWrapper++,!this._currentMaterialContext)throw console.error("drawWrapper=",e),"Invalid call to enableEffect: the materialContext property is empty!"}else t=e!==this._currentEffect,this._currentEffect=e,this._currentMaterialContext=this._defaultMaterialContext,this._currentDrawContext=this._defaultDrawContext,this._counters.numEnableEffects++,this.dbgLogIfNotDrawWrapper&&aL.Warn("enableEffect has been called with an Effect and not a Wrapper! effect.uniqueId=".concat(e.uniqueId,", effect.name=").concat(e.name,", effect.name.vertex=").concat(e.name.vertex,", effect.name.fragment=").concat(e.name.fragment),10);this._stencilStateComposer.stencilMaterial=void 0,this._forceEnableEffect=!t&&!this._forceEnableEffect&&this._forceEnableEffect,t&&(this._currentEffect.onBind&&this._currentEffect.onBind(this._currentEffect),this._currentEffect._onBindObservable&&this._currentEffect._onBindObservable.notifyObservers(this._currentEffect))}},Qk.prototype._releaseEffect=function(e){this._compiledEffects[e._key]&&(delete this._compiledEffects[e._key],this._deletePipelineContext(e.getPipelineContext()))},Qk.prototype.releaseEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e].getPipelineContext();this._deletePipelineContext(t)}this._compiledEffects={}},Qk.prototype._deletePipelineContext=function(e){e&&e.dispose()},Object.defineProperty(Qk.prototype,"needPOTTextures",{get:function(){return!1},enumerable:!1,configurable:!0}),Qk.prototype._createHardwareTexture=function(){return new FL},Qk.prototype._releaseTexture=function(e){var t=this._internalTexturesCache.indexOf(e);-1!==t&&this._internalTexturesCache.splice(t,1),this._textureHelper.releaseTexture(e)},Qk.prototype._getRGBABufferInternalSizedFormat=function(){return Qd.TEXTUREFORMAT_RGBA},Qk.prototype.updateTextureComparisonFunction=function(e,t){e._comparisonFunction=t},Qk.prototype._createInternalTexture=function(e,t,r,n){var i,o,s;void 0===r&&(r=!0),void 0===n&&(n=BF.Unknown);var a={};void 0!==t&&"object"==typeof t?(a.generateMipMaps=t.generateMipMaps,a.type=void 0===t.type?Qd.TEXTURETYPE_UNSIGNED_INT:t.type,a.samplingMode=void 0===t.samplingMode?Qd.TEXTURE_TRILINEAR_SAMPLINGMODE:t.samplingMode,a.format=void 0===t.format?Qd.TEXTUREFORMAT_RGBA:t.format,a.samples=null!==(i=t.samples)&&void 0!==i?i:1,a.creationFlags=null!==(o=t.creationFlags)&&void 0!==o?o:0,a.useSRGBBuffer=null!==(s=t.useSRGBBuffer)&&void 0!==s&&s):(a.generateMipMaps=t,a.type=Qd.TEXTURETYPE_UNSIGNED_INT,a.samplingMode=Qd.TEXTURE_TRILINEAR_SAMPLINGMODE,a.format=Qd.TEXTUREFORMAT_RGBA,a.samples=1,a.creationFlags=0,a.useSRGBBuffer=!1),a.type!==Qd.TEXTURETYPE_FLOAT||this._caps.textureFloatLinearFiltering?a.type===Qd.TEXTURETYPE_HALF_FLOAT&&!this._caps.textureHalfFloatLinearFiltering&&(a.samplingMode=Qd.TEXTURE_NEAREST_SAMPLINGMODE):a.samplingMode=Qd.TEXTURE_NEAREST_SAMPLINGMODE,a.type===Qd.TEXTURETYPE_FLOAT&&!this._caps.textureFloat&&(a.type=Qd.TEXTURETYPE_UNSIGNED_INT,aL.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));var u=new OF(this,n),c=e.width||e,l=e.height||e,h=e.layers||0;return u.baseWidth=c,u.baseHeight=l,u.width=c,u.height=l,u.depth=h,u.isReady=!0,u.samples=a.samples,u.generateMipMaps=!!a.generateMipMaps,u.samplingMode=a.samplingMode,u.type=a.type,u.format=a.format,u.is2DArray=h>0,u._cachedWrapU=Qd.TEXTURE_CLAMP_ADDRESSMODE,u._cachedWrapV=Qd.TEXTURE_CLAMP_ADDRESSMODE,u._useSRGBBuffer=a.useSRGBBuffer,this._internalTexturesCache.push(u),!r&&this._textureHelper.createGPUTextureForInternalTexture(u,c,l,h||1,a.creationFlags),u},Qk.prototype.createTexture=function(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d){var A=this;return void 0===i&&(i=Qd.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===c&&(c=null),void 0===l&&(l=null),this._createTextureBase(e,t,r,n,i,o,s,(function(e,t,r,n,i,o,s,a){var u,l=n;if(e.baseWidth=l.width,e.baseHeight=l.height,e.width=l.width,e.height=l.height,e.format=null!=c?c:-1,a(e.width,e.height,l,t,e,(function(){})),null===(u=e._hardwareTexture)||void 0===u?void 0:u.underlyingResource)!o&&!s&&A._generateMipmaps(e,A._uploadEncoder);else{var h=A._textureHelper.createGPUTextureForInternalTexture(e,l.width,l.height,void 0,f);gz.IsImageBitmap(l)&&(A._textureHelper.updateTexture(l,e,l.width,l.height,e.depth,h.format,0,0,i,!1,0,0),!o&&!s&&A._generateMipmaps(e,A._uploadEncoder))}r&&r._removePendingData(e),e.isReady=!0,e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}),(function(){return!1}),a,u,c,l,h,p,d)},Qk.prototype.wrapWebGPUTexture=function(e){var t=new FL(e),r=new OF(this,BF.Unknown,!0);return r._hardwareTexture=t,r.isReady=!0,r},Qk.prototype.wrapWebGLTexture=function(){throw new Error("wrapWebGLTexture is not supported, use wrapWebGPUTexture instead.")},Qk.prototype.generateMipMapsForCubemap=function(e){var t;e.generateMipMaps&&(!(null===(t=e._hardwareTexture)||void 0===t?void 0:t.underlyingResource)&&this._textureHelper.createGPUTextureForInternalTexture(e),this._generateMipmaps(e,e.source===BF.RenderTarget||e.source===BF.MultiRenderTarget?this._renderTargetEncoder:void 0))},Qk.prototype.updateTextureSamplingMode=function(e,t,r){void 0===r&&(r=!1),r&&(t.generateMipMaps=!0,this._generateMipmaps(t)),t.samplingMode=e},Qk.prototype.updateTextureWrappingMode=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null),null!==t&&(e._cachedWrapU=t),null!==r&&(e._cachedWrapV=r),(e.is2DArray||e.is3D)&&null!==n&&(e._cachedWrapR=n)},Qk.prototype.updateTextureDimensions=function(e,t,r,n){if(void 0===n&&(n=1),e._hardwareTexture&&(e.width!==t||e.height!==r||e.depth!==n)){var i=e._hardwareTexture.textureAdditionalUsages;e._hardwareTexture.release(),this._textureHelper.createGPUTextureForInternalTexture(e,t,r,n,i)}},Qk.prototype._setInternalTexture=function(e,t,r){if(r=null!=r?r:e,this._currentEffect){var n=this._currentEffect._pipelineContext.shaderProcessingContext.availableTextures[r];if(this._currentMaterialContext.setTexture(e,t),n&&n.autoBindSampler){var i=r+mG.AutoSamplerSuffix;this._currentMaterialContext.setSampler(i,t)}}},Qk.prototype.setTexture=function(e,t,r,n){this._setTexture(e,r,!1,!1,n,n)},Qk.prototype.setTextureArray=function(e,t,r,n){for(var i=0;i<r.length;i++)this._setTexture(-1,r[i],!0,!1,n+i.toString(),n)},Qk.prototype._setTexture=function(e,t,r,n,i,o){if(void 0===n&&(n=!1),void 0===i&&(i=""),o=null!=o?o:i,this._currentEffect){if(!t)return this._currentMaterialContext.setTexture(i,null),!1;if(t.video)t.update();else if(t.delayLoadState===Qd.DELAYLOADSTATE_NOTLOADED)return t.delayLoad(),!1;var s=null;if((s=n?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture)&&!s.isMultiview){if(s.isCube&&s._cachedCoordinatesMode!==t.coordinatesMode){s._cachedCoordinatesMode=t.coordinatesMode;var a=t.coordinatesMode!==Qd.TEXTURE_CUBIC_MODE&&t.coordinatesMode!==Qd.TEXTURE_SKYBOX_MODE?Qd.TEXTURE_WRAP_ADDRESSMODE:Qd.TEXTURE_CLAMP_ADDRESSMODE;t.wrapU=a,t.wrapV=a}s._cachedWrapU=t.wrapU,s._cachedWrapV=t.wrapV,s.is3D&&(s._cachedWrapR=t.wrapR),this._setAnisotropicLevel(0,s,t.anisotropicFilteringLevel)}this._setInternalTexture(i,s,o)}else this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - _setTexture called with a null _currentEffect! texture=",t));return!0},Qk.prototype._setAnisotropicLevel=function(e,t,r){t._cachedAnisotropicFilteringLevel!==r&&(t._cachedAnisotropicFilteringLevel=Math.min(r,this._caps.maxAnisotropy))},Qk.prototype._bindTexture=function(e,t,r){void 0!==e&&this._setInternalTexture(r,t)},Qk.prototype.generateMipmaps=function(e){this._generateMipmaps(e,this._renderTargetEncoder)},Qk.prototype._generateMipmaps=function(e,t){var r=e._hardwareTexture;if(r){t=null!=t?t:this._currentRenderTarget&&!this._currentRenderPass?this._renderTargetEncoder:this._currentRenderPass?this._uploadEncoder:this._renderEncoder;var n=e._hardwareTexture.format,i=gz.ComputeNumMipmapLevels(e.width,e.height);this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - generate mipmaps called - width=",e.width,"height=",e.height,"isCube=",e.isCube)),e.isCube?this._textureHelper.generateCubeMipmaps(r,n,i,t):this._textureHelper.generateMipmaps(r,n,i,0,t)}},Qk.prototype.updateTextureData=function(e,t,r,n,i,o,s,a,u){var c;void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=!1);var l=e._hardwareTexture;!(null===(c=e._hardwareTexture)||void 0===c?void 0:c.underlyingResource)&&(l=this._textureHelper.createGPUTextureForInternalTexture(e));var h=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);this._textureHelper.updateTexture(h,e,i,o,e.depth,l.format,s,a,e.invertY,!1,r,n),u&&this._generateMipmaps(e,this._renderTargetEncoder)},Qk.prototype._uploadCompressedDataToTextureDirectly=function(e,t,r,n,i,o,s){var a;void 0===o&&(o=0),void 0===s&&(s=0);var u=e._hardwareTexture;!(null===(a=e._hardwareTexture)||void 0===a?void 0:a.underlyingResource)&&(e.format=t,u=this._textureHelper.createGPUTextureForInternalTexture(e,r,n));var c=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);this._textureHelper.updateTexture(c,e,r,n,e.depth,u.format,o,s,!1,!1,0,0)},Qk.prototype._uploadDataToTextureDirectly=function(e,t,r,n,i,o){var s;void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=!1);var a=Math.round(Math.log(e.width)*Math.LOG2E),u=Math.round(Math.log(e.height)*Math.LOG2E),c=o?e.width:Math.pow(2,Math.max(a-n,0)),l=o?e.height:Math.pow(2,Math.max(u-n,0)),h=e._hardwareTexture;!(null===(s=e._hardwareTexture)||void 0===s?void 0:s.underlyingResource)&&(h=this._textureHelper.createGPUTextureForInternalTexture(e,c,l));var p=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);this._textureHelper.updateTexture(p,e,c,l,e.depth,h.format,r,n,e.invertY,!1,0,0)},Qk.prototype._uploadArrayBufferViewToTexture=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this._uploadDataToTextureDirectly(e,t,r,n)},Qk.prototype._uploadImageToTexture=function(e,t,r,n){var i;void 0===r&&(r=0),void 0===n&&(n=0);var o=e._hardwareTexture;!(null===(i=e._hardwareTexture)||void 0===i?void 0:i.underlyingResource)&&(o=this._textureHelper.createGPUTextureForInternalTexture(e));var s=t,a=Math.ceil(e.width/(1<<n)),u=Math.ceil(e.height/(1<<n));this._textureHelper.updateTexture(s,e,a,u,e.depth,o.format,r,n,e.invertY,!1,0,0)},Qk.prototype.readPixels=function(e,t,r,n,i,o){void 0===o&&(o=!0);var s=(this._rttRenderPassWrapper.renderPass?this._rttRenderPassWrapper:this._mainRenderPassWrapper).colorAttachmentGPUTextures[0];if(!s)return Promise.resolve(new Uint8Array(0));var a=s.underlyingResource,u=s.format;return a?(o&&this.flushFramebuffer(),this._textureHelper.readPixels(a,e,t,r,n,u)):Promise.resolve(new Uint8Array(0))},Qk.prototype.beginFrame=function(){sG.prototype.beginFrame.call(this)},Qk.prototype.endFrame=function(){if(this._snapshotRendering.endFrame(this._mainRenderPassWrapper.renderPass),this._endMainRenderPass(),this._timestampQuery.endFrame(this._renderEncoder),this.flushFramebuffer(!1),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - counters")),this._textureHelper.destroyDeferredTextures(),this._bufferManager.destroyDeferredBuffers(),this._features._collectUbosUpdatedInFrame){if(this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),!this._count||this._count<this.dbgVerboseLogsNumFrames)){var e=[];for(var t in dG._UpdatedUbosInFrame)e.push(t+":"+dG._UpdatedUbosInFrame[t]);console.log("frame #"+this._count+" - updated ubos -",e.join(", "))}dG._UpdatedUbosInFrame={}}this.countersLastFrame.numEnableEffects=this._counters.numEnableEffects,this.countersLastFrame.numEnableDrawWrapper=this._counters.numEnableDrawWrapper,this.countersLastFrame.numBundleCreationNonCompatMode=this._counters.numBundleCreationNonCompatMode,this.countersLastFrame.numBundleReuseNonCompatMode=this._counters.numBundleReuseNonCompatMode,this._counters.numEnableEffects=0,this._counters.numEnableDrawWrapper=0,this._counters.numBundleCreationNonCompatMode=0,this._counters.numBundleReuseNonCompatMode=0,this._cacheRenderPipeline.endFrame(),this._cacheBindGroups.endFrame(),this._pendingDebugCommands.length=0,sG.prototype.endFrame.call(this),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),this._count<this.dbgVerboseLogsNumFrames&&console.log("%c frame #"+this._count+" - end","background: #ffff00"),this._count<this.dbgVerboseLogsNumFrames&&(this._count++,this._count!==this.dbgVerboseLogsNumFrames&&console.log("%c frame #"+this._count+" - begin","background: #ffff00")))},Qk.prototype.flushFramebuffer=function(e){void 0===e&&(e=!0);var t=!this._currentRenderPass,r=0;this._currentRenderPass&&this._currentRenderTarget&&(r|=1,this._endRenderTargetRenderPass()),this._mainRenderPassWrapper.renderPass&&(r|=2,this._endMainRenderPass()),this._commandBuffers[0]=this._uploadEncoder.finish(),this._commandBuffers[1]=this._renderTargetEncoder.finish(),this._commandBuffers[2]=this._renderEncoder.finish(),this._device.queue.submit(this._commandBuffers),this._uploadEncoder=this._device.createCommandEncoder(this._uploadEncoderDescriptor),this._renderEncoder=this._device.createCommandEncoder(this._renderEncoderDescriptor),this._renderTargetEncoder=this._device.createCommandEncoder(this._renderTargetEncoderDescriptor),this._timestampQuery.startFrame(this._uploadEncoder),this._textureHelper.setCommandEncoder(this._uploadEncoder),this._bundleList.reset(),this._bundleListRenderTarget.reset(),e&&(2&r&&this._startMainRenderPass(!1),1&r&&this._startRenderTargetRenderPass(this._currentRenderTarget,!1,null,!1,!1),t&&this._currentRenderTarget&&(this._currentRenderPass=null))},Qk.prototype._currentFrameBufferIsDefaultFrameBuffer=function(){return null===this._currentRenderTarget},Qk.prototype._startRenderTargetRenderPass=function(e,t,r,n,i){var o,s,a,u=e,c=u._depthStencilTexture,l=null==c?void 0:c._hardwareTexture,h=null==l?void 0:l.underlyingResource,p=null==l?void 0:l.msaaTexture,f=null==h?void 0:h.createView(this._rttRenderPassWrapper.depthAttachmentViewDescriptor),d=null==p?void 0:p.createView(this._rttRenderPassWrapper.depthAttachmentViewDescriptor),A=!!l&&gz.HasStencilAspect(l.format),g=[];this.useReverseDepthBuffer&&this.setDepthFunctionToGreaterOrEqual();var _=t&&r,m=t&&n,y=t&&i;if(u._attachments&&u.isMulti){(!this._mrtAttachments||0===this._mrtAttachments.length)&&(this._mrtAttachments=u._defaultAttachments);for(var E=0;E<this._mrtAttachments.length;++E){var x=this._mrtAttachments[E],C=u.textures[E],b=null==C?void 0:C._hardwareTexture,I=null==b?void 0:b.underlyingResource;if(b&&I){var v=go(this._rttRenderPassWrapper.colorAttachmentViewDescriptor,{format:b.format}),T=b.msaaTexture,R=I.createView(v),S=null==T?void 0:T.createView(v);g.push({view:S||R,resolveTarget:T?R:void 0,clearValue:0!==x&&_?r:void 0,loadOp:0!==x&&_?_N.LoadOp.Clear:_N.LoadOp.Load,storeOp:_N.StoreOp.Store})}}this._cacheRenderPipeline.setMRT(u.textures,this._mrtAttachments.length),this._cacheRenderPipeline.setMRTAttachments(this._mrtAttachments)}else{if(B=u.texture){var M=B._hardwareTexture,w=M.underlyingResource;T=M.msaaTexture,R=w.createView(this._rttRenderPassWrapper.colorAttachmentViewDescriptor),S=null==T?void 0:T.createView(this._rttRenderPassWrapper.colorAttachmentViewDescriptor);g.push({view:S||R,resolveTarget:T?R:void 0,clearValue:_?r:void 0,loadOp:_?_N.LoadOp.Clear:_N.LoadOp.Load,storeOp:_N.StoreOp.Store})}else g.push(null)}if(null===(o=this._debugPushGroup)||void 0===o||o.call(this,"render target pass",1),this._rttRenderPassWrapper.renderPassDescriptor={colorAttachments:g,depthStencilAttachment:c&&h?{view:d||f,depthClearValue:m?this.useReverseDepthBuffer?this._clearReverseDepthValue:this._clearDepthValue:void 0,depthLoadOp:m?_N.LoadOp.Clear:_N.LoadOp.Load,depthStoreOp:_N.StoreOp.Store,stencilClearValue:u._depthStencilTextureWithStencil&&y?this._clearStencilValue:void 0,stencilLoadOp:A?u._depthStencilTextureWithStencil&&y?_N.LoadOp.Clear:_N.LoadOp.Load:void 0,stencilStoreOp:A?_N.StoreOp.Store:void 0}:void 0,occlusionQuerySet:(null===(s=this._occlusionQuery)||void 0===s?void 0:s.hasQueries)?this._occlusionQuery.querySet:void 0},this._rttRenderPassWrapper.renderPass=this._renderTargetEncoder.beginRenderPass(this._rttRenderPassWrapper.renderPassDescriptor),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),!this._count||this._count<this.dbgVerboseLogsNumFrames)){var B=u.texture;console.log("frame #"+this._count+" - render target begin pass - internalTexture.uniqueId=",B.uniqueId,"width=",B.width,"height=",B.height,this._rttRenderPassWrapper.renderPassDescriptor)}this._currentRenderPass=this._rttRenderPassWrapper.renderPass,null===(a=this._debugFlushPendingCommands)||void 0===a||a.call(this),(!l||!gz.HasStencilAspect(l.format))&&(this._stencilStateComposer.enabled=!1)},Qk.prototype._endRenderTargetRenderPass=function(){var e,t,r,n;if(this._currentRenderPass){var i=null===(e=this._currentRenderTarget.texture)||void 0===e?void 0:e._hardwareTexture;i&&!this._snapshotRendering.endRenderTargetPass(this._currentRenderPass,i)&&!this.compatibilityMode&&(this._bundleListRenderTarget.run(this._currentRenderPass),this._bundleListRenderTarget.reset()),this._currentRenderPass.end(),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - render target end pass - internalTexture.uniqueId=",null===(r=null===(t=this._currentRenderTarget)||void 0===t?void 0:t.texture)||void 0===r?void 0:r.uniqueId)),null===(n=this._debugPopGroup)||void 0===n||n.call(this,1),this._resetCurrentViewport(1),this._resetCurrentScissor(1),this._resetCurrentStencilRef(1),this._resetCurrentColorBlend(1),this._currentRenderPass=null,this._rttRenderPassWrapper.reset()}},Qk.prototype._getCurrentRenderPass=function(){return this._currentRenderTarget&&!this._currentRenderPass?this._startRenderTargetRenderPass(this._currentRenderTarget,!1,null,!1,!1):!this._currentRenderPass&&this._startMainRenderPass(!1),this._currentRenderPass},Qk.prototype._getCurrentRenderPassIndex=function(){return null===this._currentRenderPass?-1:this._currentRenderPass===this._mainRenderPassWrapper.renderPass?0:1},Qk.prototype._startMainRenderPass=function(e,t,r,n){var i,o,s;this._mainRenderPassWrapper.renderPass&&this._endMainRenderPass(),this.useReverseDepthBuffer&&this.setDepthFunctionToGreaterOrEqual();var a=e&&t,u=e&&r,c=e&&n;this._mainRenderPassWrapper.renderPassDescriptor.colorAttachments[0].clearValue=a?t:void 0,this._mainRenderPassWrapper.renderPassDescriptor.colorAttachments[0].loadOp=a?_N.LoadOp.Clear:_N.LoadOp.Load,this._mainRenderPassWrapper.renderPassDescriptor.depthStencilAttachment.depthClearValue=u?this.useReverseDepthBuffer?this._clearReverseDepthValue:this._clearDepthValue:void 0,this._mainRenderPassWrapper.renderPassDescriptor.depthStencilAttachment.depthLoadOp=u?_N.LoadOp.Clear:_N.LoadOp.Load,this._mainRenderPassWrapper.renderPassDescriptor.depthStencilAttachment.stencilClearValue=c?this._clearStencilValue:void 0,this._mainRenderPassWrapper.renderPassDescriptor.depthStencilAttachment.stencilLoadOp=this.isStencilEnable?c?_N.LoadOp.Clear:_N.LoadOp.Load:void 0,this._mainRenderPassWrapper.renderPassDescriptor.occlusionQuerySet=(null===(i=this._occlusionQuery)||void 0===i?void 0:i.hasQueries)?this._occlusionQuery.querySet:void 0,this._swapChainTexture=this._context.getCurrentTexture(),this._mainRenderPassWrapper.colorAttachmentGPUTextures[0].set(this._swapChainTexture),this._options.antialiasing?this._mainRenderPassWrapper.renderPassDescriptor.colorAttachments[0].resolveTarget=this._swapChainTexture.createView():this._mainRenderPassWrapper.renderPassDescriptor.colorAttachments[0].view=this._swapChainTexture.createView(),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - main begin pass - texture width="+this._mainTextureExtends.width," height="+this._mainTextureExtends.height,this._mainRenderPassWrapper.renderPassDescriptor)),null===(o=this._debugPushGroup)||void 0===o||o.call(this,"main pass",0),this._currentRenderPass=this._renderEncoder.beginRenderPass(this._mainRenderPassWrapper.renderPassDescriptor),this._mainRenderPassWrapper.renderPass=this._currentRenderPass,null===(s=this._debugFlushPendingCommands)||void 0===s||s.call(this),this._resetCurrentViewport(0),this._resetCurrentScissor(0),this._resetCurrentStencilRef(0),this._resetCurrentColorBlend(0),!this._isStencilEnable&&(this._stencilStateComposer.enabled=!1)},Qk.prototype._endMainRenderPass=function(){var e;null!==this._mainRenderPassWrapper.renderPass&&(this._snapshotRendering.endMainRenderPass(),!this.compatibilityMode&&!this._snapshotRendering.play&&(this._bundleList.run(this._mainRenderPassWrapper.renderPass),this._bundleList.reset()),this._mainRenderPassWrapper.renderPass.end(),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - main end pass")),null===(e=this._debugPopGroup)||void 0===e||e.call(this,0),this._resetCurrentViewport(0),this._resetCurrentScissor(0),this._resetCurrentStencilRef(0),this._resetCurrentColorBlend(0),this._mainRenderPassWrapper.renderPass===this._currentRenderPass&&(this._currentRenderPass=null),this._mainRenderPassWrapper.reset(!1))},Qk.prototype.bindFramebuffer=function(e,t,r,n,i,o,s,a){var u,c;void 0===t&&(t=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0);var l=null===(u=e.texture)||void 0===u?void 0:u._hardwareTexture;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,l&&(l._currentLayer=e.isCube?6*s+t:s),this._rttRenderPassWrapper.colorAttachmentGPUTextures[0]=l,this._rttRenderPassWrapper.depthTextureFormat=this._currentRenderTarget._depthStencilTexture?gz.GetWebGPUTextureFormat(-1,this._currentRenderTarget._depthStencilTexture.format):void 0,this._setDepthTextureFormat(this._rttRenderPassWrapper),this._setColorFormat(this._rttRenderPassWrapper),this._rttRenderPassWrapper.colorAttachmentViewDescriptor={format:this._colorFormat,dimension:_N.TextureViewDimension.E2d,mipLevelCount:1,baseArrayLayer:e.isCube?6*s+t:s,baseMipLevel:o,arrayLayerCount:1,aspect:_N.TextureAspect.All},this._rttRenderPassWrapper.depthAttachmentViewDescriptor={format:this._depthTextureFormat,dimension:_N.TextureViewDimension.E2d,mipLevelCount:1,baseArrayLayer:e.isCube?6*a+t:a,baseMipLevel:0,arrayLayerCount:1,aspect:_N.TextureAspect.All},this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - bindFramebuffer called - internalTexture.uniqueId=",null===(c=e.texture)||void 0===c?void 0:c.uniqueId,"face=",t,"lodLevel=",o,"layer=",s,this._rttRenderPassWrapper.colorAttachmentViewDescriptor,this._rttRenderPassWrapper.depthAttachmentViewDescriptor)),this._currentRenderPass=null,this.snapshotRendering&&this.snapshotRenderingMode===Qd.SNAPSHOTRENDERING_FAST&&this._getCurrentRenderPass(),this._cachedViewport&&!i?this.setViewport(this._cachedViewport,r,n):(!r&&(r=e.width,o&&(r/=Math.pow(2,o))),!n&&(n=e.height,o&&(n/=Math.pow(2,o))),this._viewport(0,0,r,n)),this.wipeCaches()},Qk.prototype.unBindFramebuffer=function(e,t,r){var n,i;void 0===t&&(t=!1);var o=this._currentRenderTarget;this._currentRenderTarget=null,r&&r(),this._currentRenderTarget=o,this._currentRenderPass&&this._currentRenderPass!==this._mainRenderPassWrapper.renderPass&&this._endRenderTargetRenderPass(),(null===(n=e.texture)||void 0===n?void 0:n.generateMipMaps)&&!t&&!e.isCube&&this._generateMipmaps(e.texture),this._currentRenderTarget=null,this._onAfterUnbindFrameBufferObservable.notifyObservers(this),this.dbgVerboseLogsForFirstFrames&&(void 0===this._count&&(this._count=0),(!this._count||this._count<this.dbgVerboseLogsNumFrames)&&console.log("frame #"+this._count+" - unBindFramebuffer called - internalTexture.uniqueId=",null===(i=e.texture)||void 0===i?void 0:i.uniqueId)),this._mrtAttachments=[],this._cacheRenderPipeline.setMRT([]),this._cacheRenderPipeline.setMRTAttachments(this._mrtAttachments),this._currentRenderPass=this._mainRenderPassWrapper.renderPass,this._setDepthTextureFormat(this._mainRenderPassWrapper),this._setColorFormat(this._mainRenderPassWrapper)},Qk.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):(this._currentRenderPass=this._mainRenderPassWrapper.renderPass,this._setDepthTextureFormat(this._mainRenderPassWrapper),this._setColorFormat(this._mainRenderPassWrapper)),this._currentRenderPass&&this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()},Qk.prototype._setColorFormat=function(e){var t,r,n=null!==(r=null===(t=e.colorAttachmentGPUTextures[0])||void 0===t?void 0:t.format)&&void 0!==r?r:null;this._cacheRenderPipeline.setColorFormat(n),this._colorFormat!==n&&(this._colorFormat=n)},Qk.prototype._setDepthTextureFormat=function(e){this._cacheRenderPipeline.setDepthStencilFormat(e.depthTextureFormat),this._depthTextureFormat!==e.depthTextureFormat&&(this._depthTextureFormat=e.depthTextureFormat)},Qk.prototype.setDitheringState=function(){},Qk.prototype.setRasterizerState=function(){},Qk.prototype.setState=function(e,t,r,n,i,o,s){var a,u;void 0===t&&(t=0),void 0===n&&(n=!1),void 0===s&&(s=0),(this._depthCullingState.cull!==e||r)&&(this._depthCullingState.cull=e);var c=null===(u=null!==(a=this.cullBackFaces)&&void 0!==a?a:i)||void 0===u||u?1:2;(this._depthCullingState.cullFace!==c||r)&&(this._depthCullingState.cullFace=c),this.setZOffset(t),this.setZOffsetUnits(s);var l=n?this._currentRenderTarget?1:2:this._currentRenderTarget?2:1;(this._depthCullingState.frontFace!==l||r)&&(this._depthCullingState.frontFace=l),this._stencilStateComposer.stencilMaterial=o},Qk.prototype._applyRenderPassChanges=function(e,t){var r,n=this._mustUpdateViewport(e),i=this._mustUpdateScissor(e),o=!!this._stencilStateComposer.enabled&&this._mustUpdateStencilRef(e),s=!!this._alphaState.alphaBlend&&this._mustUpdateBlendColor(e);t?(n&&t.addItem(new rk(this._viewportCached.x,this._viewportCached.y,this._viewportCached.z,this._viewportCached.w)),i&&t.addItem(new nk(this._scissorCached.x,this._scissorCached.y,this._scissorCached.z,this._scissorCached.w)),o&&t.addItem(new ik(null!==(r=this._stencilStateComposer.funcRef)&&void 0!==r?r:0)),s&&t.addItem(new ok(this._alphaState._blendConstants.slice()))):(n&&this._applyViewport(e),i&&this._applyScissor(e),o&&this._applyStencilRef(e),s&&this._applyBlendColor(e))},Qk.prototype._draw=function(e,t,r,n,i,o){var s,a=this._getCurrentRenderPass(),u=0===this._getCurrentRenderPassIndex()?this._bundleList:this._bundleListRenderTarget;this.applyStates();var c=this._currentEffect._pipelineContext;if(this.bindUniformBufferBase(this._currentRenderTarget?this._ubInvertY:this._ubDontInvertY,0,mG.InternalsUBOName),c.uniformBuffer&&(c.uniformBuffer.update(),this.bindUniformBufferBase(c.uniformBuffer.getBuffer(),0,mG.LeftOvertUBOName)),this._snapshotRendering.play)this._reportDrawCall();else{var l;l=o?o.getActiveBundle():this._currentDrawContext.fastBundle,!this.compatibilityMode&&(this._currentDrawContext.isDirty(this._currentMaterialContext.updateId)||this._currentMaterialContext.isDirty||this._currentMaterialContext.forceBindGroupCreation)&&(this._currentDrawContext.fastBundle=void 0);var h=a;if(!this.compatibilityMode&&l||this._snapshotRendering.record){if(this._applyRenderPassChanges(a,u),!this._snapshotRendering.record)return this._counters.numBundleReuseNonCompatMode++,this._currentDrawContext.indirectDrawBuffer&&this._currentDrawContext.setIndirectData(n,i||1,r),u.addBundle(l),void this._reportDrawCall();h=u.getBundleEncoder(this._cacheRenderPipeline.colorFormats,this._depthTextureFormat,this.currentSampleCount),u.numDrawCalls++}var p=0;if(!this._caps.textureFloatLinearFiltering&&this._currentMaterialContext.hasFloatTextures)for(var f=1,d=0;d<c.shaderProcessingContext.textureNames.length;++d){var A=c.shaderProcessingContext.textureNames[d],g=null===(s=this._currentMaterialContext.textures[A])||void 0===s?void 0:s.texture;(null==g?void 0:g.type)===Qd.TEXTURETYPE_FLOAT&&(p|=f),f<<=1}var _,m=this._cacheRenderPipeline.getRenderPipeline(t,this._currentEffect,this.currentSampleCount,p);_=o.bindGroups?o.bindGroups:this._cacheBindGroups.getBindGroups(c,this._currentDrawContext,this._currentMaterialContext,o),!this._snapshotRendering.record&&(this._applyRenderPassChanges(a,this.compatibilityMode?null:u),!this.compatibilityMode&&(this._counters.numBundleCreationNonCompatMode++,h=this._device.createRenderBundleEncoder({colorFormats:this._cacheRenderPipeline.colorFormats,depthStencilFormat:this._depthTextureFormat,sampleCount:this.currentSampleCount}))),h.setPipeline(m),this._currentIndexBuffer&&h.setIndexBuffer(this._currentIndexBuffer.underlyingResource,this._currentIndexBuffer.is32Bits?_N.IndexFormat.Uint32:_N.IndexFormat.Uint16,0);for(var y=this._cacheRenderPipeline.vertexBuffers,E=0;E<y.length;E++){var x=y[E],C=x.getBuffer();C&&h.setVertexBuffer(E,C.underlyingResource,x._validOffsetRange?0:x.byteOffset)}for(d=0;d<_.length;d++)h.setBindGroup(d,_[d]);var b=!this.compatibilityMode&&!this._snapshotRendering.record;b&&this._currentDrawContext.indirectDrawBuffer?(this._currentDrawContext.setIndirectData(n,i||1,r),0===e?h.drawIndexedIndirect(this._currentDrawContext.indirectDrawBuffer,0):h.drawIndirect(this._currentDrawContext.indirectDrawBuffer,0)):0===e?h.drawIndexed(n,i||1,r,0,0):h.draw(n,i||1,r,0),b&&(this._currentDrawContext.fastBundle=h.finish(),u.addBundle(this._currentDrawContext.fastBundle),o.setFastBundle(this._currentDrawContext.fastBundle)),this._reportDrawCall()}},Qk.prototype.drawElementsType=function(e,t,r,n,i){void 0===n&&(n=1),this._draw(0,e,t,r,n,i)},Qk.prototype.drawArraysType=function(e,t,r,n,i){void 0===n&&(n=1),this._currentIndexBuffer=null,this._draw(1,e,t,r,n,i)},Qk.prototype.dispose=function(){var e,t,r;null===(e=this._mainTexture)||void 0===e||e.destroy(),null===(t=this._mainTextureLastCopy)||void 0===t||t.destroy(),null===(r=this._depthTexture)||void 0===r||r.destroy(),this._device.destroy(),sG.prototype.dispose.call(this)},Qk.prototype.getRenderWidth=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._canvas.width},Qk.prototype.getRenderHeight=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._canvas.height},Qk.prototype.getRenderingCanvas=function(){return this._canvas},Qk.prototype.getError=function(){return 0},Qk.prototype.bindSamplers=function(){},Qk.prototype._bindTextureDirectly=function(){return!1},Qk.prototype.areAllEffectsReady=function(){return!0},Qk.prototype._executeWhenRenderingStateIsCompiled=function(e,t){t()},Qk.prototype._isRenderingStateCompiled=function(){return!0},Qk.prototype._getUnpackAlignement=function(){return 1},Qk.prototype._unpackFlipY=function(){},Qk.prototype._bindUnboundFramebuffer=function(){throw"_bindUnboundFramebuffer is not implementedin WebGPU! You probably want to use restoreDefaultFramebuffer or unBindFramebuffer instead"},Qk.prototype._getSamplingParameters=function(){throw"_getSamplingParameters is not available in WebGPU"},Qk.prototype.getUniforms=function(){return[]},Qk.prototype.setIntArray=function(){return!1},Qk.prototype.setIntArray2=function(){return!1},Qk.prototype.setIntArray3=function(){return!1},Qk.prototype.setIntArray4=function(){return!1},Qk.prototype.setArray=function(){return!1},Qk.prototype.setArray2=function(){return!1},Qk.prototype.setArray3=function(){return!1},Qk.prototype.setArray4=function(){return!1},Qk.prototype.setMatrices=function(){return!1},Qk.prototype.setMatrix3x3=function(){return!1},Qk.prototype.setMatrix2x2=function(){return!1},Qk.prototype.setFloat=function(){return!1},Qk.prototype.setFloat2=function(){return!1},Qk.prototype.setFloat3=function(){return!1},Qk.prototype.setFloat4=function(){return!1},Qk._GLSLslangDefaultOptions={jsPath:"ThirdParty/glslang.js",wasmPath:"ThirdParty/glslang.wasm"},Qk.UseTWGSL=!0,Qk.COMPILED_WGSL_STORE_NAME="wgslStore",Qk.COMPILED_WGSL_TABLE_NAME="wgsl",function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));n(),e[e.Texture=0]="Texture",e[e.StorageTexture=1]="StorageTexture",e[e.UniformBuffer=2]="UniformBuffer",e[e.StorageBuffer=3]="StorageBuffer",e[e.TextureWithoutSampler=4]="TextureWithoutSampler",e[e.Sampler=5]="Sampler"}(Lk||(Lk={}));const kk=Lk;CL.prototype.createComputeEffect=function(e,t){throw new Error("createComputeEffect: This engine does not support compute shaders!")},CL.prototype.createComputePipelineContext=function(){throw new Error("createComputePipelineContext: This engine does not support compute shaders!")},CL.prototype.createComputeContext=function(){},CL.prototype.computeDispatch=function(e,t,r,n,i,o,s){throw new Error("computeDispatch: This engine does not support compute shaders!")},CL.prototype.areAllComputeEffectsReady=function(){return!0},CL.prototype.releaseComputeEffects=function(){},CL.prototype._prepareComputePipelineContext=function(e,t,r,n,i){},CL.prototype._rebuildComputeEffects=function(){},CL.prototype._executeWhenComputeStateIsCompiled=function(e,t){t()},CL.prototype._releaseComputeEffect=function(e){},CL.prototype._deleteComputePipelineContext=function(e){};var zk,jk=(zk=!0,function(e,t){var r=zk?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return zk=!1,r}),Hk=jk(void 0,(function(){return Hk.toString().search("(((.+)+)+)+$").toString().constructor(Hk).search("(((.+)+)+)+$")}));function qk(e,t){this._device=e,this._cacheSampler=t,this.uniqueId=qk._Counter++,this._bindGroupEntries=[],this.clear()}Hk(),qk.prototype.getBindGroups=function(e,t,r){if(!r)throw new Error("WebGPUComputeContext.getBindGroups: bindingsMapping is required until browsers support reflection for wgsl shaders!");if(0===this._bindGroups.length){var n=this._bindGroupEntries.length>0;for(var i in e){var o=e[i],s=r[i],a=s.group,u=s.binding,c=o.type,l=o.object,h=o.indexInGroupEntries;switch(!(m=this._bindGroupEntries[a])&&(m=this._bindGroupEntries[a]=[]),c){case kk.Sampler:var p=l;void 0!==h&&n?m[h].resource=this._cacheSampler.getSampler(p):(o.indexInGroupEntries=m.length,m.push({binding:u,resource:this._cacheSampler.getSampler(p)}));break;case kk.Texture:case kk.TextureWithoutSampler:var f=(d=l)._texture._hardwareTexture;void 0!==h&&n?(c===kk.Texture&&(m[h++].resource=this._cacheSampler.getSampler(d._texture)),m[h].resource=f.view):(o.indexInGroupEntries=m.length,c===kk.Texture&&m.push({binding:u-1,resource:this._cacheSampler.getSampler(d._texture)}),m.push({binding:u,resource:f.view}));break;case kk.StorageTexture:var d;!((f=(d=l)._texture._hardwareTexture).textureAdditionalUsages&_N.TextureUsage.StorageBinding)&&aL.Error("computeDispatch: The texture (name=".concat(d.name,", uniqueId=").concat(d.uniqueId,") is not a storage texture!"),50),void 0!==h&&n?m[h].resource=f.viewForWriting:(o.indexInGroupEntries=m.length,m.push({binding:u,resource:f.viewForWriting}));break;case kk.UniformBuffer:case kk.StorageBuffer:var A=(kk.UniformBuffer,l).getBuffer(),g=A.underlyingResource;void 0!==h&&n?(m[h].resource.buffer=g,m[h].resource.size=A.capacity):(o.indexInGroupEntries=m.length,m.push({binding:u,resource:{buffer:g,offset:0,size:A.capacity}}))}}for(var _=0;_<this._bindGroupEntries.length;++_){var m;(m=this._bindGroupEntries[_])?this._bindGroups[_]=this._device.createBindGroup({layout:t.getBindGroupLayout(_),entries:m}):this._bindGroups[_]=void 0}this._bindGroups.length=this._bindGroupEntries.length}return this._bindGroups},qk.prototype.clear=function(){this._bindGroups=[]},qk._Counter=0;var Vk,Yk=(Vk=!0,function(e,t){var r=Vk?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Vk=!1,r}),Xk=Yk(void 0,(function(){return Xk.toString().search("(((.+)+)+)+$").toString().constructor(Xk).search("(((.+)+)+)+$")}));function Wk(e){this._name="unnamed",this.engine=e,this.computePipeline=null}Xk(),Object.defineProperty(Wk.prototype,"isAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(Wk.prototype,"isReady",{get:function(){return!!this.stage},enumerable:!1,configurable:!0}),Wk.prototype._getComputeShaderCode=function(){var e;return null===(e=this.sources)||void 0===e?void 0:e.compute},Wk.prototype.dispose=function(){};var Kk,$k=(Kk=!0,function(e,t){var r=Kk?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Kk=!1,r}),Jk=$k(void 0,(function(){return Jk.toString().search("(((.+)+)+)+$").toString().constructor(Jk).search("(((.+)+)+)+$")}));Jk();const Zk=0,ez=1,tz=2,rz=3,nz=4,iz=5;Qk.prototype.createComputeContext=function(){return new qk(this._device,this._cacheSampler)},Qk.prototype.createComputeEffect=function(e,t){var r=(e.computeElement||e.compute||e.computeToken||e.computeSource||e)+"@"+t.defines;if(this._compiledComputeEffects[r]){var n=this._compiledComputeEffects[r];return t.onCompiled&&n.isReady()&&t.onCompiled(n),n}var i=new GU(e,t,this,r);return this._compiledComputeEffects[r]=i,i},Qk.prototype.createComputePipelineContext=function(){return new Wk(this)},Qk.prototype.areAllComputeEffectsReady=function(){for(var e in this._compiledComputeEffects){if(!this._compiledComputeEffects[e].isReady())return!1}return!0},Qk.prototype.computeDispatch=function(e,t,r,n,i,o,s){var a=this;if(this._currentRenderTarget)this._onAfterUnbindFrameBufferObservable.addOnce((function(){a.computeDispatch(e,t,r,n,i,o,s)}));else{var u=e._pipelineContext,c=t;!u.computePipeline&&(u.computePipeline=this._device.createComputePipeline({layout:_N.AutoLayoutMode.Auto,compute:u.stage}));var l=this._renderTargetEncoder.beginComputePass();l.setPipeline(u.computePipeline);for(var h=c.getBindGroups(r,u.computePipeline,s),p=0;p<h.length;++p){var f=h[p];f&&l.setBindGroup(p,f)}l.dispatchWorkgroups(n,i,o),l.end()}},Qk.prototype.releaseComputeEffects=function(){for(var e in this._compiledComputeEffects){var t=this._compiledComputeEffects[e].getPipelineContext();this._deleteComputePipelineContext(t)}this._compiledComputeEffects={}},Qk.prototype._prepareComputePipelineContext=function(e,t,r,n,i){var o=e;this.dbgShowShaderCode&&(console.log(n),console.log(t)),o.sources={compute:t,rawCompute:r},o.stage=this._createComputePipelineStageDescriptor(t,n,i)},Qk.prototype._releaseComputeEffect=function(e){this._compiledComputeEffects[e._key]&&(delete this._compiledComputeEffects[e._key],this._deleteComputePipelineContext(e.getPipelineContext()))},Qk.prototype._rebuildComputeEffects=function(){for(var e in this._compiledComputeEffects){var t=this._compiledComputeEffects[e];t._pipelineContext=null,t._wasPreviouslyReady=!1,t._prepareEffect()}},Qk.prototype._deleteComputePipelineContext=function(e){e&&e.dispose()},Qk.prototype._createComputePipelineStageDescriptor=function(e,t,r){return t=t?"//"+t.split("\n").join("\n//")+"\n":"",{module:this._device.createShaderModule({code:t+e}),entryPoint:r}};var oz,sz=(oz=!0,function(e,t){var r=oz?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return oz=!1,r}),az=sz(void 0,(function(){return az.toString().search("(((.+)+)+)+$").toString().constructor(az).search("(((.+)+)+)+$")}));function uz(e,t,r,n){void 0===n&&(n={}),this._bindings={},this._samplers={},this._contextIsDirty=!1,this.onCompiled=null,this.onError=null,this.name=e,this._engine=t,this.uniqueId=UL.UniqueId,this._engine.getCaps().supportComputeShaders?n.bindingsMapping?(this._context=t.createComputeContext(),this._shaderPath=r,this._options=n||{bindingsMapping:{},defines:[]}):console.log("You must provide the binding mappings as browsers don't support reflection for wgsl shaders yet!"):console.log("This engine does not support compute shaders!")}az(),Object.defineProperty(uz.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(uz.prototype,"shaderPath",{get:function(){return this._shaderPath},enumerable:!1,configurable:!0}),uz.prototype.getClassName=function(){return"ComputeShader"},uz.prototype.setTexture=function(e,t,r){void 0===r&&(r=!0);var n=this._bindings[e];this._bindings[e]={type:r?Zk:nz,object:t,indexInGroupEntries:null==n?void 0:n.indexInGroupEntries},this._contextIsDirty||(this._contextIsDirty=!n||n.object!==t||n.type!==this._bindings[e].type)},uz.prototype.setStorageTexture=function(e,t){var r=this._bindings[e];this._contextIsDirty||(this._contextIsDirty=!r||r.object!==t),this._bindings[e]={type:ez,object:t,indexInGroupEntries:null==r?void 0:r.indexInGroupEntries}},uz.prototype.setUniformBuffer=function(e,t){var r=this._bindings[e];this._contextIsDirty||(this._contextIsDirty=!r||r.object!==t),this._bindings[e]={type:tz,object:t,indexInGroupEntries:null==r?void 0:r.indexInGroupEntries}},uz.prototype.setStorageBuffer=function(e,t){var r=this._bindings[e];this._contextIsDirty||(this._contextIsDirty=!r||r.object!==t),this._bindings[e]={type:rz,object:t,indexInGroupEntries:null==r?void 0:r.indexInGroupEntries}},uz.prototype.setTextureSampler=function(e,t){var r=this._bindings[e];this._contextIsDirty||(this._contextIsDirty=!r||!t.compareSampler(r.object)),this._bindings[e]={type:iz,object:t,indexInGroupEntries:null==r?void 0:r.indexInGroupEntries}},uz.prototype.isReady=function(){var e=this._effect;for(var t in this._bindings){var r=this._bindings[t],n=r.type,i=r.object;switch(n){case Zk:case nz:case ez:if(!i.isReady)return!1}}var o=[],s=this._shaderPath;if(this._options.defines)for(var a=0;a<this._options.defines.length;a++)o.push(this._options.defines[a]);var u=o.join("\n");return this._cachedDefines!==u&&(this._cachedDefines=u,e=this._engine.createComputeEffect(s,{defines:u,entryPoint:this._options.entryPoint,onCompiled:this.onCompiled,onError:this.onError}),this._effect=e),!!e.isReady()},uz.prototype.dispatch=function(e,t,r){var n;if(!this.isReady())return!1;for(var i in this._bindings){var o=this._bindings[i];if(!this._options.bindingsMapping[i])throw new Error("ComputeShader ('"+this.name+"'): No binding mapping has been provided for the property '"+i+"'");if(o.type===Zk){var s=this._samplers[i],a=o.object;(!s||!a._texture||!s.compareSampler(a._texture))&&(this._samplers[i]=(new wF).setParameters(a.wrapU,a.wrapV,a.wrapR,a.anisotropicFilteringLevel,a._texture.samplingMode,null===(n=a._texture)||void 0===n?void 0:n._comparisonFunction),this._contextIsDirty=!0)}}return this._contextIsDirty&&(this._contextIsDirty=!1,this._context.clear()),this._engine.computeDispatch(this._effect,this._context,this._bindings,e,t,r,this._options.bindingsMapping),!0},uz.prototype.dispatchWhenReady=function(e,t,r,n){var i=this;return void 0===n&&(n=10),new Promise((function(o){var s=function(){i.dispatch(e,t,r)?o():setTimeout(s,n)};s()}))};var cz,lz,hz,pz="\n    #extension GL_EXT_samplerless_texture_functions : enable\n\n    const vec2 pos[4] = vec2[4](vec2(-1.0f, 1.0f), vec2(1.0f, 1.0f), vec2(-1.0f, -1.0f), vec2(1.0f, -1.0f));\n    const vec2 tex[4] = vec2[4](vec2(0.0f, 0.0f), vec2(1.0f, 0.0f), vec2(0.0f, 1.0f), vec2(1.0f, 1.0f));\n\n    layout(set = 0, binding = 0) uniform texture2D img;\n\n    #ifdef INVERTY\n        layout(location = 0) out flat ivec2 vTextureSize;\n    #endif\n\n    void main() {\n        #ifdef INVERTY\n            vTextureSize = textureSize(img, 0);\n        #endif\n        gl_Position = vec4(pos[gl_VertexIndex], 0.0, 1.0);\n    }\n    ",fz=pz;!function(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));n(),e[e.MipMap=0]="MipMap",e[e.InvertYPremultiplyAlpha=1]="InvertYPremultiplyAlpha",e[e.Clear=2]="Clear",e[e.InvertYPremultiplyAlphaWithOfst=3]="InvertYPremultiplyAlphaWithOfst"}(cz||(cz={})),(hz=lz||(lz={}))[hz.DontInvertY=0]="DontInvertY",hz[hz.InvertY=1]="InvertY";var dz=[{vertex:"\n    const vec2 pos[4] = vec2[4](vec2(-1.0f, 1.0f), vec2(1.0f, 1.0f), vec2(-1.0f, -1.0f), vec2(1.0f, -1.0f));\n    const vec2 tex[4] = vec2[4](vec2(0.0f, 0.0f), vec2(1.0f, 0.0f), vec2(0.0f, 1.0f), vec2(1.0f, 1.0f));\n\n    layout(location = 0) out vec2 vTex;\n\n    void main() {\n        vTex = tex[gl_VertexIndex];\n        gl_Position = vec4(pos[gl_VertexIndex], 0.0, 1.0);\n    }\n    ",fragment:"\n    layout(set = 0, binding = 0) uniform sampler imgSampler;\n    layout(set = 0, binding = 1) uniform texture2D img;\n\n    layout(location = 0) in vec2 vTex;\n    layout(location = 0) out vec4 outColor;\n\n    void main() {\n        outColor = texture(sampler2D(img, imgSampler), vTex);\n    }\n    "},{vertex:pz,fragment:"\n    #extension GL_EXT_samplerless_texture_functions : enable\n\n    layout(set = 0, binding = 0) uniform texture2D img;\n\n    #ifdef INVERTY\n        layout(location = 0) in flat ivec2 vTextureSize;\n    #endif\n    layout(location = 0) out vec4 outColor;\n\n    void main() {\n    #ifdef INVERTY\n        vec4 color = texelFetch(img, ivec2(gl_FragCoord.x, vTextureSize.y - gl_FragCoord.y), 0);\n    #else\n        vec4 color = texelFetch(img, ivec2(gl_FragCoord.xy), 0);\n    #endif\n    #ifdef PREMULTIPLYALPHA\n        color.rgb *= color.a;\n    #endif\n        outColor = color;\n    }\n    "},{vertex:"\n    const vec2 pos[4] = vec2[4](vec2(-1.0f, 1.0f), vec2(1.0f, 1.0f), vec2(-1.0f, -1.0f), vec2(1.0f, -1.0f));\n\n    void main() {\n        gl_Position = vec4(pos[gl_VertexIndex], 0.0, 1.0);\n    }\n    ",fragment:"\n    layout(set = 0, binding = 0) uniform Uniforms {\n        uniform vec4 color;\n    };\n\n    layout(location = 0) out vec4 outColor;\n\n    void main() {\n        outColor = color;\n    }\n    "},{vertex:fz,fragment:"\n    #extension GL_EXT_samplerless_texture_functions : enable\n\n    layout(set = 0, binding = 0) uniform texture2D img;\n    layout(set = 0, binding = 1) uniform Params {\n        float ofstX;\n        float ofstY;\n        float width;\n        float height;\n    };\n\n    #ifdef INVERTY\n        layout(location = 0) in flat ivec2 vTextureSize;\n    #endif\n    layout(location = 0) out vec4 outColor;\n\n    void main() {\n        if (gl_FragCoord.x < ofstX || gl_FragCoord.x >= ofstX + width) {\n            discard;\n        }\n        if (gl_FragCoord.y < ofstY || gl_FragCoord.y >= ofstY + height) {\n            discard;\n        }\n    #ifdef INVERTY\n        vec4 color = texelFetch(img, ivec2(gl_FragCoord.x, ofstY + height - (gl_FragCoord.y - ofstY)), 0);\n    #else\n        vec4 color = texelFetch(img, ivec2(gl_FragCoord.xy), 0);\n    #endif\n    #ifdef PREMULTIPLYALPHA\n        color.rgb *= color.a;\n    #endif\n        outColor = color;\n    }\n    "}];const Az={"":0,r8unorm:1,r8uint:2,r8sint:3,r16uint:4,r16sint:5,r16float:6,rg8unorm:7,rg8uint:8,rg8sint:9,r32uint:10,r32sint:11,r32float:12,rg16uint:13,rg16sint:14,rg16float:15,rgba8unorm:16,"rgba8unorm-srgb":17,rgba8uint:18,rgba8sint:19,bgra8unorm:20,"bgra8unorm-srgb":21,rgb10a2unorm:22,rg32uint:23,rg32sint:24,rg32float:25,rgba16uint:26,rgba16sint:27,rgba16float:28,rgba32uint:29,rgba32sint:30,rgba32float:31,stencil8:32,depth16unorm:33,depth24plus:34,"depth24plus-stencil8":35,depth32float:36,"depth24unorm-stencil8":37,"depth32float-stencil8":38};function gz(e,t,r,n,i=void 0){this._pipelines={},this._compiledShaders=[],this._deferredReleaseTextures=[],this._videoPipelines={},this._videoCompiledShaders=[],this._userEngine=i,this._device=e,this._glslang=t,this._tintWASM=r,this._bufferManager=n,this._mipmapSampler=e.createSampler({minFilter:_N.FilterMode.Linear}),this._videoSampler=e.createSampler({minFilter:_N.FilterMode.Linear}),this._ubCopyWithOfst=this._bufferManager.createBuffer(16,_N.BufferUsage.Uniform|_N.BufferUsage.CopyDst).underlyingResource,this._getPipeline(_N.TextureFormat.RGBA8Unorm)}gz.ComputeNumMipmapLevels=function(e,t){return EN.ILog2(Math.max(e,t))+1},gz.prototype._getPipeline=function(e,t,r){void 0===t&&(t=cz.MipMap);var n=t===cz.MipMap?1:t===cz.InvertYPremultiplyAlpha?((r.invertY?1:0)<<1)+((r.premultiplyAlpha?1:0)<<2):t===cz.Clear?8:t===cz.InvertYPremultiplyAlphaWithOfst?((r.invertY?1:0)<<4)+((r.premultiplyAlpha?1:0)<<5):0;!this._pipelines[e]&&(this._pipelines[e]=[]);var i=this._pipelines[e][n];if(!i){var o="#version 450\r\n";(t===cz.InvertYPremultiplyAlpha||t===cz.InvertYPremultiplyAlphaWithOfst)&&(r.invertY&&(o+="#define INVERTY\r\n"),r.premultiplyAlpha&&(o+="#define PREMULTIPLYALPHA\r\n"));var s=this._compiledShaders[n];if(!s){var a=this._glslang.compileGLSL(o+dz[t].vertex,"vertex"),u=this._glslang.compileGLSL(o+dz[t].fragment,"fragment");this._tintWASM&&(a=this._tintWASM.convertSpirV2WGSL(a),u=this._tintWASM.convertSpirV2WGSL(u));var c=this._device.createShaderModule({code:a}),l=this._device.createShaderModule({code:u});s=this._compiledShaders[n]=[c,l]}var h=this._device.createRenderPipeline({layout:_N.AutoLayoutMode.Auto,vertex:{module:s[0],entryPoint:"main"},fragment:{module:s[1],entryPoint:"main",targets:[{format:e}]},primitive:{topology:_N.PrimitiveTopology.TriangleStrip,stripIndexFormat:_N.IndexFormat.Uint16}});i=this._pipelines[e][n]=[h,h.getBindGroupLayout(0)]}return i},gz.prototype._getVideoPipeline=function(e,t){void 0===t&&(t=lz.DontInvertY);var r=t===lz.InvertY?1:0;!this._videoPipelines[e]&&(this._videoPipelines[e]=[]);var n=this._videoPipelines[e][r];if(!n){var i=this._videoCompiledShaders[r];if(!i){var o=this._device.createShaderModule({code:"\n    struct VertexOutput {\n        @builtin(position) Position : vec4<f32>,\n        @location(0) fragUV : vec2<f32>\n    }\n  \n    @vertex\n    fn main(\n        @builtin(vertex_index) VertexIndex : u32\n    ) -> VertexOutput {\n        var pos = array<vec2<f32>, 4>(\n            vec2(-1.0,  1.0),\n            vec2( 1.0,  1.0),\n            vec2(-1.0, -1.0),\n            vec2( 1.0, -1.0)\n        );\n        var tex = array<vec2<f32>, 4>(\n            vec2(0.0, 0.0),\n            vec2(1.0, 0.0),\n            vec2(0.0, 1.0),\n            vec2(1.0, 1.0)\n        );\n\n        var output: VertexOutput;\n\n        output.Position = vec4<f32>(pos[VertexIndex], 0.0, 1.0);\n        output.fragUV = tex[VertexIndex];\n\n        return output;\n    }\n    "}),s=this._device.createShaderModule({code:0===r?"\n   @group(0) @binding(0) var videoTexture: texture_external;\n\n    @fragment\n    fn main(\n        @location(0) fragUV: vec2<f32>\n    ) -> @location(0) vec4<f32> {\n        let uv : vec2<i32> = vec2<i32>(i32(fragUV.x), i32(fragUV.y));\n   return textureLoad(videoTexture, uv);\n    }\n":"\n @group(0) @binding(0) var videoTexture: texture_external;\n\n    @fragment\n    fn main(\n        @location(0) fragUV: vec2<f32>\n    ) -> @location(0) vec4<f32> {\n        let uv : vec2<i32> = vec2<i32>(i32(fragUV.x), i32(1 - fragUV.y));\n    return textureLoad(videoTexture, uv);\n    }\n    "});i=this._videoCompiledShaders[r]=[o,s]}var a=this._device.createRenderPipeline({label:"CopyVideoToTexture_".concat(e,"_").concat(0===r?"DontInvertY":"InvertY"),layout:_N.AutoLayoutMode.Auto,vertex:{module:i[0],entryPoint:"main"},fragment:{module:i[1],entryPoint:"main",targets:[{format:e}]},primitive:{topology:_N.PrimitiveTopology.TriangleStrip,stripIndexFormat:_N.IndexFormat.Uint16}});n=this._videoPipelines[e][r]=[a,a.getBindGroupLayout(0)]}return n},gz._GetTextureTypeFromFormat=function(e){switch(e){case _N.TextureFormat.R8Unorm:case _N.TextureFormat.R8Snorm:case _N.TextureFormat.R8Uint:case _N.TextureFormat.R8Sint:case _N.TextureFormat.RG8Unorm:case _N.TextureFormat.RG8Snorm:case _N.TextureFormat.RG8Uint:case _N.TextureFormat.RG8Sint:case _N.TextureFormat.RGBA8Unorm:case _N.TextureFormat.RGBA8UnormSRGB:case _N.TextureFormat.RGBA8Snorm:case _N.TextureFormat.RGBA8Uint:case _N.TextureFormat.RGBA8Sint:case _N.TextureFormat.BGRA8Unorm:case _N.TextureFormat.BGRA8UnormSRGB:case _N.TextureFormat.RGB10A2Unorm:case _N.TextureFormat.RGB9E5UFloat:case _N.TextureFormat.RG11B10UFloat:case _N.TextureFormat.Depth24UnormStencil8:case _N.TextureFormat.Depth32FloatStencil8:case _N.TextureFormat.BC7RGBAUnorm:case _N.TextureFormat.BC7RGBAUnormSRGB:case _N.TextureFormat.BC6HRGBUFloat:case _N.TextureFormat.BC6HRGBFloat:case _N.TextureFormat.BC5RGUnorm:case _N.TextureFormat.BC5RGSnorm:case _N.TextureFormat.BC3RGBAUnorm:case _N.TextureFormat.BC3RGBAUnormSRGB:case _N.TextureFormat.BC2RGBAUnorm:case _N.TextureFormat.BC2RGBAUnormSRGB:case _N.TextureFormat.BC4RUnorm:case _N.TextureFormat.BC4RSnorm:case _N.TextureFormat.BC1RGBAUnorm:case _N.TextureFormat.BC1RGBAUnormSRGB:case _N.TextureFormat.ETC2RGB8Unorm:case _N.TextureFormat.ETC2RGB8UnormSRGB:case _N.TextureFormat.ETC2RGB8A1Unorm:case _N.TextureFormat.ETC2RGB8A1UnormSRGB:case _N.TextureFormat.ETC2RGBA8Unorm:case _N.TextureFormat.ETC2RGBA8UnormSRGB:case _N.TextureFormat.EACR11Unorm:case _N.TextureFormat.EACR11Snorm:case _N.TextureFormat.EACRG11Unorm:case _N.TextureFormat.EACRG11Snorm:case _N.TextureFormat.ASTC4x4Unorm:case _N.TextureFormat.ASTC4x4UnormSRGB:case _N.TextureFormat.ASTC5x4Unorm:case _N.TextureFormat.ASTC5x4UnormSRGB:case _N.TextureFormat.ASTC5x5Unorm:case _N.TextureFormat.ASTC5x5UnormSRGB:case _N.TextureFormat.ASTC6x5Unorm:case _N.TextureFormat.ASTC6x5UnormSRGB:case _N.TextureFormat.ASTC6x6Unorm:case _N.TextureFormat.ASTC6x6UnormSRGB:case _N.TextureFormat.ASTC8x5Unorm:case _N.TextureFormat.ASTC8x5UnormSRGB:case _N.TextureFormat.ASTC8x6Unorm:case _N.TextureFormat.ASTC8x6UnormSRGB:case _N.TextureFormat.ASTC8x8Unorm:case _N.TextureFormat.ASTC8x8UnormSRGB:case _N.TextureFormat.ASTC10x5Unorm:case _N.TextureFormat.ASTC10x5UnormSRGB:case _N.TextureFormat.ASTC10x6Unorm:case _N.TextureFormat.ASTC10x6UnormSRGB:case _N.TextureFormat.ASTC10x8Unorm:case _N.TextureFormat.ASTC10x8UnormSRGB:case _N.TextureFormat.ASTC10x10Unorm:case _N.TextureFormat.ASTC10x10UnormSRGB:case _N.TextureFormat.ASTC12x10Unorm:case _N.TextureFormat.ASTC12x10UnormSRGB:case _N.TextureFormat.ASTC12x12Unorm:case _N.TextureFormat.ASTC12x12UnormSRGB:return Qd.TEXTURETYPE_UNSIGNED_BYTE;case _N.TextureFormat.R16Uint:case _N.TextureFormat.R16Sint:case _N.TextureFormat.RG16Uint:case _N.TextureFormat.RG16Sint:case _N.TextureFormat.RGBA16Uint:case _N.TextureFormat.RGBA16Sint:case _N.TextureFormat.Depth16Unorm:return Qd.TEXTURETYPE_UNSIGNED_SHORT;case _N.TextureFormat.R16Float:case _N.TextureFormat.RG16Float:case _N.TextureFormat.RGBA16Float:return Qd.TEXTURETYPE_HALF_FLOAT;case _N.TextureFormat.R32Uint:case _N.TextureFormat.R32Sint:case _N.TextureFormat.RG32Uint:case _N.TextureFormat.RG32Sint:case _N.TextureFormat.RGBA32Uint:case _N.TextureFormat.RGBA32Sint:return Qd.TEXTURETYPE_UNSIGNED_INTEGER;case _N.TextureFormat.R32Float:case _N.TextureFormat.RG32Float:case _N.TextureFormat.RGBA32Float:case _N.TextureFormat.Depth32Float:return Qd.TEXTURETYPE_FLOAT;case _N.TextureFormat.Stencil8:throw"No fixed size for Stencil8 format!";case _N.TextureFormat.Depth24Plus:throw"No fixed size for Depth24Plus format!";case _N.TextureFormat.Depth24PlusStencil8:throw"No fixed size for Depth24PlusStencil8 format!"}return Qd.TEXTURETYPE_UNSIGNED_BYTE},gz._GetBlockInformationFromFormat=function(e){switch(e){case _N.TextureFormat.R8Unorm:case _N.TextureFormat.R8Snorm:case _N.TextureFormat.R8Uint:case _N.TextureFormat.R8Sint:return{width:1,height:1,length:1};case _N.TextureFormat.R16Uint:case _N.TextureFormat.R16Sint:case _N.TextureFormat.R16Float:case _N.TextureFormat.RG8Unorm:case _N.TextureFormat.RG8Snorm:case _N.TextureFormat.RG8Uint:case _N.TextureFormat.RG8Sint:return{width:1,height:1,length:2};case _N.TextureFormat.R32Uint:case _N.TextureFormat.R32Sint:case _N.TextureFormat.R32Float:case _N.TextureFormat.RG16Uint:case _N.TextureFormat.RG16Sint:case _N.TextureFormat.RG16Float:case _N.TextureFormat.RGBA8Unorm:case _N.TextureFormat.RGBA8UnormSRGB:case _N.TextureFormat.RGBA8Snorm:case _N.TextureFormat.RGBA8Uint:case _N.TextureFormat.RGBA8Sint:case _N.TextureFormat.BGRA8Unorm:case _N.TextureFormat.BGRA8UnormSRGB:case _N.TextureFormat.RGB9E5UFloat:case _N.TextureFormat.RGB10A2Unorm:case _N.TextureFormat.RG11B10UFloat:return{width:1,height:1,length:4};case _N.TextureFormat.RG32Uint:case _N.TextureFormat.RG32Sint:case _N.TextureFormat.RG32Float:case _N.TextureFormat.RGBA16Uint:case _N.TextureFormat.RGBA16Sint:case _N.TextureFormat.RGBA16Float:return{width:1,height:1,length:8};case _N.TextureFormat.RGBA32Uint:case _N.TextureFormat.RGBA32Sint:case _N.TextureFormat.RGBA32Float:return{width:1,height:1,length:16};case _N.TextureFormat.Stencil8:throw"No fixed size for Stencil8 format!";case _N.TextureFormat.Depth16Unorm:return{width:1,height:1,length:2};case _N.TextureFormat.Depth24Plus:throw"No fixed size for Depth24Plus format!";case _N.TextureFormat.Depth24PlusStencil8:throw"No fixed size for Depth24PlusStencil8 format!";case _N.TextureFormat.Depth32Float:case _N.TextureFormat.Depth24UnormStencil8:return{width:1,height:1,length:4};case _N.TextureFormat.Depth32FloatStencil8:return{width:1,height:1,length:5};case _N.TextureFormat.BC7RGBAUnorm:case _N.TextureFormat.BC7RGBAUnormSRGB:case _N.TextureFormat.BC6HRGBUFloat:case _N.TextureFormat.BC6HRGBFloat:case _N.TextureFormat.BC5RGUnorm:case _N.TextureFormat.BC5RGSnorm:case _N.TextureFormat.BC3RGBAUnorm:case _N.TextureFormat.BC3RGBAUnormSRGB:case _N.TextureFormat.BC2RGBAUnorm:case _N.TextureFormat.BC2RGBAUnormSRGB:return{width:4,height:4,length:16};case _N.TextureFormat.BC4RUnorm:case _N.TextureFormat.BC4RSnorm:case _N.TextureFormat.BC1RGBAUnorm:case _N.TextureFormat.BC1RGBAUnormSRGB:case _N.TextureFormat.ETC2RGB8Unorm:case _N.TextureFormat.ETC2RGB8UnormSRGB:case _N.TextureFormat.ETC2RGB8A1Unorm:case _N.TextureFormat.ETC2RGB8A1UnormSRGB:case _N.TextureFormat.EACR11Unorm:case _N.TextureFormat.EACR11Snorm:return{width:4,height:4,length:8};case _N.TextureFormat.ETC2RGBA8Unorm:case _N.TextureFormat.ETC2RGBA8UnormSRGB:case _N.TextureFormat.EACRG11Unorm:case _N.TextureFormat.EACRG11Snorm:case _N.TextureFormat.ASTC4x4Unorm:case _N.TextureFormat.ASTC4x4UnormSRGB:return{width:4,height:4,length:16};case _N.TextureFormat.ASTC5x4Unorm:case _N.TextureFormat.ASTC5x4UnormSRGB:return{width:5,height:4,length:16};case _N.TextureFormat.ASTC5x5Unorm:case _N.TextureFormat.ASTC5x5UnormSRGB:return{width:5,height:5,length:16};case _N.TextureFormat.ASTC6x5Unorm:case _N.TextureFormat.ASTC6x5UnormSRGB:return{width:6,height:5,length:16};case _N.TextureFormat.ASTC6x6Unorm:case _N.TextureFormat.ASTC6x6UnormSRGB:return{width:6,height:6,length:16};case _N.TextureFormat.ASTC8x5Unorm:case _N.TextureFormat.ASTC8x5UnormSRGB:return{width:8,height:5,length:16};case _N.TextureFormat.ASTC8x6Unorm:case _N.TextureFormat.ASTC8x6UnormSRGB:return{width:8,height:6,length:16};case _N.TextureFormat.ASTC8x8Unorm:case _N.TextureFormat.ASTC8x8UnormSRGB:return{width:8,height:8,length:16};case _N.TextureFormat.ASTC10x5Unorm:case _N.TextureFormat.ASTC10x5UnormSRGB:return{width:10,height:5,length:16};case _N.TextureFormat.ASTC10x6Unorm:case _N.TextureFormat.ASTC10x6UnormSRGB:return{width:10,height:6,length:16};case _N.TextureFormat.ASTC10x8Unorm:case _N.TextureFormat.ASTC10x8UnormSRGB:return{width:10,height:8,length:16};case _N.TextureFormat.ASTC10x10Unorm:case _N.TextureFormat.ASTC10x10UnormSRGB:return{width:10,height:10,length:16};case _N.TextureFormat.ASTC12x10Unorm:case _N.TextureFormat.ASTC12x10UnormSRGB:return{width:12,height:10,length:16};case _N.TextureFormat.ASTC12x12Unorm:case _N.TextureFormat.ASTC12x12UnormSRGB:return{width:12,height:12,length:16}}return{width:1,height:1,length:4}},gz._IsHardwareTexture=function(e){return!!e.release},gz._IsInternalTexture=function(e){return!!e.dispose},gz.IsImageBitmap=function(e){return void 0!==e.close},gz.IsImageBitmapArray=function(e){return Array.isArray(e)&&void 0!==e[0].close},gz.prototype.setCommandEncoder=function(e){this._commandEncoderForCreation=e},gz.IsCompressedFormat=function(e){switch(e){case _N.TextureFormat.BC7RGBAUnormSRGB:case _N.TextureFormat.BC7RGBAUnorm:case _N.TextureFormat.BC6HRGBFloat:case _N.TextureFormat.BC6HRGBUFloat:case _N.TextureFormat.BC5RGSnorm:case _N.TextureFormat.BC5RGUnorm:case _N.TextureFormat.BC4RSnorm:case _N.TextureFormat.BC4RUnorm:case _N.TextureFormat.BC3RGBAUnormSRGB:case _N.TextureFormat.BC3RGBAUnorm:case _N.TextureFormat.BC2RGBAUnormSRGB:case _N.TextureFormat.BC2RGBAUnorm:case _N.TextureFormat.BC1RGBAUnormSRGB:case _N.TextureFormat.BC1RGBAUnorm:case _N.TextureFormat.ETC2RGB8Unorm:case _N.TextureFormat.ETC2RGB8UnormSRGB:case _N.TextureFormat.ETC2RGB8A1Unorm:case _N.TextureFormat.ETC2RGB8A1UnormSRGB:case _N.TextureFormat.ETC2RGBA8Unorm:case _N.TextureFormat.ETC2RGBA8UnormSRGB:case _N.TextureFormat.EACR11Unorm:case _N.TextureFormat.EACR11Snorm:case _N.TextureFormat.EACRG11Unorm:case _N.TextureFormat.EACRG11Snorm:case _N.TextureFormat.ASTC4x4Unorm:case _N.TextureFormat.ASTC4x4UnormSRGB:case _N.TextureFormat.ASTC5x4Unorm:case _N.TextureFormat.ASTC5x4UnormSRGB:case _N.TextureFormat.ASTC5x5Unorm:case _N.TextureFormat.ASTC5x5UnormSRGB:case _N.TextureFormat.ASTC6x5Unorm:case _N.TextureFormat.ASTC6x5UnormSRGB:case _N.TextureFormat.ASTC6x6Unorm:case _N.TextureFormat.ASTC6x6UnormSRGB:case _N.TextureFormat.ASTC8x5Unorm:case _N.TextureFormat.ASTC8x5UnormSRGB:case _N.TextureFormat.ASTC8x6Unorm:case _N.TextureFormat.ASTC8x6UnormSRGB:case _N.TextureFormat.ASTC8x8Unorm:case _N.TextureFormat.ASTC8x8UnormSRGB:case _N.TextureFormat.ASTC10x5Unorm:case _N.TextureFormat.ASTC10x5UnormSRGB:case _N.TextureFormat.ASTC10x6Unorm:case _N.TextureFormat.ASTC10x6UnormSRGB:case _N.TextureFormat.ASTC10x8Unorm:case _N.TextureFormat.ASTC10x8UnormSRGB:case _N.TextureFormat.ASTC10x10Unorm:case _N.TextureFormat.ASTC10x10UnormSRGB:case _N.TextureFormat.ASTC12x10Unorm:case _N.TextureFormat.ASTC12x10UnormSRGB:case _N.TextureFormat.ASTC12x12Unorm:case _N.TextureFormat.ASTC12x12UnormSRGB:return!0}return!1},gz.GetWebGPUTextureFormat=function(e,t,r){switch(void 0===r&&(r=!1),t){case Qd.TEXTUREFORMAT_DEPTH16:return _N.TextureFormat.Depth16Unorm;case Qd.TEXTUREFORMAT_DEPTH24:return _N.TextureFormat.Depth24Plus;case Qd.TEXTUREFORMAT_DEPTH24_STENCIL8:return _N.TextureFormat.Depth24PlusStencil8;case Qd.TEXTUREFORMAT_DEPTH32_FLOAT:return _N.TextureFormat.Depth32Float;case Qd.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8:return _N.TextureFormat.Depth24UnormStencil8;case Qd.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8:return _N.TextureFormat.Depth32FloatStencil8;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM:return r?_N.TextureFormat.BC7RGBAUnormSRGB:_N.TextureFormat.BC7RGBAUnorm;case Qd.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT:return _N.TextureFormat.BC6HRGBUFloat;case Qd.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_SIGNED_FLOAT:return _N.TextureFormat.BC6HRGBFloat;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5:return r?_N.TextureFormat.BC3RGBAUnormSRGB:_N.TextureFormat.BC3RGBAUnorm;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3:return r?_N.TextureFormat.BC2RGBAUnormSRGB:_N.TextureFormat.BC2RGBAUnorm;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1:case Qd.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1:return r?_N.TextureFormat.BC1RGBAUnormSRGB:_N.TextureFormat.BC1RGBAUnorm;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4:return r?_N.TextureFormat.ASTC4x4UnormSRGB:_N.TextureFormat.ASTC4x4Unorm;case Qd.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL:case Qd.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2:return r?_N.TextureFormat.ETC2RGB8UnormSRGB:_N.TextureFormat.ETC2RGB8Unorm;case Qd.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC:return r?_N.TextureFormat.ETC2RGBA8UnormSRGB:_N.TextureFormat.ETC2RGBA8Unorm}switch(e){case Qd.TEXTURETYPE_BYTE:switch(t){case Qd.TEXTUREFORMAT_RED:return _N.TextureFormat.R8Snorm;case Qd.TEXTUREFORMAT_RG:return _N.TextureFormat.RG8Snorm;case Qd.TEXTUREFORMAT_RGB:throw"RGB format not supported in WebGPU";case Qd.TEXTUREFORMAT_RED_INTEGER:return _N.TextureFormat.R8Sint;case Qd.TEXTUREFORMAT_RG_INTEGER:return _N.TextureFormat.RG8Sint;case Qd.TEXTUREFORMAT_RGB_INTEGER:throw"RGB_INTEGER format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA_INTEGER:return _N.TextureFormat.RGBA8Sint;default:return _N.TextureFormat.RGBA8Snorm}case Qd.TEXTURETYPE_UNSIGNED_BYTE:switch(t){case Qd.TEXTUREFORMAT_RED:return _N.TextureFormat.R8Unorm;case Qd.TEXTUREFORMAT_RG:return _N.TextureFormat.RG8Unorm;case Qd.TEXTUREFORMAT_RGB:throw"TEXTUREFORMAT_RGB format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA:return r?_N.TextureFormat.RGBA8UnormSRGB:_N.TextureFormat.RGBA8Unorm;case Qd.TEXTUREFORMAT_BGRA:return r?_N.TextureFormat.BGRA8UnormSRGB:_N.TextureFormat.BGRA8Unorm;case Qd.TEXTUREFORMAT_RED_INTEGER:return _N.TextureFormat.R8Uint;case Qd.TEXTUREFORMAT_RG_INTEGER:return _N.TextureFormat.RG8Uint;case Qd.TEXTUREFORMAT_RGB_INTEGER:throw"RGB_INTEGER format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA_INTEGER:return _N.TextureFormat.RGBA8Uint;case Qd.TEXTUREFORMAT_ALPHA:throw"TEXTUREFORMAT_ALPHA format not supported in WebGPU";case Qd.TEXTUREFORMAT_LUMINANCE:throw"TEXTUREFORMAT_LUMINANCE format not supported in WebGPU";case Qd.TEXTUREFORMAT_LUMINANCE_ALPHA:throw"TEXTUREFORMAT_LUMINANCE_ALPHA format not supported in WebGPU";default:return _N.TextureFormat.RGBA8Unorm}case Qd.TEXTURETYPE_SHORT:switch(t){case Qd.TEXTUREFORMAT_RED_INTEGER:return _N.TextureFormat.R16Sint;case Qd.TEXTUREFORMAT_RG_INTEGER:return _N.TextureFormat.RG16Sint;case Qd.TEXTUREFORMAT_RGB_INTEGER:throw"TEXTUREFORMAT_RGB_INTEGER format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA_INTEGER:default:return _N.TextureFormat.RGBA16Sint}case Qd.TEXTURETYPE_UNSIGNED_SHORT:switch(t){case Qd.TEXTUREFORMAT_RED_INTEGER:return _N.TextureFormat.R16Uint;case Qd.TEXTUREFORMAT_RG_INTEGER:return _N.TextureFormat.RG16Uint;case Qd.TEXTUREFORMAT_RGB_INTEGER:throw"TEXTUREFORMAT_RGB_INTEGER format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA_INTEGER:default:return _N.TextureFormat.RGBA16Uint}case Qd.TEXTURETYPE_INT:switch(t){case Qd.TEXTUREFORMAT_RED_INTEGER:return _N.TextureFormat.R32Sint;case Qd.TEXTUREFORMAT_RG_INTEGER:return _N.TextureFormat.RG32Sint;case Qd.TEXTUREFORMAT_RGB_INTEGER:throw"TEXTUREFORMAT_RGB_INTEGER format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA_INTEGER:default:return _N.TextureFormat.RGBA32Sint}case Qd.TEXTURETYPE_UNSIGNED_INTEGER:switch(t){case Qd.TEXTUREFORMAT_RED_INTEGER:return _N.TextureFormat.R32Uint;case Qd.TEXTUREFORMAT_RG_INTEGER:return _N.TextureFormat.RG32Uint;case Qd.TEXTUREFORMAT_RGB_INTEGER:throw"TEXTUREFORMAT_RGB_INTEGER format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA_INTEGER:default:return _N.TextureFormat.RGBA32Uint}case Qd.TEXTURETYPE_FLOAT:switch(t){case Qd.TEXTUREFORMAT_RED:return _N.TextureFormat.R32Float;case Qd.TEXTUREFORMAT_RG:return _N.TextureFormat.RG32Float;case Qd.TEXTUREFORMAT_RGB:throw"TEXTUREFORMAT_RGB format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA:default:return _N.TextureFormat.RGBA32Float}case Qd.TEXTURETYPE_HALF_FLOAT:switch(t){case Qd.TEXTUREFORMAT_RED:return _N.TextureFormat.R16Float;case Qd.TEXTUREFORMAT_RG:return _N.TextureFormat.RG16Float;case Qd.TEXTUREFORMAT_RGB:throw"TEXTUREFORMAT_RGB format not supported in WebGPU";case Qd.TEXTUREFORMAT_RGBA:default:return _N.TextureFormat.RGBA16Float}case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:throw"TEXTURETYPE_UNSIGNED_SHORT_5_6_5 format not supported in WebGPU";case Qd.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV:throw"TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV format not supported in WebGPU";case Qd.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV:throw"TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV format not supported in WebGPU";case Qd.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:throw"TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4 format not supported in WebGPU";case Qd.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:throw"TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1 format not supported in WebGPU";case Qd.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV:switch(t){case Qd.TEXTUREFORMAT_RGBA:return _N.TextureFormat.RGB10A2Unorm;case Qd.TEXTUREFORMAT_RGBA_INTEGER:throw"TEXTUREFORMAT_RGBA_INTEGER format not supported in WebGPU when type is TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV";default:return _N.TextureFormat.RGB10A2Unorm}}return r?_N.TextureFormat.RGBA8UnormSRGB:_N.TextureFormat.RGBA8Unorm},gz.GetNumChannelsFromWebGPUTextureFormat=function(e){switch(e){case _N.TextureFormat.R8Unorm:case _N.TextureFormat.R8Snorm:case _N.TextureFormat.R8Uint:case _N.TextureFormat.R8Sint:case _N.TextureFormat.BC4RUnorm:case _N.TextureFormat.BC4RSnorm:case _N.TextureFormat.R16Uint:case _N.TextureFormat.R16Sint:case _N.TextureFormat.Depth16Unorm:case _N.TextureFormat.R16Float:case _N.TextureFormat.R32Uint:case _N.TextureFormat.R32Sint:case _N.TextureFormat.R32Float:case _N.TextureFormat.Depth32Float:case _N.TextureFormat.Stencil8:case _N.TextureFormat.Depth24Plus:case _N.TextureFormat.EACR11Unorm:case _N.TextureFormat.EACR11Snorm:return 1;case _N.TextureFormat.RG8Unorm:case _N.TextureFormat.RG8Snorm:case _N.TextureFormat.RG8Uint:case _N.TextureFormat.RG8Sint:case _N.TextureFormat.Depth24UnormStencil8:case _N.TextureFormat.Depth32FloatStencil8:case _N.TextureFormat.BC5RGUnorm:case _N.TextureFormat.BC5RGSnorm:case _N.TextureFormat.RG16Uint:case _N.TextureFormat.RG16Sint:case _N.TextureFormat.RG16Float:case _N.TextureFormat.RG32Uint:case _N.TextureFormat.RG32Sint:case _N.TextureFormat.RG32Float:case _N.TextureFormat.Depth24PlusStencil8:case _N.TextureFormat.EACRG11Unorm:case _N.TextureFormat.EACRG11Snorm:return 2;case _N.TextureFormat.RGB9E5UFloat:case _N.TextureFormat.RG11B10UFloat:case _N.TextureFormat.BC6HRGBUFloat:case _N.TextureFormat.BC6HRGBFloat:case _N.TextureFormat.ETC2RGB8Unorm:case _N.TextureFormat.ETC2RGB8UnormSRGB:return 3;case _N.TextureFormat.RGBA8Unorm:case _N.TextureFormat.RGBA8UnormSRGB:case _N.TextureFormat.RGBA8Snorm:case _N.TextureFormat.RGBA8Uint:case _N.TextureFormat.RGBA8Sint:case _N.TextureFormat.BGRA8Unorm:case _N.TextureFormat.BGRA8UnormSRGB:case _N.TextureFormat.RGB10A2Unorm:case _N.TextureFormat.BC7RGBAUnorm:case _N.TextureFormat.BC7RGBAUnormSRGB:case _N.TextureFormat.BC3RGBAUnorm:case _N.TextureFormat.BC3RGBAUnormSRGB:case _N.TextureFormat.BC2RGBAUnorm:case _N.TextureFormat.BC2RGBAUnormSRGB:case _N.TextureFormat.BC1RGBAUnorm:case _N.TextureFormat.BC1RGBAUnormSRGB:case _N.TextureFormat.RGBA16Uint:case _N.TextureFormat.RGBA16Sint:case _N.TextureFormat.RGBA16Float:case _N.TextureFormat.RGBA32Uint:case _N.TextureFormat.RGBA32Sint:case _N.TextureFormat.RGBA32Float:case _N.TextureFormat.ETC2RGB8A1Unorm:case _N.TextureFormat.ETC2RGB8A1UnormSRGB:case _N.TextureFormat.ETC2RGBA8Unorm:case _N.TextureFormat.ETC2RGBA8UnormSRGB:case _N.TextureFormat.ASTC4x4Unorm:case _N.TextureFormat.ASTC4x4UnormSRGB:case _N.TextureFormat.ASTC5x4Unorm:case _N.TextureFormat.ASTC5x4UnormSRGB:case _N.TextureFormat.ASTC5x5Unorm:case _N.TextureFormat.ASTC5x5UnormSRGB:case _N.TextureFormat.ASTC6x5Unorm:case _N.TextureFormat.ASTC6x5UnormSRGB:case _N.TextureFormat.ASTC6x6Unorm:case _N.TextureFormat.ASTC6x6UnormSRGB:case _N.TextureFormat.ASTC8x5Unorm:case _N.TextureFormat.ASTC8x5UnormSRGB:case _N.TextureFormat.ASTC8x6Unorm:case _N.TextureFormat.ASTC8x6UnormSRGB:case _N.TextureFormat.ASTC8x8Unorm:case _N.TextureFormat.ASTC8x8UnormSRGB:case _N.TextureFormat.ASTC10x5Unorm:case _N.TextureFormat.ASTC10x5UnormSRGB:case _N.TextureFormat.ASTC10x6Unorm:case _N.TextureFormat.ASTC10x6UnormSRGB:case _N.TextureFormat.ASTC10x8Unorm:case _N.TextureFormat.ASTC10x8UnormSRGB:case _N.TextureFormat.ASTC10x10Unorm:case _N.TextureFormat.ASTC10x10UnormSRGB:case _N.TextureFormat.ASTC12x10Unorm:case _N.TextureFormat.ASTC12x10UnormSRGB:case _N.TextureFormat.ASTC12x12Unorm:case _N.TextureFormat.ASTC12x12UnormSRGB:return 4}throw"Unknown format ".concat(e,"!")},gz.HasStencilAspect=function(e){switch(e){case _N.TextureFormat.Stencil8:case _N.TextureFormat.Depth24UnormStencil8:case _N.TextureFormat.Depth32FloatStencil8:case _N.TextureFormat.Depth24PlusStencil8:return!0}return!1},gz.HasDepthAndStencilAspects=function(e){switch(e){case _N.TextureFormat.Depth24UnormStencil8:case _N.TextureFormat.Depth32FloatStencil8:case _N.TextureFormat.Depth24PlusStencil8:return!0}return!1},gz.prototype.copyVideoToTexture=function(e,t,r,n,i){var o,s,a,u;void 0===n&&(n=!1);var c=void 0===i,l=this._getVideoPipeline(r,n?lz.InvertY:lz.DontInvertY),h=l[0],p=l[1];c&&(i=this._device.createCommandEncoder({})),null===(s=(o=i).pushDebugGroup)||void 0===s||s.call(o,"copy video to texture - invertY=".concat(n));var f={colorAttachments:[{view:t._hardwareTexture.underlyingResource.createView({format:r,dimension:_N.TextureViewDimension.E2d,mipLevelCount:1,baseArrayLayer:0,baseMipLevel:0,arrayLayerCount:1,aspect:_N.TextureAspect.All}),loadOp:_N.LoadOp.Load,storeOp:_N.StoreOp.Store}]},d=i.beginRenderPass(f),A={layout:p,entries:[{binding:0,resource:this._device.importExternalTexture({source:e.underlyingResource})}]},g=this._device.createBindGroup(A);d.setPipeline(h),d.setBindGroup(0,g),d.draw(4,1,0,0),d.end(),null===(u=(a=i).popDebugGroup)||void 0===u||u.call(a),c&&(this._device.queue.submit([i.finish()]),i=null)},gz.prototype.invertYPreMultiplyAlpha=function(e,t,r,n,i,o,s,a,u,c,l,h,p,f,d){var A,g,_,m,y,E;void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=1),void 0===c&&(c=0),void 0===l&&(l=0),void 0===h&&(h=0),void 0===p&&(p=0);var x,C=0!==h,b=void 0===f,I=this._getPipeline(n,C?cz.InvertYPremultiplyAlphaWithOfst:cz.InvertYPremultiplyAlpha,{invertY:i,premultiplyAlpha:o}),v=I[0],T=I[1];if(s=Math.max(s,0),b&&(f=this._device.createCommandEncoder({})),null===(g=(A=f).pushDebugGroup)||void 0===g||g.call(A,"internal process texture - invertY=".concat(i," premultiplyAlpha=").concat(o)),gz._IsHardwareTexture(e)?(x=e.underlyingResource,(!i||o||1!==u||0!==s)&&(e=void 0)):(x=e,e=void 0),x){C&&this._bufferManager.setRawData(this._ubCopyWithOfst,0,new Float32Array([c,l,h,p]),0,16);var R=e,S=null!==(_=null==R?void 0:R._copyInvertYTempTexture)&&void 0!==_?_:this.createTexture({width:t,height:r,layers:1},!1,!1,!1,!1,!1,n,1,f,_N.TextureUsage.CopySrc|_N.TextureUsage.RenderAttachment|_N.TextureUsage.TextureBinding),M=null!==(m=null==R?void 0:R._copyInvertYRenderPassDescr)&&void 0!==m?m:{colorAttachments:[{view:S.createView({format:n,dimension:_N.TextureViewDimension.E2d,baseMipLevel:0,mipLevelCount:1,arrayLayerCount:1,baseArrayLayer:0}),loadOp:_N.LoadOp.Load,storeOp:_N.StoreOp.Store}]},w=f.beginRenderPass(M),B=C?null==R?void 0:R._copyInvertYBindGroupWithOfst:null==R?void 0:R._copyInvertYBindGroup;if(!B){var O={layout:T,entries:[{binding:0,resource:x.createView({format:n,dimension:_N.TextureViewDimension.E2d,baseMipLevel:a,mipLevelCount:1,arrayLayerCount:u,baseArrayLayer:s})}]};C&&O.entries.push({binding:1,resource:{buffer:this._ubCopyWithOfst}}),B=this._device.createBindGroup(O)}w.setPipeline(v),w.setBindGroup(0,B),w.draw(4,1,0,0),w.end(),f.copyTextureToTexture({texture:S},{texture:x,mipLevel:a,origin:{x:0,y:0,z:s}},{width:t,height:r,depthOrArrayLayers:1}),R?(R._copyInvertYTempTexture=S,R._copyInvertYRenderPassDescr=M,C?R._copyInvertYBindGroupWithOfst=B:R._copyInvertYBindGroup=B):this._deferredReleaseTextures.push([S,null]),null===(E=(y=f).popDebugGroup)||void 0===E||E.call(y),b&&(this._device.queue.submit([f.finish()]),f=null)}},gz.prototype.copyWithInvertY=function(e,t,r,n){var i,o,s,a,u=void 0===n,c=this._getPipeline(t,cz.InvertYPremultiplyAlpha,{invertY:!0,premultiplyAlpha:!1}),l=c[0],h=c[1];u&&(n=this._device.createCommandEncoder({})),null===(o=(i=n).pushDebugGroup)||void 0===o||o.call(i,"internal copy texture with invertY");var p=n.beginRenderPass(r),f=this._device.createBindGroup({layout:h,entries:[{binding:0,resource:e}]});p.setPipeline(l),p.setBindGroup(0,f),p.draw(4,1,0,0),p.end(),null===(a=(s=n).popDebugGroup)||void 0===a||a.call(s),u&&(this._device.queue.submit([n.finish()]),n=null)},gz.prototype.createTexture=function(e,t,r,n,i,o,s,a,u,c,l,h){void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===s&&(s=_N.TextureFormat.RGBA8Unorm),void 0===a&&(a=1),void 0===c&&(c=-1),void 0===l&&(l=0),void 0===h&&(h=1),a>1&&(a=4);var p=e.layers||1,f={width:e.width,height:e.height,depthOrArrayLayers:p},d=gz.IsCompressedFormat(s),A=t?gz.ComputeNumMipmapLevels(e.width,e.height):1;h>1&&(A=h);var g=c>=0?c:_N.TextureUsage.CopySrc|_N.TextureUsage.CopyDst|_N.TextureUsage.TextureBinding;l|=t&&!d?_N.TextureUsage.CopySrc|_N.TextureUsage.RenderAttachment:0,!d&&!o&&(l|=_N.TextureUsage.RenderAttachment|_N.TextureUsage.CopyDst);var _=this._device.createTexture({size:f,dimension:o?_N.TextureDimension.E3d:_N.TextureDimension.E2d,format:s,usage:g|l,sampleCount:a,mipLevelCount:A});return gz.IsImageBitmap(e)&&(this.updateTexture(e,_,e.width,e.height,p,s,0,0,n,i,0,0),t&&r&&this.generateMipmaps(_,s,A,0,u)),_},gz.prototype.createCubeTexture=function(e,t,r,n,i,o,s,a,u,c){void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===o&&(o=_N.TextureFormat.RGBA8Unorm),void 0===s&&(s=1),void 0===u&&(u=-1),void 0===c&&(c=0),s>1&&(s=4);var l=gz.IsImageBitmapArray(e)?e[0].width:e.width,h=gz.IsImageBitmapArray(e)?e[0].height:e.height,p=gz.IsCompressedFormat(o),f=t?gz.ComputeNumMipmapLevels(l,h):1,d=u>=0?u:_N.TextureUsage.CopySrc|_N.TextureUsage.CopyDst|_N.TextureUsage.TextureBinding;c|=t&&!p?_N.TextureUsage.CopySrc|_N.TextureUsage.RenderAttachment:0,!p&&(c|=_N.TextureUsage.RenderAttachment|_N.TextureUsage.CopyDst);var A=this._device.createTexture({size:{width:l,height:h,depthOrArrayLayers:6},dimension:_N.TextureDimension.E2d,format:o,usage:d|c,sampleCount:s,mipLevelCount:f});return gz.IsImageBitmapArray(e)&&(this.updateCubeTextures(e,A,l,h,o,n,i,0,0),t&&r&&this.generateCubeMipmaps(A,o,f,a)),A},gz.prototype.generateCubeMipmaps=function(e,t,r,n){var i,o,s,a,u=void 0===n;u&&(n=this._device.createCommandEncoder({})),null===(o=(i=n).pushDebugGroup)||void 0===o||o.call(i,"create cube mipmaps - ".concat(r," levels"));for(var c=0;c<6;++c)this.generateMipmaps(e,t,r,c,n);null===(a=(s=n).popDebugGroup)||void 0===a||a.call(s),u&&(this._device.queue.submit([n.finish()]),n=null)},gz.prototype.generateMipmaps=function(e,t,r,n,i){var o,s,a,u,c,l,h,p;void 0===n&&(n=0);var f,d=void 0===i,A=this._getPipeline(t),g=A[0],_=A[1];if(n=Math.max(n,0),d&&(i=this._device.createCommandEncoder({})),null===(s=(o=i).pushDebugGroup)||void 0===s||s.call(o,"create mipmaps for face #".concat(n," - ").concat(r," levels")),gz._IsHardwareTexture(e)?(f=e.underlyingResource,e._mipmapGenRenderPassDescr=e._mipmapGenRenderPassDescr||[],e._mipmapGenBindGroup=e._mipmapGenBindGroup||[]):(f=e,e=void 0),f){for(var m=e,y=1;y<r;++y){var E=null!==(u=null===(a=null==m?void 0:m._mipmapGenRenderPassDescr[n])||void 0===a?void 0:a[y-1])&&void 0!==u?u:{colorAttachments:[{view:f.createView({format:t,dimension:_N.TextureViewDimension.E2d,baseMipLevel:y,mipLevelCount:1,arrayLayerCount:1,baseArrayLayer:n}),loadOp:_N.LoadOp.Load,storeOp:_N.StoreOp.Store}]};m&&(m._mipmapGenRenderPassDescr[n]=m._mipmapGenRenderPassDescr[n]||[],m._mipmapGenRenderPassDescr[n][y-1]=E);var x=i.beginRenderPass(E),C=null!==(l=null===(c=null==m?void 0:m._mipmapGenBindGroup[n])||void 0===c?void 0:c[y-1])&&void 0!==l?l:this._device.createBindGroup({layout:_,entries:[{binding:0,resource:this._mipmapSampler},{binding:1,resource:f.createView({format:t,dimension:_N.TextureViewDimension.E2d,baseMipLevel:y-1,mipLevelCount:1,arrayLayerCount:1,baseArrayLayer:n})}]});m&&(m._mipmapGenBindGroup[n]=m._mipmapGenBindGroup[n]||[],m._mipmapGenBindGroup[n][y-1]=C),x.setPipeline(g),x.setBindGroup(0,C),x.draw(4,1,0,0),x.end()}null===(p=(h=i).popDebugGroup)||void 0===p||p.call(h),d&&(this._device.queue.submit([i.finish()]),i=null)}},gz.prototype.generateMipmapsByCS=async function(e,t,r,n,i){var o=t._texture._hardwareTexture.underlyingResource,s=this._userEngine;const a=e,u=new dG(s);u.addUniform("srcDimension",1),u.addUniform("texelSize",2);var c=new dG(s);c.addUniform("texelSize",2);var l=a._texture.width,h=a._texture.height,p=new Zd(s,l*h*4*4),f=new Zd(s,l*h*4*4),d=new uz("texSamplerCS",s,{computeSource:"\nstruct Rgba {\n    R : f32,\n    G : f32,\n    B : f32,\n    A : f32,\n};\n\nstruct ColorBuffer {\n    colors : array<Rgba>,\n};\n\nstruct Params {\n    srcDimension : u32,\n    texelSize : vec2<f32>, \n};\n\n\nfn linear2Gamma(linearRGB : vec3<f32>) -> vec3<f32>\n{\n    if(linearRGB.x < 0.0031308 && linearRGB.y < 0.0031308\n    && linearRGB.z < 0.0031308){\n        return 12.92 * linearRGB;\n    }else{\n        return 1.13005 * sqrt(abs(linearRGB - vec3<f32>(0.00228,0.00228,0.00228))) - 0.13448 * linearRGB \n        +  vec3<f32>(0.005719,0.005719,0.005719);   \n    }\n}\n\nfn packColor(srcColor : vec4<f32>) -> vec4<f32>\n{\n#ifdef CONVERT_TO_SRGB\n    return float4(linear2Gamma(srcColor.xyz), srcColor.w);\n#else\n    return srcColor;\n#endif\n}\n\n@group(0) @binding(0) var<uniform> params : Params;\n@group(0) @binding(1) var<storage, read_write> buffer_out : ColorBuffer;\n@group(0) @binding(2) var oriDepthTexture : texture_depth_2d;\n@group(0) @binding(2) var oriTexture : texture_2d<f32>;\n@group(0) @binding(3) var mip0Texture : texture_storage_2d<rgba8unorm, write>;\n\n// pass0 原始Mip纹理采样\n@compute @workgroup_size(8, 8, 1)\nfn main(@builtin(global_invocation_id) global_id : vec3<u32>) \n{\n    var texelSize = params.texelSize;\n\n    // 若要对非2n纹理采样使用此分情况额外处理\n    var srcDimension : u32 = params.srcDimension;\n    var pix : vec4<f32> = vec4<f32>(0, 0, 0, 1);\n\n    #if _useDepthTexture\n        let depth : f32 = textureLoad(oriDepthTexture, vec2<i32>(global_id.xy), 0);\n        pix = vec4<f32>(depth, 0., 0., 1.);\n    #else\n        pix= packColor(textureLoad(oriTexture, vec2<i32>(global_id.xy), 0));\n    #endif\n   \n    let offSet = global_id.x + global_id.y * u32(texelSize.x);\n    let rgba : Rgba = Rgba(pix.x, pix.y, pix.z, pix.w);\n    buffer_out.colors[offSet] = rgba;\n    textureStore(mip0Texture, vec2<i32>(global_id.xy), pix);\n}\n"},{bindingsMapping:r?{params:{group:0,binding:0},buffer_out:{group:0,binding:1},oriDepthTexture:{group:0,binding:2},mip0Texture:{group:0,binding:3}}:{params:{group:0,binding:0},buffer_out:{group:0,binding:1},oriTexture:{group:0,binding:2},mip0Texture:{group:0,binding:3}},defines:[r?"_useDepthTexture":""]}),A=new uz("generateMipCS",s,{computeSource:"\nstruct Rgba {\n    R : f32,\n    G : f32,\n    B : f32,\n    A : f32,\n};\n\n\nstruct ColorBuffer {\n    colors : array<Rgba>,\n};\n\nstruct Params {\n    texelSize : vec2<f32>, \n};\n\nfn nearAverage(a : Rgba, b : Rgba, c : Rgba, d : Rgba) -> Rgba\n{\n    let sumR  = dot(vec4<f32>(a.R, b.R, c.R, d.R), vec4<f32>(1.0));\n    let sumG  = dot(vec4<f32>(a.G, b.G, c.G, d.G), vec4<f32>(1.0));\n    let sumB  = dot(vec4<f32>(a.B, b.B, c.B, d.B), vec4<f32>(1.0));\n    let sumA  = dot(vec4<f32>(a.A, b.A, c.A, d.A), vec4<f32>(1.0));\n\n    return Rgba(sumR/4.0, sumG/4.0, sumB/4.0, sumA/4.0);\n}\n\nfn maxDepthValue(a : Rgba, b : Rgba, c : Rgba, d : Rgba) -> Rgba\n{\n    var resColor : vec4<f32> = max(max(vec4<f32>(a.R, a.G, a.B, a.A), vec4<f32>(b.R, b.G, b.B, b.A)), max(vec4<f32>(c.R, c.G, c.B, c.A), vec4<f32>(d.R, d.G, d.B, d.A)));\n    return Rgba(resColor.x, resColor.y, resColor.z, resColor.w);\n}\n\n@group(0) @binding(0) var<uniform> params : Params;\n@group(0) @binding(1) var<storage, read> buffer_in : ColorBuffer;\n@group(0) @binding(2) var<storage, read_write> buffer_out : ColorBuffer;\n@group(0) @binding(3) var mipMapsTexture : texture_storage_2d<rgba8unorm, write>;\n\n// pass1 颜色求均值写入mip\n@compute @workgroup_size(8, 8, 1)\nfn main(@builtin(global_invocation_id) global_id : vec3<u32>) \n{\n    if(all(global_id.xy < vec2<u32>(textureDimensions(mipMapsTexture)))){\n        let width = u32(params.texelSize.x);\n        let dst_offSet = global_id.x + global_id.y * width;\n        let src_offSet = global_id.x*2u + global_id.y*2u * width*2u;\n\n        let texel1 : Rgba = buffer_in.colors[src_offSet + 0u];\n        let texel2 : Rgba = buffer_in.colors[src_offSet + 1u];\n        let texel3 : Rgba = buffer_in.colors[src_offSet + 0u +  width*2u];\n        let texel4 : Rgba = buffer_in.colors[src_offSet + 1u +  width*2u];\n\n        var resColor : Rgba = Rgba(1,1,1,1);\n        #if _isHizDepthTex\n            resColor = maxDepthValue(texel1, texel2, texel3, texel4);\n        #else\n            resColor = nearAverage(texel1, texel2, texel3, texel4);\n        #endif\n        buffer_out.colors[dst_offSet] = resColor;\n\n        textureStore(mipMapsTexture, vec2<i32>(global_id.xy), vec4<f32>(resColor.R, resColor.G, resColor.B, resColor.A));\n    }\n}\n"},{bindingsMapping:{params:{group:0,binding:0},buffer_in:{group:0,binding:1},buffer_out:{group:0,binding:2},mipMapsTexture:{group:0,binding:3}},defines:[n?"_isHizDepthTex":""]}),g=d;for(let e=0;e<i;e++){let n=l>>e,d=h>>e;if(e>0&&(g=A),0==e){let e=(1&d)<<1|1&n;u.updateInt("srcDimension",e),u.updateFloat2("texelSize",n,d),u.update(),g.setUniformBuffer("params",u),r?g.setTexture("oriDepthTexture",a,!1):g.setTexture("oriTexture",a,!1),g.setStorageTexture("mip0Texture",t)}else{c.updateFloat2("texelSize",n,d),c.update(),g.setUniformBuffer("params",c);let r=o.createView({format:"rgba8unorm",dimension:_N.TextureViewDimension.E2d,mipLevelCount:1,baseArrayLayer:0,baseMipLevel:e});t._texture._hardwareTexture.viewForWriting=r,g.setStorageTexture("mipMapsTexture",t)}1&e?(g.setStorageBuffer("buffer_in",p),g.setStorageBuffer("buffer_out",f)):(e>0&&g.setStorageBuffer("buffer_in",f),g.setStorageBuffer("buffer_out",p)),await g.dispatchWhenReady(Math.ceil(n/8),Math.ceil(d/8),1),e!=i-1&&s._currentRenderTarget&&s.unBindFramebuffer(s._currentRenderTarget)}p.dispose(),f.dispose(),c.dispose(),u.dispose()},gz.prototype.createGPUTextureForInternalTexture=function(e,t,r,n,i){!e._hardwareTexture&&(e._hardwareTexture=new FL),void 0===t&&(t=e.width),void 0===r&&(r=e.height),void 0===n&&(n=e.depth);var o=e._hardwareTexture,s=!!((null!=i?i:0)&Qd.TEXTURE_CREATIONFLAG_STORAGE);o.format=gz.GetWebGPUTextureFormat(e.type,e.format,e._useSRGBBuffer),o.textureUsages=e._source===BF.RenderTarget||e.source===BF.MultiRenderTarget?_N.TextureUsage.TextureBinding|_N.TextureUsage.CopySrc|_N.TextureUsage.RenderAttachment:e._source===BF.DepthStencil?_N.TextureUsage.TextureBinding|_N.TextureUsage.RenderAttachment:-1,o.textureAdditionalUsages=s?_N.TextureUsage.StorageBinding:0;var a,u=e.generateMipMaps,c=n||1;if(a=null!==e._maxLodLevel?e._maxLodLevel:e.mipmapCount>1?e.mipmapCount:u?gz.ComputeNumMipmapLevels(t,r):1,e.isCube){var l=this.createCubeTexture({width:t,height:r},e.generateMipMaps,e.generateMipMaps,e.invertY,!1,o.format,1,this._commandEncoderForCreation,o.textureUsages,o.textureAdditionalUsages);o.set(l),o.createView({format:o.format,dimension:_N.TextureViewDimension.Cube,mipLevelCount:a,baseArrayLayer:0,baseMipLevel:0,arrayLayerCount:6,aspect:gz.HasDepthAndStencilAspects(o.format)?_N.TextureAspect.DepthOnly:_N.TextureAspect.All},s)}else{l=this.createTexture({width:t,height:r,layers:c},e.generateMipMaps,e.generateMipMaps,e.invertY,!1,e.is3D,o.format,1,this._commandEncoderForCreation,o.textureUsages,o.textureAdditionalUsages,a);o.set(l);var h=o.format;"depth24plus-stencil8"==h&&(h="depth24plus"),o.createView({format:h,dimension:e.is2DArray?_N.TextureViewDimension.E2dArray:e.is3D?_N.TextureDimension.E3d:_N.TextureViewDimension.E2d,mipLevelCount:a,baseArrayLayer:0,baseMipLevel:0,arrayLayerCount:e.is3D?1:c,aspect:gz.HasDepthAndStencilAspects(o.format)?_N.TextureAspect.DepthOnly:_N.TextureAspect.All},s)}return e.width=e.baseWidth=t,e.height=e.baseHeight=r,e.depth=e.baseDepth=n,this.createMSAATexture(e,e.samples),o},gz.prototype.createMSAATexture=function(e,t){var r=e._hardwareTexture;if((null==r?void 0:r.msaaTexture)&&(this.releaseTexture(r.msaaTexture),r.msaaTexture=null),r&&!((null!=t?t:1)<=1)){var n=e.width,i=e.height,o=e.depth||1;if(e.isCube){var s=this.createCubeTexture({width:n,height:i},!1,!1,e.invertY,!1,r.format,t,this._commandEncoderForCreation,r.textureUsages,r.textureAdditionalUsages);r.msaaTexture=s}else{s=this.createTexture({width:n,height:i,layers:o},!1,!1,e.invertY,!1,e.is3D,r.format,t,this._commandEncoderForCreation,r.textureUsages,r.textureAdditionalUsages);r.msaaTexture=s}var a=r.format;"depth24plus-stencil8"==a&&(a="depth24plus"),r.createMSAAView({format:a,dimension:e.is2DArray?_N.TextureViewDimension.E2dArray:e.is3D?_N.TextureDimension.E3d:_N.TextureViewDimension.E2d,mipLevelCount:1,baseArrayLayer:0,baseMipLevel:0,arrayLayerCount:e.is3D?1:o,aspect:gz.HasDepthAndStencilAspects(r.format)?_N.TextureAspect.DepthOnly:_N.TextureAspect.All})}},gz.prototype.updateCubeTextures=function(e,t,r,n,i,o,s,a,u){void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=0),void 0===u&&(u=0);for(var c=[0,3,1,4,2,5],l=0;l<c.length;++l){var h=e[c[l]];this.updateTexture(h,t,r,n,1,i,l,0,o,s,a,u)}},gz.prototype.updateTexture=function(e,t,r,n,i,o,s,a,u,c,l,h,p){void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=!1),void 0===c&&(c=!1),void 0===l&&(l=0),void 0===h&&(h=0);var f=gz._IsInternalTexture(t)?t._hardwareTexture.underlyingResource:t,d=gz._GetBlockInformationFromFormat(o),A=gz._IsInternalTexture(t)?t._hardwareTexture:t,g={texture:f,origin:{x:l,y:h,z:Math.max(s,0)},mipLevel:a,premultipliedAlpha:c},_={width:Math.ceil(r/d.width)*d.width,height:Math.ceil(n/d.height)*d.height,depthOrArrayLayers:i||1};if(void 0!==e.byteLength){var m=Math.ceil(r/d.width)*d.length,y=256*Math.ceil(m/256)===m;if(o==_N.TextureFormat.RGBA16Float&&(y=!1),y){var E=this._device.createCommandEncoder({}),x=this._bufferManager.createRawBuffer(e.byteLength,_N.BufferUsage.MapWrite|_N.BufferUsage.CopySrc,!0),C=x.getMappedRange();new Uint8Array(C).set(e),x.unmap(),E.copyBufferToTexture({buffer:x,offset:0,bytesPerRow:m,rowsPerImage:n},g,_),this._device.queue.submit([E.finish()]),this._bufferManager.releaseBuffer(x)}else this._device.queue.writeTexture(g,e,{offset:0,bytesPerRow:m,rowsPerImage:n},_);if(u||c){if(!gz._IsInternalTexture(t))throw"updateTexture: Can't process the texture data because a GPUTexture was provided instead of an InternalTexture!";var b=0===l&&0===h&&r===t.width&&n===t.height;this.invertYPreMultiplyAlpha(A,t.width,t.height,o,u,c,s,a,i||1,l,h,b?0:r,b?0:n,void 0,p)}}else if(u)if(g.premultipliedAlpha=!1,gz._IsInternalTexture(t)&&0===l&&0===h&&r===t.width&&n===t.height)this._device.queue.copyExternalImageToTexture({source:e},g,_),this.invertYPreMultiplyAlpha(A,r,n,o,u,c,s,a,i||1,0,0,0,0,void 0,p);else{E=this._device.createCommandEncoder({});var I=this.createTexture({width:r,height:n,layers:1},!1,!1,!1,!1,!1,o,1,E,_N.TextureUsage.CopySrc|_N.TextureUsage.TextureBinding);this._deferredReleaseTextures.push([I,null]),_.depthOrArrayLayers=1,this._device.queue.copyExternalImageToTexture({source:e},{texture:I},_),_.depthOrArrayLayers=i||1;this.invertYPreMultiplyAlpha(I,r,n,o,u,c,0,a,i||1,0,0,0,0,E,p),E.copyTextureToTexture({texture:I},g,_),this._device.queue.submit([E.finish()])}else this._device.queue.copyExternalImageToTexture({source:e},g,_)},gz.prototype.readPixels=function(e,t,r,n,i,o,s,a,u,c){void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=null),void 0===c&&(c=!1);var l=gz._GetBlockInformationFromFormat(o),h=Math.ceil(n/l.width)*l.length,p=256*Math.ceil(h/256),f=p*i,d=this._bufferManager.createRawBuffer(f,_N.BufferUsage.MapRead|_N.BufferUsage.CopyDst),A=this._device.createCommandEncoder({});return A.copyTextureToBuffer({texture:e,mipLevel:a,origin:{x:t,y:r,z:Math.max(s,0)}},{buffer:d,offset:0,bytesPerRow:p},{width:n,height:i,depthOrArrayLayers:1}),this._device.queue.submit([A.finish()]),this._bufferManager.readDataFromBuffer(d,f,n,i,h,p,gz._GetTextureTypeFromFormat(o),0,u,!0,c)},gz.prototype.releaseTexture=function(e){if(gz._IsInternalTexture(e)){var t=e._hardwareTexture,r=e._irradianceTexture;this._deferredReleaseTextures.push([t,r])}else this._deferredReleaseTextures.push([e,null])},gz.prototype.destroyDeferredTextures=function(){for(var e=0;e<this._deferredReleaseTextures.length;++e){var t=this._deferredReleaseTextures[e],r=t[0],n=t[1];r&&(gz._IsHardwareTexture(r)?r.release():r.destroy()),null==n||n.dispose()}this._deferredReleaseTextures.length=0};var _z=0;function mz(e){e=Qn(e,Qn.EMPTY_OBJECT),Un.defined("options.context",e.context);var t=e.context,r=e.width,n=e.height,i=e.source;Nn(i)&&(Nn(r)||(r=Qn(i.videoWidth,i.width)),Nn(n)||(n=Qn(i.videoHeight,i.height)));var o=Qn(e.pixelFormat,IA.RGBA),s=Qn(e.pixelDatatype,CA.UNSIGNED_BYTE),a=o,u=IA.isCompressedFormat(a);this._needGenerateMipmap=Qn(e.generateMipmap,!1);var c=Qn(e.flipY,!0),l=e.context.engine,h=BA.toPixelFormat(o),p=BA.toPixelType(s);this._sampler=Nn(e.sampler)?e.sampler:new gF,this._samples=Qn(e.samples,1);var f,d=BA.toAddressMode(this._sampler.wrapS),A=BA.toAddressMode(this._sampler.wrapT),g=BA.toSamplerMode(s,this._sampler),_=null;if(Nn(i))if(Nn(i.arrayBufferView)){var m=i.arrayBufferView;!u&&c&&(m=IA.flipY(m,o,s,r,n)),_=l.createRawTexture(m,r,n,h,this._needGenerateMipmap,!1,g,null,p,0,!1,1,this._samples),this._texture=new VF(_),_.wrapU=d,_.wrapV=A}else if(Nn(i.framebuffer))console.log("defined(source.framebuffer)");else if(void 0!==i.close)c=!1,_=l.createTexture("",!this._needGenerateMipmap,c,null,g,null,null,i,null,a,"",null,null,null,null),this._texture=new VF(_),_.wrapU=d,_.wrapV=A;else{var y=this;createImageBitmap(i).then((function(e){_=l.createTexture("",!y._needGenerateMipmap,c,null,g,null,null,e,null,a,"",null,null,null,null),y._texture=new VF(_),_.wrapU=d,_.wrapV=A})).catch((e=>{console.log("createImageBitmap")}))}else{if(o==IA.DEPTH_COMPONENT||o==IA.DEPTH_COMPONENT16||o==IA.DEPTH_COMPONENT32F||o==IA.DEPTH_STENCIL){var E={width:r,height:n},x={generateStencil:o==IA.DEPTH_STENCIL,bilinearFiltering:!1,isCube:!1,depthTextureFormat:h,samples:this._samples,comparisonFunction:this._sampler._comparisonFunction};_=l.createDepthStencilTexture(E,x),l._textureHelper.createGPUTextureForInternalTexture(_),this._texture=new VF(_)}else _=l.createRawTexture(m,r,n,h,this._needGenerateMipmap,c,g,!1,p,0,!1,0,this._samples),this._texture=new VF(_);_.wrapU=d,_.wrapV=A}f=u?IA.compressedTextureSizeInBytes(o,r,n):IA.textureSizeInBytes(o,s,r,n),this._id=_z++,this._context=t,this._pixelFormat=o,this._pixelDatatype=s,this._width=r,this._height=n,this._dimensions=new li(r,n),this._size=[r,n],this._mipmapTexture,this._sizeInBytes=f,this._flipY=c,this._ownerName=e.owner,t.memorySize+=f,t.memoryAnalyzer.allocateGPUMemory(Fd,e.owner,f)}function yz(e){e=Qn(e,Qn.EMPTY_OBJECT),Un.defined("options.context",e.context),e.context.webgpu?this._inner=new mz(e):this._inner=new AN(e)}mz.fromFramebuffer=function(e){e=Qn(e,Qn.EMPTY_OBJECT),Un.defined("options.context",e.context),e.context},Object.defineProperties(mz.prototype,{id:{set:function(e){this._id=e},get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},size:{get:function(){return this._size}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}},thinTexture:{get:function(){return this._texture}},internalTexture:{get:function(){return this._texture._texture}},GPUTexture:{get:function(){return this._texture._texture._hardwareTexture.underlyingResource}}}),mz.prototype.copyFrom=function(e,t,r){var n=e.width,i=e.height,o=e.arrayBufferView;if(Nn(o))this._context.engine.updateTextureData(this.internalTexture,o,t,r,n,i);else{var s=this.internalTexture,a=s._hardwareTexture;e instanceof HTMLVideoElement?this._context.engine.updateVideoTexture(s,e,!1):this._context.engine._textureHelper.updateTexture(e,s,n,i,s.depth,a.format,0,0,!0,!1,t,r)}},mz.prototype.copyFromFramebuffer=function(e,t,r,n,i,o){console.log("TextureGPU.prototype.copyFromFramebuffer")},mz.prototype.copyFromTexture=function(e,t,r,n,i,o,s){var a=this._context.engine._device,u=this.GPUTexture,c=e._inner.GPUTexture,l=a.createCommandEncoder({});l.copyTextureToTexture({texture:c,origin:{x:n,y:i,z:0}},{texture:u,origin:{x:t,y:r,z:0}},{width:c.width,height:c.height,depthOrArrayLayers:1}),a.queue.submit([l.finish()])},mz.prototype.generateMipmap=function(e){if(this._needGenerateMipmap&&Nn(this._texture)){var t=gz.ComputeNumMipmapLevels(this._width,this._height),r=this.GPUTexture;this._context.engine._textureHelper.generateMipmaps(r,r.format,t,0)}else this._needGenerateMipmap=!0},mz.prototype.generateMipmapTextureByCS=function(){if(Nn(this.thinTexture)){if(this._context.engine._currentRenderTarget){var e=this;return void this._context.engine._onAfterUnbindFrameBufferObservable.addOnce((function(){e._afterCreate(!1)}))}this._afterCreate(!1)}},mz.prototype.generateHizDepthTextureByCS=function(){if(Nn(this.thinTexture)){if(this._context.engine._currentRenderTarget){var e=this;return void this._context.engine._onAfterUnbindFrameBufferObservable.addOnce((function(){e._afterCreate(!0)}))}this._afterCreate(!0)}},mz.prototype._afterCreate=function(e){var t=gz.ComputeNumMipmapLevels(this._width,this._height),r=this.pixelFormat==IA.DEPTH_COMPONENT||this.pixelFormat==IA.DEPTH_STENCIL;let n=this._context.engine.createRawTexture(null,this._width,this._height,Qd.TEXTUREFORMAT_RGBA,!0,this.internalTexture.invertY,this.internalTexture.samplingMode,!1,0,Qd.TEXTURE_CREATIONFLAG_STORAGE,!1,t,this.internalTexture.samples);this._mipmapTexture=new VF(n),this._context.engine._textureHelper.generateMipmapsByCS(this._texture,this._mipmapTexture,r,e,t)},mz.prototype.isDestroyed=function(){return!1},mz.prototype.destroy=function(){return this._context.memorySize-=this._sizeInBytes,this._context.memoryAnalyzer.releaseGPUMemory(Fd,this._ownerName,this._sizeInBytes),this._texture.dispose(),Dd(this)},yz.create=function(e){return new yz(e)},yz.fromFramebuffer=function(e){e=Qn(e,Qn.EMPTY_OBJECT),Un.defined("options.context",e.context);var t=e.context,r=t._gl,n=Qn(e.pixelFormat,IA.RGB),i=Qn(e.framebufferXOffset,0),o=Qn(e.framebufferYOffset,0),s=Qn(e.width,r.drawingBufferWidth),a=Qn(e.height,r.drawingBufferHeight),u=e.framebuffer;if(!IA.validate(n))throw new Ln("Invalid pixelFormat.");if(IA.isDepthFormat(n)||IA.isCompressedFormat(n))throw new Ln("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.");if(Un.defined("options.context",e.context),Un.typeOf.number.greaterThanOrEquals("framebufferXOffset",i,0),Un.typeOf.number.greaterThanOrEquals("framebufferYOffset",o,0),i+s>r.drawingBufferWidth)throw new Ln("framebufferXOffset + width must be less than or equal to drawingBufferWidth");if(o+a>r.drawingBufferHeight)throw new Ln("framebufferYOffset + height must be less than or equal to drawingBufferHeight.");return new yz({context:t,width:s,height:a,pixelFormat:n,source:{framebuffer:Nn(u)?u:t.defaultFramebuffer,xOffset:i,yOffset:o,width:s,height:a}})},Object.defineProperties(yz.prototype,{id:{set:function(e){this._inner.id=e},get:function(){return this._inner.id}},sampler:{get:function(){return this._inner.sampler},set:function(e){this._inner.sampler=e}},pixelFormat:{get:function(){return this._inner.pixelFormat}},pixelDatatype:{get:function(){return this._inner.pixelDatatype}},dimensions:{get:function(){return this._inner.dimensions}},size:{get:function(){return this._inner.size}},preMultiplyAlpha:{get:function(){return this._inner.preMultiplyAlpha}},flipY:{get:function(){return this._inner.flipY}},width:{get:function(){return this._inner.width}},height:{get:function(){return this._inner.height}},sizeInBytes:{get:function(){return this._inner.sizeInBytes}},_target:{get:function(){return this._inner._target}},_texture:{get:function(){return this._inner._texture}},is3D:{get:function(){return!1}},is2DArray:{get:function(){return!1}},samples:{get:function(){return this._inner._samples}}}),yz.prototype.copyFrom=function(e,t,r){this._inner.copyFrom(e,t,r)},yz.prototype.copyFromFramebuffer=function(e,t,r,n,i,o){this._inner.copyFromFramebuffer(e,t,r,n,i,o)},yz.prototype.copyFromTexture=function(e,t,r,n,i,o,s){this._inner.copyFromTexture(e,t,r,n,i,o,s)},yz.prototype.generateMipmap=function(e){this._inner.generateMipmap(e)},yz.prototype.isDestroyed=function(){return!1},yz.prototype.destroy=function(){return this._inner.destroy(),Dd(this)};var Ez,xz=(Ez=!0,function(e,t){var r=Ez?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Ez=!1,r}),Cz=xz(void 0,(function(){return Cz.toString().search("(((.+)+)+)+$").toString().constructor(Cz).search("(((.+)+)+)+$")}));Cz();const bz=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Iz=bz(void 0,(function(){return Iz.toString().search("(((.+)+)+)+$").toString().constructor(Iz).search("(((.+)+)+)+$")}));Iz();const vz=new Uint16Array(8184);for(let e=0;e<2046;e++){let t=e+2,r=0,n=0,i=0,o=0,s=0,a=0;for(1&t?i=o=s=32:r=n=a=32;(t>>=1)>1;){const e=r+i>>1,u=n+o>>1;1&t?(i=r,o=n,r=s,n=a):(r=i,n=o,i=s,o=a),s=e,a=u}const u=4*e;vz[u+0]=r,vz[u+1]=n,vz[u+2]=i,vz[u+3]=o}var Tz,Rz=(Tz=!0,function(e,t){var r=Tz?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Tz=!1,r}),Sz=Rz(void 0,(function(){return Sz.toString().search("(((.+)+)+)+$").toString().constructor(Sz).search("(((.+)+)+)+$")}));Sz(),Cf([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);var Mz,wz=(Mz=!0,function(e,t){var r=Mz?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Mz=!1,r}),Bz=wz(void 0,(function(){return Bz.toString().search("(((.+)+)+)+$").toString().constructor(Bz).search("(((.+)+)+)+$")}));Bz(),Cf([{name:"a_pos",type:"Int16",components:2}]);const Oz=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Dz=Oz(void 0,(function(){return Dz.toString().search("(((.+)+)+)+$").toString().constructor(Dz).search("(((.+)+)+)+$")}));Dz(),new vc;const Fz=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Pz=Fz(void 0,(function(){return Pz.toString().search("(((.+)+)+)+$").toString().constructor(Pz).search("(((.+)+)+)+$")}));Pz();const Nz=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Lz=Nz(void 0,(function(){return Lz.toString().search("(((.+)+)+)+$").toString().constructor(Lz).search("(((.+)+)+)+$")}));Lz();class Uz{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new n(Ec,16,0),this.featureIndexArray=new fd,this.promoteId=t}insert(e,t,r,n,i,o=0){const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i,o);const a=this.grid;for(let e=0;e<t.length;e++){const r=t[e],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<r.length;e++){const t=r[e];n[0]=Math.min(n[0],t.x),n[1]=Math.min(n[1],Ec-t.y),n[2]=Math.max(n[2],t.x),n[3]=Math.max(n[3],Ec-t.y)}n[0]<Ec&&n[1]<Ec&&n[2]>=0&&n[3]>=0&&a.insert(s,n[0],n[1],n[2],n[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new nF(new UI(this.rawTileData)).layers,this.sourceLayerCoder=new aF(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,t,r,n){this.loadVTLayers();const i=e.params||{},o=zg(i.filter),s=e.tileResult;e.transform;const a=s.bufferedTilespaceBounds,u=this.grid.query(a.min.x,a.min.y,a.max.x,a.max.y,((e,t,r,n)=>function(e,t,r,n,i){for(const o of e)if(t<=o.x&&r<=o.y&&n>=o.x&&i>=o.y)return!0;const o=[new Pn(t,r),new Pn(t,i),new Pn(n,i),new Pn(n,r)];if(e.length>2)for(const t of o)if(L_(e,t))return!0;for(let t=0;t<e.length-1;t++)if(U_(e[t],e[t+1],o))return!0;return!1}(s.bufferedTilespaceGeometry,e,t,r,n)));u.sort(Qz);const c={};let l;for(let a=0;a<u.length;a++){const h=u[a];if(h===l)continue;l=h;const p=this.featureIndexArray.get(h);let f=null;this.loadMatchingFeature(c,p,o,i.layers,i.availableImages,t,r,n,((t,r,n,i=0)=>(!f&&(f=g_(t,!1)),r.queryIntersectsFeature(s,t,n,f,this.z,e.transform,e.pixelPosMatrix,null,i))))}return c}loadMatchingFeature(e,t,r,n,i,o,s,a,u){const{featureIndex:c,bucketIndex:l,sourceLayerIndex:h,layoutVertexArrayOffset:p}=t,f=this.bucketLayerIDs[l];if(n&&!function(e,t){for(let r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}(n,f))return;const d=this.sourceLayerCoder.decode(h),A=this.vtLayers[d].feature(c);if(r.needGeometry){const e=E_(A,!0);if(!r.filter(new $p(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!r.filter(new $p(this.tileID.overscaledZ),A))return;const g=this.getId(A,d);for(let t=0;t<f.length;t++){const r=f[t];if(n&&n.indexOf(r)<0)continue;const l=o[r];if(!l)continue;let h={};void 0!==g&&a&&(h=a.getState(l.sourceLayer||"_geojsonTileLayer",g));const d=ip({},s[r]);d.paint=Gz(d.paint,l.paint,A,h,i),d.layout=Gz(d.layout,l.layout,A,h,i);const _=!u||u(A,l,h,p);if(!_)continue;const m=new hF(A,this.z,this.x,this.y,g);m.layer=d;let y=e[r];void 0===y&&(y=e[r]=[]),y.push({featureIndex:c,feature:m,intersectionZ:_})}}lookupSymbolFeatures(e,t,r,n,i,o,s,a){const u={};this.loadVTLayers();const c=zg(i);for(const i of e)this.loadMatchingFeature(u,{bucketIndex:r,sourceLayerIndex:n,featureIndex:i,layoutVertexArrayOffset:0},c,o,s,a,t);return u}loadFeature(e){const{featureIndex:t,sourceLayerIndex:r}=e;this.loadVTLayers();const n=this.sourceLayerCoder.decode(r),i=this.vtFeatures[n];if(i[t])return i[t];const o=this.vtLayers[n].feature(t);return i[t]=o,o}hasLayer(e){for(const t of this.bucketLayerIDs)for(const r of t)if(e===r)return!0;return!1}getId(e,t){let r=e.id;if(this.promoteId){const n="string"==typeof this.promoteId?this.promoteId:this.promoteId[t];null!=n&&(r=e.properties[n]),"boolean"==typeof r&&(r=Number(r))}return r}}function Gz(e,t,r,n,i){return ap(e,((e,o)=>{const s=t instanceof uf?t.get(o):null;return s&&s.evaluate?s.evaluate(r,n,i):s}))}function Qz(e,t){return t-e}Sp(Uz,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const kz=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),zz=kz(void 0,(function(){return zz.toString().search("(((.+)+)+)+$").toString().constructor(zz).search("(((.+)+)+)+$")}));zz();class jz{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.image=new yx({width:e,height:t}),this.positions={},this.uploaded=!1}getDash(e,t){const r=this.getKey(e,t);return this.positions[r]}trim(){const e=this.width,t=this.height=(r=this.nextRow)<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2));var r;this.image.resize({width:e,height:t})}getKey(e,t){return e.join(",")+t}getDashRanges(e,t,r){const n=[];let i=e.length%2==1?-e[e.length-1]*r:0,o=e[0]*r,s=!0;n.push({left:i,right:o,isDash:s,zeroLength:0===e[0]});let a=e[0];for(let t=1;t<e.length;t++){s=!s;const u=e[t];i=a*r,a+=u,o=a*r,n.push({left:i,right:o,isDash:s,zeroLength:0===u})}return n}addRoundDash(e,t,r){const n=t/2;for(let t=-r;t<=r;t++){const i=this.nextRow+r+t,o=this.width*i;let s=0,a=e[s];for(let i=0;i<this.width;i++){i/a.right>1&&(a=e[++s]);const u=Math.abs(i-a.left),c=Math.abs(i-a.right),l=Math.min(u,c);let h;const p=t/r*(n+1);if(a.isDash){const e=n-Math.abs(p);h=Math.sqrt(l*l+e*e)}else h=n-Math.sqrt(l*l+p*p);this.image.data[o+i]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e,t){for(let t=e.length-1;t>=0;--t){const r=e[t],n=e[t+1];r.zeroLength?e.splice(t,1):n&&n.isDash===r.isDash&&(n.left=r.left,e.splice(t,1))}const r=e[0],n=e[e.length-1];r.isDash===n.isDash&&(r.left=n.left-this.width,n.right=r.right+this.width);const i=this.width*this.nextRow;let o=0,s=e[o];for(let r=0;r<this.width;r++){r/s.right>1&&(s=e[++o]);const n=Math.abs(r-s.left),a=Math.abs(r-s.right),u=Math.min(n,a),c=(s.isDash?u:-u)+t;this.image.data[i+r]=Math.max(0,Math.min(255,c+128))}}addDash(e,t){const r=this.getKey(e,t);if(this.positions[r])return this.positions[r];const n="round"===t,i=n?7:0,o=2*i+1;if(this.nextRow+o>this.height)return lp("LineAtlas out of space"),null;0===e.length&&e.push(1);let s=0;for(let t=0;t<e.length;t++)e[t]<0&&(lp("Negative value is found in line dasharray, replacing values with 0"),e[t]=0),s+=e[t];if(0!==s){const r=this.width/s,o=this.getDashRanges(e,this.width,r);if(n)this.addRoundDash(o,r,i);else{const e="square"===t?.5*r:0;this.addRegularDash(o,e)}}const a=this.nextRow+i;this.nextRow+=o;const u={tl:[a,i],br:[s,0]};return this.positions[r]=u,u}}Sp(jz,"LineAtlas");const Hz=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),qz=Hz(void 0,(function(){return qz.toString().search("(((.+)+)+)+$").toString().constructor(qz).search("(((.+)+)+)+$")}));qz();class Vz{constructor(e){const t={},r=[];for(const n in e){const i=e[n],o=t[n]={};for(const e in i.glyphs){const t=i.glyphs[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const n=t.metrics.localGlyph?2:1,s={x:0,y:0,w:t.bitmap.width+2*n,h:t.bitmap.height+2*n};r.push(s),o[e]=s}}const{w:n,h:i}=iv(r),o=new yx({width:n||1,height:i||1});for(const r in e){const n=e[r];for(const e in n.glyphs){const i=n.glyphs[+e];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const s=t[r][e],a=i.metrics.localGlyph?2:1;yx.copy(i.bitmap,o,{x:0,y:0},{x:s.x+a,y:s.y+a},i.bitmap)}}this.image=o,this.positions=t}}Sp(Vz,"GlyphAtlas");const Yz=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Xz=Yz(void 0,(function(){return Xz.toString().search("(((.+)+)+)+$").toString().constructor(Xz).search("(((.+)+)+)+$")}));Xz();class Wz{constructor(e){this.tileID=new DM(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y,e.tileID.canonical.indexExtent),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=LM(e.tileID.canonical,e.projection),this.projection=e.projection,this.crs=e.crs}parse(e,t,r,n,i,o){this.status="parsing",this.data=t,this.collisionBoxArray=new od;const s=new aF(Object.keys(t.layers).sort()),a=new Uz(this.tileID,this.promoteId);a.bucketLayerIDs=[];const u={},c=new jz(256,256),l={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:c,availableImages:n,crs:this.crs},h=r.familiesBySource[this.source];for(const r in h){const i=t.layers[r];if(!i)continue;let o=!1,c=!1;for(const e of h[r])"symbol"===e[0].type?o=!0:c=!0;if(!0===this.isSymbolTile&&!o)continue;if(!1===this.isSymbolTile&&!c)continue;1===i.version&&lp('Vector tile source "'+this.source+'" layer "'+r+'" does not use vector tile spec v2 and therefore may have some rendering errors.');const p=s.encode(r),f=[];for(let e=0;e<i.length;e++){const t=i.feature(e),n=a.getId(t,r);f.push({feature:t,id:n,index:e,sourceLayerIndex:p})}for(const t of h[r]){const r=t[0];if(void 0!==this.isSymbolTile&&"symbol"===r.type!==this.isSymbolTile)continue;if(r.minzoom&&this.zoom<Math.floor(r.minzoom))continue;if(r.maxzoom&&this.zoom>=r.maxzoom)continue;if("none"===r.visibility)continue;Kz(t,this.zoom,n);(u[r.id]=r.createBucket({index:a.bucketLayerIDs.length,layers:t,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:p,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:n,webgpu:e.webgpu})).populate(f,l,this.tileID.canonical,this.tileTransform),a.bucketLayerIDs.push(t.map((e=>e.id)))}}let p,f,d,A;c.trim();const g={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},_=()=>{if(p)return o(p);if(f&&d&&A){const e=new Vz(f),t=new uv(d,A);for(const r in u){const i=u[r];if(i instanceof tD)Kz(i.layers,this.zoom,n),AT(i,f,e.positions,d,t.iconPositions,this.showCollisionBoxes,n,this.tileID.canonical,this.tileZoom,this.projection,this.crs);else if(i.hasPattern&&(i instanceof GC||i instanceof qx)){Kz(i.layers,this.zoom,n);const e=t.patternPositions;i.addFeatures(l,this.tileID.canonical,e,n,this.tileTransform)}}this.status="done",o(null,{buckets:np(u).filter((e=>!e.isEmpty())),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:c,imageAtlas:t,glyphMap:this.returnDependencies?f:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?e.positions:null})}},m=ap(l.glyphDependencies,(e=>Object.keys(e).map(Number)));Object.keys(m).length?i.send("getGlyphs",{uid:this.uid,stacks:m,source:this.source},((e,t)=>{!p&&(p=e,f=t,_())}),void 0,!1,g):f={};const y=Object.keys(l.iconDependencies);y.length?i.send("getImages",{icons:y,source:this.source,tileID:this.tileID,type:"icons"},((e,t)=>{!p&&(p=e,d=t,_())}),void 0,!1,g):d={};const E=Object.keys(l.patternDependencies);E.length?i.send("getImages",{icons:E,source:this.source,tileID:this.tileID,type:"patterns"},((e,t)=>{!p&&(p=e,A=t,_())}),void 0,!1,g):A={},_()}}function Kz(e,t,r){const n=new $p(t);for(const t of e)t.recalculate(n,r)}var $z,Jz,Zz=void 0!==Zz?Zz:{},ej=Object.assign({},Zz),tj="object"==typeof window,rj="function"==typeof importScripts,nj="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,ij="";if(nj){var oj=require("fs"),sj=require("path");ij=rj?sj.dirname(ij)+"/":__dirname+"/",$z=(e,t)=>(e=Ij(e)?new URL(e):sj.normalize(e),oj.readFileSync(e,t?void 0:"utf8")),Jz=e=>{var t=$z(e,!0);return t.buffer||(t=new Uint8Array(t)),t},!Zz.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),"undefined"!=typeof module&&(module.exports=Zz),process.on("uncaughtException",(e=>{if(!("unwind"===e||e instanceof Rj||e.context instanceof Rj))throw e})),Zz.inspect=()=>"[Emscripten Module object]"}else(tj||rj)&&(rj?ij=self.location.href:"undefined"!=typeof document&&document.currentScript&&(ij=document.currentScript.src),ij=0!==ij.indexOf("blob:")?ij.substr(0,ij.replace(/[?#].*/,"").lastIndexOf("/")+1):"",$z=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},rj&&(Jz=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));Zz.print||console.log.bind(console);var aj,uj,cj=Zz.printErr||console.error.bind(console);function lj(e){if(bj(e))return function(e){if(void 0!==nj&&nj){var t=Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.length)}for(var r=atob(e),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n}(e.slice(Cj.length))}Object.assign(Zz,ej),ej=null,Zz.arguments&&Zz.arguments,Zz.thisProgram&&Zz.thisProgram,Zz.quit&&Zz.quit,Zz.wasmBinary&&(aj=Zz.wasmBinary),"object"!=typeof WebAssembly&&yj("no native wasm support detected");var hj,pj=!1;function fj(){var e=uj.buffer;Zz.HEAP8=new Int8Array(e),Zz.HEAP16=new Int16Array(e),Zz.HEAPU8=hj=new Uint8Array(e),Zz.HEAPU16=new Uint16Array(e),Zz.HEAP32=new Int32Array(e),Zz.HEAPU32=new Uint32Array(e),Zz.HEAPF32=new Float32Array(e),Zz.HEAPF64=new Float64Array(e)}var dj=[],Aj=[],gj=[];var _j=0,mj=null;function yj(e){throw Zz.onAbort&&Zz.onAbort(e),cj(e="Aborted("+e+")"),pj=!0,e+=". Build with -sASSERTIONS for more info.",new WebAssembly.RuntimeError(e)}var Ej,xj,Cj="data:application/octet-stream;base64,",bj=e=>e.startsWith(Cj),Ij=e=>e.startsWith("file://");function vj(e){return Promise.resolve().then((()=>function(e){if(e==Ej&&aj)return new Uint8Array(aj);var t=lj(e);if(t)return t;if(Jz)return Jz(e);throw"both async and sync fetching of the wasm failed"}(e)))}function Tj(e,t,r,n){return function(e,t,r){return vj(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{cj(`failed to asynchronously prepare wasm: ${e}`),yj(e)}))}(t,r,n)}function Rj(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}bj(Ej="data:application/octet-stream;base64,AGFzbQEAAAABHwZgAX8Bf2ABfwBgAABgA39/fwBgA39/fwF/YAJ/fwACDQIBYQFhAAABYQFiAAIDExIAAwAAAgEBAQUDAAMFAQQEAQQEBQFwAQEBBQcBAYACgIACBggBfwFBkJAECwchCAFjAgABZAAGAWUAEwFmABEBZwAQAWgBAAFpAAwBagASCuZdEioBAX8jAEEQayIBIAA6AA8gAS0ADyIAQQF0IABBB3VBAXFBG2xzQf8BcQufAQEBfyMAQRBrIgMgADoADyADIAE2AgggAyACNgIEIANBADoAAwNAIAMtAANBBE9FBEAgA0EAOgACA0AgAy0AAiIBQQRPRQRAIAEgAy0AA0ECdCICIAMoAghqaiIAIAMoAgQgASACIAMtAA9BBHRqamotAAAgAC0AAHM6AAAgAyADLQACQQFqOgACDAELCyADIAMtAANBAWo6AAMMAQsLC08BAn9BkAwoAgAiASAAQQdqQXhxIgJqIQACQCACQQAgACABTRsNACAAPwBBEHRLBEAgABAARQ0BC0GQDCAANgIAIAEPC0GUDEEwNgIAQX8LNQEBf0EBIAAgAEEBTRshAAJAA0AgABAMIgENAUGIECgCACIBBEAgARECAAwBCwsQAQALIAELAgAL+AEBAX8jAEEQayIBIAA2AgwgASABKAIMLQANOgALIAEoAgwgASgCDC0ACToADSABKAIMIAEoAgwtAAU6AAkgASgCDCABKAIMLQABOgAFIAEoAgwgAS0ACzoAASABIAEoAgwtAAI6AAsgASgCDCABKAIMLQAKOgACIAEoAgwgAS0ACzoACiABIAEoAgwtAAY6AAsgASgCDCABKAIMLQAOOgAGIAEoAgwgAS0ACzoADiABIAEoAgwtAAM6AAsgASgCDCABKAIMLQAHOgADIAEoAgwgASgCDC0ACzoAByABKAIMIAEoAgwtAA86AAsgASgCDCABLQALOgAPC/gBAQF/IwBBEGsiASAANgIMIAEgASgCDC0AAToACyABKAIMIAEoAgwtAAU6AAEgASgCDCABKAIMLQAJOgAFIAEoAgwgASgCDC0ADToACSABKAIMIAEtAAs6AA0gASABKAIMLQACOgALIAEoAgwgASgCDC0ACjoAAiABKAIMIAEtAAs6AAogASABKAIMLQAGOgALIAEoAgwgASgCDC0ADjoABiABKAIMIAEtAAs6AA4gASABKAIMLQADOgALIAEoAgwgASgCDC0ADzoAAyABKAIMIAEoAgwtAAs6AA8gASgCDCABKAIMLQAHOgALIAEoAgwgAS0ACzoABwt7AQF/IwBBEGsiASAANgIMIAFBADoACwNAIAEtAAtBBE9FBEAgAUEAOgAKA0AgAS0ACiIAQQRPRQRAIAEtAAsgASgCDCAAQQJ0amoiACAALQAALQCACDoAACABIAEtAApBAWo6AAoMAQsLIAEgAS0AC0EBajoACwwBCwsL6wQBAX8jAEEQayICJAAgAiAANgIMIAIgATYCCCACQQA6AAdBACACKAIMIAIoAggQAyACQQE6AAcDQCACLQAHQQ5JBEAgAigCDBAJIAIoAgwQCCACKAIMIQEjAEEQayIAJAAgACABNgIMIABBADoACwNAIAAtAAsiAUEESQRAIAAgACgCDCABQQJ0ai0AADoACCAAIAAoAgwgAC0AC0ECdGoiAS0AAyABLQACIAEtAAAgAS0AAXNzczoACiAAIAAoAgwgAC0AC0ECdGotAAAgACgCDCAALQALQQJ0ai0AAXM6AAkgACAALQAJEAI6AAkgACgCDCAALQALQQJ0aiIBIAEtAAAgAC0ACSAALQAKc3M6AAAgACAAKAIMIAAtAAtBAnRqLQABIAAoAgwgAC0AC0ECdGotAAJzOgAJIAAgAC0ACRACOgAJIAAoAgwgAC0AC0ECdGoiASABLQABIAAtAAkgAC0ACnNzOgABIAAgACgCDCAALQALQQJ0ai0AAiAAKAIMIAAtAAtBAnRqLQADczoACSAAIAAtAAkQAjoACSAAKAIMIAAtAAtBAnRqIgEgAS0AAiAALQAJIAAtAApzczoAAiAAIAAoAgwgAC0AC0ECdGotAAMgAC0ACHM6AAkgACAALQAJEAI6AAkgACgCDCAALQALQQJ0aiIBIAEtAAMgAC0ACSAALQAKc3M6AAMgACAALQALQQFqOgALDAELCyAAQRBqJAAgAi0AByACKAIMIAIoAggQAyACIAItAAdBAWo6AAcMAQsLIAIoAgwQCSACKAIMEAhBDiACKAIMIAIoAggQAyACQRBqJAALmwYBAX8jAEEQayIDJAAgAyAANgIMIAMgATYCCCADIAI2AgQgAygCCCEBIwBBIGsiACADKAIMNgIcIAAgATYCGCAAQQA2AhQDQCAAKAIUIgFBCEkEQCABQQJ0IgEgACgCHGogASAAKAIYai0AADoAACAAKAIUQQJ0QQFqIgEgACgCHGogASAAKAIYai0AADoAACAAKAIUQQJ0QQJqIgEgACgCHGogASAAKAIYai0AADoAACAAKAIUQQJ0QQNqIgEgACgCHGogASAAKAIYai0AADoAACAAIAAoAhRBAWo2AhQMAQsLIABBCDYCFANAIAAoAhQiAUE8SQRAIAAgAUEBa0ECdDYCDCAAIAAoAhwgACgCDGotAAA6AAggACAAKAIcIAAoAgxBAWpqLQAAOgAJIAAgACgCHCAAKAIMQQJqai0AADoACiAAIAAoAhwgACgCDEEDamotAAA6AAsgACgCFEEHcUUEQCAAIAAtAAg6AAcgACAALQAJOgAIIAAgAC0ACjoACSAAIAAtAAs6AAogACAALQAHOgALIAAgAC0ACC0AgAg6AAggACAALQAJLQCACDoACSAAIAAtAAotAIAIOgAKIAAgAC0ACy0AgAg6AAsgACAALQAIIAAoAhRBA3YtAIAKczoACAsgACgCFEEHcUEERgRAIAAgAC0ACC0AgAg6AAggACAALQAJLQCACDoACSAAIAAtAAotAIAIOgAKIAAgAC0ACy0AgAg6AAsLIAAgACgCFEECdDYCECAAIAAoAhRBCGtBAnQ2AgwgACgCHCIBIAAoAhBqIAAoAgwgAWotAAAgAC0ACHM6AAAgACgCHCAAKAIQQQFqaiAAKAIcIAAoAgxBAWpqLQAAIAAtAAlzOgAAIAAoAhwgACgCEEECamogACgCHCAAKAIMQQJqai0AACAALQAKczoAACAAKAIcIAAoAhBBA2pqIAAoAhwgACgCDEEDamotAAAgAC0AC3M6AAAgACAAKAIUQQFqNgIUDAELCyADKAIMIgAgAygCBCIBKQAANwDwASAAIAEpAAg3APgBIANBEGokAAvOJwEMfyMAQRBrIgokAAJAAkACQAJAAkACQAJAAkACQCAAQfQBTQRAQZgMKAIAIgZBECAAQQtqQXhxIABBC0kbIgVBA3YiAHYiAUEDcQRAAkAgAUF/c0EBcSAAaiICQQN0IgFBwAxqIgAgAUHIDGooAgAiASgCCCIDRgRAQZgMIAZBfiACd3E2AgAMAQsgAyAANgIMIAAgAzYCCAsgAUEIaiEAIAEgAkEDdCICQQNyNgIEIAEgAmoiASABKAIEQQFyNgIEDAoLIAVBoAwoAgAiB00NASABBEACQEECIAB0IgJBACACa3IgASAAdHFoIgFBA3QiAEHADGoiAiAAQcgMaigCACIAKAIIIgNGBEBBmAwgBkF+IAF3cSIGNgIADAELIAMgAjYCDCACIAM2AggLIAAgBUEDcjYCBCAAIAVqIgQgAUEDdCIBIAVrIgNBAXI2AgQgACABaiADNgIAIAcEQCAHQXhxQcAMaiEBQawMKAIAIQICfyAGQQEgB0EDdnQiBXFFBEBBmAwgBSAGcjYCACABDAELIAEoAggLIQUgASACNgIIIAUgAjYCDCACIAE2AgwgAiAFNgIICyAAQQhqIQBBrAwgBDYCAEGgDCADNgIADAoLQZwMKAIAIgtFDQEgC2hBAnRByA5qKAIAIgIoAgRBeHEgBWshBCACIQEDQAJAIAEoAhAiAEUEQCABKAIUIgBFDQELIAAoAgRBeHEgBWsiASAEIAEgBEkiARshBCAAIAIgARshAiAAIQEMAQsLIAIoAhghCSACIAIoAgwiA0cEQEGoDCgCABogAigCCCIAIAM2AgwgAyAANgIIDAkLIAJBFGoiASgCACIARQRAIAIoAhAiAEUNAyACQRBqIQELA0AgASEIIAAiA0EUaiIBKAIAIgANACADQRBqIQEgAygCECIADQALIAhBADYCAAwIC0F/IQUgAEG/f0sNACAAQQtqIgBBeHEhBUGcDCgCACIIRQ0AQQAgBWshBAJAAkACQAJ/QQAgBUGAAkkNABpBHyAFQf///wdLDQAaIAVBJiAAQQh2ZyIAa3ZBAXEgAEEBdGtBPmoLIgdBAnRByA5qKAIAIgFFBEBBACEADAELQQAhACAFQRkgB0EBdmtBACAHQR9HG3QhAgNAAkAgASgCBEF4cSAFayIGIARPDQAgASEDIAYiBA0AQQAhBCABIQAMAwsgACABKAIUIgYgBiABIAJBHXZBBHFqKAIQIgFGGyAAIAYbIQAgAkEBdCECIAENAAsLIAAgA3JFBEBBACEDQQIgB3QiAEEAIABrciAIcSIARQ0DIABoQQJ0QcgOaigCACEACyAARQ0BCwNAIAAoAgRBeHEgBWsiAiAESSEBIAIgBCABGyEEIAAgAyABGyEDIAAoAhAiAQR/IAEFIAAoAhQLIgANAAsLIANFDQAgBEGgDCgCACAFa08NACADKAIYIQcgAyADKAIMIgJHBEBBqAwoAgAaIAMoAggiACACNgIMIAIgADYCCAwHCyADQRRqIgEoAgAiAEUEQCADKAIQIgBFDQMgA0EQaiEBCwNAIAEhBiAAIgJBFGoiASgCACIADQAgAkEQaiEBIAIoAhAiAA0ACyAGQQA2AgAMBgsgBUGgDCgCACIDTQRAQawMKAIAIQACQCADIAVrIgFBEE8EQCAAIAVqIgIgAUEBcjYCBCAAIANqIAE2AgAgACAFQQNyNgIEDAELIAAgA0EDcjYCBCAAIANqIgEgASgCBEEBcjYCBEEAIQJBACEBC0GgDCABNgIAQawMIAI2AgAgAEEIaiEADAgLIAVBpAwoAgAiAkkEQEGkDCACIAVrIgE2AgBBsAxBsAwoAgAiACAFaiICNgIAIAIgAUEBcjYCBCAAIAVBA3I2AgQgAEEIaiEADAgLQQAhACAFQS9qIgQCf0HwDygCAARAQfgPKAIADAELQfwPQn83AgBB9A9CgKCAgICABDcCAEHwDyAKQQxqQXBxQdiq1aoFczYCAEGEEEEANgIAQdQPQQA2AgBBgCALIgFqIgZBACABayIIcSIBIAVNDQdB0A8oAgAiAwRAQcgPKAIAIgcgAWoiCSAHTQ0IIAMgCUkNCAsCQEHUDy0AAEEEcUUEQAJAAkACQAJAQbAMKAIAIgMEQEHYDyEAA0AgAyAAKAIAIgdPBEAgByAAKAIEaiADSw0DCyAAKAIIIgANAAsLQQAQBCICQX9GDQMgASEGQfQPKAIAIgBBAWsiAyACcQRAIAEgAmsgAiADakEAIABrcWohBgsgBSAGTw0DQdAPKAIAIgAEQEHIDygCACIDIAZqIgggA00NBCAAIAhJDQQLIAYQBCIAIAJHDQEMBQsgBiACayAIcSIGEAQiAiAAKAIAIAAoAgRqRg0BIAIhAAsgAEF/Rg0BIAVBMGogBk0EQCAAIQIMBAtB+A8oAgAiAiAEIAZrakEAIAJrcSICEARBf0YNASACIAZqIQYgACECDAMLIAJBf0cNAgtB1A9B1A8oAgBBBHI2AgALIAEQBCECQQAQBCEAIAJBf0YNBSAAQX9GDQUgACACTQ0FIAAgAmsiBiAFQShqTQ0FC0HID0HIDygCACAGaiIANgIAQcwPKAIAIABJBEBBzA8gADYCAAsCQEGwDCgCACIEBEBB2A8hAANAIAIgACgCACIBIAAoAgQiA2pGDQIgACgCCCIADQALDAQLQagMKAIAIgBBACAAIAJNG0UEQEGoDCACNgIAC0EAIQBB3A8gBjYCAEHYDyACNgIAQbgMQX82AgBBvAxB8A8oAgA2AgBB5A9BADYCAANAIABBA3QiAUHIDGogAUHADGoiAzYCACABQcwMaiADNgIAIABBAWoiAEEgRw0AC0GkDCAGQShrIgBBeCACa0EHcSIBayIDNgIAQbAMIAEgAmoiATYCACABIANBAXI2AgQgACACakEoNgIEQbQMQYAQKAIANgIADAQLIAIgBE0NAiABIARLDQIgACgCDEEIcQ0CIAAgAyAGajYCBEGwDCAEQXggBGtBB3EiAGoiATYCAEGkDEGkDCgCACAGaiICIABrIgA2AgAgASAAQQFyNgIEIAIgBGpBKDYCBEG0DEGAECgCADYCAAwDC0EAIQMMBQtBACECDAMLQagMKAIAIAJLBEBBqAwgAjYCAAsgAiAGaiEBQdgPIQACQAJAAkADQCABIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQdgPIQADQAJAIAQgACgCACIBTwRAIAEgACgCBGoiAyAESw0BCyAAKAIIIQAMAQsLQaQMIAZBKGsiAEF4IAJrQQdxIgFrIgg2AgBBsAwgASACaiIBNgIAIAEgCEEBcjYCBCAAIAJqQSg2AgRBtAxBgBAoAgA2AgAgBCADQScgA2tBB3FqQS9rIgAgACAEQRBqSRsiAUEbNgIEIAFB4A8pAgA3AhAgAUHYDykCADcCCEHgDyABQQhqNgIAQdwPIAY2AgBB2A8gAjYCAEHkD0EANgIAIAFBGGohAANAIABBBzYCBCAAQQhqIQwgAEEEaiEAIAwgA0kNAAsgASAERg0CIAEgASgCBEF+cTYCBCAEIAEgBGsiAkEBcjYCBCABIAI2AgAgAkH/AU0EQCACQXhxQcAMaiEAAn9BmAwoAgAiAUEBIAJBA3Z0IgJxRQRAQZgMIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBDYCCCABIAQ2AgwgBCAANgIMIAQgATYCCAwDC0EfIQAgAkH///8HTQRAIAJBJiACQQh2ZyIAa3ZBAXEgAEEBdGtBPmohAAsgBCAANgIcIARCADcCECAAQQJ0QcgOaiEBAkBBnAwoAgAiA0EBIAB0IgZxRQRAQZwMIAMgBnI2AgAgASAENgIADAELIAJBGSAAQQF2a0EAIABBH0cbdCEAIAEoAgAhAwNAIAMiASgCBEF4cSACRg0DIABBHXYhAyAAQQF0IQAgASADQQRxaiIGKAIQIgMNAAsgBiAENgIQCyAEIAE2AhggBCAENgIMIAQgBDYCCAwCCyAAIAI2AgAgACAAKAIEIAZqNgIEIAJBeCACa0EHcWoiByAFQQNyNgIEIAFBeCABa0EHcWoiBCAFIAdqIgVrIQYCQEGwDCgCACAERgRAQbAMIAU2AgBBpAxBpAwoAgAgBmoiADYCACAFIABBAXI2AgQMAQtBrAwoAgAgBEYEQEGsDCAFNgIAQaAMQaAMKAIAIAZqIgA2AgAgBSAAQQFyNgIEIAAgBWogADYCAAwBCyAEKAIEIgJBA3FBAUYEQCACQXhxIQkCQCACQf8BTQRAIAQoAgwiACAEKAIIIgFGBEBBmAxBmAwoAgBBfiACQQN2d3E2AgAMAgsgASAANgIMIAAgATYCCAwBCyAEKAIYIQgCQCAEIAQoAgwiAEcEQEGoDCgCABogBCgCCCIBIAA2AgwgACABNgIIDAELAkAgBEEUaiIBKAIAIgJFBEAgBCgCECICRQ0BIARBEGohAQsDQCABIQMgAiIAQRRqIgEoAgAiAg0AIABBEGohASAAKAIQIgINAAsgA0EANgIADAELQQAhAAsgCEUNAAJAIAQoAhwiAUECdEHIDmoiAigCACAERgRAIAIgADYCACAADQFBnAxBnAwoAgBBfiABd3E2AgAMAgsgCEEQQRQgCCgCECAERhtqIAA2AgAgAEUNAQsgACAINgIYIAQoAhAiAQRAIAAgATYCECABIAA2AhgLIAQoAhQiAUUNACAAIAE2AhQgASAANgIYCyAGIAlqIQYgBCAJaiIEKAIEIQILIAQgAkF+cTYCBCAFIAZBAXI2AgQgBSAGaiAGNgIAIAZB/wFNBEAgBkF4cUHADGohAAJ/QZgMKAIAIgFBASAGQQN2dCICcUUEQEGYDCABIAJyNgIAIAAMAQsgACgCCAshASAAIAU2AgggASAFNgIMIAUgADYCDCAFIAE2AggMAQtBHyECIAZB////B00EQCAGQSYgBkEIdmciAGt2QQFxIABBAXRrQT5qIQILIAUgAjYCHCAFQgA3AhAgAkECdEHIDmohAQJAAkBBnAwoAgAiAEEBIAJ0IgNxRQRAQZwMIAAgA3I2AgAgASAFNgIADAELIAZBGSACQQF2a0EAIAJBH0cbdCECIAEoAgAhAANAIAAiASgCBEF4cSAGRg0CIAJBHXYhACACQQF0IQIgASAAQQRxaiIDKAIQIgANAAsgAyAFNgIQCyAFIAE2AhggBSAFNgIMIAUgBTYCCAwBCyABKAIIIgAgBTYCDCABIAU2AgggBUEANgIYIAUgATYCDCAFIAA2AggLIAdBCGohAAwFCyABKAIIIgAgBDYCDCABIAQ2AgggBEEANgIYIAQgATYCDCAEIAA2AggLQaQMKAIAIgAgBU0NAEGkDCAAIAVrIgE2AgBBsAxBsAwoAgAiACAFaiICNgIAIAIgAUEBcjYCBCAAIAVBA3I2AgQgAEEIaiEADAMLQZQMQTA2AgBBACEADAILAkAgB0UNAAJAIAMoAhwiAEECdEHIDmoiASgCACADRgRAIAEgAjYCACACDQFBnAwgCEF+IAB3cSIINgIADAILIAdBEEEUIAcoAhAgA0YbaiACNgIAIAJFDQELIAIgBzYCGCADKAIQIgAEQCACIAA2AhAgACACNgIYCyADKAIUIgBFDQAgAiAANgIUIAAgAjYCGAsCQCAEQQ9NBEAgAyAEIAVqIgBBA3I2AgQgACADaiIAIAAoAgRBAXI2AgQMAQsgAyAFQQNyNgIEIAMgBWoiAiAEQQFyNgIEIAIgBGogBDYCACAEQf8BTQRAIARBeHFBwAxqIQACf0GYDCgCACIBQQEgBEEDdnQiBXFFBEBBmAwgASAFcjYCACAADAELIAAoAggLIQEgACACNgIIIAEgAjYCDCACIAA2AgwgAiABNgIIDAELQR8hACAEQf///wdNBEAgBEEmIARBCHZnIgBrdkEBcSAAQQF0a0E+aiEACyACIAA2AhwgAkIANwIQIABBAnRByA5qIQECQAJAIAhBASAAdCIFcUUEQEGcDCAFIAhyNgIAIAEgAjYCAAwBCyAEQRkgAEEBdmtBACAAQR9HG3QhACABKAIAIQUDQCAFIgEoAgRBeHEgBEYNAiAAQR12IQUgAEEBdCEAIAEgBUEEcWoiBigCECIFDQALIAYgAjYCEAsgAiABNgIYIAIgAjYCDCACIAI2AggMAQsgASgCCCIAIAI2AgwgASACNgIIIAJBADYCGCACIAE2AgwgAiAANgIICyADQQhqIQAMAQsCQCAJRQ0AAkAgAigCHCIAQQJ0QcgOaiIBKAIAIAJGBEAgASADNgIAIAMNAUGcDCALQX4gAHdxNgIADAILIAlBEEEUIAkoAhAgAkYbaiADNgIAIANFDQELIAMgCTYCGCACKAIQIgAEQCADIAA2AhAgACADNgIYCyACKAIUIgBFDQAgAyAANgIUIAAgAzYCGAsCQCAEQQ9NBEAgAiAEIAVqIgBBA3I2AgQgACACaiIAIAAoAgRBAXI2AgQMAQsgAiAFQQNyNgIEIAIgBWoiAyAEQQFyNgIEIAMgBGogBDYCACAHBEAgB0F4cUHADGohAEGsDCgCACEBAn9BASAHQQN2dCIFIAZxRQRAQZgMIAUgBnI2AgAgAAwBCyAAKAIICyEFIAAgATYCCCAFIAE2AgwgASAANgIMIAEgBTYCCAtBrAwgAzYCAEGgDCAENgIACyACQQhqIQALIApBEGokACAAC60CAQF/IwBBMGsiAyQAIAMgADYCLCADIAE2AiggAyACNgIkIANBADYCDCADQRA2AggDQCADKAIMIAMoAiRJBEAgAygCCEEQRgRAIANBEGoiACADKAIsIgEpAPABNwAAIAAgASkA+AE3AAggACADKAIsEAogA0EPNgIIA0ACQCADKAIIIgBBAEgNAAJAIAAgAygCLEHwAWpqIgAtAABB/wFGBEAgAEEAOgAADAELIAMoAgggAygCLEHwAWpqIgAgAC0AAEEBajoAAAwBCyADIAMoAghBAWs2AggMAQsLIANBADYCCAsgAygCKCADKAIMaiIAIAAtAAAgAygCCCADQRBqai0AAHM6AAAgAyADKAIMQQFqNgIMIAMgAygCCEEBajYCCAwBCwsgA0EwaiQAC1wBAX8jAEEQayICIAA2AgwgAiABNgIIIAJBADoABwNAIAItAAciAUEQT0UEQCABIAIoAgxqIgAgASACKAIIai0AACAALQAAczoAACACIAItAAdBAWo6AAcMAQsLC3sBAX8jAEEQayIBIAA2AgwgAUEAOgALA0AgAS0AC0EET0UEQCABQQA6AAoDQCABLQAKIgBBBE9FBEAgAS0ACyABKAIMIABBAnRqaiIAIAAtAAAtAJAKOgAAIAEgAS0ACkEBajoACgwBCwsgASABLQALQQFqOgALDAELCwuCEQEDfyMAQYACayIFJAACQCABRQ0AIAJFDQAgBSAAKAIEIAAoAggQCwJAAkACQCAAKAIAQQFrDgIAAQILIwBBIGsiAyQAIAMgBTYCHCADIAE2AhggAyACNgIUIANBADYCEANAIAMoAhAgAygCFEkEQCADIAMoAhgiACkAADcAACADIAApAAg3AAggAygCGCEAIAMoAhwhBCMAQRBrIgEkACABIAA2AgwgASAENgIIIAFBADoAB0EOIAEoAgwgASgCCBADIAFBDToABwNAIAEtAAcEQCABKAIMEAcgASgCDBAPIAEtAAcgASgCDCABKAIIEAMgASgCDCEEIwBBEGsiACQAIAAgBDYCDCAAQQA2AggDQCAAKAIIIgRBBEgEQCAAIAAoAgwgBEECdGotAAA6AAcgACAAKAIMIAAoAghBAnRqLQABOgAGIAAgACgCDCAAKAIIQQJ0ai0AAjoABSAAIAAoAgwgACgCCEECdGotAAM6AAQgAC0AByIEQQBsIAQQAkH/AXFzIAAtAAcQAkH/AXEQAkH/AXFzIAAtAAcQAkH/AXEQAkH/AXEQAkH/AXFzIAAtAAcQAkH/AXEQAkH/AXEQAkH/AXEQAkH/AXFBAGxzIAAtAAYiBCAEEAJB/wFxcyAALQAGEAJB/wFxEAJB/wFxQQBscyAALQAGEAJB/wFxEAJB/wFxEAJB/wFxcyAALQAGEAJB/wFxEAJB/wFxEAJB/wFxEAJB/wFxQQBsc3MgAC0ABSIEIAQQAkH/AXFBAGxzIAAtAAUQAkH/AXEQAkH/AXFzIAAtAAUQAkH/AXEQAkH/AXEQAkH/AXFzIAAtAAUQAkH/AXEQAkH/AXEQAkH/AXEQAkH/AXFBAGxzcyAALQAEIgQgBBACQf8BcUEAbHMgAC0ABBACQf8BcRACQf8BcUEAbHMgAC0ABBACQf8BcRACQf8BcRACQf8BcXMgAC0ABBACQf8BcRACQf8BcRACQf8BcRACQf8BcUEAbHNzIQQgACgCDCAAKAIIQQJ0aiAEOgAAIAAtAAcgAC0ABxACQf8BcUEAbHMgAC0ABxACQf8BcRACQf8BcUEAbHMgAC0ABxACQf8BcRACQf8BcRACQf8BcXMgAC0ABxACQf8BcRACQf8BcRACQf8BcRACQf8BcUEAbHMgAC0ABkEAbCAALQAGEAJB/wFxcyAALQAGEAJB/wFxEAJB/wFxcyAALQAGEAJB/wFxEAJB/wFxEAJB/wFxcyAALQAGEAJB/wFxEAJB/wFxEAJB/wFxEAJB/wFxQQBsc3MgAC0ABSAALQAFEAJB/wFxcyAALQAFEAJB/wFxEAJB/wFxQQBscyAALQAFEAJB/wFxEAJB/wFxEAJB/wFxcyAALQAFEAJB/wFxEAJB/wFxEAJB/wFxEAJB/wFxQQBsc3MgAC0ABCAALQAEEAJB/wFxQQBscyAALQAEEAJB/wFxEAJB/wFxcyAALQAEEAJB/wFxEAJB/wFxEAJB/wFxcyAALQAEEAJB/wFxEAJB/wFxEAJB/wFxEAJB/wFxQQBsc3MhBCAAKAIMIAAoAghBAnRqIAQ6AAEgAC0AByAALQAHEAJB/wFxQQBscyAALQAHEAJB/wFxEAJB/wFxcyAALQAHEAJB/wFxEAJB/wFxEAJB/wFxcyAALQAHEAJB/wFxEAJB/wFxEAJB/wFxEAJB/wFxQQBscyAALQAGIAAtAAYQAkH/AXFBAGxzIAAtAAYQAkH/AXEQAkH/AXFBAGxzIAAtAAYQAkH/AXEQAkH/AXEQAkH/AXFzIAAtAAYQAkH/AXEQAkH/AXEQAkH/AXEQAkH/AXFBAGxzcyAALQAFQQBsIAAtAAUQAkH/AXFzIAAtAAUQAkH/AXEQAkH/AXFzIAAtAAUQAkH/AXEQAkH/AXEQAkH/AXFzIAAtAAUQAkH/AXEQAkH/AXEQAkH/AXEQAkH/AXFBAGxzcyAALQAEIAAtAAQQAkH/AXFzIAAtAAQQAkH/AXEQAkH/AXFBAGxzIAAtAAQQAkH/AXEQAkH/AXEQAkH/AXFzIAAtAAQQAkH/AXEQAkH/AXEQAkH/AXEQAkH/AXFBAGxzcyEEIAAoAgwgACgCCEECdGogBDoAAiAALQAHIAAtAAcQAkH/AXFzIAAtAAcQAkH/AXEQAkH/AXFBAGxzIAAtAAcQAkH/AXEQAkH/AXEQAkH/AXFzIAAtAAcQAkH/AXEQAkH/AXEQAkH/AXEQAkH/AXFBAGxzIAAtAAYgAC0ABhACQf8BcUEAbHMgAC0ABhACQf8BcRACQf8BcXMgAC0ABhACQf8BcRACQf8BcRACQf8BcXMgAC0ABhACQf8BcRACQf8BcRACQf8BcRACQf8BcUEAbHNzIAAtAAUgAC0ABRACQf8BcUEAbHMgAC0ABRACQf8BcRACQf8BcUEAbHMgAC0ABRACQf8BcRACQf8BcRACQf8BcXMgAC0ABRACQf8BcRACQf8BcRACQf8BcRACQf8BcUEAbHNzIAAtAARBAGwgAC0ABBACQf8BcXMgAC0ABBACQf8BcRACQf8BcXMgAC0ABBACQf8BcRACQf8BcRACQf8BcXMgAC0ABBACQf8BcRACQf8BcRACQf8BcRACQf8BcUEAbHNzIQQgACgCDCAAKAIIQQJ0aiAEOgADIAAgACgCCEEBajYCCAwBCwsgAEEQaiQAIAEgAS0AB0EBazoABwwBCwsgASgCDBAHIAEoAgwQD0EAIAEoAgwgASgCCBADIAFBEGokACADKAIYIAMoAhxB8AFqEA4gAygCHCIAIAMpAAA3APABIAAgAykACDcA+AEgAyADKAIYQRBqNgIYIAMgAygCEEEQajYCEAwBCwsgA0EgaiQADAELIAUgASACEA0LIAIhAwsgBUGAAmokACADC4ACAQJ/IwBBgAJrIgMkAAJAIAFFDQAgAkUNACADIAAoAgQgACgCCBALAkACQAJAIAAoAgBBAWsOAgABAgsjAEEgayIAJAAgACADNgIcIAAgATYCGCAAIAI2AhQgACAAKAIcQfABajYCDCAAQQA2AhADQCAAKAIQIAAoAhRJBEAgACgCGCAAKAIMEA4gACgCGCAAKAIcEAogACAAKAIYNgIMIAAgACgCGEEQajYCGCAAIAAoAhBBEGo2AhAMAQsLIAAoAhwiASAAKAIMIgQpAAA3APABIAEgBCkACDcA+AEgAEEgaiQADAELIAMgASACEA0LIAIhBAsgA0GAAmokACAEC9ILAQd/AkAgAEUNACAAQQhrIgIgAEEEaygCACIBQXhxIgBqIQUCQCABQQFxDQAgAUEDcUUNASACIAIoAgAiAWsiAkGoDCgCAEkNASAAIAFqIQACQAJAQawMKAIAIAJHBEAgAUH/AU0EQCABQQN2IQQgAigCDCIBIAIoAggiA0YEQEGYDEGYDCgCAEF+IAR3cTYCAAwFCyADIAE2AgwgASADNgIIDAQLIAIoAhghBiACIAIoAgwiAUcEQCACKAIIIgMgATYCDCABIAM2AggMAwsgAkEUaiIEKAIAIgNFBEAgAigCECIDRQ0CIAJBEGohBAsDQCAEIQcgAyIBQRRqIgQoAgAiAw0AIAFBEGohBCABKAIQIgMNAAsgB0EANgIADAILIAUoAgQiAUEDcUEDRw0CQaAMIAA2AgAgBSABQX5xNgIEIAIgAEEBcjYCBCAFIAA2AgAPC0EAIQELIAZFDQACQCACKAIcIgNBAnRByA5qIgQoAgAgAkYEQCAEIAE2AgAgAQ0BQZwMQZwMKAIAQX4gA3dxNgIADAILIAZBEEEUIAYoAhAgAkYbaiABNgIAIAFFDQELIAEgBjYCGCACKAIQIgMEQCABIAM2AhAgAyABNgIYCyACKAIUIgNFDQAgASADNgIUIAMgATYCGAsgAiAFTw0AIAUoAgQiAUEBcUUNAAJAAkACQAJAIAFBAnFFBEBBsAwoAgAgBUYEQEGwDCACNgIAQaQMQaQMKAIAIABqIgA2AgAgAiAAQQFyNgIEIAJBrAwoAgBHDQZBoAxBADYCAEGsDEEANgIADwtBrAwoAgAgBUYEQEGsDCACNgIAQaAMQaAMKAIAIABqIgA2AgAgAiAAQQFyNgIEIAAgAmogADYCAA8LIAFBeHEgAGohACABQf8BTQRAIAFBA3YhBCAFKAIMIgEgBSgCCCIDRgRAQZgMQZgMKAIAQX4gBHdxNgIADAULIAMgATYCDCABIAM2AggMBAsgBSgCGCEGIAUgBSgCDCIBRwRAQagMKAIAGiAFKAIIIgMgATYCDCABIAM2AggMAwsgBUEUaiIEKAIAIgNFBEAgBSgCECIDRQ0CIAVBEGohBAsDQCAEIQcgAyIBQRRqIgQoAgAiAw0AIAFBEGohBCABKAIQIgMNAAsgB0EANgIADAILIAUgAUF+cTYCBCACIABBAXI2AgQgACACaiAANgIADAMLQQAhAQsgBkUNAAJAIAUoAhwiA0ECdEHIDmoiBCgCACAFRgRAIAQgATYCACABDQFBnAxBnAwoAgBBfiADd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAE2AgAgAUUNAQsgASAGNgIYIAUoAhAiAwRAIAEgAzYCECADIAE2AhgLIAUoAhQiA0UNACABIAM2AhQgAyABNgIYCyACIABBAXI2AgQgACACaiAANgIAIAJBrAwoAgBHDQBBoAwgADYCAA8LIABB/wFNBEAgAEF4cUHADGohAQJ/QZgMKAIAIgNBASAAQQN2dCIAcUUEQEGYDCAAIANyNgIAIAEMAQsgASgCCAshACABIAI2AgggACACNgIMIAIgATYCDCACIAA2AggPC0EfIQMgAEH///8HTQRAIABBJiAAQQh2ZyIBa3ZBAXEgAUEBdGtBPmohAwsgAiADNgIcIAJCADcCECADQQJ0QcgOaiEBAkACQAJAQZwMKAIAIgRBASADdCIHcUUEQEGcDCAEIAdyNgIAIAEgAjYCACACIAE2AhgMAQsgAEEZIANBAXZrQQAgA0EfRxt0IQMgASgCACEBA0AgASIEKAIEQXhxIABGDQIgA0EddiEBIANBAXQhAyAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAI2AhAgAiAENgIYCyACIAI2AgwgAiACNgIIDAELIAQoAggiACACNgIMIAQgAjYCCCACQQA2AhggAiAENgIMIAIgADYCCAtBuAxBuAwoAgBBAWsiAEF/IAAbNgIACwtjAQF/QQwQBSIDIAA2AgAgA0EgEAUiADYCBCAAIAEpABg3ABggACABKQAQNwAQIAAgASkACDcACCAAIAEpAAA3AAAgA0EQEAUiADYCCCAAIAIpAAg3AAggACACKQAANwAAIAMLC6EEAgBBgAgLkARjfHd78mtvxTABZyv+16t2yoLJffpZR/Ct1KKvnKRywLf9kyY2P/fMNKXl8XHYMRUExyPDGJYFmgcSgOLrJ7J1CYMsGhtuWqBSO9azKeMvhFPRAO0g/LFbasu+OUpMWM/Q76r7Q00zhUX5An9QPJ+oUaNAj5KdOPW8ttohEP/z0s0ME+xfl0QXxKd+PWRdGXNggU/cIiqQiEbuuBTeXgvb4DI6CkkGJFzC06xikZXkeefIN22N1U6pbFb06mV6rgi6eCUuHKa0xujddB9LvYuKcD61ZkgD9g5hNVe5hsEdnuH4mBFp2Y6Umx6H6c5VKN+MoYkNv+ZCaEGZLQ+wVLsWjQECBAgQIECAGzYAAAAAAFIJatUwNqU4v0CjnoHz1/t84zmCmy//hzSOQ0TE3unLVHuUMqbCIz3uTJULQvrDTgguoWYo2SSydluiSW2L0SVy+PZkhmiYFtSkXMxdZbaSbHBIUP3tudpeFUZXp42dhJDYqwCMvNMK9+RYBbizRQbQLB6Pyj8PAsGvvQMBE4prOpERQU9n3OqX8s/O8LTmc5asdCLnrTWF4vk36Bx1325H8RpxHSnFiW+3Yg6qGL4b/FY+S8bSeSCa28D+eM1a9B/dqDOIB8cxsRIQWSeA7F9gUX+pGbVKDS3lep+TyZzvoOA7Ta4q9bDI67s8g1OZYRcrBH66d9Ym4WkUY1UhDH0AQZAMCwMQCAE=")||(xj=Ej,Ej=Zz.locateFile?Zz.locateFile(xj,ij):ij+xj);var Sj=e=>{for(;e.length>0;)e.shift()(Zz)};Zz.noExitRuntime;var Mj,wj=e=>{var t=(e-uj.buffer.byteLength+65535)/65536;try{return uj.grow(t),fj(),1}catch(e){}},Bj={b:()=>{yj("")},a:e=>{var t=hj.length,r=2147483648;if((e>>>=0)>r)return!1;for(var n=(e,t)=>e+(t-e%t)%t,i=1;i<=4;i*=2){var o=t*(1+.2/i);o=Math.min(o,e+100663296);var s=Math.min(r,n(Math.max(e,o),65536));if(wj(s))return!0}return!1}},Oj=function(){var e={a:Bj};function t(e,t){var r;return Oj=e.exports,uj=Oj.c,fj(),r=Oj.d,Aj.unshift(r),function(){if(_j--,Zz.monitorRunDependencies&&Zz.monitorRunDependencies(_j),0==_j&&mj){var e=mj;mj=null,e()}}(),Oj}if(_j++,Zz.monitorRunDependencies&&Zz.monitorRunDependencies(_j),Zz.instantiateWasm)try{return Zz.instantiateWasm(e,t)}catch(e){return cj(`Module.instantiateWasm callback failed with error: ${e}`),!1}return Tj(0,Ej,e,(function(e){t(e.instance)})),{}}();function Dj(){function e(){Mj||(Mj=!0,Zz.calledRun=!0,pj||(Sj(Aj),Zz.onRuntimeInitialized&&Zz.onRuntimeInitialized(),function(){if(Zz.postRun)for("function"==typeof Zz.postRun&&(Zz.postRun=[Zz.postRun]);Zz.postRun.length;)e=Zz.postRun.shift(),gj.unshift(e);var e;Sj(gj)}()))}_j>0||(!function(){if(Zz.preRun)for("function"==typeof Zz.preRun&&(Zz.preRun=[Zz.preRun]);Zz.preRun.length;)e=Zz.preRun.shift(),dj.unshift(e);var e;Sj(dj)}(),_j>0||(Zz.setStatus?(Zz.setStatus("Running..."),setTimeout((function(){setTimeout((function(){Zz.setStatus("")}),1),e()}),1)):e()))}if(Zz._UGCWasm_CipherAES_New=(e,t,r)=>(Zz._UGCWasm_CipherAES_New=Oj.e)(e,t,r),Zz._UGCWasm_CipherAES_Encrypt=(e,t,r)=>(Zz._UGCWasm_CipherAES_Encrypt=Oj.f)(e,t,r),Zz._UGCWasm_CipherAES_Decrypt=(e,t,r)=>(Zz._UGCWasm_CipherAES_Decrypt=Oj.g)(e,t,r),Zz._malloc=e=>(Zz._malloc=Oj.i)(e),Zz._free=e=>(Zz._free=Oj.j)(e),mj=function e(){Mj||Dj(),Mj||(mj=e)},Zz.preInit)for("function"==typeof Zz.preInit&&(Zz.preInit=[Zz.preInit]);Zz.preInit.length>0;)Zz.preInit.pop()();Dj();var Fj=function(e){e=void 0!==e?e:{};var t,r,n=Object.assign({},e),i="object"==typeof window,o="function"==typeof importScripts,s="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,a="";if(s){var u=require("fs"),c=require("path");a=o?c.dirname(a)+"/":__dirname+"/",t=(e,t)=>(e=v(e)?new URL(e):c.normalize(e),u.readFileSync(e,t?void 0:"utf8")),r=e=>{var r=t(e,!0);return r.buffer||(r=new Uint8Array(r)),r},!e.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),"undefined"!=typeof module&&(module.exports=e),process.on("uncaughtException",(e=>{if(!("unwind"===e||e instanceof S||e.context instanceof S))throw e})),e.inspect=()=>"[Emscripten Module object]"}else(i||o)&&(o?a=self.location.href:"undefined"!=typeof document&&document.currentScript&&(a=document.currentScript.src),a=0!==a.indexOf("blob:")?a.substr(0,a.replace(/[?#].*/,"").lastIndexOf("/")+1):"",t=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},o&&(r=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));e.print||console.log.bind(console);var l,h,p=e.printErr||console.error.bind(console);Object.assign(e,n),n=null,e.arguments&&e.arguments,e.thisProgram&&e.thisProgram,e.quit&&e.quit,e.wasmBinary&&(l=e.wasmBinary),"object"!=typeof WebAssembly&&x("no native wasm support detected");var f,d=!1;function A(){var t=h.buffer;e.HEAP8=new Int8Array(t),e.HEAP16=new Int16Array(t),e.HEAPU8=f=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAP32=new Int32Array(t),e.HEAPU32=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}var g=[],_=[],m=[],y=0,E=null;function x(t){throw e.onAbort&&e.onAbort(t),p(t="Aborted("+t+")"),d=!0,t+=". Build with -sASSERTIONS for more info.",new WebAssembly.RuntimeError(t)}var C,b="data:application/octet-stream;base64,",I=e=>e.startsWith(b),v=e=>e.startsWith("file://");function T(e){if(e==C&&l)return new Uint8Array(l);var t=function(e){if(I(e))return function(e){if(void 0!==s&&s){var t=Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.length)}for(var r=atob(e),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n}(e.slice(37))}(e);if(t)return t;if(r)return r(e);throw"both async and sync fetching of the wasm failed"}function R(e,t,r){return function(e){return Promise.resolve().then((()=>T(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{p(`failed to asynchronously prepare wasm: ${e}`),x(e)}))}function S(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}I(C="data:application/octet-stream;base64,AGFzbQEAAAABLghgAX8Bf2AAAGADf39/AGADf39/AX9gAX8AYAR/f39/AGACf38AYAV/f39/fwACEwMBYQFhAAEBYQFiAAABYQFjAAIDDw4EAAACAQIFBgcABAMDAwQFAXABAQEFBwEBgAKAgAIGCAF/AUGQlwQLByUJAWQCAAFlAAcBZgAQAWcADwFoAA4BaQANAWoBAAFrAAwBbAADCuvpAQ7SCwEHfwJAIABFDQAgAEEIayICIABBBGsoAgAiAUF4cSIAaiEFAkAgAUEBcQ0AIAFBA3FFDQEgAiACKAIAIgFrIgJBqBMoAgBJDQEgACABaiEAAkACQEGsEygCACACRwRAIAFB/wFNBEAgAUEDdiEEIAIoAgwiASACKAIIIgNGBEBBmBNBmBMoAgBBfiAEd3E2AgAMBQsgAyABNgIMIAEgAzYCCAwECyACKAIYIQYgAiACKAIMIgFHBEAgAigCCCIDIAE2AgwgASADNgIIDAMLIAJBFGoiBCgCACIDRQRAIAIoAhAiA0UNAiACQRBqIQQLA0AgBCEHIAMiAUEUaiIEKAIAIgMNACABQRBqIQQgASgCECIDDQALIAdBADYCAAwCCyAFKAIEIgFBA3FBA0cNAkGgEyAANgIAIAUgAUF+cTYCBCACIABBAXI2AgQgBSAANgIADwtBACEBCyAGRQ0AAkAgAigCHCIDQQJ0QcgVaiIEKAIAIAJGBEAgBCABNgIAIAENAUGcE0GcEygCAEF+IAN3cTYCAAwCCyAGQRBBFCAGKAIQIAJGG2ogATYCACABRQ0BCyABIAY2AhggAigCECIDBEAgASADNgIQIAMgATYCGAsgAigCFCIDRQ0AIAEgAzYCFCADIAE2AhgLIAIgBU8NACAFKAIEIgFBAXFFDQACQAJAAkACQCABQQJxRQRAQbATKAIAIAVGBEBBsBMgAjYCAEGkE0GkEygCACAAaiIANgIAIAIgAEEBcjYCBCACQawTKAIARw0GQaATQQA2AgBBrBNBADYCAA8LQawTKAIAIAVGBEBBrBMgAjYCAEGgE0GgEygCACAAaiIANgIAIAIgAEEBcjYCBCAAIAJqIAA2AgAPCyABQXhxIABqIQAgAUH/AU0EQCABQQN2IQQgBSgCDCIBIAUoAggiA0YEQEGYE0GYEygCAEF+IAR3cTYCAAwFCyADIAE2AgwgASADNgIIDAQLIAUoAhghBiAFIAUoAgwiAUcEQEGoEygCABogBSgCCCIDIAE2AgwgASADNgIIDAMLIAVBFGoiBCgCACIDRQRAIAUoAhAiA0UNAiAFQRBqIQQLA0AgBCEHIAMiAUEUaiIEKAIAIgMNACABQRBqIQQgASgCECIDDQALIAdBADYCAAwCCyAFIAFBfnE2AgQgAiAAQQFyNgIEIAAgAmogADYCAAwDC0EAIQELIAZFDQACQCAFKAIcIgNBAnRByBVqIgQoAgAgBUYEQCAEIAE2AgAgAQ0BQZwTQZwTKAIAQX4gA3dxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgMEQCABIAM2AhAgAyABNgIYCyAFKAIUIgNFDQAgASADNgIUIAMgATYCGAsgAiAAQQFyNgIEIAAgAmogADYCACACQawTKAIARw0AQaATIAA2AgAPCyAAQf8BTQRAIABBeHFBwBNqIQECf0GYEygCACIDQQEgAEEDdnQiAHFFBEBBmBMgACADcjYCACABDAELIAEoAggLIQAgASACNgIIIAAgAjYCDCACIAE2AgwgAiAANgIIDwtBHyEDIABB////B00EQCAAQSYgAEEIdmciAWt2QQFxIAFBAXRrQT5qIQMLIAIgAzYCHCACQgA3AhAgA0ECdEHIFWohAQJAAkACQEGcEygCACIEQQEgA3QiB3FFBEBBnBMgBCAHcjYCACABIAI2AgAgAiABNgIYDAELIABBGSADQQF2a0EAIANBH0cbdCEDIAEoAgAhAQNAIAEiBCgCBEF4cSAARg0CIANBHXYhASADQQF0IQMgBCABQQRxaiIHQRBqKAIAIgENAAsgByACNgIQIAIgBDYCGAsgAiACNgIMIAIgAjYCCAwBCyAEKAIIIgAgAjYCDCAEIAI2AgggAkEANgIYIAIgBDYCDCACIAA2AggLQbgTQbgTKAIAQQFrIgBBfyAAGzYCAAsLTwECf0GQEygCACIBIABBB2pBeHEiAmohAAJAIAJBACAAIAFNGw0AIAA/AEEQdEsEQCAAEAFFDQELQZATIAA2AgAgAQ8LQZQTQTA2AgBBfws1AQF/QQEgACAAQQFNGyEAAkADQCAAEAwiAQ0BQYgXKAIAIgEEQCABEQEADAELCxAAAAsgAQuOTwEBfyMAQTBrIgMgADYCLCADIAE2AiggAyACNgIkIAMgAygCLDYCICADIAMoAigiAC0AAEEYdCAALQABQRB0ciAALQACQQh0ciAALQADcjYCHCADIAMoAigtAAcgAygCKC0ABEEYdCADKAIoLQAFQRB0ciADKAIoLQAGQQh0cnI2AhggAyADKAIoLQALIAMoAigtAAhBGHQgAygCKC0ACUEQdHIgAygCKC0ACkEIdHJyNgIUIAMgAygCKC0ADyADKAIoLQAMQRh0IAMoAigtAA1BEHRyIAMoAigtAA5BCHRycjYCECADIAMoAiAoAgAgAygCECADKAIYIAMoAhRzc3M2AgwgAyADKAIMQf8BcUECdEGACmooAgAiAEEIdCAAQRh2cjYCCCADIAMoAgxBCHY2AgwgAyADKAIIIAMoAhxzNgIcIAMgAygCDEH/AXFBAnRBgApqKAIAQRB0IAMoAgxB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIMQQh2NgIMIAMgAygCCCADKAIcczYCHCADIAMoAgxB/wFxQQJ0QYAKaigCAEEYdCADKAIMQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCDEEIdjYCDCADIAMoAgggAygCHHM2AhwgAyADKAIMQQJ0QYAKaigCADYCBCADIAMoAhwgAygCBHM2AgwgAyADKAIgKAIEIAMoAgwgAygCFCADKAIQc3NzNgIcIAMgAygCHEH/AXFBAnRBgApqKAIAIgBBCHQgAEEYdnI2AgggAyADKAIcQQh2NgIcIAMgAygCCCADKAIYczYCGCADIAMoAhxB/wFxQQJ0QYAKaigCAEEQdCADKAIcQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCHEEIdjYCHCADIAMoAgggAygCGHM2AhggAyADKAIcQf8BcUECdEGACmooAgBBGHQgAygCHEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhxBCHY2AhwgAyADKAIIIAMoAhhzNgIYIAMgAygCHEECdEGACmooAgA2AgQgAyADKAIYIAMoAgRzNgIcIAMgAygCICgCCCADKAIcIAMoAhAgAygCDHNzczYCGCADIAMoAhhB/wFxQQJ0QYAKaigCACIAQQh0IABBGHZyNgIIIAMgAygCGEEIdjYCGCADIAMoAgggAygCFHM2AhQgAyADKAIYQf8BcUECdEGACmooAgBBEHQgAygCGEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAhhBCHY2AhggAyADKAIIIAMoAhRzNgIUIAMgAygCGEH/AXFBAnRBgApqKAIAQRh0IAMoAhhB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIYQQh2NgIYIAMgAygCCCADKAIUczYCFCADIAMoAhhBAnRBgApqKAIANgIEIAMgAygCFCADKAIEczYCGCADIAMoAiAoAgwgAygCGCADKAIMIAMoAhxzc3M2AhQgAyADKAIUQf8BcUECdEGACmooAgAiAEEIdCAAQRh2cjYCCCADIAMoAhRBCHY2AhQgAyADKAIIIAMoAhBzNgIQIAMgAygCFEH/AXFBAnRBgApqKAIAQRB0IAMoAhRB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIUQQh2NgIUIAMgAygCCCADKAIQczYCECADIAMoAhRB/wFxQQJ0QYAKaigCAEEYdCADKAIUQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCFEEIdjYCFCADIAMoAgggAygCEHM2AhAgAyADKAIUQQJ0QYAKaigCADYCBCADIAMoAhAgAygCBHM2AhQgAyADKAIgKAIQIAMoAhQgAygCHCADKAIYc3NzNgIQIAMgAygCEEH/AXFBAnRBgApqKAIAIgBBCHQgAEEYdnI2AgggAyADKAIQQQh2NgIQIAMgAygCCCADKAIMczYCDCADIAMoAhBB/wFxQQJ0QYAKaigCAEEQdCADKAIQQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCEEEIdjYCECADIAMoAgggAygCDHM2AgwgAyADKAIQQf8BcUECdEGACmooAgBBGHQgAygCEEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhBBCHY2AhAgAyADKAIIIAMoAgxzNgIMIAMgAygCEEECdEGACmooAgA2AgQgAyADKAIMIAMoAgRzNgIQIAMgAygCICgCFCADKAIQIAMoAhggAygCFHNzczYCDCADIAMoAgxB/wFxQQJ0QYAKaigCAEEIdCADKAIMQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCDEEIdjYCDCADIAMoAgggAygCHHM2AhwgAyADKAIMQf8BcUECdEGACmooAgBBEHQgAygCDEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAgxBCHY2AgwgAyADKAIIIAMoAhxzNgIcIAMgAygCDEH/AXFBAnRBgApqKAIAQRh0IAMoAgxB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIMQQh2NgIMIAMgAygCCCADKAIcczYCHCADIAMoAgxBAnRBgApqKAIANgIEIAMgAygCHCADKAIEczYCDCADIAMoAiAoAhggAygCDCADKAIUIAMoAhBzc3M2AhwgAyADKAIcQf8BcUECdEGACmooAgBBCHQgAygCHEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAhxBCHY2AhwgAyADKAIIIAMoAhhzNgIYIAMgAygCHEH/AXFBAnRBgApqKAIAQRB0IAMoAhxB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIcQQh2NgIcIAMgAygCCCADKAIYczYCGCADIAMoAhxB/wFxQQJ0QYAKaigCAEEYdCADKAIcQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCHEEIdjYCHCADIAMoAgggAygCGHM2AhggAyADKAIcQQJ0QYAKaigCADYCBCADIAMoAhggAygCBHM2AhwgAyADKAIgKAIcIAMoAhwgAygCECADKAIMc3NzNgIYIAMgAygCGEH/AXFBAnRBgApqKAIAQQh0IAMoAhhB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIYQQh2NgIYIAMgAygCCCADKAIUczYCFCADIAMoAhhB/wFxQQJ0QYAKaigCAEEQdCADKAIYQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCGEEIdjYCGCADIAMoAgggAygCFHM2AhQgAyADKAIYQf8BcUECdEGACmooAgBBGHQgAygCGEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhhBCHY2AhggAyADKAIIIAMoAhRzNgIUIAMgAygCGEECdEGACmooAgA2AgQgAyADKAIUIAMoAgRzNgIYIAMgAygCICgCICADKAIYIAMoAgwgAygCHHNzczYCFCADIAMoAhRB/wFxQQJ0QYAKaigCAEEIdCADKAIUQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCFEEIdjYCFCADIAMoAgggAygCEHM2AhAgAyADKAIUQf8BcUECdEGACmooAgBBEHQgAygCFEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAhRBCHY2AhQgAyADKAIIIAMoAhBzNgIQIAMgAygCFEH/AXFBAnRBgApqKAIAQRh0IAMoAhRB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIUQQh2NgIUIAMgAygCCCADKAIQczYCECADIAMoAhRBAnRBgApqKAIANgIEIAMgAygCECADKAIEczYCFCADIAMoAiAoAiQgAygCFCADKAIcIAMoAhhzc3M2AhAgAyADKAIQQf8BcUECdEGACmooAgBBCHQgAygCEEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAhBBCHY2AhAgAyADKAIIIAMoAgxzNgIMIAMgAygCEEH/AXFBAnRBgApqKAIAQRB0IAMoAhBB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIQQQh2NgIQIAMgAygCCCADKAIMczYCDCADIAMoAhBB/wFxQQJ0QYAKaigCAEEYdCADKAIQQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCEEEIdjYCECADIAMoAgggAygCDHM2AgwgAyADKAIQQQJ0QYAKaigCADYCBCADIAMoAgwgAygCBHM2AhAgAyADKAIgKAIoIAMoAhAgAygCGCADKAIUc3NzNgIMIAMgAygCDEH/AXFBAnRBgApqKAIAQQh0IAMoAgxB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIMQQh2NgIMIAMgAygCCCADKAIcczYCHCADIAMoAgxB/wFxQQJ0QYAKaigCAEEQdCADKAIMQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCDEEIdjYCDCADIAMoAgggAygCHHM2AhwgAyADKAIMQf8BcUECdEGACmooAgBBGHQgAygCDEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAgxBCHY2AgwgAyADKAIIIAMoAhxzNgIcIAMgAygCDEECdEGACmooAgA2AgQgAyADKAIcIAMoAgRzNgIMIAMgAygCICgCLCADKAIMIAMoAhQgAygCEHNzczYCHCADIAMoAhxB/wFxQQJ0QYAKaigCAEEIdCADKAIcQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCHEEIdjYCHCADIAMoAgggAygCGHM2AhggAyADKAIcQf8BcUECdEGACmooAgBBEHQgAygCHEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAhxBCHY2AhwgAyADKAIIIAMoAhhzNgIYIAMgAygCHEH/AXFBAnRBgApqKAIAQRh0IAMoAhxB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIcQQh2NgIcIAMgAygCCCADKAIYczYCGCADIAMoAhxBAnRBgApqKAIANgIEIAMgAygCGCADKAIEczYCHCADIAMoAiAoAjAgAygCHCADKAIQIAMoAgxzc3M2AhggAyADKAIYQf8BcUECdEGACmooAgBBCHQgAygCGEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAhhBCHY2AhggAyADKAIIIAMoAhRzNgIUIAMgAygCGEH/AXFBAnRBgApqKAIAQRB0IAMoAhhB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIYQQh2NgIYIAMgAygCCCADKAIUczYCFCADIAMoAhhB/wFxQQJ0QYAKaigCAEEYdCADKAIYQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCGEEIdjYCGCADIAMoAgggAygCFHM2AhQgAyADKAIYQQJ0QYAKaigCADYCBCADIAMoAhQgAygCBHM2AhggAyADKAIgKAI0IAMoAhggAygCDCADKAIcc3NzNgIUIAMgAygCFEH/AXFBAnRBgApqKAIAQQh0IAMoAhRB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIUQQh2NgIUIAMgAygCCCADKAIQczYCECADIAMoAhRB/wFxQQJ0QYAKaigCAEEQdCADKAIUQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCFEEIdjYCFCADIAMoAgggAygCEHM2AhAgAyADKAIUQf8BcUECdEGACmooAgBBGHQgAygCFEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhRBCHY2AhQgAyADKAIIIAMoAhBzNgIQIAMgAygCFEECdEGACmooAgA2AgQgAyADKAIQIAMoAgRzNgIUIAMgAygCICgCOCADKAIUIAMoAhwgAygCGHNzczYCECADIAMoAhBB/wFxQQJ0QYAKaigCAEEIdCADKAIQQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCEEEIdjYCECADIAMoAgggAygCDHM2AgwgAyADKAIQQf8BcUECdEGACmooAgBBEHQgAygCEEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAhBBCHY2AhAgAyADKAIIIAMoAgxzNgIMIAMgAygCEEH/AXFBAnRBgApqKAIAQRh0IAMoAhBB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIQQQh2NgIQIAMgAygCCCADKAIMczYCDCADIAMoAhBBAnRBgApqKAIANgIEIAMgAygCDCADKAIEczYCECADIAMoAiAoAjwgAygCECADKAIYIAMoAhRzc3M2AgwgAyADKAIMQf8BcUECdEGACmooAgBBCHQgAygCDEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAgxBCHY2AgwgAyADKAIIIAMoAhxzNgIcIAMgAygCDEH/AXFBAnRBgApqKAIAQRB0IAMoAgxB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIMQQh2NgIMIAMgAygCCCADKAIcczYCHCADIAMoAgxB/wFxQQJ0QYAKaigCAEEYdCADKAIMQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCDEEIdjYCDCADIAMoAgggAygCHHM2AhwgAyADKAIMQQJ0QYAKaigCADYCBCADIAMoAhwgAygCBHM2AgwgAyADKAIgKAJAIAMoAgwgAygCFCADKAIQc3NzNgIcIAMgAygCHEH/AXFBAnRBgApqKAIAQQh0IAMoAhxB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIcQQh2NgIcIAMgAygCCCADKAIYczYCGCADIAMoAhxB/wFxQQJ0QYAKaigCAEEQdCADKAIcQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCHEEIdjYCHCADIAMoAgggAygCGHM2AhggAyADKAIcQf8BcUECdEGACmooAgBBGHQgAygCHEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhxBCHY2AhwgAyADKAIIIAMoAhhzNgIYIAMgAygCHEECdEGACmooAgA2AgQgAyADKAIYIAMoAgRzNgIcIAMgAygCICgCRCADKAIcIAMoAhAgAygCDHNzczYCGCADIAMoAhhB/wFxQQJ0QYAKaigCAEEIdCADKAIYQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCGEEIdjYCGCADIAMoAgggAygCFHM2AhQgAyADKAIYQf8BcUECdEGACmooAgBBEHQgAygCGEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAhhBCHY2AhggAyADKAIIIAMoAhRzNgIUIAMgAygCGEH/AXFBAnRBgApqKAIAQRh0IAMoAhhB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIYQQh2NgIYIAMgAygCCCADKAIUczYCFCADIAMoAhhBAnRBgApqKAIANgIEIAMgAygCFCADKAIEczYCGCADIAMoAiAoAkggAygCGCADKAIMIAMoAhxzc3M2AhQgAyADKAIUQf8BcUECdEGACmooAgBBCHQgAygCFEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAhRBCHY2AhQgAyADKAIIIAMoAhBzNgIQIAMgAygCFEH/AXFBAnRBgApqKAIAQRB0IAMoAhRB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIUQQh2NgIUIAMgAygCCCADKAIQczYCECADIAMoAhRB/wFxQQJ0QYAKaigCAEEYdCADKAIUQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCFEEIdjYCFCADIAMoAgggAygCEHM2AhAgAyADKAIUQQJ0QYAKaigCADYCBCADIAMoAhAgAygCBHM2AhQgAyADKAIgKAJMIAMoAhQgAygCHCADKAIYc3NzNgIQIAMgAygCEEH/AXFBAnRBgApqKAIAQQh0IAMoAhBB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIQQQh2NgIQIAMgAygCCCADKAIMczYCDCADIAMoAhBB/wFxQQJ0QYAKaigCAEEQdCADKAIQQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCEEEIdjYCECADIAMoAgggAygCDHM2AgwgAyADKAIQQf8BcUECdEGACmooAgBBGHQgAygCEEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhBBCHY2AhAgAyADKAIIIAMoAgxzNgIMIAMgAygCEEECdEGACmooAgA2AgQgAyADKAIMIAMoAgRzNgIQIAMgAygCICgCUCADKAIQIAMoAhggAygCFHNzczYCDCADIAMoAgxB/wFxQQJ0QYAKaigCAEEIdCADKAIMQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCDEEIdjYCDCADIAMoAgggAygCHHM2AhwgAyADKAIMQf8BcUECdEGACmooAgBBEHQgAygCDEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAgxBCHY2AgwgAyADKAIIIAMoAhxzNgIcIAMgAygCDEH/AXFBAnRBgApqKAIAQRh0IAMoAgxB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIMQQh2NgIMIAMgAygCCCADKAIcczYCHCADIAMoAgxBAnRBgApqKAIANgIEIAMgAygCHCADKAIEczYCDCADIAMoAiAoAlQgAygCDCADKAIUIAMoAhBzc3M2AhwgAyADKAIcQf8BcUECdEGACmooAgBBCHQgAygCHEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAhxBCHY2AhwgAyADKAIIIAMoAhhzNgIYIAMgAygCHEH/AXFBAnRBgApqKAIAQRB0IAMoAhxB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIcQQh2NgIcIAMgAygCCCADKAIYczYCGCADIAMoAhxB/wFxQQJ0QYAKaigCAEEYdCADKAIcQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCHEEIdjYCHCADIAMoAgggAygCGHM2AhggAyADKAIcQQJ0QYAKaigCADYCBCADIAMoAhggAygCBHM2AhwgAyADKAIgKAJYIAMoAhwgAygCECADKAIMc3NzNgIYIAMgAygCGEH/AXFBAnRBgApqKAIAQQh0IAMoAhhB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIYQQh2NgIYIAMgAygCCCADKAIUczYCFCADIAMoAhhB/wFxQQJ0QYAKaigCAEEQdCADKAIYQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCGEEIdjYCGCADIAMoAgggAygCFHM2AhQgAyADKAIYQf8BcUECdEGACmooAgBBGHQgAygCGEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhhBCHY2AhggAyADKAIIIAMoAhRzNgIUIAMgAygCGEECdEGACmooAgA2AgQgAyADKAIUIAMoAgRzNgIYIAMgAygCICgCXCADKAIYIAMoAgwgAygCHHNzczYCFCADIAMoAhRB/wFxQQJ0QYAKaigCAEEIdCADKAIUQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCFEEIdjYCFCADIAMoAgggAygCEHM2AhAgAyADKAIUQf8BcUECdEGACmooAgBBEHQgAygCFEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAhRBCHY2AhQgAyADKAIIIAMoAhBzNgIQIAMgAygCFEH/AXFBAnRBgApqKAIAQRh0IAMoAhRB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIUQQh2NgIUIAMgAygCCCADKAIQczYCECADIAMoAhRBAnRBgApqKAIANgIEIAMgAygCECADKAIEczYCFCADIAMoAiAoAmAgAygCFCADKAIcIAMoAhhzc3M2AhAgAyADKAIQQf8BcUECdEGACmooAgBBCHQgAygCEEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAhBBCHY2AhAgAyADKAIIIAMoAgxzNgIMIAMgAygCEEH/AXFBAnRBgApqKAIAQRB0IAMoAhBB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIQQQh2NgIQIAMgAygCCCADKAIMczYCDCADIAMoAhBB/wFxQQJ0QYAKaigCAEEYdCADKAIQQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCEEEIdjYCECADIAMoAgggAygCDHM2AgwgAyADKAIQQQJ0QYAKaigCADYCBCADIAMoAgwgAygCBHM2AhAgAyADKAIgKAJkIAMoAhAgAygCGCADKAIUc3NzNgIMIAMgAygCDEH/AXFBAnRBgApqKAIAQQh0IAMoAgxB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIMQQh2NgIMIAMgAygCCCADKAIcczYCHCADIAMoAgxB/wFxQQJ0QYAKaigCAEEQdCADKAIMQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCDEEIdjYCDCADIAMoAgggAygCHHM2AhwgAyADKAIMQf8BcUECdEGACmooAgBBGHQgAygCDEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAgxBCHY2AgwgAyADKAIIIAMoAhxzNgIcIAMgAygCDEECdEGACmooAgA2AgQgAyADKAIcIAMoAgRzNgIMIAMgAygCICgCaCADKAIMIAMoAhQgAygCEHNzczYCHCADIAMoAhxB/wFxQQJ0QYAKaigCAEEIdCADKAIcQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCHEEIdjYCHCADIAMoAgggAygCGHM2AhggAyADKAIcQf8BcUECdEGACmooAgBBEHQgAygCHEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAhxBCHY2AhwgAyADKAIIIAMoAhhzNgIYIAMgAygCHEH/AXFBAnRBgApqKAIAQRh0IAMoAhxB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIcQQh2NgIcIAMgAygCCCADKAIYczYCGCADIAMoAhxBAnRBgApqKAIANgIEIAMgAygCGCADKAIEczYCHCADIAMoAiAoAmwgAygCHCADKAIQIAMoAgxzc3M2AhggAyADKAIYQf8BcUECdEGACmooAgBBCHQgAygCGEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAhhBCHY2AhggAyADKAIIIAMoAhRzNgIUIAMgAygCGEH/AXFBAnRBgApqKAIAQRB0IAMoAhhB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIYQQh2NgIYIAMgAygCCCADKAIUczYCFCADIAMoAhhB/wFxQQJ0QYAKaigCAEEYdCADKAIYQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCGEEIdjYCGCADIAMoAgggAygCFHM2AhQgAyADKAIYQQJ0QYAKaigCADYCBCADIAMoAhQgAygCBHM2AhggAyADKAIgKAJwIAMoAhggAygCDCADKAIcc3NzNgIUIAMgAygCFEH/AXFBAnRBgApqKAIAQQh0IAMoAhRB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIUQQh2NgIUIAMgAygCCCADKAIQczYCECADIAMoAhRB/wFxQQJ0QYAKaigCAEEQdCADKAIUQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCFEEIdjYCFCADIAMoAgggAygCEHM2AhAgAyADKAIUQf8BcUECdEGACmooAgBBGHQgAygCFEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhRBCHY2AhQgAyADKAIIIAMoAhBzNgIQIAMgAygCFEECdEGACmooAgA2AgQgAyADKAIQIAMoAgRzNgIUIAMgAygCICgCdCADKAIUIAMoAhwgAygCGHNzczYCECADIAMoAhBB/wFxQQJ0QYAKaigCAEEIdCADKAIQQf8BcUECdEGACmooAgBBGHZyNgIIIAMgAygCEEEIdjYCECADIAMoAgggAygCDHM2AgwgAyADKAIQQf8BcUECdEGACmooAgBBEHQgAygCEEH/AXFBAnRBgApqKAIAQRB2cjYCCCADIAMoAhBBCHY2AhAgAyADKAIIIAMoAgxzNgIMIAMgAygCEEH/AXFBAnRBgApqKAIAQRh0IAMoAhBB/wFxQQJ0QYAKaigCAEEIdnI2AgggAyADKAIQQQh2NgIQIAMgAygCCCADKAIMczYCDCADIAMoAhBBAnRBgApqKAIANgIEIAMgAygCDCADKAIEczYCECADIAMoAiAoAnggAygCECADKAIYIAMoAhRzc3M2AgwgAyADKAIMQf8BcUECdEGACmooAgBBCHQgAygCDEH/AXFBAnRBgApqKAIAQRh2cjYCCCADIAMoAgxBCHY2AgwgAyADKAIIIAMoAhxzNgIcIAMgAygCDEH/AXFBAnRBgApqKAIAQRB0IAMoAgxB/wFxQQJ0QYAKaigCAEEQdnI2AgggAyADKAIMQQh2NgIMIAMgAygCCCADKAIcczYCHCADIAMoAgxB/wFxQQJ0QYAKaigCAEEYdCADKAIMQf8BcUECdEGACmooAgBBCHZyNgIIIAMgAygCDEEIdjYCDCADIAMoAgggAygCHHM2AhwgAyADKAIMQQJ0QYAKaigCADYCBCADIAMoAhwgAygCBHM2AgwgAyADKAIgKAJ8IAMoAgwgAygCFCADKAIQc3NzNgIcIAMgAygCHEH/AXFBAnRBgApqKAIAQQh0IAMoAhxB/wFxQQJ0QYAKaigCAEEYdnI2AgggAyADKAIcQQh2NgIcIAMgAygCCCADKAIYczYCGCADIAMoAhxB/wFxQQJ0QYAKaigCAEEQdCADKAIcQf8BcUECdEGACmooAgBBEHZyNgIIIAMgAygCHEEIdjYCHCADIAMoAgggAygCGHM2AhggAyADKAIcQf8BcUECdEGACmooAgBBGHQgAygCHEH/AXFBAnRBgApqKAIAQQh2cjYCCCADIAMoAhxBCHY2AhwgAyADKAIIIAMoAhhzNgIYIAMgAygCHEECdEGACmooAgA2AgQgAyADKAIYIAMoAgRzNgIcIAMoAiQgAygCHEEYdjoAACADKAIkIAMoAhxBEHY6AAEgAygCJCADKAIcQQh2OgACIAMoAiQgAygCHDoAAyADKAIkIAMoAgxBGHY6AAQgAygCJCADKAIMQRB2OgAFIAMoAiQgAygCDEEIdjoABiADKAIkIAMoAgw6AAcgAygCJCADKAIQQRh2OgAIIAMoAiQgAygCEEEQdjoACSADKAIkIAMoAhBBCHY6AAogAygCJCADKAIQOgALIAMoAiQgAygCFEEYdjoADCADKAIkIAMoAhRBEHY6AA0gAygCJCADKAIUQQh2OgAOIAMoAiQgAygCFDoADwsCAAv8AwECfyACQYAETwRAIAAgASACEAIPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAEEDcUUEQCAAIQIMAQsgAkUEQCAAIQIMAQsgACECA0AgAiABLQAAOgAAIAFBAWohASACQQFqIgJBA3FFDQEgAiADSQ0ACwsCQCADQXxxIgBBwABJDQAgAiAAQUBqIgRLDQADQCACIAEoAgA2AgAgAiABKAIENgIEIAIgASgCCDYCCCACIAEoAgw2AgwgAiABKAIQNgIQIAIgASgCFDYCFCACIAEoAhg2AhggAiABKAIcNgIcIAIgASgCIDYCICACIAEoAiQ2AiQgAiABKAIoNgIoIAIgASgCLDYCLCACIAEoAjA2AjAgAiABKAI0NgI0IAIgASgCODYCOCACIAEoAjw2AjwgAUFAayEBIAJBQGsiAiAETQ0ACwsgACACTQ0BA0AgAiABKAIANgIAIAFBBGohASACQQRqIgIgAEkNAAsMAQsgA0EESQRAIAAhAgwBCyAAIANBBGsiBEsEQCAAIQIMAQsgACECA0AgAiABLQAAOgAAIAIgAS0AAToAASACIAEtAAI6AAIgAiABLQADOgADIAFBBGohASACQQRqIgIgBE0NAAsLIAIgA0kEQANAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANHDQALCwuPAQEBfyMAQSBrIgQgADYCHCAEIAE2AhggBCACNgIUIAQgAzYCECAEIAQoAhw2AgwgBCAEKAIYNgIIIAQgBCgCFDYCBCAEQQA2AgADQCAEKAIAIgAgBCgCEE9FBEAgACAEKAIMaiAAIAQoAghqLQAAIAAgBCgCBGotAABzOgAAIAQgBCgCAEEBajYCAAwBCwsLkSwBAX8jAEEgayICIAA2AhwgAiABNgIYIAIgAigCHDYCFCACQYASKAIAIAIoAhgiAC0AAEEYdCAALQABQRB0ciAALQACQQh0ciAALQADcnM2AhAgAkGEEigCACACKAIYLQAHIAIoAhgtAARBGHQgAigCGC0ABUEQdHIgAigCGC0ABkEIdHJyczYCDCACQYgSKAIAIAIoAhgtAAsgAigCGC0ACEEYdCACKAIYLQAJQRB0ciACKAIYLQAKQQh0cnJzNgIIIAJBjBIoAgAgAigCGC0ADyACKAIYLQAMQRh0IAIoAhgtAA1BEHRyIAIoAhgtAA5BCHRycnM2AgQgAkGQEigCACACKAIEIAIoAgwgAigCCHNzczYCACACIAIoAgAiAEEYdi0AgAhBGHQgAEEQdkH/AXEtAIAIQRB0cyAAQQh2Qf8BcS0AgAhBCHRzIABB/wFxLQCACHM2AgAgAiACKAIQIAIoAgAgAigCAEENdCACKAIAIgBBE3ZycyACKAIAQRd0IABBCXZyc3M2AgAgAigCFCACKAIANgIAIAJBlBIoAgAgAigCACACKAIIIAIoAgRzc3M2AhAgAiACKAIQQf8BcS0AgAggAigCEEEYdi0AgAhBGHQgAigCEEEQdkH/AXEtAIAIQRB0cyACKAIQQQh2Qf8BcS0AgAhBCHRzczYCECACIAIoAgwgAigCECACKAIQQQ10IAIoAhAiAEETdnJzIAIoAhBBF3QgAEEJdnJzczYCECACKAIUIAIoAhA2AgQgAkGYEigCACACKAIQIAIoAgQgAigCAHNzczYCDCACIAIoAgxB/wFxLQCACCACKAIMQRh2LQCACEEYdCACKAIMQRB2Qf8BcS0AgAhBEHRzIAIoAgxBCHZB/wFxLQCACEEIdHNzNgIMIAIgAigCCCACKAIMIAIoAgxBDXQgAigCDCIAQRN2cnMgAigCDEEXdCAAQQl2cnNzNgIMIAIoAhQgAigCDDYCCCACQZwSKAIAIAIoAgwgAigCACACKAIQc3NzNgIIIAIgAigCCEH/AXEtAIAIIAIoAghBGHYtAIAIQRh0IAIoAghBEHZB/wFxLQCACEEQdHMgAigCCEEIdkH/AXEtAIAIQQh0c3M2AgggAiACKAIEIAIoAgggAigCCEENdCACKAIIIgBBE3ZycyACKAIIQRd0IABBCXZyc3M2AgggAigCFCACKAIINgIMIAJBoBIoAgAgAigCCCACKAIQIAIoAgxzc3M2AgQgAiACKAIEQf8BcS0AgAggAigCBEEYdi0AgAhBGHQgAigCBEEQdkH/AXEtAIAIQRB0cyACKAIEQQh2Qf8BcS0AgAhBCHRzczYCBCACIAIoAgAgAigCBCACKAIEQQ10IAIoAgQiAEETdnJzIAIoAgRBF3QgAEEJdnJzczYCBCACKAIUIAIoAgQ2AhAgAkGkEigCACACKAIEIAIoAgwgAigCCHNzczYCACACIAIoAgBB/wFxLQCACCACKAIAQRh2LQCACEEYdCACKAIAQRB2Qf8BcS0AgAhBEHRzIAIoAgBBCHZB/wFxLQCACEEIdHNzNgIAIAIgAigCECACKAIAQRd0IAIoAgBBCXZyIAIoAgAgAigCAEENdCACKAIAQRN2cnNzczYCACACKAIUIAIoAgA2AhQgAkGoEigCACACKAIAIAIoAgggAigCBHNzczYCECACIAIoAhBB/wFxLQCACCACKAIQQRh2LQCACEEYdCACKAIQQRB2Qf8BcS0AgAhBEHRzIAIoAhBBCHZB/wFxLQCACEEIdHNzNgIQIAIgAigCDCACKAIQQRd0IAIoAhBBCXZyIAIoAhAgAigCEEENdCACKAIQQRN2cnNzczYCECACKAIUIAIoAhA2AhggAkGsEigCACACKAIQIAIoAgQgAigCAHNzczYCDCACIAIoAgxB/wFxLQCACCACKAIMQRh2LQCACEEYdCACKAIMQRB2Qf8BcS0AgAhBEHRzIAIoAgxBCHZB/wFxLQCACEEIdHNzNgIMIAIgAigCCCACKAIMQRd0IAIoAgxBCXZyIAIoAgwgAigCDEENdCACKAIMQRN2cnNzczYCDCACKAIUIAIoAgw2AhwgAkGwEigCACACKAIMIAIoAgAgAigCEHNzczYCCCACIAIoAghB/wFxLQCACCACKAIIQRh2LQCACEEYdCACKAIIQRB2Qf8BcS0AgAhBEHRzIAIoAghBCHZB/wFxLQCACEEIdHNzNgIIIAIgAigCBCACKAIIQRd0IAIoAghBCXZyIAIoAgggAigCCEENdCACKAIIQRN2cnNzczYCCCACKAIUIAIoAgg2AiAgAkG0EigCACACKAIIIAIoAhAgAigCDHNzczYCBCACIAIoAgRB/wFxLQCACCACKAIEQRh2LQCACEEYdCACKAIEQRB2Qf8BcS0AgAhBEHRzIAIoAgRBCHZB/wFxLQCACEEIdHNzNgIEIAIgAigCACACKAIEQRd0IAIoAgRBCXZyIAIoAgQgAigCBEENdCACKAIEQRN2cnNzczYCBCACKAIUIAIoAgQ2AiQgAkG4EigCACACKAIEIAIoAgwgAigCCHNzczYCACACIAIoAgBB/wFxLQCACCACKAIAQRh2LQCACEEYdCACKAIAQRB2Qf8BcS0AgAhBEHRzIAIoAgBBCHZB/wFxLQCACEEIdHNzNgIAIAIgAigCECACKAIAQRd0IAIoAgBBCXZyIAIoAgAgAigCAEENdCACKAIAQRN2cnNzczYCACACKAIUIAIoAgA2AiggAkG8EigCACACKAIAIAIoAgggAigCBHNzczYCECACIAIoAhBB/wFxLQCACCACKAIQQRh2LQCACEEYdCACKAIQQRB2Qf8BcS0AgAhBEHRzIAIoAhBBCHZB/wFxLQCACEEIdHNzNgIQIAIgAigCDCACKAIQQRd0IAIoAhBBCXZyIAIoAhAgAigCEEENdCACKAIQQRN2cnNzczYCECACKAIUIAIoAhA2AiwgAkHAEigCACACKAIQIAIoAgQgAigCAHNzczYCDCACIAIoAgxB/wFxLQCACCACKAIMQRh2LQCACEEYdCACKAIMQRB2Qf8BcS0AgAhBEHRzIAIoAgxBCHZB/wFxLQCACEEIdHNzNgIMIAIgAigCCCACKAIMQRd0IAIoAgxBCXZyIAIoAgwgAigCDEENdCACKAIMQRN2cnNzczYCDCACKAIUIAIoAgw2AjAgAkHEEigCACACKAIMIAIoAgAgAigCEHNzczYCCCACIAIoAghB/wFxLQCACCACKAIIQRh2LQCACEEYdCACKAIIQRB2Qf8BcS0AgAhBEHRzIAIoAghBCHZB/wFxLQCACEEIdHNzNgIIIAIgAigCBCACKAIIQRd0IAIoAghBCXZyIAIoAgggAigCCEENdCACKAIIQRN2cnNzczYCCCACKAIUIAIoAgg2AjQgAkHIEigCACACKAIIIAIoAhAgAigCDHNzczYCBCACIAIoAgRB/wFxLQCACCACKAIEQRh2LQCACEEYdCACKAIEQRB2Qf8BcS0AgAhBEHRzIAIoAgRBCHZB/wFxLQCACEEIdHNzNgIEIAIgAigCACACKAIEQRd0IAIoAgRBCXZyIAIoAgQgAigCBEENdCACKAIEQRN2cnNzczYCBCACKAIUIAIoAgQ2AjggAkHMEigCACACKAIEIAIoAgwgAigCCHNzczYCACACIAIoAgBB/wFxLQCACCACKAIAQRh2LQCACEEYdCACKAIAQRB2Qf8BcS0AgAhBEHRzIAIoAgBBCHZB/wFxLQCACEEIdHNzNgIAIAIgAigCECACKAIAQRd0IAIoAgBBCXZyIAIoAgAgAigCAEENdCACKAIAQRN2cnNzczYCACACKAIUIAIoAgA2AjwgAkHQEigCACACKAIAIAIoAgggAigCBHNzczYCECACIAIoAhBB/wFxLQCACCACKAIQQRh2LQCACEEYdCACKAIQQRB2Qf8BcS0AgAhBEHRzIAIoAhBBCHZB/wFxLQCACEEIdHNzNgIQIAIgAigCDCACKAIQQRd0IAIoAhBBCXZyIAIoAhAgAigCEEENdCACKAIQQRN2cnNzczYCECACKAIUIAIoAhA2AkAgAkHUEigCACACKAIQIAIoAgQgAigCAHNzczYCDCACIAIoAgxB/wFxLQCACCACKAIMQRh2LQCACEEYdCACKAIMQRB2Qf8BcS0AgAhBEHRzIAIoAgxBCHZB/wFxLQCACEEIdHNzNgIMIAIgAigCCCACKAIMQRd0IAIoAgxBCXZyIAIoAgwgAigCDEENdCACKAIMQRN2cnNzczYCDCACKAIUIAIoAgw2AkQgAkHYEigCACACKAIMIAIoAgAgAigCEHNzczYCCCACIAIoAghB/wFxLQCACCACKAIIQRh2LQCACEEYdCACKAIIQRB2Qf8BcS0AgAhBEHRzIAIoAghBCHZB/wFxLQCACEEIdHNzNgIIIAIgAigCBCACKAIIQRd0IAIoAghBCXZyIAIoAgggAigCCEENdCACKAIIQRN2cnNzczYCCCACKAIUIAIoAgg2AkggAkHcEigCACACKAIIIAIoAhAgAigCDHNzczYCBCACIAIoAgRB/wFxLQCACCACKAIEQRh2LQCACEEYdCACKAIEQRB2Qf8BcS0AgAhBEHRzIAIoAgRBCHZB/wFxLQCACEEIdHNzNgIEIAIgAigCACACKAIEQRd0IAIoAgRBCXZyIAIoAgQgAigCBEENdCACKAIEQRN2cnNzczYCBCACKAIUIAIoAgQ2AkwgAkHgEigCACACKAIEIAIoAgwgAigCCHNzczYCACACIAIoAgBB/wFxLQCACCACKAIAQRh2LQCACEEYdCACKAIAQRB2Qf8BcS0AgAhBEHRzIAIoAgBBCHZB/wFxLQCACEEIdHNzNgIAIAIgAigCECACKAIAQRd0IAIoAgBBCXZyIAIoAgAgAigCAEENdCACKAIAQRN2cnNzczYCACACKAIUIAIoAgA2AlAgAkHkEigCACACKAIAIAIoAgggAigCBHNzczYCECACIAIoAhBB/wFxLQCACCACKAIQQRh2LQCACEEYdCACKAIQQRB2Qf8BcS0AgAhBEHRzIAIoAhBBCHZB/wFxLQCACEEIdHNzNgIQIAIgAigCDCACKAIQQRd0IAIoAhBBCXZyIAIoAhAgAigCEEENdCACKAIQQRN2cnNzczYCECACKAIUIAIoAhA2AlQgAkHoEigCACACKAIQIAIoAgQgAigCAHNzczYCDCACIAIoAgxB/wFxLQCACCACKAIMQRh2LQCACEEYdCACKAIMQRB2Qf8BcS0AgAhBEHRzIAIoAgxBCHZB/wFxLQCACEEIdHNzNgIMIAIgAigCCCACKAIMQRd0IAIoAgxBCXZyIAIoAgwgAigCDEENdCACKAIMQRN2cnNzczYCDCACKAIUIAIoAgw2AlggAkHsEigCACACKAIMIAIoAgAgAigCEHNzczYCCCACIAIoAghB/wFxLQCACCACKAIIQRh2LQCACEEYdCACKAIIQRB2Qf8BcS0AgAhBEHRzIAIoAghBCHZB/wFxLQCACEEIdHNzNgIIIAIgAigCBCACKAIIQRd0IAIoAghBCXZyIAIoAgggAigCCEENdCACKAIIQRN2cnNzczYCCCACKAIUIAIoAgg2AlwgAkHwEigCACACKAIIIAIoAhAgAigCDHNzczYCBCACIAIoAgRB/wFxLQCACCACKAIEQRh2LQCACEEYdCACKAIEQRB2Qf8BcS0AgAhBEHRzIAIoAgRBCHZB/wFxLQCACEEIdHNzNgIEIAIgAigCACACKAIEQRd0IAIoAgRBCXZyIAIoAgQgAigCBEENdCACKAIEQRN2cnNzczYCBCACKAIUIAIoAgQ2AmAgAkH0EigCACACKAIEIAIoAgwgAigCCHNzczYCACACIAIoAgBB/wFxLQCACCACKAIAQRh2LQCACEEYdCACKAIAQRB2Qf8BcS0AgAhBEHRzIAIoAgBBCHZB/wFxLQCACEEIdHNzNgIAIAIgAigCECACKAIAQRd0IAIoAgBBCXZyIAIoAgAgAigCAEENdCACKAIAQRN2cnNzczYCACACKAIUIAIoAgA2AmQgAkH4EigCACACKAIAIAIoAgggAigCBHNzczYCECACIAIoAhBB/wFxLQCACCACKAIQQRh2LQCACEEYdCACKAIQQRB2Qf8BcS0AgAhBEHRzIAIoAhBBCHZB/wFxLQCACEEIdHNzNgIQIAIgAigCDCACKAIQQRd0IAIoAhBBCXZyIAIoAhAgAigCEEENdCACKAIQQRN2cnNzczYCECACKAIUIAIoAhA2AmggAkH8EigCACACKAIQIAIoAgQgAigCAHNzczYCDCACIAIoAgxB/wFxLQCACCACKAIMQRh2LQCACEEYdCACKAIMQRB2Qf8BcS0AgAhBEHRzIAIoAgxBCHZB/wFxLQCACEEIdHNzNgIMIAIgAigCCCACKAIMQRd0IAIoAgxBCXZyIAIoAgwgAigCDEENdCACKAIMQRN2cnNzczYCDCACKAIUIAIoAgw2AmwgAkGAEygCACACKAIMIAIoAgAgAigCEHNzczYCCCACIAIoAghB/wFxLQCACCACKAIIQRh2LQCACEEYdCACKAIIQRB2Qf8BcS0AgAhBEHRzIAIoAghBCHZB/wFxLQCACEEIdHNzNgIIIAIgAigCBCACKAIIQRd0IAIoAghBCXZyIAIoAgggAigCCEENdCACKAIIQRN2cnNzczYCCCACKAIUIAIoAgg2AnAgAkGEEygCACACKAIIIAIoAhAgAigCDHNzczYCBCACIAIoAgRB/wFxLQCACCACKAIEQRh2LQCACEEYdCACKAIEQRB2Qf8BcS0AgAhBEHRzIAIoAgRBCHZB/wFxLQCACEEIdHNzNgIEIAIgAigCACACKAIEQRd0IAIoAgRBCXZyIAIoAgQgAigCBEENdCACKAIEQRN2cnNzczYCBCACKAIUIAIoAgQ2AnQgAkGIEygCACACKAIEIAIoAgwgAigCCHNzczYCACACIAIoAgBB/wFxLQCACCACKAIAQRh2LQCACEEYdCACKAIAQRB2Qf8BcS0AgAhBEHRzIAIoAgBBCHZB/wFxLQCACEEIdHNzNgIAIAIgAigCECACKAIAQRd0IAIoAgBBCXZyIAIoAgAgAigCAEENdCACKAIAQRN2cnNzczYCACACKAIUIAIoAgA2AnggAkGMEygCACACKAIAIAIoAgggAigCBHNzczYCECACIAIoAhBB/wFxLQCACCACKAIQQRh2LQCACEEYdCACKAIQQRB2Qf8BcS0AgAhBEHRzIAIoAhBBCHZB/wFxLQCACEEIdHNzNgIQIAIgAigCDCACKAIQQRd0IAIoAhBBCXZyIAIoAhAgAigCEEENdCACKAIQQRN2cnNzczYCECACKAIUIAIoAhA2AnwgAkEANgIAIAJBADYCBCACQQA2AgggAkEANgIMIAJBADYCEAuHAgEBfyMAQUBqIgUkACAFIAA2AjwgBSABNgI4IAUgAjYCNCAFIAM2AjAgBSAENgIsA0AgBSgCMCIABEAgBUEQIAAgAEEQTxs2AgwgBSgCPCAFKAI4IAVBEGoiABAGIAUoAiwgBSgCNCAAIAUoAgwQCSMAQRBrIgAgBSgCODYCDCAAQQ82AggDQAJAIAAoAggiAUEASA0AIAEgACgCDGoiASABLQAAQQFqOgAAIAAoAgwgACgCCGotAAANACAAIAAoAghBAWs2AggMAQsLIAUgBSgCDCAFKAI0ajYCNCAFIAUoAgwgBSgCLGo2AiwgBSAFKAIwIAUoAgxrNgIwDAELCyAFQUBrJAALxicBDH8jAEEQayIKJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBBmBMoAgAiBkEQIABBC2pBeHEgAEELSRsiBUEDdiIAdiIBQQNxBEACQCABQX9zQQFxIABqIgJBA3QiAUHAE2oiACABQcgTaigCACIBKAIIIgRGBEBBmBMgBkF+IAJ3cTYCAAwBCyAEIAA2AgwgACAENgIICyABQQhqIQAgASACQQN0IgJBA3I2AgQgASACaiIBIAEoAgRBAXI2AgQMDwsgBUGgEygCACIHTQ0BIAEEQAJAQQIgAHQiAkEAIAJrciABIAB0cWgiAUEDdCIAQcATaiICIABByBNqKAIAIgAoAggiBEYEQEGYEyAGQX4gAXdxIgY2AgAMAQsgBCACNgIMIAIgBDYCCAsgACAFQQNyNgIEIAAgBWoiCCABQQN0IgEgBWsiBEEBcjYCBCAAIAFqIAQ2AgAgBwRAIAdBeHFBwBNqIQFBrBMoAgAhAgJ/IAZBASAHQQN2dCIDcUUEQEGYEyADIAZyNgIAIAEMAQsgASgCCAshAyABIAI2AgggAyACNgIMIAIgATYCDCACIAM2AggLIABBCGohAEGsEyAINgIAQaATIAQ2AgAMDwtBnBMoAgAiC0UNASALaEECdEHIFWooAgAiAigCBEF4cSAFayEDIAIhAQNAAkAgASgCECIARQRAIAEoAhQiAEUNAQsgACgCBEF4cSAFayIBIAMgASADSSIBGyEDIAAgAiABGyECIAAhAQwBCwsgAigCGCEJIAIgAigCDCIERwRAQagTKAIAGiACKAIIIgAgBDYCDCAEIAA2AggMDgsgAkEUaiIBKAIAIgBFBEAgAigCECIARQ0DIAJBEGohAQsDQCABIQggACIEQRRqIgEoAgAiAA0AIARBEGohASAEKAIQIgANAAsgCEEANgIADA0LQX8hBSAAQb9/Sw0AIABBC2oiAEF4cSEFQZwTKAIAIghFDQBBACAFayEDAkACQAJAAn9BACAFQYACSQ0AGkEfIAVB////B0sNABogBUEmIABBCHZnIgBrdkEBcSAAQQF0a0E+agsiB0ECdEHIFWooAgAiAUUEQEEAIQAMAQtBACEAIAVBGSAHQQF2a0EAIAdBH0cbdCECA0ACQCABKAIEQXhxIAVrIgYgA08NACABIQQgBiIDDQBBACEDIAEhAAwDCyAAIAEoAhQiBiAGIAEgAkEddkEEcWooAhAiAUYbIAAgBhshACACQQF0IQIgAQ0ACwsgACAEckUEQEEAIQRBAiAHdCIAQQAgAGtyIAhxIgBFDQMgAGhBAnRByBVqKAIAIQALIABFDQELA0AgACgCBEF4cSAFayICIANJIQEgAiADIAEbIQMgACAEIAEbIQQgACgCECIBBH8gAQUgACgCFAsiAA0ACwsgBEUNACADQaATKAIAIAVrTw0AIAQoAhghByAEIAQoAgwiAkcEQEGoEygCABogBCgCCCIAIAI2AgwgAiAANgIIDAwLIARBFGoiASgCACIARQRAIAQoAhAiAEUNAyAEQRBqIQELA0AgASEGIAAiAkEUaiIBKAIAIgANACACQRBqIQEgAigCECIADQALIAZBADYCAAwLCyAFQaATKAIAIgRNBEBBrBMoAgAhAAJAIAQgBWsiAUEQTwRAIAAgBWoiAiABQQFyNgIEIAAgBGogATYCACAAIAVBA3I2AgQMAQsgACAEQQNyNgIEIAAgBGoiASABKAIEQQFyNgIEQQAhAkEAIQELQaATIAE2AgBBrBMgAjYCACAAQQhqIQAMDQsgBUGkEygCACICSQRAQaQTIAIgBWsiATYCAEGwE0GwEygCACIAIAVqIgI2AgAgAiABQQFyNgIEIAAgBUEDcjYCBCAAQQhqIQAMDQtBACEAIAVBL2oiAwJ/QfAWKAIABEBB+BYoAgAMAQtB/BZCfzcCAEH0FkKAoICAgIAENwIAQfAWIApBDGpBcHFB2KrVqgVzNgIAQYQXQQA2AgBB1BZBADYCAEGAIAsiAWoiBkEAIAFrIghxIgEgBU0NDEHQFigCACIEBEBByBYoAgAiByABaiIJIAdNDQ0gBCAJSQ0NCwJAQdQWLQAAQQRxRQRAAkACQAJAAkBBsBMoAgAiBARAQdgWIQADQCAEIAAoAgAiB08EQCAHIAAoAgRqIARLDQMLIAAoAggiAA0ACwtBABAEIgJBf0YNAyABIQZB9BYoAgAiAEEBayIEIAJxBEAgASACayACIARqQQAgAGtxaiEGCyAFIAZPDQNB0BYoAgAiAARAQcgWKAIAIgQgBmoiCCAETQ0EIAAgCEkNBAsgBhAEIgAgAkcNAQwFCyAGIAJrIAhxIgYQBCICIAAoAgAgACgCBGpGDQEgAiEACyAAQX9GDQEgBUEwaiAGTQRAIAAhAgwEC0H4FigCACICIAMgBmtqQQAgAmtxIgIQBEF/Rg0BIAIgBmohBiAAIQIMAwsgAkF/Rw0CC0HUFkHUFigCAEEEcjYCAAsgARAEIQJBABAEIQAgAkF/Rg0FIABBf0YNBSAAIAJNDQUgACACayIGIAVBKGpNDQULQcgWQcgWKAIAIAZqIgA2AgBBzBYoAgAgAEkEQEHMFiAANgIACwJAQbATKAIAIgMEQEHYFiEAA0AgAiAAKAIAIgEgACgCBCIEakYNAiAAKAIIIgANAAsMBAtBqBMoAgAiAEEAIAAgAk0bRQRAQagTIAI2AgALQQAhAEHcFiAGNgIAQdgWIAI2AgBBuBNBfzYCAEG8E0HwFigCADYCAEHkFkEANgIAA0AgAEEDdCIBQcgTaiABQcATaiIENgIAIAFBzBNqIAQ2AgAgAEEBaiIAQSBHDQALQaQTIAZBKGsiAEF4IAJrQQdxIgFrIgQ2AgBBsBMgASACaiIBNgIAIAEgBEEBcjYCBCAAIAJqQSg2AgRBtBNBgBcoAgA2AgAMBAsgAiADTQ0CIAEgA0sNAiAAKAIMQQhxDQIgACAEIAZqNgIEQbATIANBeCADa0EHcSIAaiIBNgIAQaQTQaQTKAIAIAZqIgIgAGsiADYCACABIABBAXI2AgQgAiADakEoNgIEQbQTQYAXKAIANgIADAMLQQAhBAwKC0EAIQIMCAtBqBMoAgAgAksEQEGoEyACNgIACyACIAZqIQFB2BYhAAJAAkACQANAIAEgACgCAEcEQCAAKAIIIgANAQwCCwsgAC0ADEEIcUUNAQtB2BYhAANAIAMgACgCACIBTwRAIAEgACgCBGoiBCADSw0DCyAAKAIIIQAMAAsACyAAIAI2AgAgACAAKAIEIAZqNgIEIAJBeCACa0EHcWoiByAFQQNyNgIEIAFBeCABa0EHcWoiBiAFIAdqIgVrIQAgAyAGRgRAQbATIAU2AgBBpBNBpBMoAgAgAGoiADYCACAFIABBAXI2AgQMCAtBrBMoAgAgBkYEQEGsEyAFNgIAQaATQaATKAIAIABqIgA2AgAgBSAAQQFyNgIEIAAgBWogADYCAAwICyAGKAIEIgNBA3FBAUcNBiADQXhxIQkgA0H/AU0EQCAGKAIMIgEgBigCCCICRgRAQZgTQZgTKAIAQX4gA0EDdndxNgIADAcLIAIgATYCDCABIAI2AggMBgsgBigCGCEIIAYgBigCDCICRwRAIAYoAggiASACNgIMIAIgATYCCAwFCyAGQRRqIgEoAgAiA0UEQCAGKAIQIgNFDQQgBkEQaiEBCwNAIAEhBCADIgJBFGoiASgCACIDDQAgAkEQaiEBIAIoAhAiAw0ACyAEQQA2AgAMBAtBpBMgBkEoayIAQXggAmtBB3EiAWsiCDYCAEGwEyABIAJqIgE2AgAgASAIQQFyNgIEIAAgAmpBKDYCBEG0E0GAFygCADYCACADIARBJyAEa0EHcWpBL2siACAAIANBEGpJGyIBQRs2AgQgAUHgFikCADcCECABQdgWKQIANwIIQeAWIAFBCGo2AgBB3BYgBjYCAEHYFiACNgIAQeQWQQA2AgAgAUEYaiEAA0AgAEEHNgIEIABBCGohDCAAQQRqIQAgDCAESQ0ACyABIANGDQAgASABKAIEQX5xNgIEIAMgASADayICQQFyNgIEIAEgAjYCACACQf8BTQRAIAJBeHFBwBNqIQACf0GYEygCACIBQQEgAkEDdnQiAnFFBEBBmBMgASACcjYCACAADAELIAAoAggLIQEgACADNgIIIAEgAzYCDCADIAA2AgwgAyABNgIIDAELQR8hACACQf///wdNBEAgAkEmIAJBCHZnIgBrdkEBcSAAQQF0a0E+aiEACyADIAA2AhwgA0IANwIQIABBAnRByBVqIQECQAJAQZwTKAIAIgRBASAAdCIGcUUEQEGcEyAEIAZyNgIAIAEgAzYCAAwBCyACQRkgAEEBdmtBACAAQR9HG3QhACABKAIAIQQDQCAEIgEoAgRBeHEgAkYNAiAAQR12IQQgAEEBdCEAIAEgBEEEcWoiBigCECIEDQALIAYgAzYCEAsgAyABNgIYIAMgAzYCDCADIAM2AggMAQsgASgCCCIAIAM2AgwgASADNgIIIANBADYCGCADIAE2AgwgAyAANgIIC0GkEygCACIAIAVNDQBBpBMgACAFayIBNgIAQbATQbATKAIAIgAgBWoiAjYCACACIAFBAXI2AgQgACAFQQNyNgIEIABBCGohAAwIC0GUE0EwNgIAQQAhAAwHC0EAIQILIAhFDQACQCAGKAIcIgFBAnRByBVqIgQoAgAgBkYEQCAEIAI2AgAgAg0BQZwTQZwTKAIAQX4gAXdxNgIADAILIAhBEEEUIAgoAhAgBkYbaiACNgIAIAJFDQELIAIgCDYCGCAGKAIQIgEEQCACIAE2AhAgASACNgIYCyAGKAIUIgFFDQAgAiABNgIUIAEgAjYCGAsgACAJaiEAIAYgCWoiBigCBCEDCyAGIANBfnE2AgQgBSAAQQFyNgIEIAAgBWogADYCACAAQf8BTQRAIABBeHFBwBNqIQECf0GYEygCACICQQEgAEEDdnQiAHFFBEBBmBMgACACcjYCACABDAELIAEoAggLIQAgASAFNgIIIAAgBTYCDCAFIAE2AgwgBSAANgIIDAELQR8hAyAAQf///wdNBEAgAEEmIABBCHZnIgFrdkEBcSABQQF0a0E+aiEDCyAFIAM2AhwgBUIANwIQIANBAnRByBVqIQECQAJAQZwTKAIAIgJBASADdCIEcUUEQEGcEyACIARyNgIAIAEgBTYCAAwBCyAAQRkgA0EBdmtBACADQR9HG3QhAyABKAIAIQIDQCACIgEoAgRBeHEgAEYNAiADQR12IQIgA0EBdCEDIAEgAkEEcWoiBCgCECICDQALIAQgBTYCEAsgBSABNgIYIAUgBTYCDCAFIAU2AggMAQsgASgCCCIAIAU2AgwgASAFNgIIIAVBADYCGCAFIAE2AgwgBSAANgIICyAHQQhqIQAMAgsCQCAHRQ0AAkAgBCgCHCIAQQJ0QcgVaiIBKAIAIARGBEAgASACNgIAIAINAUGcEyAIQX4gAHdxIgg2AgAMAgsgB0EQQRQgBygCECAERhtqIAI2AgAgAkUNAQsgAiAHNgIYIAQoAhAiAARAIAIgADYCECAAIAI2AhgLIAQoAhQiAEUNACACIAA2AhQgACACNgIYCwJAIANBD00EQCAEIAMgBWoiAEEDcjYCBCAAIARqIgAgACgCBEEBcjYCBAwBCyAEIAVBA3I2AgQgBCAFaiICIANBAXI2AgQgAiADaiADNgIAIANB/wFNBEAgA0F4cUHAE2ohAAJ/QZgTKAIAIgFBASADQQN2dCIDcUUEQEGYEyABIANyNgIAIAAMAQsgACgCCAshASAAIAI2AgggASACNgIMIAIgADYCDCACIAE2AggMAQtBHyEAIANB////B00EQCADQSYgA0EIdmciAGt2QQFxIABBAXRrQT5qIQALIAIgADYCHCACQgA3AhAgAEECdEHIFWohAQJAAkAgCEEBIAB0IgZxRQRAQZwTIAYgCHI2AgAgASACNgIADAELIANBGSAAQQF2a0EAIABBH0cbdCEAIAEoAgAhBQNAIAUiASgCBEF4cSADRg0CIABBHXYhBiAAQQF0IQAgASAGQQRxaiIGKAIQIgUNAAsgBiACNgIQCyACIAE2AhggAiACNgIMIAIgAjYCCAwBCyABKAIIIgAgAjYCDCABIAI2AgggAkEANgIYIAIgATYCDCACIAA2AggLIARBCGohAAwBCwJAIAlFDQACQCACKAIcIgBBAnRByBVqIgEoAgAgAkYEQCABIAQ2AgAgBA0BQZwTIAtBfiAAd3E2AgAMAgsgCUEQQRQgCSgCECACRhtqIAQ2AgAgBEUNAQsgBCAJNgIYIAIoAhAiAARAIAQgADYCECAAIAQ2AhgLIAIoAhQiAEUNACAEIAA2AhQgACAENgIYCwJAIANBD00EQCACIAMgBWoiAEEDcjYCBCAAIAJqIgAgACgCBEEBcjYCBAwBCyACIAVBA3I2AgQgAiAFaiIEIANBAXI2AgQgAyAEaiADNgIAIAcEQCAHQXhxQcATaiEAQawTKAIAIQECf0EBIAdBA3Z0IgUgBnFFBEBBmBMgBSAGcjYCACAADAELIAAoAggLIQYgACABNgIIIAYgATYCDCABIAA2AgwgASAGNgIIC0GsEyAENgIAQaATIAM2AgALIAJBCGohAAsgCkEQaiQAIAALNwEBfyAABEAgACgCBCIBBEAgARADIABBADYCBAsgACgCCCIBBEAgARADIABBADYCCAsLIAAQAwu7LwEGfyMAQZABayIFJAACQCABRQ0AIAJFDQAgAhAFIQYCQAJAAkACQAJAIAAoAgBBAWsOAgIAAQsgBUEQaiIDIAAoAgQQCiAFIAAoAggiACkAADcDACAFIAApAAg3AwggAyAFIAEgAiAGEAsMAgsgBhADQX8hAgwCCyAAKAIEIQQjAEEgayIIIgMgBUEQaiIHNgIcIAMgBDYCGCADIAMoAhw2AhQgA0GAEigCACADKAIYIgQtAABBGHQgBC0AAUEQdHIgBC0AAkEIdHIgBC0AA3JzNgIQIANBhBIoAgAgAygCGC0AByADKAIYLQAEQRh0IAMoAhgtAAVBEHRyIAMoAhgtAAZBCHRycnM2AgwgA0GIEigCACADKAIYLQALIAMoAhgtAAhBGHQgAygCGC0ACUEQdHIgAygCGC0ACkEIdHJyczYCCCADQYwSKAIAIAMoAhgtAA8gAygCGC0ADEEYdCADKAIYLQANQRB0ciADKAIYLQAOQQh0cnJzNgIEIANBkBIoAgAgAygCBCADKAIMIAMoAghzc3M2AgAgAyADKAIAIgRBGHYtAIAIQRh0IARBEHZB/wFxLQCACEEQdHMgBEEIdkH/AXEtAIAIQQh0cyAEQf8BcS0AgAhzNgIAIAMgAygCECADKAIAIAMoAgBBDXQgAygCACIEQRN2cnMgAygCAEEXdCAEQQl2cnNzNgIAIAMoAhQgAygCADYCfCADQZQSKAIAIAMoAgAgAygCCCADKAIEc3NzNgIQIAMgAygCEEH/AXEtAIAIIAMoAhBBGHYtAIAIQRh0IAMoAhBBEHZB/wFxLQCACEEQdHMgAygCEEEIdkH/AXEtAIAIQQh0c3M2AhAgAyADKAIMIAMoAhAgAygCEEENdCADKAIQIgRBE3ZycyADKAIQQRd0IARBCXZyc3M2AhAgAygCFCADKAIQNgJ4IANBmBIoAgAgAygCECADKAIEIAMoAgBzc3M2AgwgAyADKAIMQf8BcS0AgAggAygCDEEYdi0AgAhBGHQgAygCDEEQdkH/AXEtAIAIQRB0cyADKAIMQQh2Qf8BcS0AgAhBCHRzczYCDCADIAMoAgggAygCDCADKAIMQQ10IAMoAgwiBEETdnJzIAMoAgxBF3QgBEEJdnJzczYCDCADKAIUIAMoAgw2AnQgA0GcEigCACADKAIMIAMoAgAgAygCEHNzczYCCCADIAMoAghB/wFxLQCACCADKAIIQRh2LQCACEEYdCADKAIIQRB2Qf8BcS0AgAhBEHRzIAMoAghBCHZB/wFxLQCACEEIdHNzNgIIIAMgAygCBCADKAIIIAMoAghBDXQgAygCCCIEQRN2cnMgAygCCEEXdCAEQQl2cnNzNgIIIAMoAhQgAygCCDYCcCADQaASKAIAIAMoAgggAygCECADKAIMc3NzNgIEIAMgAygCBEH/AXEtAIAIIAMoAgRBGHYtAIAIQRh0IAMoAgRBEHZB/wFxLQCACEEQdHMgAygCBEEIdkH/AXEtAIAIQQh0c3M2AgQgAyADKAIAIAMoAgQgAygCBEENdCADKAIEIgRBE3ZycyADKAIEQRd0IARBCXZyc3M2AgQgAygCFCADKAIENgJsIANBpBIoAgAgAygCBCADKAIMIAMoAghzc3M2AgAgAyADKAIAQf8BcS0AgAggAygCAEEYdi0AgAhBGHQgAygCAEEQdkH/AXEtAIAIQRB0cyADKAIAQQh2Qf8BcS0AgAhBCHRzczYCACADIAMoAhAgAygCAEEXdCADKAIAQQl2ciADKAIAIAMoAgBBDXQgAygCAEETdnJzc3M2AgAgAygCFCADKAIANgJoIANBqBIoAgAgAygCACADKAIIIAMoAgRzc3M2AhAgAyADKAIQQf8BcS0AgAggAygCEEEYdi0AgAhBGHQgAygCEEEQdkH/AXEtAIAIQRB0cyADKAIQQQh2Qf8BcS0AgAhBCHRzczYCECADIAMoAgwgAygCEEEXdCADKAIQQQl2ciADKAIQIAMoAhBBDXQgAygCEEETdnJzc3M2AhAgAygCFCADKAIQNgJkIANBrBIoAgAgAygCECADKAIEIAMoAgBzc3M2AgwgAyADKAIMQf8BcS0AgAggAygCDEEYdi0AgAhBGHQgAygCDEEQdkH/AXEtAIAIQRB0cyADKAIMQQh2Qf8BcS0AgAhBCHRzczYCDCADIAMoAgggAygCDEEXdCADKAIMQQl2ciADKAIMIAMoAgxBDXQgAygCDEETdnJzc3M2AgwgAygCFCADKAIMNgJgIANBsBIoAgAgAygCDCADKAIAIAMoAhBzc3M2AgggAyADKAIIQf8BcS0AgAggAygCCEEYdi0AgAhBGHQgAygCCEEQdkH/AXEtAIAIQRB0cyADKAIIQQh2Qf8BcS0AgAhBCHRzczYCCCADIAMoAgQgAygCCEEXdCADKAIIQQl2ciADKAIIIAMoAghBDXQgAygCCEETdnJzc3M2AgggAygCFCADKAIINgJcIANBtBIoAgAgAygCCCADKAIQIAMoAgxzc3M2AgQgAyADKAIEQf8BcS0AgAggAygCBEEYdi0AgAhBGHQgAygCBEEQdkH/AXEtAIAIQRB0cyADKAIEQQh2Qf8BcS0AgAhBCHRzczYCBCADIAMoAgAgAygCBEEXdCADKAIEQQl2ciADKAIEIAMoAgRBDXQgAygCBEETdnJzc3M2AgQgAygCFCADKAIENgJYIANBuBIoAgAgAygCBCADKAIMIAMoAghzc3M2AgAgAyADKAIAQf8BcS0AgAggAygCAEEYdi0AgAhBGHQgAygCAEEQdkH/AXEtAIAIQRB0cyADKAIAQQh2Qf8BcS0AgAhBCHRzczYCACADIAMoAhAgAygCAEEXdCADKAIAQQl2ciADKAIAIAMoAgBBDXQgAygCAEETdnJzc3M2AgAgAygCFCADKAIANgJUIANBvBIoAgAgAygCACADKAIIIAMoAgRzc3M2AhAgAyADKAIQQf8BcS0AgAggAygCEEEYdi0AgAhBGHQgAygCEEEQdkH/AXEtAIAIQRB0cyADKAIQQQh2Qf8BcS0AgAhBCHRzczYCECADIAMoAgwgAygCEEEXdCADKAIQQQl2ciADKAIQIAMoAhBBDXQgAygCEEETdnJzc3M2AhAgAygCFCADKAIQNgJQIANBwBIoAgAgAygCECADKAIEIAMoAgBzc3M2AgwgAyADKAIMQf8BcS0AgAggAygCDEEYdi0AgAhBGHQgAygCDEEQdkH/AXEtAIAIQRB0cyADKAIMQQh2Qf8BcS0AgAhBCHRzczYCDCADIAMoAgggAygCDEEXdCADKAIMQQl2ciADKAIMIAMoAgxBDXQgAygCDEETdnJzc3M2AgwgAygCFCADKAIMNgJMIANBxBIoAgAgAygCDCADKAIAIAMoAhBzc3M2AgggAyADKAIIQf8BcS0AgAggAygCCEEYdi0AgAhBGHQgAygCCEEQdkH/AXEtAIAIQRB0cyADKAIIQQh2Qf8BcS0AgAhBCHRzczYCCCADIAMoAgQgAygCCEEXdCADKAIIQQl2ciADKAIIIAMoAghBDXQgAygCCEETdnJzc3M2AgggAygCFCADKAIINgJIIANByBIoAgAgAygCCCADKAIQIAMoAgxzc3M2AgQgAyADKAIEQf8BcS0AgAggAygCBEEYdi0AgAhBGHQgAygCBEEQdkH/AXEtAIAIQRB0cyADKAIEQQh2Qf8BcS0AgAhBCHRzczYCBCADIAMoAgAgAygCBEEXdCADKAIEQQl2ciADKAIEIAMoAgRBDXQgAygCBEETdnJzc3M2AgQgAygCFCADKAIENgJEIANBzBIoAgAgAygCBCADKAIMIAMoAghzc3M2AgAgAyADKAIAQf8BcS0AgAggAygCAEEYdi0AgAhBGHQgAygCAEEQdkH/AXEtAIAIQRB0cyADKAIAQQh2Qf8BcS0AgAhBCHRzczYCACADIAMoAhAgAygCAEEXdCADKAIAQQl2ciADKAIAIAMoAgBBDXQgAygCAEETdnJzc3M2AgAgAygCFEFAayADKAIANgIAIANB0BIoAgAgAygCACADKAIIIAMoAgRzc3M2AhAgAyADKAIQQf8BcS0AgAggAygCEEEYdi0AgAhBGHQgAygCEEEQdkH/AXEtAIAIQRB0cyADKAIQQQh2Qf8BcS0AgAhBCHRzczYCECADIAMoAgwgAygCEEEXdCADKAIQQQl2ciADKAIQIAMoAhBBDXQgAygCEEETdnJzc3M2AhAgAygCFCADKAIQNgI8IANB1BIoAgAgAygCECADKAIEIAMoAgBzc3M2AgwgAyADKAIMQf8BcS0AgAggAygCDEEYdi0AgAhBGHQgAygCDEEQdkH/AXEtAIAIQRB0cyADKAIMQQh2Qf8BcS0AgAhBCHRzczYCDCADIAMoAgggAygCDEEXdCADKAIMQQl2ciADKAIMIAMoAgxBDXQgAygCDEETdnJzc3M2AgwgAygCFCADKAIMNgI4IANB2BIoAgAgAygCDCADKAIAIAMoAhBzc3M2AgggAyADKAIIQf8BcS0AgAggAygCCEEYdi0AgAhBGHQgAygCCEEQdkH/AXEtAIAIQRB0cyADKAIIQQh2Qf8BcS0AgAhBCHRzczYCCCADIAMoAgQgAygCCEEXdCADKAIIQQl2ciADKAIIIAMoAghBDXQgAygCCEETdnJzc3M2AgggAygCFCADKAIINgI0IANB3BIoAgAgAygCCCADKAIQIAMoAgxzc3M2AgQgAyADKAIEQf8BcS0AgAggAygCBEEYdi0AgAhBGHQgAygCBEEQdkH/AXEtAIAIQRB0cyADKAIEQQh2Qf8BcS0AgAhBCHRzczYCBCADIAMoAgAgAygCBEEXdCADKAIEQQl2ciADKAIEIAMoAgRBDXQgAygCBEETdnJzc3M2AgQgAygCFCADKAIENgIwIANB4BIoAgAgAygCBCADKAIMIAMoAghzc3M2AgAgAyADKAIAQf8BcS0AgAggAygCAEEYdi0AgAhBGHQgAygCAEEQdkH/AXEtAIAIQRB0cyADKAIAQQh2Qf8BcS0AgAhBCHRzczYCACADIAMoAhAgAygCAEEXdCADKAIAQQl2ciADKAIAIAMoAgBBDXQgAygCAEETdnJzc3M2AgAgAygCFCADKAIANgIsIANB5BIoAgAgAygCACADKAIIIAMoAgRzc3M2AhAgAyADKAIQQf8BcS0AgAggAygCEEEYdi0AgAhBGHQgAygCEEEQdkH/AXEtAIAIQRB0cyADKAIQQQh2Qf8BcS0AgAhBCHRzczYCECADIAMoAgwgAygCEEEXdCADKAIQQQl2ciADKAIQIAMoAhBBDXQgAygCEEETdnJzc3M2AhAgAygCFCADKAIQNgIoIANB6BIoAgAgAygCECADKAIEIAMoAgBzc3M2AgwgAyADKAIMQf8BcS0AgAggAygCDEEYdi0AgAhBGHQgAygCDEEQdkH/AXEtAIAIQRB0cyADKAIMQQh2Qf8BcS0AgAhBCHRzczYCDCADIAMoAgggAygCDEEXdCADKAIMQQl2ciADKAIMIAMoAgxBDXQgAygCDEETdnJzc3M2AgwgAygCFCADKAIMNgIkIANB7BIoAgAgAygCDCADKAIAIAMoAhBzc3M2AgggAyADKAIIQf8BcS0AgAggAygCCEEYdi0AgAhBGHQgAygCCEEQdkH/AXEtAIAIQRB0cyADKAIIQQh2Qf8BcS0AgAhBCHRzczYCCCADIAMoAgQgAygCCEEXdCADKAIIQQl2ciADKAIIIAMoAghBDXQgAygCCEETdnJzc3M2AgggAygCFCADKAIINgIgIANB8BIoAgAgAygCCCADKAIQIAMoAgxzc3M2AgQgAyADKAIEQf8BcS0AgAggAygCBEEYdi0AgAhBGHQgAygCBEEQdkH/AXEtAIAIQRB0cyADKAIEQQh2Qf8BcS0AgAhBCHRzczYCBCADIAMoAgAgAygCBEEXdCADKAIEQQl2ciADKAIEIAMoAgRBDXQgAygCBEETdnJzc3M2AgQgAygCFCADKAIENgIcIANB9BIoAgAgAygCBCADKAIMIAMoAghzc3M2AgAgAyADKAIAQf8BcS0AgAggAygCAEEYdi0AgAhBGHQgAygCAEEQdkH/AXEtAIAIQRB0cyADKAIAQQh2Qf8BcS0AgAhBCHRzczYCACADIAMoAhAgAygCAEEXdCADKAIAQQl2ciADKAIAIAMoAgBBDXQgAygCAEETdnJzc3M2AgAgAygCFCADKAIANgIYIANB+BIoAgAgAygCACADKAIIIAMoAgRzc3M2AhAgAyADKAIQQf8BcS0AgAggAygCEEEYdi0AgAhBGHQgAygCEEEQdkH/AXEtAIAIQRB0cyADKAIQQQh2Qf8BcS0AgAhBCHRzczYCECADIAMoAgwgAygCEEEXdCADKAIQQQl2ciADKAIQIAMoAhBBDXQgAygCEEETdnJzc3M2AhAgAygCFCADKAIQNgIUIANB/BIoAgAgAygCECADKAIEIAMoAgBzc3M2AgwgAyADKAIMQf8BcS0AgAggAygCDEEYdi0AgAhBGHQgAygCDEEQdkH/AXEtAIAIQRB0cyADKAIMQQh2Qf8BcS0AgAhBCHRzczYCDCADIAMoAgggAygCDEEXdCADKAIMQQl2ciADKAIMIAMoAgxBDXQgAygCDEETdnJzc3M2AgwgAygCFCADKAIMNgIQIANBgBMoAgAgAygCDCADKAIAIAMoAhBzc3M2AgggAyADKAIIQf8BcS0AgAggAygCCEEYdi0AgAhBGHQgAygCCEEQdkH/AXEtAIAIQRB0cyADKAIIQQh2Qf8BcS0AgAhBCHRzczYCCCADIAMoAgQgAygCCEEXdCADKAIIQQl2ciADKAIIIAMoAghBDXQgAygCCEETdnJzc3M2AgggAygCFCADKAIINgIMIANBhBMoAgAgAygCCCADKAIQIAMoAgxzc3M2AgQgAyADKAIEQf8BcS0AgAggAygCBEEYdi0AgAhBGHQgAygCBEEQdkH/AXEtAIAIQRB0cyADKAIEQQh2Qf8BcS0AgAhBCHRzczYCBCADIAMoAgAgAygCBEEXdCADKAIEQQl2ciADKAIEIAMoAgRBDXQgAygCBEETdnJzc3M2AgQgAygCFCADKAIENgIIIANBiBMoAgAgAygCBCADKAIMIAMoAghzc3M2AgAgAyADKAIAQf8BcS0AgAggAygCAEEYdi0AgAhBGHQgAygCAEEQdkH/AXEtAIAIQRB0cyADKAIAQQh2Qf8BcS0AgAhBCHRzczYCACADIAMoAhAgAygCAEEXdCADKAIAQQl2ciADKAIAIAMoAgBBDXQgAygCAEETdnJzc3M2AgAgAygCFCADKAIANgIEIANBjBMoAgAgAygCACADKAIIIAMoAgRzc3M2AhAgAyADKAIQQf8BcS0AgAggAygCEEEYdi0AgAhBGHQgAygCEEEQdkH/AXEtAIAIQRB0cyADKAIQQQh2Qf8BcS0AgAhBCHRzczYCECADIAMoAgwgAygCEEEXdCADKAIQQQl2ciADKAIQIAMoAhBBDXQgAygCEEETdnJzc3M2AhAgAygCFCADKAIQNgIAIANBADYCACADQQA2AgQgA0EANgIIIANBADYCDCADQQA2AhAgACgCCCEDIAgiACQAIAAgBzYCHCAAIAM2AhggACABNgIUIAAgAkEEdjYCECAAIAY2AgwDQCAAIAAoAhAiA0EBazYCECADBEAgACgCHCAAKAIUIAAoAgwQBiAAKAIYIQQjAEEgayIDIAAoAgw2AhwgAyAENgIYIANBEDYCFCADIAMoAhw2AhAgAyADKAIYNgIMIANBADYCCANAIAMoAggiBCADKAIUSQRAIAQgAygCEGoiByAEIAMoAgxqLQAAIActAABzOgAAIAMgAygCCEEBajYCCAwBCwsgACAAKAIUNgIYIAAgACgCFEEQajYCFCAAIAAoAgxBEGo2AgwMAQsLIABBIGokAAsgASAGIAIQCCAGEAMLIAIhAwsgBUGQAWokACADC68CAQN/IwBBkAFrIgMkAAJAIAFFDQAgAkUNACADQRBqIAAoAgQQCiACEAUhBUF/IQQCQAJAAkACQCAAKAIAQQFrDgIAAQMLIAAoAgghBCMAQSBrIgAkACAAIANBEGo2AhwgACAENgIYIAAgATYCFCAAIAJBBHY2AhAgACAFNgIMA0AgACAAKAIQIgRBAWs2AhAgBARAIAAoAgwgACgCFCAAKAIYQRAQCSAAKAIcIAAoAgwgACgCDBAGIAAgACgCDDYCGCAAIAAoAhRBEGo2AhQgACAAKAIMQRBqNgIMDAELCyAAQSBqJAAMAQsgAyAAKAIIIgApAAA3AwAgAyAAKQAINwMIIANBEGogAyABIAIgBRALCyABIAUgAhAIIAIhBAsgBRADCyADQZABaiQAIAQLYwEBf0EMEAUiAyAANgIAIANBIBAFIgA2AgQgACABKQAYNwAYIAAgASkAEDcAECAAIAEpAAg3AAggACABKQAANwAAIANBEBAFIgA2AgggACACKQAINwAIIAAgAikAADcAACADCwuiCwIAQYAIC4AK1pDp/szhPbcWthTCKPssBStnmnYqvgTDqkQTJkmGBpmcQlD0ke+YejNUC0Ptz6xi5LMcqckI6JWA35T6dY8/pkcHp/zzcxe6g1k8GeaFT6hoa4GycWTai/jrD0twVp01HiQOXmNY0aIlInw7ASF4h9QARlef0ydSTDYC56DEyJ7qv4rSQMc4taP38s75YRWh4K5dpJs0GlWtkzIw9Yyx4x324i6CZspgwCkjqw1TTm/V2zdF3v2OLwP/anJtbFtRjRuvkrvdvH8R2VxBHxBa2ArBMYilzXu9LXTQErjltLCJaZdKDJZ3fmW58QnFbsaEGPB97DrcTSB57l8+18s5SFtb1Y5CQpLQp6fqTfv7/QYzM8/8h4fiZfT0Pcne3rVrWFgWTtratG5QUBRECwvByqCgKIjv7/gXsLAsnBQUBRGsrCuHnZ1m+2pqmPLZ2XeuqKgqgvr6vEYQEAQUDw/Az6qqqAIREUVUTEwTX5iYJr4lJUhtGhqEnhgYBh5mZpv9cnKe7AkJQ0pBQVEQ09P3JEZGk9W/v+xTYmKa+Onpe5LMzDP/UVFVBCwsCycNDUJPt7fuWT8/zPOysq4ciYlj6pOT53TOzrF/cHAcbKamqw0nJ8rtICAIKKOj60hWVpfBAgKCgH9/3KNSUpbE6+v5EtXVdKE+Po2z/Pw/w5qapD4dHUZbHBwHG56epTvz8/8Mz8/wP83Ncr9cXBdL6uq4Ug4OgY9lZVg98PA8zGRkGX2bm+V+FhaHkT09TnOioqoIoaFpyK2tascGBoOFysqwesXFcLWRkWX0a2vZsi4uiafj4/sYr6/oRzw8DzMtLUpnwcFxsFlZVw52dp/p1NQ14Xh4HmaQkCS0ODgONnl5XyaNjWLvYWFZOEdH0pWKiqAqlJQlsYiIIqrx8X2M7Ow71wQEAQWEhCGl4eF5mB4ehZtTU9eEAAAAABkZR15dXVYLfn6d409P0J+cnCe7SUlTGjExTXzY2DbuCAgCCp+f5HuCgqIgExPH1CMjy+h6epzmq6vpQv7+vUMqKoiiS0vRmgEBQUAfH8Tb4OA42NbWt2GOjqEv39/0K8vL8To7O8325+f6HYWFYOVUVBVBhoajJYOD42C6uqwWdXVcKZKSpjRubpn30NA05GhoGnJVVVQBtravGU5Okd/IyDL6wMAw8NfX9iEyMo68xsazdY+P4G90dB1p29v1LouL4Wq4uC6WCgqAipmZZ/4rK8nigYFh4AMDw8CkpCmNjIwjr66uqQc0NA05TU1SHzk5T3a9vW7TV1fWgW9v2Lfc3DfrFRVEUXt73ab39/4JOjqMtry8L5MMDAMP///8A6mpa8LJyXO6tbVs2bGxbdxtbVo3RUVQFTY2j7lsbBt3vr6tE0pKkNru7rlXd3feqfLyvkz9/X6DREQRVWdn2r1xcV0sBQVARXx8H2NAQBBQaWlbMmNj27goKAoiBwfCxcTEMfUiIoqolpanMTc3zvnt7XqX9va/SbS0LZnR0XWkQ0PTkEhIElri4rpYl5fmcdLStmTCwrJwJiaLraWlaM1eXpXLKSlLYjAwDDxaWpTO3d12q/n5f4aVlWTx5ua7XcfH8jUkJAktFxfG0bm5b9YbG8XeEhKGlGBgGHjDw/Mw9fV8ibOz71zo6DrSc3PfrDU1THmAgCCg5eV4nbu77VZ9fV4j+Pg+xl9f1IsvL8jn5OQ53SEhSWgAQYASC5MBxrqxo1AzqlaXkX1n3CJwshUOBwAxKiMcTUY/OGliW1SFfndwoZqTjL22r6jZ0svE9e7n4BEKA/wtJh8YSUI7NGVeV1CBenNsnZaPiLmyq6TVzsfA8erj3A0G//gpIhsURT43MGFaU0x9dm9omZKLhLWup6DRysO87ebf2AkC+/QlHhcQQTozLF1WT0h5cmtkkAsB")||(C=function(t){return e.locateFile?e.locateFile(t,a):a+t}(C));var M=t=>{for(;t.length>0;)t.shift()(e)};e.noExitRuntime;var w,B=e=>{var t=(e-h.buffer.byteLength+65535)/65536;try{return h.grow(t),A(),1}catch(e){}},O={a:()=>{x("")},c:(e,t,r)=>f.copyWithin(e,t,t+r),b:e=>{var t=f.length,r=2147483648;if((e>>>=0)>r)return!1;for(var n=(e,t)=>e+(t-e%t)%t,i=1;i<=4;i*=2){var o=t*(1+.2/i);o=Math.min(o,e+100663296);var s=Math.min(r,n(Math.max(e,o),65536));if(B(s))return!0}return!1}},D=function(){var t={a:O};function r(t,r){var n;return D=t.exports,h=D.d,A(),n=D.e,_.unshift(n),function(){if(y--,e.monitorRunDependencies&&e.monitorRunDependencies(y),0==y&&E){var t=E;E=null,t()}}(),D}if(y++,e.monitorRunDependencies&&e.monitorRunDependencies(y),e.instantiateWasm)try{return e.instantiateWasm(t,r)}catch(e){return p(`Module.instantiateWasm callback failed with error: ${e}`),!1}return R(C,t,(function(e){r(e.instance)})),{}}();function F(){function t(){w||(w=!0,e.calledRun=!0,d||(M(_),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)t=e.postRun.shift(),m.unshift(t);var t;M(m)}()))}y>0||(function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)t=e.preRun.shift(),g.unshift(t);var t;M(g)}(),y>0||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),t()}),1)):t()))}if(e._UGCWasm_CipherSM4_New=(t,r,n)=>(e._UGCWasm_CipherSM4_New=D.f)(t,r,n),e._UGCWasm_CipherSM4_Encrypt=(t,r,n)=>(e._UGCWasm_CipherSM4_Encrypt=D.g)(t,r,n),e._UGCWasm_CipherSM4_Decrypt=(t,r,n)=>(e._UGCWasm_CipherSM4_Decrypt=D.h)(t,r,n),e._UGCWasm_CipherSM4_Delete=t=>(e._UGCWasm_CipherSM4_Delete=D.i)(t),e._malloc=t=>(e._malloc=D.k)(t),e._free=t=>(e._free=D.l)(t),E=function e(){w||F(),w||(E=e)},e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return F(),e}();function Pj(){}var Nj=!1,Lj=!1,Uj=!1;function Gj(e,t){if(e.byteLength<=t)return e;return e.subarray(0,t)}function Qj(e,t){for(let r=0;r<e.length;r++)t[r]=e[r];return t}Zz.onRuntimeInitialized=()=>{(Nj=!0)&&Lj&&(Uj=!0)},Fj.onRuntimeInitialized=()=>{Lj=!0,Nj&&Lj&&(Uj=!0)},Pj.parse=function(e,t){return Uj?t="SM4"===e.type?function(e,t){const r=new Uint8Array(t),n=Gj(r,256),i=new Uint8Array(e),o=Fj._malloc(i.length*i.BYTES_PER_ELEMENT);Fj.HEAPU8.set(i,o/i.BYTES_PER_ELEMENT);const s=new Uint8Array([48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102]),a=Fj._malloc(s.length*s.BYTES_PER_ELEMENT);Fj.HEAPU8.set(s,a/s.BYTES_PER_ELEMENT);const u=Fj._UGCWasm_CipherSM4_New(2,o,a);Fj._free(o),Fj._free(a);const c=Fj._malloc(n.length*n.BYTES_PER_ELEMENT);Fj.HEAPU8.set(n,c/n.BYTES_PER_ELEMENT),Fj._UGCWasm_CipherSM4_Decrypt(u,c,n.length);const l=Qj(Fj.HEAPU8.subarray(c,c+n.length),r);return Fj._UGCWasm_CipherSM4_Delete(u),Fj._free(c),l.buffer}(e.key,t):function(e,t){var r=new Uint8Array(t);const n=new Uint8Array(e),i=Zz._malloc(n.length*n.BYTES_PER_ELEMENT);Zz.HEAPU8.set(n,i/n.BYTES_PER_ELEMENT);var o=new Uint8Array([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),s=Zz._malloc(o.length*o.BYTES_PER_ELEMENT);Zz.HEAPU8.set(o,s/o.BYTES_PER_ELEMENT);var a=Zz._UGCWasm_CipherAES_New(2,i,s);Zz._free(i),Zz._free(s);const u=Gj(r,256);return function(e,t,r){const n=Zz._malloc(e.length*e.BYTES_PER_ELEMENT);Zz.HEAPU8.set(e,n/e.BYTES_PER_ELEMENT),Zz._UGCWasm_CipherAES_Encrypt(t,n,e.length);let i=Zz.HEAPU8.subarray(n,n+e.length);const o=Qj(i,r);return Zz._free(n),o}(u,a,r).buffer}(e.key,t):null};const kj=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),zj=kj(void 0,(function(){return zj.toString().search("(((.+)+)+)+$").toString().constructor(zj).search("(((.+)+)+)+$")}));zj();class jj{constructor(e){this.entries={},this.scheduler=e}request(e,t,r,n){const i=this.entries[e]=this.entries[e]||{callbacks:[]};if(i.result){const[e,r]=i.result;return this.scheduler?this.scheduler.add((()=>{n(e,r)}),t):n(e,r),()=>{}}return i.callbacks.push(n),!i.cancel&&(i.cancel=r(((r,n)=>{i.result=[r,n];for(const e of i.callbacks)this.scheduler?this.scheduler.add((()=>{e(r,n)}),t):e(r,n);setTimeout((()=>delete this.entries[e]),3e3)}))),()=>{i.result||(i.callbacks=i.callbacks.filter((e=>e!==n)),!i.callbacks.length&&(i.cancel(),delete this.entries[e]))}}}function Hj(e,t,r){const n=JSON.stringify(e.request);e.data&&(this.deduped.entries[n]={result:[null,e.data]});const i={type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom};return this.deduped.request(n,i,(t=>{const r=(n=e.request,i=(r,n,i,o)=>{if(r)t(r);else if(n){if(Nn(e.encryptInfo)&&null==(n=Pj.parse(e.encryptInfo,n)))return void t(null);n.byteLength,t(null,{vectorTile:new nF(new UI(n)),rawData:n,cacheControl:i,expires:o})}},Tp(ip(n,{type:"arrayBuffer"}),i));var n,i;return()=>{r.cancel(),t()}}),t)}class qj extends jp{constructor(e,t,r,n,i){super(),this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=i||Hj,this.loading={},this.loaded={},this.deduped=new jj(e.scheduler),this.isSpriteLoaded=n,this.scheduler=e.scheduler}loadTile(e,t){const r=e.uid,n=e&&e.request;n&&n.collectResourceTiming;const i=this.loading[r]=new Wz(e);i.abort=this.loadVectorData(e,((n,o)=>{const s=!this.loading[r];if(delete this.loading[r],s||n||!o)return i.status="done",s||(this.loaded[r]=i),t(n);const a=o.rawData,u={};o.expires&&(u.expires=o.expires),o.cacheControl&&(u.cacheControl=o.cacheControl),i.vectorTile=o.vectorTile||new nF(new UI(a));const c=()=>{i.parse(e,i.vectorTile,this.layerIndex,this.availableImages,this.actor,((e,r)=>{if(e||!r)return t(e);t(null,ip({rawTileData:a.slice(0)},r,u,{}))}))};this.isSpriteLoaded?c():this.once("isSpriteLoaded",(()=>{if(this.scheduler){const t={type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom};this.scheduler.add(c,t)}else c()})),this.loaded=this.loaded||{},this.loaded[r]=i}))}reloadTile(e,t){const r=this.loaded,n=e.uid,i=this;if(r&&r[n]){const o=r[n];o.showCollisionBoxes=e.showCollisionBoxes,o.enableTerrain=!!e.enableTerrain,o.projection=e.projection,o.tileTransform=LM(e.tileID.canonical,e.projection);const s=(r,n)=>{const s=o.reloadCallback;s&&(delete o.reloadCallback,o.parse(e,o.vectorTile,i.layerIndex,this.availableImages,i.actor,s)),t(r,n)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(e,o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}abortTile(e,t){const r=e.uid,n=this.loading[r];n&&(n.abort&&n.abort(),delete this.loading[r]),t()}removeTile(e,t){const r=this.loaded,n=e.uid;r&&r[n]&&delete r[n],t()}}var Vj,Yj=(Vj=!0,function(e,t){var r=Vj?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Vj=!1,r}),Xj=Yj(void 0,(function(){return Xj.toString().search("(((.+)+)+)+$").toString().constructor(Xj).search("(((.+)+)+)+$")}));function Wj(e,t){var r,n=e&&e.type;if("FeatureCollection"===n)for(r=0;r<e.features.length;r++)Wj(e.features[r],t);else if("GeometryCollection"===n)for(r=0;r<e.geometries.length;r++)Wj(e.geometries[r],t);else if("Feature"===n)Wj(e.geometry,t);else if("Polygon"===n)Kj(e.coordinates,t);else if("MultiPolygon"===n)for(r=0;r<e.coordinates.length;r++)Kj(e.coordinates[r],t);return e}function Kj(e,t){if(0!==e.length){$j(e[0],t);for(var r=1;r<e.length;r++)$j(e[r],!t)}}function $j(e,t){for(var r=0,n=0,i=0,o=e.length,s=o-1;i<o;s=i++){var a=(e[i][0]-e[s][0])*(e[s][1]+e[i][1]),u=r+a;n+=Math.abs(r)>=Math.abs(a)?r-u+a:a-u+r,r=u}r+n>=0!=!!t&&e.reverse()}Xj();const Jj=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Zj=Jj(void 0,(function(){return Zj.toString().search("(((.+)+)+)+$").toString().constructor(Zj).search("(((.+)+)+)+$")}));Zj();class eH{constructor(e){this._feature=e,this.extent=Ec,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const t of this._feature.geometry)e.push([new Pn(t[0],t[1])]);return e}{const e=[];for(const t of this._feature.geometry){const r=[];for(const e of t)r.push(new Pn(e[0],e[1]));e.push(r)}return e}}toGeoJSON(e,t,r){return VD.prototype.toGeoJSON.call(this,e,t,r)}}class tH{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=Ec,this.length=e.length,this._features=e}feature(e){return new eH(this._features[e])}}var rH,nH=(rH=!0,function(e,t){var r=rH?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return rH=!1,r}),iH=nH(void 0,(function(){return iH.toString().search("(((.+)+)+)+$").toString().constructor(iH).search("(((.+)+)+)+$")}));iH();var oH,sH=(oH=!0,function(e,t){var r=oH?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return oH=!1,r}),aH=sH(void 0,(function(){return aH.toString().search("(((.+)+)+)+$").toString().constructor(aH).search("(((.+)+)+)+$")}));function uH(e){var t=new UI;return function(e,t){for(var r in e.layers)t.writeMessage(3,cH,e.layers[r])}(e,t),t.finish()}function cH(e,t){t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r,n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,lH,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)t.writeMessage(4,AH,o[r])}function lH(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,hH,e),t.writeVarintField(3,r.type),t.writeMessage(4,dH,r)}function hH(e,t){var r=e.feature,n=e.keys,i=e.values,o=e.keycache,s=e.valuecache;for(var a in r.properties){var u=r.properties[a],c=o[a];if(null!==u){void 0===c&&(n.push(a),c=n.length-1,o[a]=c),t.writeVarint(c);var l=typeof u;"string"!==l&&"boolean"!==l&&"number"!==l&&(u=JSON.stringify(u));var h=l+":"+u,p=s[h];void 0===p&&(i.push(u),p=i.length-1,s[h]=p),t.writeVarint(p)}}}function pH(e,t){return(t<<3)+(7&e)}function fH(e){return e<<1^e>>31}function dH(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,o=0,s=r.length,a=0;a<s;a++){var u=r[a],c=1;1===n&&(c=u.length),t.writeVarint(pH(1,c));for(var l=3===n?u.length-1:u.length,h=0;h<l;h++){1===h&&1!==n&&t.writeVarint(pH(2,l-1));var p=u[h].x-i,f=u[h].y-o;t.writeVarint(fH(p)),t.writeVarint(fH(f)),i+=p,o+=f}3===n&&t.writeVarint(pH(7,1))}}function AH(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}aH();const gH=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];function _H(e,t=64,r=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=gH.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-s%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+o+s+a),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}function mH(e,t,r,n,i,o){if(i-n<=r)return;const s=n+i>>1;yH(e,t,s,n,i,o),mH(e,t,r,n,s-1,1-o),mH(e,t,r,s+1,i,1-o)}function yH(e,t,r,n,i,o){for(;i>n;){if(i-n>600){const s=i-n+1,a=r-n+1,u=Math.log(s),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(s-c)/s)*(a-s/2<0?-1:1);yH(e,t,r,Math.max(n,Math.floor(r-a*c/s+l)),Math.min(i,Math.floor(r+(s-a)*c/s+l)),o)}const s=t[2*r+o];let a=n,u=i;for(EH(e,t,n,r),t[2*i+o]>s&&EH(e,t,n,i);a<u;){for(EH(e,t,a,u),a++,u--;t[2*a+o]<s;)a++;for(;t[2*u+o]>s;)u--}t[2*n+o]===s?EH(e,t,n,u):(u++,EH(e,t,u,i)),u<=r&&(n=u+1),r<=u&&(i=u-1)}}function EH(e,t,r,n){xH(e,r,n),xH(t,2*r,2*n),xH(t,2*r+1,2*n+1)}function xH(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function CH(e,t,r,n){const i=e-r,o=t-n;return i*i+o*o}function bH(e,t,r,n,i,o){var s=i-r,a=o-n,u={x:e-.5*s,y:t-.5*a,width:s,height:a},c={x:r,y:n,width:s,height:a},l=u.x,h=u.y,p=c.x,f=c.y;return!(l>p+c.width||l+u.width<p||h+u.height<f||h>f+c.height)}_H.prototype.add=function(e,t){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r},_H.prototype.finish=function(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return mH(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this},_H.prototype.range=function(e,t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:s}=this,a=[0,i.length-1,0],u=[];for(;a.length;){const c=a.pop()||0,l=a.pop()||0,h=a.pop()||0;if(l-h<=s){for(let s=h;s<=l;s++){const a=o[2*s],c=o[2*s+1];a>=e&&a<=r&&c>=t&&c<=n&&u.push(i[s])}continue}const p=h+l>>1,f=o[2*p],d=o[2*p+1];f>=e&&f<=r&&d>=t&&d<=n&&u.push(i[p]),(0===c?e<=f:t<=d)&&(a.push(h),a.push(p-1),a.push(1-c)),(0===c?r>=f:n>=d)&&(a.push(p+1),a.push(l),a.push(1-c))}return u},_H.prototype.within=function(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:i,nodeSize:o}=this,s=[0,n.length-1,0],a=[],u=r*r;for(;s.length;){const c=s.pop()||0,l=s.pop()||0,h=s.pop()||0;if(l-h<=o){for(let r=h;r<=l;r++)CH(i[2*r],i[2*r+1],e,t)<=u&&a.push(n[r]);continue}const p=h+l>>1,f=i[2*p],d=i[2*p+1];CH(f,d,e,t)<=u&&a.push(n[p]),(0===c?e-r<=f:t-r<=d)&&(s.push(h),s.push(p-1),s.push(1-c)),(0===c?e+r>=f:t+r>=d)&&(s.push(p+1),s.push(l),s.push(1-c))}return a},_H.prototype.intersect=function(e,t,r,n,i){const{ids:o,coords:s,nodeSize:a}=this;var u,c,l=[0,o.length-1,0],h=[];for(i=i||bH;l.length;){var p=l.pop(),f=l.pop(),d=l.pop();if(f-d<=a)for(var A=d;A<=f;A++)i(u=s[2*A],c=s[2*A+1],e,t,r,n,A,o[A])&&h.push(o[A]);else{var g=d+f>>1;i(u=s[2*g],c=s[2*g+1],e,t,r,n,g,o[g])&&h.push(o[g]);var _=1-p;(0===p?e<=u:t<=c)&&(l.push(d),l.push(g-1),l.push(_)),(0===p?r>=u:n>=c)&&(l.push(g+1),l.push(f),l.push(_))}}return h},_H.from=function(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,r]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=r>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const i=gH[15&r];if(!i)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new _H(s,o,i,e)};const IH=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),vH=IH(void 0,(function(){return vH.toString().search("(((.+)+)+)+$").toString().constructor(vH).search("(((.+)+)+)+$")}));vH();const TH={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},RH=Math.fround||(SH=new Float32Array(1),e=>(SH[0]=+e,SH[0]));var SH;class MH{constructor(e){this.options=Object.assign(Object.create(TH),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:r,maxZoom:n}=this.options;t&&console.time("total time");const i="prepare "+e.length+" points";t&&console.time(i),this.points=e;const o=[];for(let t=0;t<e.length;t++){const r=e[t];if(!r.geometry)continue;const[n,i]=r.geometry.coordinates,s=RH(OH(n)),a=RH(DH(i));o.push(s,a,1/0,t,-1,1),this.options.reduce&&o.push(0)}let s=this.trees[n+1]=this._createTree(o);t&&console.timeEnd(i);for(let e=n;e>=r;e--){const r=+Date.now();s=this.trees[e]=this._createTree(this._cluster(s,e)),t&&console.log("z%d: %d clusters in %dms",e,s.numItems,+Date.now()-r)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){const e=this.getClusters([r,n,180,o],t),s=this.getClusters([-180,n,i,o],t);return e.concat(s)}const s=this.trees[this._limitZoom(t)],a=s.range(OH(r),DH(o),OH(i),DH(n)),u=s.data,c=[];for(const e of a){const t=this.stride*e;c.push(u[t+5]>1?wH(u,t,this.clusterProps):this.points[u[t+3]])}return c}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);const o=i.data;if(t*this.stride>=o.length)throw new Error(n);const s=this.options.radius/(this.options.extent*Math.pow(2,r-1)),a=o[t*this.stride],u=o[t*this.stride+1],c=i.within(a,u,s),l=[];for(const t of c){const r=t*this.stride;o[r+4]===e&&l.push(o[r+5]>1?wH(o,r,this.clusterProps):this.points[o[r+3]])}if(0===l.length)throw new Error(n);return l}getLeaves(e,t,r){t=t||10,r=r||0;const n=[];return this._appendLeaves(n,e,t,r,0),n}getTile(e,t,r){const n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:o,radius:s}=this.options,a=s/o,u=(r-a)/i,c=(r+1+a)/i,l={features:[]};return this._addTileFeatures(n.range((t-a)/i,u,(t+1+a)/i,c),n.data,t,r,i,l),0===t&&this._addTileFeatures(n.range(1-a/i,u,1,c),n.data,i,r,i,l),t===i-1&&this._addTileFeatures(n.range(0,u,a/i,c),n.data,-1,r,i,l),l.features.length?l:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,n,i){const o=this.getChildren(t);for(const t of o){const o=t.properties;if(o&&o.cluster?i+o.point_count<=n?i+=o.point_count:i=this._appendLeaves(e,o.cluster_id,r,n,i):i<n?i++:e.push(t),e.length===r)break}return i}_createTree(e){const t=new _H(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let r=0;r<e.length;r+=this.stride)t.add(e[r],e[r+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,r,n,i,o){for(const s of e){const e=s*this.stride,a=t[e+5]>1;let u,c,l;if(a)u=BH(t,e,this.clusterProps),c=t[e],l=t[e+1];else{const r=this.points[t[e+3]];u=r.properties;const[n,i]=r.geometry.coordinates;c=OH(n),l=DH(i)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*i-r)),Math.round(this.options.extent*(l*i-n))]],tags:u};let p;p=a||this.options.generateId?t[e+3]:this.points[t[e+3]].id,void 0!==p&&(h.id=p),o.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:r,extent:n,reduce:i,minPoints:o}=this.options,s=r/(n*Math.pow(2,t)),a=e.data,u=[],c=this.stride;for(let r=0;r<a.length;r+=c){if(a[r+2]<=t)continue;a[r+2]=t;const n=a[r],l=a[r+1],h=e.within(a[r],a[r+1],s),p=a[r+5];let f=p;for(const e of h){const r=e*c;a[r+2]>t&&(f+=a[r+5])}if(f>p&&f>=o){let e,o=n*p,s=l*p,d=-1;const A=(r/c<<5)+(t+1)+this.points.length;for(const n of h){const u=n*c;if(a[u+2]<=t)continue;a[u+2]=t;const l=a[u+5];o+=a[u]*l,s+=a[u+1]*l,a[u+4]=A,i&&(!e&&(e=this._map(a,r,!0),d=this.clusterProps.length,this.clusterProps.push(e)),i(e,this._map(a,u)))}a[r+4]=A,u.push(o/f,s/f,1/0,A,-1,f),i&&u.push(d)}else{for(let e=0;e<c;e++)u.push(a[r+e]);if(f>1)for(const e of h){const r=e*c;if(!(a[r+2]<=t)){a[r+2]=t;for(let e=0;e<c;e++)u.push(a[r+e])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,r){if(e[t+5]>1){const n=this.clusterProps[e[t+6]];return r?Object.assign({},n):n}const n=this.points[e[t+3]].properties,i=this.options.map(n);return r&&i===n?Object.assign({},i):i}}function wH(e,t,r){return{type:"Feature",id:e[t+3],properties:BH(e,t,r),geometry:{type:"Point",coordinates:[(n=e[t],360*(n-.5)),FH(e[t+1])]}};var n}function BH(e,t,r){const n=e[t+5],i=n>=1e4?Math.round(n/1e3)+"k":n>=1e3?Math.round(n/100)/10+"k":n,o=e[t+6],s=-1===o?{}:Object.assign({},r[o]);return Object.assign(s,{cluster:!0,cluster_id:e[t+3],point_count:n,point_count_abbreviated:i})}function OH(e){return e/360+.5}function DH(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function FH(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}var PH,NH=(PH=!0,function(e,t){var r=PH?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return PH=!1,r}),LH=NH(void 0,(function(){return LH.toString().search("(((.+)+)+)+$").toString().constructor(LH).search("(((.+)+)+)+$")}));function UH(e,t,r,n){for(var i,o=n,s=r-t>>1,a=r-t,u=e[t],c=e[t+1],l=e[r],h=e[r+1],p=t+3;p<r;p+=3){var f=GH(e[p],e[p+1],u,c,l,h);if(f>o)i=p,o=f;else if(f===o){var d=Math.abs(p-s);d<a&&(i=p,a=d)}}o>n&&(i-t>3&&UH(e,t,i,n),e[i+2]=o,r-i>3&&UH(e,i,r,n))}function GH(e,t,r,n,i,o){var s=i-r,a=o-n;if(0!==s||0!==a){var u=((e-r)*s+(t-n)*a)/(s*s+a*a);u>1?(r=i,n=o):u>0&&(r+=s*u,n+=a*u)}return(s=e-r)*s+(a=t-n)*a}LH();var QH,kH=(QH=!0,function(e,t){var r=QH?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return QH=!1,r}),zH=kH(void 0,(function(){return zH.toString().search("(((.+)+)+)+$").toString().constructor(zH).search("(((.+)+)+)+$")}));function jH(e,t,r,n){var i={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)HH(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)HH(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)HH(e,t[n][i])}(i),i}function HH(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}zH();var qH,VH=(qH=!0,function(e,t){var r=qH?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return qH=!1,r}),YH=VH(void 0,(function(){return YH.toString().search("(((.+)+)+)+$").toString().constructor(YH).search("(((.+)+)+)+$")}));function XH(e,t,r,n,i){if(t.geometry){var o=t.geometry.coordinates,s=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),u=[],c=t.id;if(r.promoteId?c=t.properties[r.promoteId]:r.generateId&&(c=n||0),"Point"===s)WH(o,u,i);else if("MultiPoint"===s)for(var l=0;l<o.length;l++)WH(o[l],u,i);else if("LineString"===s)KH(o,u,a,!1,i);else if("MultiLineString"===s){if(r.lineMetrics){for(l=0;l<o.length;l++)u=[],KH(o[l],u,a,!1,i),e.push(jH(c,"LineString",u,t.properties));return}$H(o,u,a,!1,i)}else if("Polygon"===s)$H(o,u,a,!0,i);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(l=0;l<t.geometry.geometries.length;l++)XH(e,{id:c,geometry:t.geometry.geometries[l],properties:t.properties},r,n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(l=0;l<o.length;l++){var h=[];$H(o[l],h,a,!0,i),u.push(h)}}e.push(jH(c,s,u,t.properties))}}function WH(e,t,r){var{x:n,y:i}=r.fromLngLat(e);t.push(n,i),t.push(0)}function KH(e,t,r,n,i){for(var o,s,a=0,u=0;u<e.length;u++){var{x:c,y:l}=i.fromLngLat(e[u]);t.push(c,l),t.push(0),u>0&&(a+=n?(o*l-c*s)/2:Math.sqrt(Math.pow(c-o,2)+Math.pow(l-s,2))),o=c,s=l}var h=t.length-3;t[2]=1,UH(t,0,h,r),t[h+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function $H(e,t,r,n,i){for(var o=0;o<e.length;o++){var s=[];KH(e[o],s,r,n,i),t.push(s)}}YH();var JH,ZH=(JH=!0,function(e,t){var r=JH?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return JH=!1,r}),eq=ZH(void 0,(function(){return eq.toString().search("(((.+)+)+)+$").toString().constructor(eq).search("(((.+)+)+)+$")}));function tq(e,t,r,n,i,o,s,a){if(n/=t,o>=(r/=t)&&s<n)return e;if(s<r||o>=n)return null;for(var u=[],c=0;c<e.length;c++){var l=e[c],h=l.geometry,p=l.type,f=0===i?l.minX:l.minY,d=0===i?l.maxX:l.maxY;if(f>=r&&d<n)u.push(l);else if(!(d<r||f>=n)){var A=[];if("Point"===p||"MultiPoint"===p)rq(h,A,r,n,i);else if("LineString"===p)nq(h,A,r,n,i,!1,a.lineMetrics);else if("MultiLineString"===p)oq(h,A,r,n,i,!1);else if("Polygon"===p)oq(h,A,r,n,i,!0);else if("MultiPolygon"===p)for(var g=0;g<h.length;g++){var _=[];oq(h[g],_,r,n,i,!0),_.length&&A.push(_)}if(A.length){if(a.lineMetrics&&"LineString"===p){for(g=0;g<A.length;g++)u.push(jH(l.id,p,A[g],l.tags));continue}("LineString"===p||"MultiLineString"===p)&&(1===A.length?(p="LineString",A=A[0]):p="MultiLineString"),("Point"===p||"MultiPoint"===p)&&(p=3===A.length?"Point":"MultiPoint"),u.push(jH(l.id,p,A,l.tags))}}}return u.length?u:null}function rq(e,t,r,n,i){for(var o=0;o<e.length;o+=3){var s=e[o+i];s>=r&&s<=n&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function nq(e,t,r,n,i,o,s){for(var a,u,c=iq(e),l=0===i?aq:uq,h=e.start,p=0;p<e.length-3;p+=3){var f=e[p],d=e[p+1],A=e[p+2],g=e[p+3],_=e[p+4],m=0===i?f:d,y=0===i?g:_,E=!1;s&&(a=Math.sqrt(Math.pow(f-g,2)+Math.pow(d-_,2))),m<r?y>r&&(u=l(c,f,d,g,_,r),s&&(c.start=h+a*u)):m>n?y<n&&(u=l(c,f,d,g,_,n),s&&(c.start=h+a*u)):sq(c,f,d,A),y<r&&m>=r&&(u=l(c,f,d,g,_,r),E=!0),y>n&&m<=n&&(u=l(c,f,d,g,_,n),E=!0),!o&&E&&(s&&(c.end=h+a*u),t.push(c),c=iq(e)),s&&(h+=a)}var x=e.length-3;f=e[x],d=e[x+1],A=e[x+2],(m=0===i?f:d)>=r&&m<=n&&sq(c,f,d,A),x=c.length-3,o&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&sq(c,c[0],c[1],c[2]),c.length&&t.push(c)}function iq(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function oq(e,t,r,n,i,o){for(var s=0;s<e.length;s++)nq(e[s],t,r,n,i,o,!1)}function sq(e,t,r,n){e.push(t),e.push(r),e.push(n)}function aq(e,t,r,n,i,o){var s=(o-t)/(n-t);return e.push(o),e.push(r+(i-r)*s),e.push(1),s}function uq(e,t,r,n,i,o){var s=(o-r)/(i-r);return e.push(t+(n-t)*s),e.push(o),e.push(1),s}eq();var cq,lq=(cq=!0,function(e,t){var r=cq?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return cq=!1,r}),hq=lq(void 0,(function(){return hq.toString().search("(((.+)+)+)+$").toString().constructor(hq).search("(((.+)+)+)+$")}));function pq(e,t){for(var r=[],n=0;n<e.length;n++){var i,o=e[n],s=o.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)i=fq(o.geometry,t);else if("MultiLineString"===s||"Polygon"===s){i=[];for(var a=0;a<o.geometry.length;a++)i.push(fq(o.geometry[a],t))}else if("MultiPolygon"===s)for(i=[],a=0;a<o.geometry.length;a++){for(var u=[],c=0;c<o.geometry[a].length;c++)u.push(fq(o.geometry[a][c],t));i.push(u)}r.push(jH(o.id,s,i,o.tags))}return r}function fq(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}hq();var dq,Aq=(dq=!0,function(e,t){var r=dq?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return dq=!1,r}),gq=Aq(void 0,(function(){return gq.toString().search("(((.+)+)+)+$").toString().constructor(gq).search("(((.+)+)+)+$")}));function _q(e,t){if(e.transformed)return e;var r,n,i,o=1<<e.z,s=e.x,a=e.y;for(r=0;r<e.features.length;r++){var u=e.features[r],c=u.geometry,l=u.type;if(u.geometry=[],1===l)for(n=0;n<c.length;n+=2)u.geometry.push(mq(c[n],c[n+1],t,o,s,a));else for(n=0;n<c.length;n++){var h=[];for(i=0;i<c[n].length;i+=2)h.push(mq(c[n][i],c[n][i+1],t,o,s,a));u.geometry.push(h)}}return e.transformed=!0,e}function mq(e,t,r,n,i,o){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-o))]}gq();var yq,Eq=(yq=!0,function(e,t){var r=yq?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return yq=!1,r}),xq=Eq(void 0,(function(){return xq.toString().search("(((.+)+)+)+$").toString().constructor(xq).search("(((.+)+)+)+$")}));function Cq(e,t,r,n,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<e.length;a++){s.numFeatures++,bq(s,e[a],o,i);var u=e[a].minX,c=e[a].minY,l=e[a].maxX,h=e[a].maxY;u<s.minX&&(s.minX=u),c<s.minY&&(s.minY=c),l>s.maxX&&(s.maxX=l),h>s.maxY&&(s.maxY=h)}return s}function bq(e,t,r,n){var i=t.geometry,o=t.type,s=[];if("Point"===o||"MultiPoint"===o)for(var a=0;a<i.length;a+=3)s.push(i[a]),s.push(i[a+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)Iq(s,i,e,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(a=0;a<i.length;a++)Iq(s,i[a],e,r,"Polygon"===o,0===a);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(a=0;a<c.length;a++)Iq(s,c[a],e,r,!0,0===a)}if(s.length){var l=t.tags||null;if("LineString"===o&&n.lineMetrics){for(var h in l={},t.tags)l[h]=t.tags[h];l.mapbox_clip_start=i.start/i.size,l.mapbox_clip_end=i.end/i.size}var p={geometry:s,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:l};null!==t.id&&(p.id=t.id),e.features.push(p)}}function Iq(e,t,r,n,i,o){var s=n*n;if(n>0&&t.size<(i?s:n))r.numPoints+=t.length/3;else{for(var a=[],u=0;u<t.length;u+=3)(0===n||t[u+2]>s)&&(r.numSimplified++,a.push(t[u]),a.push(t[u+1])),r.numPoints++;i&&function(e,t){for(var r=0,n=0,i=e.length,o=i-2;n<i;o=n,n+=2)r+=(e[n]-e[o])*(e[n+1]+e[o+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var s=e[n],a=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=s,e[i-1-n]=a}}(a,o),e.push(a)}}xq();var vq,Tq=(vq=!0,function(e,t){var r=vq?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return vq=!1,r}),Rq=Tq(void 0,(function(){return Rq.toString().search("(((.+)+)+)+$").toString().constructor(Rq).search("(((.+)+)+)+$")}));function Sq(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n,i,o,s,a,u,c=function(e,t){var r=[],n=t.epsgCode||3857,i=bM.fromEpsgCode(n);if("FeatureCollection"===e.type)for(var o=0;o<e.features.length;o++)XH(r,e.features[o],t,o,i);else"Feature"===e.type?XH(r,e,t,void 0,i):XH(r,{geometry:e},t,void 0,i);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=c,o=(i=t).buffer/i.extent,s=n,a=tq(n,1,-1-o,o,0,-1,2,i),u=tq(n,1,1-o,2+o,0,-1,2,i),(a||u)&&(s=tq(n,1,-o,1+o,0,-1,2,i)||[],a&&(s=pq(a,1).concat(s)),u&&(s=s.concat(pq(u,-1)))),(c=s).length&&this.splitTile(c,0,0,0),r&&(c.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Mq(e,t,r){return 32*((1<<e)*r+t)+e}Rq(),Sq.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Sq.prototype.splitTile=function(e,t,r,n,i,o,s){for(var a=[e,t,r,n],u=this.options,c=u.debug;a.length;){n=a.pop(),r=a.pop(),t=a.pop(),e=a.pop();var l=1<<t,h=Mq(t,r,n),p=this.tiles[h];if(!p&&(c>1&&console.time("creation"),p=this.tiles[h]=Cq(e,t,r,n,u),this.tileCoords.push({z:t,x:r,y:n}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var f="z"+t;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(p.source=e,i){if(t===u.maxZoom||t===i)continue;var d=1<<i-t;if(r!==Math.floor(o/d)||n!==Math.floor(s/d))continue}else if(t===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints)continue;if(p.source=null,0!==e.length){c>1&&console.time("clipping");var A,g,_,m,y,E,x=.5*u.buffer/u.extent,C=.5-x,b=.5+x,I=1+x;A=g=_=m=null,y=tq(e,l,r-x,r+b,0,p.minX,p.maxX,u),E=tq(e,l,r+C,r+I,0,p.minX,p.maxX,u),e=null,y&&(A=tq(y,l,n-x,n+b,1,p.minY,p.maxY,u),g=tq(y,l,n+C,n+I,1,p.minY,p.maxY,u),y=null),E&&(_=tq(E,l,n-x,n+b,1,p.minY,p.maxY,u),m=tq(E,l,n+C,n+I,1,p.minY,p.maxY,u),E=null),c>1&&console.timeEnd("clipping"),a.push(A||[],t+1,2*r,2*n),a.push(g||[],t+1,2*r,2*n+1),a.push(_||[],t+1,2*r+1,2*n),a.push(m||[],t+1,2*r+1,2*n+1)}}},Sq.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,o=n.debug;if(e<0||e>24)return null;var s=1<<e,a=Mq(e,t=(t%s+s)%s,r);if(this.tiles[a])return _q(this.tiles[a],i);o>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var u,c=e,l=t,h=r;!u&&c>0;)c--,l=Math.floor(l/2),h=Math.floor(h/2),u=this.tiles[Mq(c,l,h)];return u&&u.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,l,h),o>1&&console.time("drilling down"),this.splitTile(u.source,c,l,h,e,t,r),o>1&&console.timeEnd("drilling down"),this.tiles[a]?_q(this.tiles[a],i):null):null};const wq=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Bq=wq(void 0,(function(){return Bq.toString().search("(((.+)+)+)+$").toString().constructor(Bq).search("(((.+)+)+)+$")}));function Oq(e,t){const r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);const n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return t(null,null);const i=new tH(n.features);let o=uH(i);(0!==o.byteOffset||o.byteLength!==o.buffer.byteLength)&&(o=new Uint8Array(o)),t(null,{vectorTile:i,rawData:o.buffer})}Bq();class Dq extends qj{constructor(e,t,r,n,i){super(e,t,r,n,Oq),i&&(this.loadGeoJSON=i)}loadData(e,t){const r=e&&e.request;r&&r.collectResourceTiming,this.loadGeoJSON(e,((r,n)=>{if(r||!n)return t(r);if("object"!=typeof n)return t(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));Wj(n,!0);try{if(e.filter){const t=Tn(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===t.result)throw new Error(t.value.map((e=>e.key+": "+e.message)).join(", "));const r=n.features.filter((e=>t.value.evaluate({zoom:0},e)));n={type:"FeatureCollection",features:r}}e.geojsonVtOptions.epsgCode=e.epsgCode,this._geoJSONIndex=e.cluster?new MH(function({superclusterOptions:e,clusterProperties:t}){if(!t||!e)return e;const r={},n={},i={accumulated:null,zoom:0},o={properties:null},s=Object.keys(t);for(const e of s){const[i,o]=t[e],s=Tn(o),a=Tn("string"==typeof i?[i,["accumulated"],["get",e]]:i);r[e]=s.value,n[e]=a.value}return e.map=e=>{o.properties=e;const t={};for(const e of s)t[e]=r[e].evaluate(i,o);return t},e.reduce=(e,t)=>{o.properties=t;for(const t of s)i.accumulated=e[t],e[t]=n[t].evaluate(i,o)},e}(e)).load(n.features):(i=n,o=e.geojsonVtOptions,new Sq(i,o))}catch(e){return t(e)}this.loaded={};t(null,{});var i,o}))}reloadTile(e,t){const r=this.loaded,n=e.uid;return r&&r[n]?super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(e,t){if(e.request)r=e.request,n=t,Tp(ip(r,{type:"json"}),n);else{if("string"!=typeof e.data)return t(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return t(null,JSON.parse(e.data))}catch(r){return t(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}var r,n}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}const Fq=function(){let e=!0;return function(t,r){const n=e?function(){if(r){const e=r.apply(t,arguments);return r=null,e}}:function(){};return e=!1,n}}(),Pq=Fq(void 0,(function(){return Pq.toString().search("(((.+)+)+)+$").toString().constructor(Pq).search("(((.+)+)+)+$")}));Pq();"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new class{constructor(e){this.self=e,this.actor=new Up(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.coordinateReferenceSystems={},this.defaultProjection=bw({name:"mercator"}),this.defaultCrs=bM.EPSG3857,this.webgpu=!1,this.workerSourceTypes={vector:qj,geojson:Dq},this.workerSources={},this.demWorkerSources={}}clearCaches(e,t,r){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],r()}checkIfReady(e,t,r){r()}setReferrer(e,t){this.referrer=t}spriteLoaded(e,t){this.isSpriteLoaded[e]=t;for(const r in this.workerSources[e]){const n=this.workerSources[e][r];for(const e in n)n[e]instanceof qj&&(n[e].isSpriteLoaded=t,n[e].fire(new kp("isSpriteLoaded")))}}setImages(e,t,r){this.availableImages[e]=t,r()}enableTerrain(e,t,r){this.terrain=t,r()}setProjection(e,t){this.projections[e]=bw(t)}setCrs(e,t){let r=bM.fromEpsgCode(t.epsgCode,t.WKT,t.extent);(r.extent[2]!=t.extent[2]||r.extent[3]!=t.extent[3])&&(r=new bM(t.epsgCode,t.extent)),this.coordinateReferenceSystems[e]=r,this.setSceneMode(e,t.sceneMode)}setSceneMode(e,t){this.coordinateReferenceSystems[e].sceneMode=t}setLayers(e,t,r){this.getLayerIndex(e).replace(t),r()}updateLayers(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()}loadTile(e,t,r){const n=t;n.projection=this.projections[e]||this.defaultProjection,n.crs=this.coordinateReferenceSystems[e]||this.defaultCrs,n.webgpu=this.webgpu,this.getWorkerSource(e,t.type,t.source).loadTile(n,r)}reloadTile(e,t,r){const n=t;n.projection=this.projections[e]||this.defaultProjection,n.crs=this.coordinateReferenceSystems[e]||this.defaultCrs,n.webgpu=this.webgpu,this.getWorkerSource(e,t.type,t.source).reloadTile(t,r)}abortTile(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)}removeTile(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)}removeSource(e,t,r){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;const n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,r):r()}loadWorkerSource(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}}getAvailableImages(e){let t=this.availableImages[e];return!t&&(t=[]),t}getLayerIndex(e){let t=this.layerIndexes[e];return!t&&(t=this.layerIndexes[e]=new zD),t}getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){const n={send:(t,r,n)=>{this.actor.send(t,r,n,e)}};!this.workerSourceTypes[t]&&console.log("no "+t),this.workerSources[e][t][r]=new this.workerSourceTypes[t](n,this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded[e])}return this.workerSources[e][t][r]}enforceCacheSizeLimit(e,t){}setUseWebgpu(e,t){this.webgpu=t}}(self))}));
