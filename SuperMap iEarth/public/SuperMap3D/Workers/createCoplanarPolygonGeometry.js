define(["./arrayRemoveDuplicates-a6924649","./BoundingRectangle-254f21a3","./buildModuleUrl-caba6be5","./Cartesian2-b72655a5","./Cartesian3-3a8bdb0b","./Check-52a7d806","./ComponentDatatype-98414d16","./CoplanarPolygonGeometryLibrary-5e41171e","./when-92c6cf3c","./GeometryAttribute-1689f5ef","./GeometryAttributes-7f66ea53","./GeometryInstance-3173015a","./GeometryPipeline-d4a27acf","./IndexDatatype-86677ec4","./Math-ecf82623","./FeatureDetection-9827a02d","./PolygonGeometryLibrary-10e62b0f","./PolygonPipeline-2a0dc978","./VertexFormat-f496a3f1","./Cartographic-a2c313d7","./Event-3390cd7d","./RuntimeError-c6a62a80","./WebGLConstants-42651efd","./OrientedBoundingBox-d4e18f2c","./Cartesian4-72b88c9e","./EllipsoidTangentPlane-396aeb10","./IntersectionTests-672dbf40","./Plane-3f69b850","./AttributeCompression-b5a80a71","./EncodedCartesian3-4f120b1b","./ArcType-31298545","./EllipsoidRhumbLine-b1a766ae"],(function(e,t,n,o,a,r,i,p,s,c,l,y,u,d,g,m,v,h,b,f,w,A,P,x,D,F,T,_,k,L,E,C){"use strict";var R=new a.o,I=new t.f,H=new o.o,G=new o.o,O=new a.o,B=new a.o,$=new a.o,z=new a.o,N=new a.o,S=new a.o,j=new c.n,M=new m.p$1,U=new m.p$1,V=new a.o;function Y(e,t,n,r,p,s,y,u){var v=e.positions,b=h.A.triangulate(e.positions2D,e.holes);b.length<3&&(b=[0,1,2]);var f=d.IndexDatatype.createTypedArray(v.length,b.length);f.set(b);var w=M;if(0!==r){var A=c.n.fromAxisAngle(s,r,j);if(w=m.p$1.fromQuaternion(A,w),t.tangent||t.bitangent){A=c.n.fromAxisAngle(s,-r,j);var P=m.p$1.fromQuaternion(A,U);y=a.o.normalize(m.p$1.multiplyByVector(P,y,y),y),t.bitangent&&(u=a.o.normalize(a.o.cross(s,y,u),u))}}else w=m.p$1.clone(m.p$1.IDENTITY,w);var x=G;t.st&&(x.x=n.x,x.y=n.y);for(var D=v.length,F=3*D,T=new Float64Array(F),_=t.normal?new Float32Array(F):void 0,k=t.tangent?new Float32Array(F):void 0,L=t.bitangent?new Float32Array(F):void 0,E=t.st?new Float32Array(2*D):void 0,C=0,I=0,O=0,B=0,$=0,z=0;z<D;z++){var N=v[z];if(T[C++]=N.x,T[C++]=N.y,T[C++]=N.z,t.st){var S=p(m.p$1.multiplyByVector(w,N,R),H);o.o.subtract(S,x,S);var V=g.e.clamp(S.x/n.width,0,1),Y=g.e.clamp(S.y/n.height,0,1);E[$++]=V,E[$++]=Y}t.normal&&(_[I++]=s.x,_[I++]=s.y,_[I++]=s.z),t.tangent&&(k[B++]=y.x,k[B++]=y.y,k[B++]=y.z),t.bitangent&&(L[O++]=u.x,L[O++]=u.y,L[O++]=u.z)}var q=new l.a;return t.position&&(q.position=new c.o({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:T})),t.normal&&(q.normal=new c.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:_})),t.tangent&&(q.tangent=new c.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:k})),t.bitangent&&(q.bitangent=new c.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:L})),t.st&&(q.st=new c.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:E})),new c.I({attributes:q,indices:f,primitiveType:m._0x41bc81.TRIANGLES})}function q(e){var t=(e=s.u(e,s.u.EMPTY_OBJECT)).polygonHierarchy;r.o.defined("options.polygonHierarchy",t);var n=s.u(e.vertexFormat,b.n.DEFAULT);this._vertexFormat=b.n.clone(n),this._polygonHierarchy=t,this._stRotation=s.u(e.stRotation,0),this._ellipsoid=o.t.clone(s.u(e.ellipsoid,o.t.WGS84)),this._workerName="createCoplanarPolygonGeometry",this.packedLength=v.y.computeHierarchyPackedLength(t)+b.n.packedLength+o.t.packedLength+2}q.fromPositions=function(e){return e=s.u(e,s.u.EMPTY_OBJECT),r.o.defined("options.positions",e.positions),new q({polygonHierarchy:{positions:e.positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid})},q.pack=function(e,t,n){return r.o.typeOf.object("value",e),r.o.defined("array",t),n=s.u(n,0),n=v.y.packPolygonHierarchy(e._polygonHierarchy,t,n),o.t.pack(e._ellipsoid,t,n),n+=o.t.packedLength,b.n.pack(e._vertexFormat,t,n),n+=b.n.packedLength,t[n++]=e._stRotation,t[n]=e.packedLength,t};var J=o.t.clone(o.t.UNIT_SPHERE),Q=new b.n,W={polygonHierarchy:{}};return q.unpack=function(e,t,n){r.o.defined("array",e),t=s.u(t,0);var a=v.y.unpackPolygonHierarchy(e,t);t=a.startingIndex,delete a.startingIndex;var i=o.t.unpack(e,t,J);t+=o.t.packedLength;var p=b.n.unpack(e,t,Q);t+=b.n.packedLength;var c=e[t++],l=e[t];return s.e(n)||(n=new q(W)),n._polygonHierarchy=a,n._ellipsoid=o.t.clone(i,n._ellipsoid),n._vertexFormat=b.n.clone(p,n._vertexFormat),n._stRotation=c,n.packedLength=l,n},q.createGeometry=function(t){var o=t._vertexFormat,r=t._polygonHierarchy,i=t._stRotation,s=r.positions;if(!((s=e.D(s,a.o.equalsEpsilon,!0)).length<3)){var l=O,m=B,h=$,b=N,f=S;if(p.g.computeProjectTo2DArguments(s,z,b,f)){if(l=a.o.cross(b,f,l),l=a.o.normalize(l,l),!a.o.equalsEpsilon(z,a.o.ZERO,g.e.EPSILON6)){var w=t._ellipsoid.geodeticSurfaceNormal(z,V);a.o.dot(l,w)<0&&(l=a.o.negate(l,l),b=a.o.negate(b,b))}var A=p.g.createProjectPointsTo2DFunction(z,b,f),P=p.g.createProjectPointTo2DFunction(z,b,f);o.tangent&&(m=a.o.clone(b,m)),o.bitangent&&(h=a.o.clone(f,h));var x=v.y.polygonsFromHierarchy(r,A,!1),D=x.hierarchy,F=x.polygons;if(0!==D.length){s=D[0].outerRing;for(var T=n.i.fromPoints(s),_=v.y.computeBoundingRectangle(l,P,s,i,I),k=[],L=0;L<F.length;L++){var E=new y.d({geometry:Y(F[L],o,_,i,P,l,m,h)});k.push(E)}var C=u.k.combineInstances(k)[0];C.attributes.position.values=new Float64Array(C.attributes.position.values),C.indices=d.IndexDatatype.createTypedArray(C.attributes.position.values.length/3,C.indices);var R=C.attributes;return o.position||delete R.position,new c.I({attributes:R,indices:C.indices,primitiveType:C.primitiveType,boundingSphere:T})}}}},function(e,t){return s.e(t)&&(e=q.unpack(e,t)),q.createGeometry(e)}}));
