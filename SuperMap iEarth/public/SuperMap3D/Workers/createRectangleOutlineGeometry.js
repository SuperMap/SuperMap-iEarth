define(["./defaultValue-2110bb17","./Ellipsoid-ca2b8eb1","./Rectangle-52f780a9","./arrayFill-c1a6b724","./buildModuleUrl-36ce0ebc","./Cartesian3-c1138337","./Cartographic-630e5de6","./ComponentDatatype-3cfb1146","./Check-92c551fb","./GeometryAttribute-b12ab6bd","./GeometryAttributes-3cad3ff9","./GeometryOffsetAttribute-da5a1d35","./IndexDatatype-d833345d","./Math-cd1437d9","./PolygonPipeline-478e7e0d","./PrimitiveType-d9ba7368","./RectangleGeometryLibrary-7ac5a02e","./FeatureDetection-e7fb956a","./defer-a21481c0","./Event-589349b0","./RuntimeError-6daf0e01","./WebGLConstants-92042d9e","./Cartesian4-5c264813","./EllipsoidRhumbLine-89d13f20"],(function(e,t,i,r,a,n,o,s,u,l,c,h,d,p,f,g,b,_,v,y,m,w,A,E){"use strict";var x=new a.i,D=new a.i,P=new n.o,H=new i.h;function k(e,t){var i=e._ellipsoid,r=t.height,a=t.width,n=t.northCap,o=t.southCap,u=r,h=2,p=0,f=4;n&&(h-=1,u-=1,p+=1,f-=2),o&&(h-=1,u-=1,p+=1,f-=2),p+=h*a+2*u-f;var _,v=new Float64Array(3*p),y=0,m=0,w=P;if(n)b.j.computePosition(t,i,!1,m,0,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;else for(_=0;_<a;_++)b.j.computePosition(t,i,!1,m,_,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(_=a-1,m=1;m<r;m++)b.j.computePosition(t,i,!1,m,_,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;if(m=r-1,!o)for(_=a-2;_>=0;_--)b.j.computePosition(t,i,!1,m,_,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(_=0,m=r-2;m>0;m--)b.j.computePosition(t,i,!1,m,_,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(var A=v.length/3*2,E=d.IndexDatatype.createTypedArray(v.length/3,A),x=0,D=0;D<v.length/3-1;D++)E[x++]=D,E[x++]=D+1;E[x++]=v.length/3-1,E[x++]=0;var H=new l.I({attributes:new c.a,primitiveType:g._0xa706e5.LINES});return H.attributes.position=new l.o({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:v}),H.indices=E,H}function L(r){var a=(r=e.u(r,e.u.EMPTY_OBJECT)).rectangle,n=e.u(r.granularity,p.e.RADIANS_PER_DEGREE),o=e.u(r.ellipsoid,t.t.WGS84),s=e.u(r.rotation,0);if(!e.e(a))throw new u.t("rectangle is required.");if(i.h.validate(a),a.north<a.south)throw new u.t("options.rectangle.north must be greater than options.rectangle.south");var l=e.u(r.height,0),c=e.u(r.extrudedHeight,l);this._rectangle=i.h.clone(a),this._granularity=n,this._ellipsoid=o,this._surfaceHeight=Math.max(l,c),this._rotation=s,this._extrudedHeight=Math.min(l,c),this._offsetAttribute=r.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}L.packedLength=i.h.packedLength+t.t.packedLength+5,L.pack=function(r,a,n){if(!e.e(r))throw new u.t("value is required");if(!e.e(a))throw new u.t("array is required");return n=e.u(n,0),i.h.pack(r._rectangle,a,n),n+=i.h.packedLength,t.t.pack(r._ellipsoid,a,n),n+=t.t.packedLength,a[n++]=r._granularity,a[n++]=r._surfaceHeight,a[n++]=r._rotation,a[n++]=r._extrudedHeight,a[n]=e.u(r._offsetAttribute,-1),a};var N=new i.h,G=t.t.clone(t.t.UNIT_SPHERE),C={rectangle:N,ellipsoid:G,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};L.unpack=function(r,a,n){if(!e.e(r))throw new u.t("array is required");a=e.u(a,0);var o=i.h.unpack(r,a,N);a+=i.h.packedLength;var s=t.t.unpack(r,a,G);a+=t.t.packedLength;var l=r[a++],c=r[a++],h=r[a++],d=r[a++],p=r[a];return e.e(n)?(n._rectangle=i.h.clone(o,n._rectangle),n._ellipsoid=t.t.clone(s,n._ellipsoid),n._surfaceHeight=c,n._rotation=h,n._extrudedHeight=d,n._offsetAttribute=-1===p?void 0:p,n):(C.granularity=l,C.height=c,C.rotation=h,C.extrudedHeight=d,C.offsetAttribute=-1===p?void 0:p,new L(C))};var I=new o.a;return L.createGeometry=function(t){var i,n,o=t._rectangle,u=t._ellipsoid,c=b.j.computeOptions(o,t._granularity,t._rotation,0,H,I);if(!p.e.equalsEpsilon(o.north,o.south,p.e.EPSILON10)&&!p.e.equalsEpsilon(o.east,o.west,p.e.EPSILON10)){var _,v=t._surfaceHeight,y=t._extrudedHeight;if(!p.e.equalsEpsilon(v,y,0,p.e.EPSILON2)){if(i=function(e,t){var i=e._surfaceHeight,r=e._extrudedHeight,a=e._ellipsoid,n=r,o=i,s=k(e,t),u=t.height,l=t.width,c=f.A.scaleToGeodeticHeight(s.attributes.position.values,o,a,!1),h=c.length,p=new Float64Array(2*h);p.set(c);var g=f.A.scaleToGeodeticHeight(s.attributes.position.values,n,a);p.set(g,h),s.attributes.position.values=p;var b=t.northCap,_=t.southCap,v=4;b&&(v-=1),_&&(v-=1);var y,m=2*(p.length/3+v),w=d.IndexDatatype.createTypedArray(p.length/3,m);h=p.length/6;for(var A=0,E=0;E<h-1;E++)w[A++]=E,w[A++]=E+1,w[A++]=E+h,w[A++]=E+h+1;if(w[A++]=h-1,w[A++]=0,w[A++]=h+h-1,w[A++]=h,w[A++]=0,w[A++]=h,b)y=u-1;else{var x=l-1;w[A++]=x,w[A++]=x+h,y=l+u-2}if(w[A++]=y,w[A++]=y+h,!_){var D=l+y-1;w[A++]=D,w[A]=D+h}return s.indices=w,s}(t,c),e.e(t._offsetAttribute)){var m=i.attributes.position.values.length/3,w=new Uint8Array(m);t._offsetAttribute===h.z.TOP?w=r.d(w,1,0,m/2):(_=t._offsetAttribute===h.z.NONE?0:1,w=r.d(w,_)),i.attributes.applyOffset=new l.o({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}var A=a.i.fromRectangle3D(o,u,v,D),E=a.i.fromRectangle3D(o,u,y,x);n=a.i.union(A,E)}else{if((i=k(t,c)).attributes.position.values=f.A.scaleToGeodeticHeight(i.attributes.position.values,v,u,!1),e.e(t._offsetAttribute)){var P=i.attributes.position.values.length,L=new Uint8Array(P/3);_=t._offsetAttribute===h.z.NONE?0:1,r.d(L,_),i.attributes.applyOffset=new l.o({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}n=a.i.fromRectangle3D(o,u,v)}return new l.I({attributes:i.attributes,indices:i.indices,primitiveType:g._0xa706e5.LINES,boundingSphere:n,offsetAttribute:t._offsetAttribute})}},function(r,a){return e.e(a)&&(r=L.unpack(r,a)),r._ellipsoid=t.t.clone(r._ellipsoid),r._rectangle=i.h.clone(r._rectangle),L.createGeometry(r)}}));
