import{a as N}from"./chunk-IZAS6KUJ.js";import{a as q,b as x}from"./chunk-MPSLJKIO.js";import{b as z}from"./chunk-ZMHH4UFY.js";import"./chunk-6X6ULKRC.js";import{a as M}from"./chunk-44AFRGCG.js";import{a as W}from"./chunk-UIA2BV6O.js";import{d as S,k as U,l as y}from"./chunk-CJHFPVIB.js";import"./chunk-NPAFDOYL.js";import{b as B}from"./chunk-SSYG2MIY.js";import{a as C}from"./chunk-SRPTWKHW.js";import"./chunk-6S43R6PL.js";import"./chunk-Z4SOZDEW.js";import"./chunk-MX7ZM7WW.js";import"./chunk-EHDXVZQM.js";import{a as g}from"./chunk-NLYLRNUA.js";import{b as m}from"./chunk-7TOCOFC3.js";import"./chunk-ZVKIUA3Y.js";import{b as J}from"./chunk-3HZNWEV7.js";import{a as V}from"./chunk-LBR6REQR.js";import{a as A}from"./chunk-GXFCHGTA.js";import{a as w}from"./chunk-UBHQMGET.js";import"./chunk-EDZQSM3T.js";import{a as R}from"./chunk-PJGSCWXZ.js";import{a as E}from"./chunk-NUC3LT2W.js";import"./chunk-SFC4FDPW.js";var X=new S,Z=new S,$=new V,G=new g;function j(e,t){var r=e._ellipsoid,d=t.height,n=t.width,c=t.northCap,p=t.southCap,v=d,_=2,h=0,H=4;c&&(_-=1,v-=1,h+=1,H-=2),p&&(_-=1,v-=1,h+=1,H-=2),h+=_*n+2*v-H;var i=new Float64Array(h*3),a=0,s=0,l,o=$;if(c)N.computePosition(t,r,!1,s,0,o),i[a++]=o.x,i[a++]=o.y,i[a++]=o.z;else for(l=0;l<n;l++)N.computePosition(t,r,!1,s,l,o),i[a++]=o.x,i[a++]=o.y,i[a++]=o.z;for(l=n-1,s=1;s<d;s++)N.computePosition(t,r,!1,s,l,o),i[a++]=o.x,i[a++]=o.y,i[a++]=o.z;if(s=d-1,!p)for(l=n-2;l>=0;l--)N.computePosition(t,r,!1,s,l,o),i[a++]=o.x,i[a++]=o.y,i[a++]=o.z;for(l=0,s=d-2;s>0;s--)N.computePosition(t,r,!1,s,l,o),i[a++]=o.x,i[a++]=o.y,i[a++]=o.z;for(var T=i.length/3*2,P=M.createTypedArray(i.length/3,T),f=0,u=0;u<i.length/3-1;u++)P[f++]=u,P[f++]=u+1;P[f++]=i.length/3-1,P[f++]=0;var b=new U({attributes:new W,primitiveType:B.LINES});return b.attributes.position=new y({componentDatatype:C.DOUBLE,componentsPerAttribute:3,values:i}),b.indices=P,b}function I(e,t){var r=e._surfaceHeight,d=e._extrudedHeight,n=e._ellipsoid,c=d,p=r,v=j(e,t),_=t.height,h=t.width,H=z.scaleToGeodeticHeight(v.attributes.position.values,p,n,!1),i=H.length,a=new Float64Array(i*2);a.set(H);var s=z.scaleToGeodeticHeight(v.attributes.position.values,c,n);a.set(s,i),v.attributes.position.values=a;var l=t.northCap,o=t.southCap,T=4;l&&(T-=1),o&&(T-=1);var P=(a.length/3+T)*2,f=M.createTypedArray(a.length/3,P);i=a.length/6;for(var u=0,b=0;b<i-1;b++)f[u++]=b,f[u++]=b+1,f[u++]=b+i,f[u++]=b+i+1;f[u++]=i-1,f[u++]=0,f[u++]=i+i-1,f[u++]=i,f[u++]=0,f[u++]=i;var L;if(l)L=_-1;else{var F=h-1;f[u++]=F,f[u++]=F+i,L=h+_-2}if(f[u++]=L,f[u++]=L+i,!o){var Y=h+L-1;f[u++]=Y,f[u]=Y+i}return v.indices=f,v}function D(e){e=w(e,w.EMPTY_OBJECT);var t=e.rectangle,r=w(e.granularity,A.RADIANS_PER_DEGREE),d=w(e.ellipsoid,m.WGS84),n=w(e.rotation,0);if(!E(t))throw new R("rectangle is required.");if(g.validate(t),t.north<t.south)throw new R("options.rectangle.north must be greater than options.rectangle.south");var c=w(e.height,0),p=w(e.extrudedHeight,c);this._rectangle=g.clone(t),this._granularity=r,this._ellipsoid=d,this._surfaceHeight=Math.max(c,p),this._rotation=n,this._extrudedHeight=Math.min(c,p),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}D.packedLength=g.packedLength+m.packedLength+5;D.pack=function(e,t,r){if(!E(e))throw new R("value is required");if(!E(t))throw new R("array is required");return r=w(r,0),g.pack(e._rectangle,t,r),r+=g.packedLength,m.pack(e._ellipsoid,t,r),r+=m.packedLength,t[r++]=e._granularity,t[r++]=e._surfaceHeight,t[r++]=e._rotation,t[r++]=e._extrudedHeight,t[r]=w(e._offsetAttribute,-1),t};var K=new g,Q=m.clone(m.UNIT_SPHERE),k={rectangle:K,ellipsoid:Q,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};D.unpack=function(e,t,r){if(!E(e))throw new R("array is required");t=w(t,0);var d=g.unpack(e,t,K);t+=g.packedLength;var n=m.unpack(e,t,Q);t+=m.packedLength;var c=e[t++],p=e[t++],v=e[t++],_=e[t++],h=e[t];return E(r)?(r._rectangle=g.clone(d,r._rectangle),r._ellipsoid=m.clone(n,r._ellipsoid),r._surfaceHeight=p,r._rotation=v,r._extrudedHeight=_,r._offsetAttribute=h===-1?void 0:h,r):(k.granularity=c,k.height=p,k.rotation=v,k.extrudedHeight=_,k.offsetAttribute=h===-1?void 0:h,new D(k))};var ee=new J;D.createGeometry=function(e){var t=e._rectangle,r=e._ellipsoid,d=N.computeOptions(t,e._granularity,e._rotation,0,G,ee),n,c;if(!(A.equalsEpsilon(t.north,t.south,A.EPSILON10)||A.equalsEpsilon(t.east,t.west,A.EPSILON10))){var p=e._surfaceHeight,v=e._extrudedHeight,_=!A.equalsEpsilon(p,v,0,A.EPSILON2),h;if(_){if(n=I(e,d),E(e._offsetAttribute)){var H=n.attributes.position.values.length/3,i=new Uint8Array(H);e._offsetAttribute===x.TOP?i=q(i,1,0,H/2):(h=e._offsetAttribute===x.NONE?0:1,i=q(i,h)),n.attributes.applyOffset=new y({componentDatatype:C.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}var a=S.fromRectangle3D(t,r,p,Z),s=S.fromRectangle3D(t,r,v,X);c=S.union(a,s)}else{if(n=j(e,d),n.attributes.position.values=z.scaleToGeodeticHeight(n.attributes.position.values,p,r,!1),E(e._offsetAttribute)){var l=n.attributes.position.values.length,o=new Uint8Array(l/3);h=e._offsetAttribute===x.NONE?0:1,q(o,h),n.attributes.applyOffset=new y({componentDatatype:C.UNSIGNED_BYTE,componentsPerAttribute:1,values:o})}c=S.fromRectangle3D(t,r,p)}return new U({attributes:n.attributes,indices:n.indices,primitiveType:B.LINES,boundingSphere:c,offsetAttribute:e._offsetAttribute})}};var O=D;function te(e,t){return E(t)&&(e=O.unpack(e,t)),e._ellipsoid=m.clone(e._ellipsoid),e._rectangle=g.clone(e._rectangle),O.createGeometry(e)}var Ne=te;export{Ne as default};
