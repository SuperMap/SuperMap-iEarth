import{c as J}from"./chunk-CJHFPVIB.js";import{a as ar}from"./chunk-SSYG2MIY.js";import{a as y}from"./chunk-Z4SOZDEW.js";import{b as or}from"./chunk-3HZNWEV7.js";import{a}from"./chunk-LBR6REQR.js";import{a as R}from"./chunk-GXFCHGTA.js";import{a as K}from"./chunk-UBHQMGET.js";import{a as F}from"./chunk-EDZQSM3T.js";import{a as h}from"./chunk-PJGSCWXZ.js";import{a as q}from"./chunk-NUC3LT2W.js";var tr={};tr.computeDiscriminant=function(r,e,i){if(typeof r!="number")throw new h("a is a required number.");if(typeof e!="number")throw new h("b is a required number.");if(typeof i!="number")throw new h("c is a required number.");var n=e*e-4*r*i;return n};function hr(r,e,i){var n=r+e;return R.sign(r)!==R.sign(e)&&Math.abs(n/Math.max(Math.abs(r),Math.abs(e)))<i?0:n}tr.computeRealRoots=function(r,e,i){if(typeof r!="number")throw new h("a is a required number.");if(typeof e!="number")throw new h("b is a required number.");if(typeof i!="number")throw new h("c is a required number.");var n;if(r===0)return e===0?[]:[-i/e];if(e===0){if(i===0)return[0,0];var t=Math.abs(i),f=Math.abs(r);if(t<f&&t/f<R.EPSILON14)return[0,0];if(t>f&&f/t<R.EPSILON14)return[];if(n=-i/r,n<0)return[];var u=Math.sqrt(n);return[-u,u]}else if(i===0)return n=-e/r,n<0?[n,0]:[0,n];var v=e*e,c=4*r*i,d=hr(v,-c,R.EPSILON14);if(d<0)return[];var o=-.5*hr(e,R.sign(e)*Math.sqrt(d),R.EPSILON14);return e>0?[o/r,i/o]:[i/o,o/r]};var B=tr;var fr={};fr.computeDiscriminant=function(r,e,i,n){if(typeof r!="number")throw new h("a is a required number.");if(typeof e!="number")throw new h("b is a required number.");if(typeof i!="number")throw new h("c is a required number.");if(typeof n!="number")throw new h("d is a required number.");var t=r*r,f=e*e,u=i*i,v=n*n,c=18*r*e*i*n+f*u-27*t*v-4*(r*u*i+f*e*n);return c};function ur(r,e,i,n){var t=r,f=e/3,u=i/3,v=n,c=t*u,d=f*v,o=f*f,m=u*u,g=t*u-o,l=t*v-f*u,b=f*v-m,M=4*g*b-l*l,O,E;if(M<0){var D,N,w;o*d>=c*m?(D=t,N=g,w=-2*f*g+t*l):(D=v,N=b,w=-v*l+2*u*b);var s=w<0?-1:1,z=-s*Math.abs(D)*Math.sqrt(-M);E=-w+z;var I=E/2,L=I<0?-Math.pow(-I,1/3):Math.pow(I,1/3),C=E===z?-L:-N/L;return O=N<=0?L+C:-w/(L*L+C*C+N),o*d>=c*m?[(O-f)/t]:[-v/(O+u)]}var x=g,T=-2*f*g+t*l,p=b,S=-v*l+2*u*b,A=Math.sqrt(M),G=Math.sqrt(3)/2,W=Math.abs(Math.atan2(t*A,-T)/3);O=2*Math.sqrt(-x);var Q=Math.cos(W);E=O*Q;var _=O*(-Q/2-G*Math.sin(W)),Y=E+_>2*f?E-f:_-f,er=t,Z=Y/er;W=Math.abs(Math.atan2(v*A,-S)/3),O=2*Math.sqrt(-p),Q=Math.cos(W),E=O*Q,_=O*(-Q/2-G*Math.sin(W));var nr=-v,ir=E+_<2*u?E+u:_+u,V=nr/ir,yr=er*ir,mr=-Y*ir-er*nr,Or=Y*nr,j=(u*mr-f*Or)/(-f*mr+u*yr);return Z<=j?Z<=V?j<=V?[Z,j,V]:[Z,V,j]:[V,Z,j]:Z<=V?[j,Z,V]:j<=V?[j,V,Z]:[V,j,Z]}fr.computeRealRoots=function(r,e,i,n){if(typeof r!="number")throw new h("a is a required number.");if(typeof e!="number")throw new h("b is a required number.");if(typeof i!="number")throw new h("c is a required number.");if(typeof n!="number")throw new h("d is a required number.");var t,f;if(r===0)return B.computeRealRoots(e,i,n);if(e===0){if(i===0){if(n===0)return[0,0,0];f=-n/r;var u=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3);return[u,u,u]}else if(n===0)return t=B.computeRealRoots(r,0,i),t.Length===0?[0]:[t[0],0,t[1]];return ur(r,0,i,n)}else{if(i===0)return n===0?(f=-e/r,f<0?[f,0,0]:[0,0,f]):ur(r,e,0,n);if(n===0)return t=B.computeRealRoots(r,e,i),t.length===0?[0]:t[1]<=0?[t[0],t[1],0]:t[0]>=0?[0,t[0],t[1]]:[t[0],0,t[1]]}return ur(r,e,i,n)};var H=fr;var vr={};vr.computeDiscriminant=function(r,e,i,n,t){if(typeof r!="number")throw new h("a is a required number.");if(typeof e!="number")throw new h("b is a required number.");if(typeof i!="number")throw new h("c is a required number.");if(typeof n!="number")throw new h("d is a required number.");if(typeof t!="number")throw new h("e is a required number.");var f=r*r,u=f*r,v=e*e,c=v*e,d=i*i,o=d*i,m=n*n,g=m*n,l=t*t,b=l*t,M=v*d*m-4*c*g-4*r*o*m+18*r*e*i*g-27*f*m*m+256*u*b+t*(18*c*i*n-4*v*o+16*r*d*d-80*r*e*d*n-6*r*v*m+144*f*i*m)+l*(144*r*v*i-27*v*v-128*f*d-192*f*e*n);return M};function U(r,e,i,n){var t=r*r,f=e-3*t/8,u=i-e*r/2+t*r/8,v=n-i*r/4+e*t/16-3*t*t/256,c=H.computeRealRoots(1,2*f,f*f-4*v,-u*u);if(c.length>0){var d=-r/4,o=c[c.length-1];if(Math.abs(o)<R.EPSILON14){var m=B.computeRealRoots(1,f,v);if(m.length===2){var g=m[0],l=m[1],b;if(g>=0&&l>=0){var M=Math.sqrt(g),O=Math.sqrt(l);return[d-O,d-M,d+M,d+O]}else{if(g>=0&&l<0)return b=Math.sqrt(g),[d-b,d+b];if(g<0&&l>=0)return b=Math.sqrt(l),[d-b,d+b]}}return[]}else if(o>0){var E=Math.sqrt(o),D=(f+o-u/E)/2,N=(f+o+u/E)/2,w=B.computeRealRoots(1,E,D),s=B.computeRealRoots(1,-E,N);return w.length!==0?(w[0]+=d,w[1]+=d,s.length!==0?(s[0]+=d,s[1]+=d,w[1]<=s[0]?[w[0],w[1],s[0],s[1]]:s[1]<=w[0]?[s[0],s[1],w[0],w[1]]:w[0]>=s[0]&&w[1]<=s[1]?[s[0],w[0],w[1],s[1]]:s[0]>=w[0]&&s[1]<=w[1]?[w[0],s[0],s[1],w[1]]:w[0]>s[0]&&w[0]<s[1]?[s[0],w[0],s[1],w[1]]:[w[0],s[0],w[1],s[1]]):w):s.length!==0?(s[0]+=d,s[1]+=d,s):[]}}return[]}function X(r,e,i,n){var t=i*i,f=e*e,u=r*r,v=-2*e,c=i*r+f-4*n,d=u*n-i*e*r+t,o=H.computeRealRoots(1,v,c,d);if(o.length>0){var m=o[0],g=e-m,l=g*g,b=r/2,M=g/2,O=l-4*n,E=l+4*Math.abs(n),D=u-4*m,N=u+4*Math.abs(m),w,s;if(m<0||O*N<D*E){var z=Math.sqrt(D);w=z/2,s=z===0?0:(r*M-i)/z}else{var I=Math.sqrt(O);w=I===0?0:(r*M-i)/I,s=I/2}var L,C;b===0&&w===0?(L=0,C=0):R.sign(b)===R.sign(w)?(L=b+w,C=m/L):(C=b-w,L=m/C);var x,T;M===0&&s===0?(x=0,T=0):R.sign(M)===R.sign(s)?(x=M+s,T=n/x):(T=M-s,x=n/T);var p=B.computeRealRoots(1,L,x),S=B.computeRealRoots(1,C,T);if(p.length!==0)return S.length!==0?p[1]<=S[0]?[p[0],p[1],S[0],S[1]]:S[1]<=p[0]?[S[0],S[1],p[0],p[1]]:p[0]>=S[0]&&p[1]<=S[1]?[S[0],p[0],p[1],S[1]]:S[0]>=p[0]&&S[1]<=p[1]?[p[0],S[0],S[1],p[1]]:p[0]>S[0]&&p[0]<S[1]?[S[0],p[0],S[1],p[1]]:[p[0],S[0],p[1],S[1]]:p;if(S.length!==0)return S}return[]}vr.computeRealRoots=function(r,e,i,n,t){if(typeof r!="number")throw new h("a is a required number.");if(typeof e!="number")throw new h("b is a required number.");if(typeof i!="number")throw new h("c is a required number.");if(typeof n!="number")throw new h("d is a required number.");if(typeof t!="number")throw new h("e is a required number.");if(Math.abs(r)<R.EPSILON15)return H.computeRealRoots(e,i,n,t);var f=e/r,u=i/r,v=n/r,c=t/r,d=f<0?1:0;switch(d+=u<0?d+1:d,d+=v<0?d+1:d,d+=c<0?d+1:d,d){case 0:return U(f,u,v,c);case 1:return X(f,u,v,c);case 2:return X(f,u,v,c);case 3:return U(f,u,v,c);case 4:return U(f,u,v,c);case 5:return X(f,u,v,c);case 6:return U(f,u,v,c);case 7:return U(f,u,v,c);case 8:return X(f,u,v,c);case 9:return U(f,u,v,c);case 10:return U(f,u,v,c);case 11:return X(f,u,v,c);case 12:return U(f,u,v,c);case 13:return U(f,u,v,c);case 14:return U(f,u,v,c);case 15:return U(f,u,v,c);default:return}};var lr=vr;function $(r,e){e=a.clone(K(e,a.ZERO)),a.equals(e,a.ZERO)||a.normalize(e,e),this.origin=a.clone(K(r,a.ZERO)),this.direction=e}$.clone=function(r,e){if(!!q(r))return q(e)?(e.origin=a.clone(r.origin),e.direction=a.clone(r.direction),e):new $(r.origin,r.direction)};$.getPoint=function(r,e,i){return F.typeOf.object("ray",r),F.typeOf.number("t",e),q(i)||(i=new a),i=a.multiplyByScalar(r.direction,e,i),a.add(r.origin,i,i)};$.transform=function(r,e,i){return F.typeOf.object("ray",r),F.typeOf.object("matrix",e),F.typeOf.object("result",i),ar.multiplyByPoint(e,r.origin,i.origin),ar.multiplyByPointAsVector(e,r.direction,i.direction),i};var dr=$;var P={};P.rayPlane=function(r,e,i){if(!q(r))throw new h("ray is required.");if(!q(e))throw new h("plane is required.");q(i)||(i=new a);var n=r.origin,t=r.direction,f=e.normal,u=a.dot(f,t);if(!(Math.abs(u)<R.EPSILON15)){var v=(-e.distance-a.dot(f,n))/u;if(!(v<0))return i=a.multiplyByScalar(t,v,i),a.add(n,i,i)}};var Pr=new a,Er=new a,Rr=new a,sr=new a,wr=new a;P.rayTriangleParametric=function(r,e,i,n,t){if(!q(r))throw new h("ray is required.");if(!q(e))throw new h("p0 is required.");if(!q(i))throw new h("p1 is required.");if(!q(n))throw new h("p2 is required.");t=K(t,!1);var f=r.origin,u=r.direction,v=a.subtract(i,e,Pr),c=a.subtract(n,e,Er),d=a.cross(u,c,Rr),o=a.dot(v,d),m,g,l,b,M;if(t){if(o<R.EPSILON6||(m=a.subtract(f,e,sr),l=a.dot(m,d),l<0||l>o)||(g=a.cross(m,v,wr),b=a.dot(u,g),b<0||l+b>o))return;M=a.dot(c,g)/o}else{if(Math.abs(o)<R.EPSILON6)return;var O=1/o;if(m=a.subtract(f,e,sr),l=a.dot(m,d)*O,l<0||l>1||(g=a.cross(m,v,wr),b=a.dot(u,g)*O,b<0||l+b>1))return;M=a.dot(c,g)*O}return M};P.rayTriangle=function(r,e,i,n,t,f){var u=P.rayTriangleParametric(r,e,i,n,t);if(!(!q(u)||u<0))return q(f)||(f=new a),a.multiplyByScalar(r.direction,u,f),a.add(r.origin,f,f)};var Lr=new dr;P.lineSegmentTriangle=function(r,e,i,n,t,f,u){if(!q(r))throw new h("v0 is required.");if(!q(e))throw new h("v1 is required.");if(!q(i))throw new h("p0 is required.");if(!q(n))throw new h("p1 is required.");if(!q(t))throw new h("p2 is required.");var v=Lr;a.clone(r,v.origin),a.subtract(e,r,v.direction),a.normalize(v.direction,v.direction);var c=P.rayTriangleParametric(v,i,n,t,f);if(!(!q(c)||c<0||c>a.distance(r,e)))return q(u)||(u=new a),a.multiplyByScalar(v.direction,c,u),a.add(v.origin,u,u)};function Cr(r,e,i,n){var t=e*e-4*r*i;if(!(t<0)){if(t>0){var f=1/(2*r),u=Math.sqrt(t),v=(-e+u)*f,c=(-e-u)*f;return v<c?(n.root0=v,n.root1=c):(n.root0=c,n.root1=v),n}var d=-e/(2*r);if(d!==0)return n.root0=n.root1=d,n}}var Nr={root0:0,root1:0};function pr(r,e,i){q(i)||(i=new J);var n=r.origin,t=r.direction,f=e.center,u=e.radius*e.radius,v=a.subtract(n,f,Rr),c=a.dot(t,t),d=2*a.dot(t,v),o=a.magnitudeSquared(v)-u,m=Cr(c,d,o,Nr);if(!!q(m))return i.start=m.root0,i.stop=m.root1,i}P.raySphere=function(r,e,i){if(!q(r))throw new h("ray is required.");if(!q(e))throw new h("sphere is required.");if(i=pr(r,e,i),!(!q(i)||i.stop<0))return i.start=Math.max(i.start,0),i};var Ir=new dr;P.lineSegmentSphere=function(r,e,i,n){if(!q(r))throw new h("p0 is required.");if(!q(e))throw new h("p1 is required.");if(!q(i))throw new h("sphere is required.");var t=Ir;a.clone(r,t.origin);var f=a.subtract(e,r,t.direction),u=a.magnitude(f);if(a.normalize(f,f),n=pr(t,i,n),!(!q(n)||n.stop<0||n.start>u))return n.start=Math.max(n.start,0),n.stop=Math.min(n.stop,u),n};var Dr=new a,Tr=new a;P.rayEllipsoid=function(r,e){if(!q(r))throw new h("ray is required.");if(!q(e))throw new h("ellipsoid is required.");var i=e.oneOverRadii,n=a.multiplyComponents(i,r.origin,Dr),t=a.multiplyComponents(i,r.direction,Tr),f=a.magnitudeSquared(n),u=a.dot(n,t),v,c,d,o,m;if(f>1){if(u>=0)return;var g=u*u;if(v=f-1,c=a.magnitudeSquared(t),d=c*v,g<d)return;if(g>d){o=u*u-d,m=-u+Math.sqrt(o);var l=m/c,b=v/m;return l<b?new J(l,b):{start:b,stop:l}}var M=Math.sqrt(v/c);return new J(M,M)}else if(f<1)return v=f-1,c=a.magnitudeSquared(t),d=c*v,o=u*u-d,m=-u+Math.sqrt(o),new J(0,m/c);if(u<0)return c=a.magnitudeSquared(t),new J(0,-u/c)};function k(r,e,i){var n=r+e;return R.sign(r)!==R.sign(e)&&Math.abs(n/Math.max(Math.abs(r),Math.abs(e)))<i?0:n}function zr(r,e,i,n,t){var f=n*n,u=t*t,v=(r[y.COLUMN1ROW1]-r[y.COLUMN2ROW2])*u,c=t*(n*k(r[y.COLUMN1ROW0],r[y.COLUMN0ROW1],R.EPSILON15)+e.y),d=r[y.COLUMN0ROW0]*f+r[y.COLUMN2ROW2]*u+n*e.x+i,o=u*k(r[y.COLUMN2ROW1],r[y.COLUMN1ROW2],R.EPSILON15),m=t*(n*k(r[y.COLUMN2ROW0],r[y.COLUMN0ROW2])+e.z),g,l=[];if(m===0&&o===0){if(g=B.computeRealRoots(v,c,d),g.length===0)return l;var b=g[0],M=Math.sqrt(Math.max(1-b*b,0));if(l.push(new a(n,t*b,t*-M)),l.push(new a(n,t*b,t*M)),g.length===2){var O=g[1],E=Math.sqrt(Math.max(1-O*O,0));l.push(new a(n,t*O,t*-E)),l.push(new a(n,t*O,t*E))}return l}var D=m*m,N=o*o,w=v*v,s=m*o,z=w+N,I=2*(c*v+s),L=2*d*v+c*c-N+D,C=2*(d*c-s),x=d*d-D;if(z===0&&I===0&&L===0&&C===0)return l;g=lr.computeRealRoots(z,I,L,C,x);var T=g.length;if(T===0)return l;for(var p=0;p<T;++p){var S=g[p],A=S*S,G=Math.max(1-A,0),W=Math.sqrt(G),Q;R.sign(v)===R.sign(d)?Q=k(v*A+d,c*S,R.EPSILON12):R.sign(d)===R.sign(c*S)?Q=k(v*A,c*S+d,R.EPSILON12):Q=k(v*A+c*S,d,R.EPSILON12);var _=k(o*S,m,R.EPSILON15),Y=Q*_;Y<0?l.push(new a(n,t*S,t*W)):Y>0?l.push(new a(n,t*S,t*-W)):W!==0?(l.push(new a(n,t*S,t*-W)),l.push(new a(n,t*S,t*W)),++p):l.push(new a(n,t*S,t*W))}return l}var cr=new a,qr=new a,gr=new a,rr=new a,Wr=new a,Br=new y,xr=new y,Ur=new y,Qr=new y,Vr=new y,Sr=new y,br=new y,Mr=new a,Zr=new a,jr=new or;P.grazingAltitudeLocation=function(r,e){if(!q(r))throw new h("ray is required.");if(!q(e))throw new h("ellipsoid is required.");var i=r.origin,n=r.direction;if(!a.equals(i,a.ZERO)){var t=e.geodeticSurfaceNormal(i,cr);if(a.dot(n,t)>=0)return i}var f=q(this.rayEllipsoid(r,e)),u=e.transformPositionToScaledSpace(n,cr),v=a.normalize(u,u),c=a.mostOrthogonalAxis(u,rr),d=a.normalize(a.cross(c,v,qr),qr),o=a.normalize(a.cross(v,d,gr),gr),m=Br;m[0]=v.x,m[1]=v.y,m[2]=v.z,m[3]=d.x,m[4]=d.y,m[5]=d.z,m[6]=o.x,m[7]=o.y,m[8]=o.z;var g=y.transpose(m,xr),l=y.fromScale(e.radii,Ur),b=y.fromScale(e.oneOverRadii,Qr),M=Vr;M[0]=0,M[1]=-n.z,M[2]=n.y,M[3]=n.z,M[4]=0,M[5]=-n.x,M[6]=-n.y,M[7]=n.x,M[8]=0;var O=y.multiply(y.multiply(g,b,Sr),M,Sr),E=y.multiply(y.multiply(O,l,br),m,br),D=y.multiplyByVector(O,i,Wr),N=zr(E,a.negate(D,cr),0,0,1),w,s,z=N.length;if(z>0){for(var I=a.clone(a.ZERO,Zr),L=Number.NEGATIVE_INFINITY,C=0;C<z;++C){w=y.multiplyByVector(l,y.multiplyByVector(m,N[C],Mr),Mr);var x=a.normalize(a.subtract(w,i,rr),rr),T=a.dot(x,n);T>L&&(L=T,I=a.clone(w,I))}var p=e.cartesianToCartographic(I,jr);return L=R.clamp(L,0,1),s=a.magnitude(a.subtract(I,i,rr))*Math.sqrt(1-L*L),s=f?-s:s,p.height=s,e.cartographicToCartesian(p,new a)}};var Ar=new a;P.lineSegmentPlane=function(r,e,i,n){if(!q(r))throw new h("endPoint0 is required.");if(!q(e))throw new h("endPoint1 is required.");if(!q(i))throw new h("plane is required.");q(n)||(n=new a);var t=a.subtract(e,r,Ar),f=i.normal,u=a.dot(f,t);if(!(Math.abs(u)<R.EPSILON6)){var v=a.dot(f,r),c=-(i.distance+v)/u;if(!(c<0||c>1))return a.multiplyByScalar(t,c,n),a.add(r,n,n),n}};P.trianglePlaneIntersection=function(r,e,i,n){if(!q(r)||!q(e)||!q(i)||!q(n))throw new h("p0, p1, p2, and plane are required.");var t=n.normal,f=n.distance,u=a.dot(t,r)+f<0,v=a.dot(t,e)+f<0,c=a.dot(t,i)+f<0,d=0;d+=u?1:0,d+=v?1:0,d+=c?1:0;var o,m;if((d===1||d===2)&&(o=new a,m=new a),d===1){if(u)return P.lineSegmentPlane(r,e,n,o),P.lineSegmentPlane(r,i,n,m),{positions:[r,e,i,o,m],indices:[0,3,4,1,2,4,1,4,3]};if(v)return P.lineSegmentPlane(e,i,n,o),P.lineSegmentPlane(e,r,n,m),{positions:[r,e,i,o,m],indices:[1,3,4,2,0,4,2,4,3]};if(c)return P.lineSegmentPlane(i,r,n,o),P.lineSegmentPlane(i,e,n,m),{positions:[r,e,i,o,m],indices:[2,3,4,0,1,4,0,4,3]}}else if(d===2)if(u)if(v){if(!c)return P.lineSegmentPlane(r,i,n,o),P.lineSegmentPlane(e,i,n,m),{positions:[r,e,i,o,m],indices:[0,1,4,0,4,3,2,3,4]}}else return P.lineSegmentPlane(i,e,n,o),P.lineSegmentPlane(r,e,n,m),{positions:[r,e,i,o,m],indices:[2,0,4,2,4,3,1,3,4]};else return P.lineSegmentPlane(e,r,n,o),P.lineSegmentPlane(i,r,n,m),{positions:[r,e,i,o,m],indices:[1,2,4,1,4,3,0,3,4]}};var ge=P;export{dr as a,ge as b};
