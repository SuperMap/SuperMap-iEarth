import{a as k,b as R}from"./chunk-MPSLJKIO.js";import{a as c}from"./chunk-Z53FGVZR.js";import{a as H}from"./chunk-SP6GVFX5.js";import{b as z}from"./chunk-HOZ5IOFP.js";import{a as Y,b as N}from"./chunk-ZMHH4UFY.js";import"./chunk-D45ASFTR.js";import"./chunk-6X6ULKRC.js";import{a as x}from"./chunk-ONAS2LTV.js";import{a as J}from"./chunk-VI4IWVT4.js";import"./chunk-MQMYX2JZ.js";import"./chunk-KW5QJXXE.js";import"./chunk-REXJO6A6.js";import"./chunk-EUSYH4JF.js";import{a as W}from"./chunk-44AFRGCG.js";import{a as M}from"./chunk-UIA2BV6O.js";import{d as q,k as D,l as C}from"./chunk-CJHFPVIB.js";import"./chunk-NPAFDOYL.js";import{b as F}from"./chunk-SSYG2MIY.js";import{a as S}from"./chunk-SRPTWKHW.js";import"./chunk-6S43R6PL.js";import"./chunk-Z4SOZDEW.js";import"./chunk-MX7ZM7WW.js";import"./chunk-EHDXVZQM.js";import"./chunk-NLYLRNUA.js";import{b as p}from"./chunk-7TOCOFC3.js";import"./chunk-ZVKIUA3Y.js";import"./chunk-3HZNWEV7.js";import"./chunk-LBR6REQR.js";import{a as L}from"./chunk-GXFCHGTA.js";import{a as y}from"./chunk-UBHQMGET.js";import{a as T}from"./chunk-EDZQSM3T.js";import{a as B}from"./chunk-PJGSCWXZ.js";import{a as E}from"./chunk-NUC3LT2W.js";import"./chunk-SFC4FDPW.js";var Q=[],G=[];function V(e,r,t,b,d){var _=z.fromPoints(r,e),u=_.projectPointsOntoPlane(r,Q),n=N.computeWindingOrder2D(u);n===Y.CLOCKWISE&&(u.reverse(),r=r.slice().reverse());var a,i,o=r.length,f=0;if(b)for(a=new Float64Array(o*2*3),i=0;i<o;i++){var m=r[i],P=r[(i+1)%o];a[f++]=m.x,a[f++]=m.y,a[f++]=m.z,a[f++]=P.x,a[f++]=P.y,a[f++]=P.z}else{var h=0;if(d===H.GEODESIC)for(i=0;i<o;i++)h+=c.subdivideLineCount(r[i],r[(i+1)%o],t);else if(d===H.RHUMB)for(i=0;i<o;i++)h+=c.subdivideRhumbLineCount(e,r[i],r[(i+1)%o],t);for(a=new Float64Array(h*3),i=0;i<o;i++){var l;d===H.GEODESIC?l=c.subdivideLine(r[i],r[(i+1)%o],t,G):d===H.RHUMB&&(l=c.subdivideRhumbLine(e,r[i],r[(i+1)%o],t,G));for(var v=l.length,s=0;s<v;++s)a[f++]=l[s]}}o=a.length/3;var O=o*2,g=W.createTypedArray(o,O);for(f=0,i=0;i<o-1;i++)g[f++]=i,g[f++]=i+1;return g[f++]=o-1,g[f++]=0,new x({geometry:new D({attributes:new M({position:new C({componentDatatype:S.DOUBLE,componentsPerAttribute:3,values:a})}),indices:g,primitiveType:F.LINES})})}function X(e,r,t,b,d){var _=z.fromPoints(r,e),u=_.projectPointsOntoPlane(r,Q),n=N.computeWindingOrder2D(u);n===Y.CLOCKWISE&&(u.reverse(),r=r.slice().reverse());var a,i,o=r.length,f=new Array(o),h=0;if(b)for(a=new Float64Array(o*2*3*2),i=0;i<o;++i){f[i]=h/3;var P=r[i],O=r[(i+1)%o];a[h++]=P.x,a[h++]=P.y,a[h++]=P.z,a[h++]=O.x,a[h++]=O.y,a[h++]=O.z}else{var l=0;if(d===H.GEODESIC)for(i=0;i<o;i++)l+=c.subdivideLineCount(r[i],r[(i+1)%o],t);else if(d===H.RHUMB)for(i=0;i<o;i++)l+=c.subdivideRhumbLineCount(e,r[i],r[(i+1)%o],t);for(a=new Float64Array(l*3*2),i=0;i<o;++i){f[i]=h/3;var v;d===H.GEODESIC?v=c.subdivideLine(r[i],r[(i+1)%o],t,G):d===H.RHUMB&&(v=c.subdivideRhumbLine(e,r[i],r[(i+1)%o],t,G));for(var s=v.length,m=0;m<s;++m)a[h++]=v[m]}}o=a.length/(3*2);var g=f.length,U=(o*2+g)*2,A=W.createTypedArray(o,U);for(h=0,i=0;i<o;++i)A[h++]=i,A[h++]=(i+1)%o,A[h++]=i+o,A[h++]=(i+1)%o+o;for(i=0;i<g;i++){var j=f[i];A[h++]=j,A[h++]=j+o}return new x({geometry:new D({attributes:new M({position:new C({componentDatatype:S.DOUBLE,componentsPerAttribute:3,values:a})}),indices:A,primitiveType:F.LINES})})}function w(e){if(T.typeOf.object("options",e),T.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),e.perPositionHeight&&E(e.height))throw new B("Cannot use both options.perPositionHeight and options.height");if(E(e.arcType)&&e.arcType!==H.GEODESIC&&e.arcType!==H.RHUMB)throw new B("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var r=e.polygonHierarchy,t=y(e.ellipsoid,p.WGS84),b=y(e.granularity,L.RADIANS_PER_DEGREE),d=y(e.perPositionHeight,!1),_=d&&E(e.extrudedHeight),u=y(e.arcType,H.GEODESIC),n=y(e.height,0),a=y(e.extrudedHeight,n);if(!_){var i=Math.max(n,a);a=Math.min(n,a),n=i}this._ellipsoid=p.clone(t),this._granularity=b,this._height=n,this._extrudedHeight=a,this._arcType=u,this._polygonHierarchy=r,this._perPositionHeight=d,this._perPositionHeightExtrude=_,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=c.computeHierarchyPackedLength(r)+p.packedLength+8}w.pack=function(e,r,t){return T.typeOf.object("value",e),T.defined("array",r),t=y(t,0),t=c.packPolygonHierarchy(e._polygonHierarchy,r,t),p.pack(e._ellipsoid,r,t),t+=p.packedLength,r[t++]=e._height,r[t++]=e._extrudedHeight,r[t++]=e._granularity,r[t++]=e._perPositionHeightExtrude?1:0,r[t++]=e._perPositionHeight?1:0,r[t++]=e._arcType,r[t++]=y(e._offsetAttribute,-1),r[t]=e.packedLength,r};var Z=p.clone(p.UNIT_SPHERE),$={polygonHierarchy:{}};w.unpack=function(e,r,t){T.defined("array",e),r=y(r,0);var b=c.unpackPolygonHierarchy(e,r);r=b.startingIndex,delete b.startingIndex;var d=p.unpack(e,r,Z);r+=p.packedLength;var _=e[r++],u=e[r++],n=e[r++],a=e[r++]===1,i=e[r++]===1,o=e[r++],f=e[r++],h=e[r];return E(t)||(t=new w($)),t._polygonHierarchy=b,t._ellipsoid=p.clone(d,t._ellipsoid),t._height=_,t._extrudedHeight=u,t._granularity=n,t._perPositionHeight=i,t._perPositionHeightExtrude=a,t._arcType=o,t._offsetAttribute=f===-1?void 0:f,t.packedLength=h,t};w.fromPositions=function(e){e=y(e,y.EMPTY_OBJECT),T.defined("options.positions",e.positions);var r={polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute};return new w(r)};w.createGeometry=function(e){var r=e._ellipsoid,t=e._granularity,b=e._polygonHierarchy,d=e._perPositionHeight,_=e._arcType,u=c.polygonOutlinesFromHierarchy(b,!d,r);if(u.length!==0){var n,a=[],i=L.chordLength(t,r.maximumRadius),o=e._height,f=e._extrudedHeight,h=e._perPositionHeightExtrude||!L.equalsEpsilon(o,f,0,L.EPSILON2),l,v;if(h)for(v=0;v<u.length;v++){if(n=X(r,u[v],i,d,_),n.geometry=c.scaleToGeodeticHeightExtruded(n.geometry,o,f,r,d),E(e._offsetAttribute)){var s=n.geometry.attributes.position.values.length/3,m=new Uint8Array(s);e._offsetAttribute===R.TOP?m=k(m,1,0,s/2):(l=e._offsetAttribute===R.NONE?0:1,m=k(m,l)),n.geometry.attributes.applyOffset=new C({componentDatatype:S.UNSIGNED_BYTE,componentsPerAttribute:1,values:m})}a.push(n)}else for(v=0;v<u.length;v++){if(n=V(r,u[v],i,d,_),n.geometry.attributes.position.values=N.scaleToGeodeticHeight(n.geometry.attributes.position.values,o,r,!d),E(e._offsetAttribute)){var P=n.geometry.attributes.position.values.length,O=new Uint8Array(P/3);l=e._offsetAttribute===R.NONE?0:1,k(O,l),n.geometry.attributes.applyOffset=new C({componentDatatype:S.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}a.push(n)}var g=J.combineInstances(a)[0],U=q.fromVertices(g.attributes.position.values);return new D({attributes:g.attributes,indices:g.indices,primitiveType:g.primitiveType,boundingSphere:U,offsetAttribute:e._offsetAttribute})}};var K=w;function I(e,r){return E(r)&&(e=K.unpack(e,r)),e._ellipsoid=p.clone(e._ellipsoid),K.createGeometry(e)}var Te=I;export{Te as default};
