import{a as M}from"./chunk-X3VIQ4EU.js";import{a as _e}from"./chunk-NRJCFN72.js";import"./chunk-J67OD5PY.js";import"./chunk-XYWAVEQ2.js";import{a as pe,b as Ne}from"./chunk-MPSLJKIO.js";import{a as Z}from"./chunk-RYEDLSXB.js";import"./chunk-HOZ5IOFP.js";import{b as Me}from"./chunk-ZMHH4UFY.js";import{a as ke}from"./chunk-D45ASFTR.js";import"./chunk-6X6ULKRC.js";import"./chunk-REXJO6A6.js";import"./chunk-EUSYH4JF.js";import{a as Re}from"./chunk-44AFRGCG.js";import{a as Ge}from"./chunk-UIA2BV6O.js";import{d as Ye,k as qe,l as ee}from"./chunk-CJHFPVIB.js";import"./chunk-NPAFDOYL.js";import{b as We}from"./chunk-SSYG2MIY.js";import{a as x}from"./chunk-SRPTWKHW.js";import"./chunk-6S43R6PL.js";import"./chunk-Z4SOZDEW.js";import"./chunk-MX7ZM7WW.js";import"./chunk-EHDXVZQM.js";import{a as Oe}from"./chunk-NLYLRNUA.js";import{b as q}from"./chunk-7TOCOFC3.js";import"./chunk-ZVKIUA3Y.js";import{b as Le}from"./chunk-3HZNWEV7.js";import{a}from"./chunk-LBR6REQR.js";import{a as de}from"./chunk-GXFCHGTA.js";import{a as H}from"./chunk-UBHQMGET.js";import{a as fe}from"./chunk-EDZQSM3T.js";import"./chunk-PJGSCWXZ.js";import{a as j}from"./chunk-NUC3LT2W.js";import"./chunk-SFC4FDPW.js";var Qe=new a,Xe=new a,Ce=new a,De=new a,xe=new a,Ze=new a,le=new a,me=new a;function $e(e,r){for(var i=0;i<e.length;i++)e[i]=r.scaleToGeodeticSurface(e[i],e[i]);return e}function I(e,r,i,u,l,h){var v=e.normals,N=e.tangents,g=e.bitangents,n=a.normalize(a.cross(i,r,le),le);h.normal&&M.addAttribute(v,r,u,l),h.tangent&&M.addAttribute(N,n,u,l),h.bitangent&&M.addAttribute(g,i,u,l)}function Fe(e,r,i){var u=e.positions,l=e.corners,h=e.endPositions,v=e.lefts,N=e.normals,g=new Ge,n,f=0,d=0,t,p=0,c;for(t=0;t<u.length;t+=2)c=u[t].length-3,f+=c,p+=c*2,d+=u[t+1].length-3;for(f+=3,d+=3,t=0;t<l.length;t++){n=l[t];var E=l[t].leftPositions;j(E)?(c=E.length,f+=c,p+=c):(c=l[t].rightPositions.length,d+=c,p+=c)}var L=j(h),T;L&&(T=h[0].length-3,f+=T,d+=T,T/=3,p+=T*6);var V=f+d,m=new Float64Array(V),P=r.normal?new Float32Array(V):void 0,te=r.tangent?new Float32Array(V):void 0,U=r.bitangent?new Float32Array(V):void 0,A={normals:P,tangents:te,bitangents:U},o=0,s=V-1,S,O,C,R,w=Qe,_=Xe,ie,ne,we=T/2,b=Re.createTypedArray(V/3,p),y=0;if(L){ne=Ce,ie=De;var Ue=h[0];for(w=a.fromArray(N,0,w),_=a.fromArray(v,0,_),t=0;t<we;t++)ne=a.fromArray(Ue,(we-1-t)*3,ne),ie=a.fromArray(Ue,(we+t)*3,ie),M.addAttribute(m,ie,o),M.addAttribute(m,ne,void 0,s),I(A,w,_,o,s,r),O=o/3,R=O+1,S=(s-2)/3,C=S-1,b[y++]=S,b[y++]=O,b[y++]=C,b[y++]=C,b[y++]=O,b[y++]=R,o+=3,s-=3}var ye=0,Ae=0,he=u[ye++],K=u[ye++];m.set(he,o),m.set(K,s-K.length+1),_=a.fromArray(v,Ae,_);var oe,ce;for(c=K.length-3,t=0;t<c;t+=3)oe=i.geodeticSurfaceNormal(a.fromArray(he,t,le),le),ce=i.geodeticSurfaceNormal(a.fromArray(K,c-t,me),me),w=a.normalize(a.add(oe,ce,w),w),I(A,w,_,o,s,r),O=o/3,R=O+1,S=(s-2)/3,C=S-1,b[y++]=S,b[y++]=O,b[y++]=C,b[y++]=C,b[y++]=O,b[y++]=R,o+=3,s-=3;for(oe=i.geodeticSurfaceNormal(a.fromArray(he,c,le),le),ce=i.geodeticSurfaceNormal(a.fromArray(K,c,me),me),w=a.normalize(a.add(oe,ce,w),w),Ae+=3,t=0;t<l.length;t++){var D;n=l[t];var Ve=n.leftPositions,Se=n.rightPositions,ue,Q,B=Ze,Y=Ce,W=De;if(w=a.fromArray(N,Ae,w),j(Ve)){for(I(A,w,_,void 0,s,r),s-=3,ue=R,Q=C,D=0;D<Ve.length/3;D++)B=a.fromArray(Ve,D*3,B),b[y++]=ue,b[y++]=Q-D-1,b[y++]=Q-D,M.addAttribute(m,B,void 0,s),Y=a.fromArray(m,(Q-D-1)*3,Y),W=a.fromArray(m,ue*3,W),_=a.normalize(a.subtract(Y,W,_),_),I(A,w,_,void 0,s,r),s-=3;B=a.fromArray(m,ue*3,B),Y=a.subtract(a.fromArray(m,Q*3,Y),B,Y),W=a.subtract(a.fromArray(m,(Q-D)*3,W),B,W),_=a.normalize(a.add(Y,W,_),_),I(A,w,_,o,void 0,r),o+=3}else{for(I(A,w,_,o,void 0,r),o+=3,ue=C,Q=R,D=0;D<Se.length/3;D++)B=a.fromArray(Se,D*3,B),b[y++]=ue,b[y++]=Q+D,b[y++]=Q+D+1,M.addAttribute(m,B,o),Y=a.fromArray(m,ue*3,Y),W=a.fromArray(m,(Q+D)*3,W),_=a.normalize(a.subtract(Y,W,_),_),I(A,w,_,o,void 0,r),o+=3;B=a.fromArray(m,ue*3,B),Y=a.subtract(a.fromArray(m,(Q+D)*3,Y),B,Y),W=a.subtract(a.fromArray(m,Q*3,W),B,W),_=a.normalize(a.negate(a.add(W,Y,_),_),_),I(A,w,_,void 0,s,r),s-=3}for(he=u[ye++],K=u[ye++],he.splice(0,3),K.splice(K.length-3,3),m.set(he,o),m.set(K,s-K.length+1),c=K.length-3,Ae+=3,_=a.fromArray(v,Ae,_),D=0;D<K.length;D+=3)oe=i.geodeticSurfaceNormal(a.fromArray(he,D,le),le),ce=i.geodeticSurfaceNormal(a.fromArray(K,c-D,me),me),w=a.normalize(a.add(oe,ce,w),w),I(A,w,_,o,s,r),R=o/3,O=R-1,C=(s-2)/3,S=C+1,b[y++]=S,b[y++]=O,b[y++]=C,b[y++]=C,b[y++]=O,b[y++]=R,o+=3,s-=3;o-=3,s+=3}if(w=a.fromArray(N,N.length-3,w),I(A,w,_,o,s,r),L){o+=3,s-=3,ne=Ce,ie=De;var Be=h[1];for(t=0;t<we;t++)ne=a.fromArray(Be,(T-t-1)*3,ne),ie=a.fromArray(Be,t*3,ie),M.addAttribute(m,ne,void 0,s),M.addAttribute(m,ie,o),I(A,w,_,o,s,r),R=o/3,O=R-1,C=(s-2)/3,S=C+1,b[y++]=S,b[y++]=O,b[y++]=C,b[y++]=C,b[y++]=O,b[y++]=R,o+=3,s-=3}if(g.position=new ee({componentDatatype:x.DOUBLE,componentsPerAttribute:3,values:m}),r.st){var k=new Float32Array(V/3*2),ve,ge,z=0;if(L){f/=3,d/=3;var Te=Math.PI/(T+1);ge=1/(f-T+1),ve=1/(d-T+1);var X,Ee=T/2;for(t=Ee+1;t<T+1;t++)X=de.PI_OVER_TWO+Te*t,k[z++]=ve*(1+Math.cos(X)),k[z++]=.5*(1+Math.sin(X));for(t=1;t<d-T+1;t++)k[z++]=t*ve,k[z++]=0;for(t=T;t>Ee;t--)X=de.PI_OVER_TWO-t*Te,k[z++]=1-ve*(1+Math.cos(X)),k[z++]=.5*(1+Math.sin(X));for(t=Ee;t>0;t--)X=de.PI_OVER_TWO-Te*t,k[z++]=1-ge*(1+Math.cos(X)),k[z++]=.5*(1+Math.sin(X));for(t=f-T;t>0;t--)k[z++]=t*ge,k[z++]=1;for(t=1;t<Ee+1;t++)X=de.PI_OVER_TWO+Te*t,k[z++]=ge*(1+Math.cos(X)),k[z++]=.5*(1+Math.sin(X))}else{for(f/=3,d/=3,ge=1/(f-1),ve=1/(d-1),t=0;t<d;t++)k[z++]=t*ve,k[z++]=0;for(t=f;t>0;t--)k[z++]=(t-1)*ge,k[z++]=1}g.st=new ee({componentDatatype:x.FLOAT,componentsPerAttribute:2,values:k})}return r.normal&&(g.normal=new ee({componentDatatype:x.FLOAT,componentsPerAttribute:3,values:A.normals})),r.tangent&&(g.tangent=new ee({componentDatatype:x.FLOAT,componentsPerAttribute:3,values:A.tangents})),r.bitangent&&(g.bitangent=new ee({componentDatatype:x.FLOAT,componentsPerAttribute:3,values:A.bitangents})),{attributes:g,indices:b}}function er(e,r){if(!r.normal&&!r.tangent&&!r.bitangent&&!r.st)return e;var i=e.position.values,u,l;(r.normal||r.bitangent)&&(u=e.normal.values,l=e.bitangent.values);var h=e.position.values.length/18,v=h*3,N=h*2,g=v*2,n;if(r.normal||r.bitangent||r.tangent){var f=r.normal?new Float32Array(v*6):void 0,d=r.tangent?new Float32Array(v*6):void 0,t=r.bitangent?new Float32Array(v*6):void 0,p=Qe,c=Xe,E=Ce,L=De,T=xe,V=Ze,m=g;for(n=0;n<v;n+=3){var P=m+g;p=a.fromArray(i,n,p),c=a.fromArray(i,n+v,c),E=a.fromArray(i,(n+3)%v,E),c=a.subtract(c,p,c),E=a.subtract(E,p,E),L=a.normalize(a.cross(c,E,L),L),r.normal&&(M.addAttribute(f,L,P),M.addAttribute(f,L,P+3),M.addAttribute(f,L,m),M.addAttribute(f,L,m+3)),(r.tangent||r.bitangent)&&(V=a.fromArray(u,n,V),r.bitangent&&(M.addAttribute(t,V,P),M.addAttribute(t,V,P+3),M.addAttribute(t,V,m),M.addAttribute(t,V,m+3)),r.tangent&&(T=a.normalize(a.cross(V,L,T),T),M.addAttribute(d,T,P),M.addAttribute(d,T,P+3),M.addAttribute(d,T,m),M.addAttribute(d,T,m+3))),m+=6}if(r.normal){for(f.set(u),n=0;n<v;n+=3)f[n+v]=-u[n],f[n+v+1]=-u[n+1],f[n+v+2]=-u[n+2];e.normal.values=f}else e.normal=void 0;if(r.bitangent?(t.set(l),t.set(l,v),e.bitangent.values=t):e.bitangent=void 0,r.tangent){var te=e.tangent.values;d.set(te),d.set(te,v),e.tangent.values=d}}if(r.st){var U=e.st.values,A=new Float32Array(N*6);A.set(U),A.set(U,N);for(var o=N*2,s=0;s<2;s++){for(A[o++]=U[0],A[o++]=U[1],n=2;n<N;n+=2){var S=U[n],O=U[n+1];A[o++]=S,A[o++]=O,A[o++]=S,A[o++]=O}A[o++]=U[0],A[o++]=U[1]}e.st.values=A}return e}function He(e,r,i){i[r++]=e[0],i[r++]=e[1],i[r++]=e[2];for(var u=3;u<e.length;u+=3){var l=e[u],h=e[u+1],v=e[u+2];i[r++]=l,i[r++]=h,i[r++]=v,i[r++]=l,i[r++]=h,i[r++]=v}return i[r++]=e[0],i[r++]=e[1],i[r++]=e[2],i}function rr(e,r){var i=new Z({position:r.position,normal:r.normal||r.bitangent||e.shadowVolume,tangent:r.tangent,bitangent:r.normal||r.bitangent,st:r.st}),u=e.ellipsoid,l=M.computePositions(e),h=Fe(l,i,u),v=e.height,N=e.extrudedHeight,g=h.attributes,n=h.indices,f=g.position.values,d=f.length,t=new Float64Array(d*6),p=new Float64Array(d);p.set(f);var c=new Float64Array(d*4);f=Me.scaleToGeodeticHeight(f,v,u),c=He(f,0,c),p=Me.scaleToGeodeticHeight(p,N,u),c=He(p,d*2,c),t.set(f),t.set(p,d),t.set(c,d*2),g.position.values=t,g=er(g,r);var E,L=d/3;if(e.shadowVolume){var T=g.normal.values;d=T.length;var V=new Float32Array(d*6);for(E=0;E<d;E++)T[E]=-T[E];V.set(T,d),V=He(T,d*4,V),g.extrudeDirection=new ee({componentDatatype:x.FLOAT,componentsPerAttribute:3,values:V}),r.normal||(g.normal=void 0)}if(j(e.offsetAttribute)){var m=new Uint8Array(L*6);if(e.offsetAttribute===Ne.TOP)m=pe(m,1,0,L),m=pe(m,1,L*2,L*4);else{var P=e.offsetAttribute===Ne.NONE?0:1;m=pe(m,P)}g.applyOffset=new ee({componentDatatype:x.UNSIGNED_BYTE,componentsPerAttribute:1,values:m})}var te=n.length,U=L+L,A=Re.createTypedArray(t.length/3,te*2+U*3);A.set(n);var o=te;for(E=0;E<te;E+=3){var s=n[E],S=n[E+1],O=n[E+2];A[o++]=O+L,A[o++]=S+L,A[o++]=s+L}var C,R,w,_;for(E=0;E<U;E+=2)C=E+U,R=C+U,w=C+1,_=R+1,A[o++]=C,A[o++]=R,A[o++]=w,A[o++]=w,A[o++]=R,A[o++]=_;return{attributes:g,indices:A}}var Je=new a,se=new a,F=new Le;function Ke(e,r,i,u,l,h){var v=a.subtract(r,e,Je);a.normalize(v,v);var N=i.geodeticSurfaceNormal(e,se),g=a.cross(v,N,Je);a.multiplyByScalar(g,u,g);var n=l.latitude,f=l.longitude,d=h.latitude,t=h.longitude;a.add(e,g,se),i.cartesianToCartographic(se,F);var p=F.latitude,c=F.longitude;n=Math.min(n,p),f=Math.min(f,c),d=Math.max(d,p),t=Math.max(t,c),a.subtract(e,g,se),i.cartesianToCartographic(se,F),p=F.latitude,c=F.longitude,n=Math.min(n,p),f=Math.min(f,c),d=Math.max(d,p),t=Math.max(t,c),l.latitude=n,l.longitude=f,h.latitude=d,h.longitude=t}var $=new a,be=new a,G=new Le,J=new Le;function je(e,r,i,u,l){e=$e(e,r);var h=ke(e,a.equalsEpsilon),v=h.length;if(v<2||i<=0)return new Oe;var N=i*.5;G.latitude=Number.POSITIVE_INFINITY,G.longitude=Number.POSITIVE_INFINITY,J.latitude=Number.NEGATIVE_INFINITY,J.longitude=Number.NEGATIVE_INFINITY;var g,n;if(u===_e.ROUNDED){var f=h[0];a.subtract(f,h[1],$),a.normalize($,$),a.multiplyByScalar($,N,$),a.add(f,$,be),r.cartesianToCartographic(be,F),g=F.latitude,n=F.longitude,G.latitude=Math.min(G.latitude,g),G.longitude=Math.min(G.longitude,n),J.latitude=Math.max(J.latitude,g),J.longitude=Math.max(J.longitude,n)}for(var d=0;d<v-1;++d)Ke(h[d],h[d+1],r,N,G,J);var t=h[v-1];a.subtract(t,h[v-2],$),a.normalize($,$),a.multiplyByScalar($,N,$),a.add(t,$,be),Ke(t,be,r,N,G,J),u===_e.ROUNDED&&(r.cartesianToCartographic(be,F),g=F.latitude,n=F.longitude,G.latitude=Math.min(G.latitude,g),G.longitude=Math.min(G.longitude,n),J.latitude=Math.max(J.latitude,g),J.longitude=Math.max(J.longitude,n));var p=j(l)?l:new Oe;return p.north=J.latitude,p.south=G.latitude,p.east=J.longitude,p.west=G.longitude,p}function ae(e){e=H(e,H.EMPTY_OBJECT);var r=e.positions,i=e.width;fe.defined("options.positions",r),fe.defined("options.width",i);var u=H(e.height,0),l=H(e.extrudedHeight,u);this._positions=r,this._ellipsoid=q.clone(H(e.ellipsoid,q.WGS84)),this._vertexFormat=Z.clone(H(e.vertexFormat,Z.DEFAULT)),this._width=i,this._height=Math.max(u,l),this._extrudedHeight=Math.min(u,l),this._cornerType=H(e.cornerType,_e.ROUNDED),this._granularity=H(e.granularity,de.RADIANS_PER_DEGREE),this._shadowVolume=H(e.shadowVolume,!1),this._workerName="createCorridorGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this.packedLength=1+r.length*a.packedLength+q.packedLength+Z.packedLength+7}ae.pack=function(e,r,i){fe.defined("value",e),fe.defined("array",r),i=H(i,0);var u=e._positions,l=u.length;r[i++]=l;for(var h=0;h<l;++h,i+=a.packedLength)a.pack(u[h],r,i);return q.pack(e._ellipsoid,r,i),i+=q.packedLength,Z.pack(e._vertexFormat,r,i),i+=Z.packedLength,r[i++]=e._width,r[i++]=e._height,r[i++]=e._extrudedHeight,r[i++]=e._cornerType,r[i++]=e._granularity,r[i++]=e._shadowVolume?1:0,r[i]=H(e._offsetAttribute,-1),r};var Ie=q.clone(q.UNIT_SPHERE),Pe=new Z,re={positions:void 0,ellipsoid:Ie,vertexFormat:Pe,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};ae.unpack=function(e,r,i){fe.defined("array",e),r=H(r,0);for(var u=e[r++],l=new Array(u),h=0;h<u;++h,r+=a.packedLength)l[h]=a.unpack(e,r);var v=q.unpack(e,r,Ie);r+=q.packedLength;var N=Z.unpack(e,r,Pe);r+=Z.packedLength;var g=e[r++],n=e[r++],f=e[r++],d=e[r++],t=e[r++],p=e[r++]===1,c=e[r];return j(i)?(i._positions=l,i._ellipsoid=q.clone(v,i._ellipsoid),i._vertexFormat=Z.clone(N,i._vertexFormat),i._width=g,i._height=n,i._extrudedHeight=f,i._cornerType=d,i._granularity=t,i._shadowVolume=p,i._offsetAttribute=c===-1?void 0:c,i):(re.positions=l,re.width=g,re.height=n,re.extrudedHeight=f,re.cornerType=d,re.granularity=t,re.shadowVolume=p,re.offsetAttribute=c===-1?void 0:c,new ae(re))};ae.computeRectangle=function(e,r){e=H(e,H.EMPTY_OBJECT);var i=e.positions,u=e.width;fe.defined("options.positions",i),fe.defined("options.width",u);var l=H(e.ellipsoid,q.WGS84),h=H(e.cornerType,_e.ROUNDED);return je(i,l,u,h,r)};ae.createGeometry=function(e){var r=e._positions,i=e._width,u=e._ellipsoid;r=$e(r,u);var l=ke(r,a.equalsEpsilon);if(!(l.length<2||i<=0)){var h=e._height,v=e._extrudedHeight,N=!de.equalsEpsilon(h,v,0,de.EPSILON2),g=e._vertexFormat,n={ellipsoid:u,positions:l,width:i,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!0},f;if(N)n.height=h,n.extrudedHeight=v,n.shadowVolume=e._shadowVolume,n.offsetAttribute=e._offsetAttribute,f=rr(n,g);else{var d=M.computePositions(n);if(f=Fe(d,g,u),f.attributes.position.values=Me.scaleToGeodeticHeight(f.attributes.position.values,h,u),j(e._offsetAttribute)){var t=e._offsetAttribute===Ne.NONE?0:1,p=f.attributes.position.values.length,c=new Uint8Array(p/3);pe(c,t),f.attributes.applyOffset=new ee({componentDatatype:x.UNSIGNED_BYTE,componentsPerAttribute:1,values:c})}}var E=f.attributes,L=Ye.fromVertices(E.position.values,void 0,3);return g.position||(f.attributes.position.values=void 0),new qe({attributes:E,indices:f.indices,primitiveType:We.TRIANGLES,boundingSphere:L,offsetAttribute:e._offsetAttribute})}};ae.createShadowVolume=function(e,r,i){var u=e._granularity,l=e._ellipsoid,h=r(u,l),v=i(u,l);return new ae({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:l,granularity:u,extrudedHeight:h,height:v,vertexFormat:Z.POSITION_ONLY,shadowVolume:!0})};Object.defineProperties(ae.prototype,{rectangle:{get:function(){return j(this._rectangle)||(this._rectangle=je(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}});var ze=ae;function ar(e,r){return j(r)&&(e=ze.unpack(e,r)),e._ellipsoid=q.clone(e._ellipsoid),ze.createGeometry(e)}var Dr=ar;export{Dr as default};
