define(["exports","./S3MPixelFormat-339a4168","./when-92c6cf3c","./Cartesian3-3a8bdb0b","./Check-52a7d806","./IndexDatatype-86677ec4","./WebGLConstants-42651efd","./FeatureDetection-cec0163f","./ComponentDatatype-98414d16"],(function(e,t,r,n,i,a,o,s,_){"use strict";function E(e,t,r,n){var i=e|t<<8,a=i>>11&31,o=i>>5&63,s=31&i;return r[n+0]=a<<3|a>>2,r[n+1]=o<<2|o>>4,r[n+2]=s<<3|s>>2,r[n+3]=255,i}function f(e,t,r,n){var i=0;0!=(6&n)&&(i=8),function(e,t,r,n){for(var i=new Uint8Array(16),a=E(t[r+0],t[r+1],i,0),o=E(t[r+2],t[r+3],i,4),s=0;s<3;s++){var _=i[s],f=i[4+s];n&&a<=o?(i[8+s]=(_+f)/2,i[12+s]=0):(i[8+s]=(2*_+f)/3,i[12+s]=(_+2*f)/3)}i[11]=255,i[15]=n&&a<=o?0:255;var u=new Uint8Array(16);for(s=0;s<4;++s){var T=t[r+4+s];u[4*s+0]=3&T,u[4*s+1]=T>>2&3,u[4*s+2]=T>>4&3,u[4*s+3]=T>>6&3}for(s=0;s<16;++s)for(var A=4*u[s],c=0;c<4;++c)e[4*s+c]=i[A+c]}(e,t,r+i,0!=(1&n)),0!=(2&n)?function(e,t,r){for(var n=0;n<8;++n){var i=bytes[r+n],a=15&i,o=240&i;e[8*n+3]=a|a<<4,e[8*n+7]=o|o>>4}}(e,0,r):0!=(4&n)&&function(e,t,r){var n=t[r+0],i=t[r+1],a=new Uint8Array(8);if(a[0]=n,a[1]=i,n<=i){for(var o=1;o<5;++o)a[1+o]=((5-o)*n+o*i)/5;a[6]=0,a[7]=255}else for(o=1;o<7;++o)a[1+o]=((7-o)*n+o*i)/7;var s=new Uint8Array(16),_=(r+=2,0);for(o=0;o<2;++o){for(var E=0,f=0;f<3;++f)E|=t[r++]<<8*f;for(f=0;f<8;++f){var u=E>>3*f&7;s[_++]=u}}for(o=0;o<16;++o)e[4*o+3]=a[s[o]]}(e,t,r)}function u(e){}u.decode=function(e,r,n,i,a){if(null!=e&&null!=i&&0!=n&&0!=r){var o=0;1&(o=a>t.S3MPixelFormat.BGR||a===t.S3MPixelFormat.LUMINANCE_ALPHA?4:33)&&32&o?function(e,t,r,n){for(var i=new Uint16Array(4),a=e,o=0,s=0,_=0,E=0,f=0,u=0,T=0,A=0,c=0,y=t/4,R=r/4,p=0;p<R;p++)for(var d=0;d<y;d++)_=4*((R-p)*y+d),i[0]=n[_],i[1]=n[_+1],E=31&i[0],f=2016&i[0],u=63488&i[0],T=31&i[1],A=2016&i[1],c=63488&i[1],i[2]=5*E+3*T>>3|5*f+3*A>>3&2016|5*u+3*c>>3&63488,i[3]=5*T+3*E>>3|5*A+3*f>>3&2016|5*c+3*u>>3&63488,o=n[_+2],a[s=4*p*t+4*d]=i[3&o],a[s+1]=i[o>>2&3],a[s+2]=i[o>>4&3],a[s+3]=i[o>>6&3],a[s+=t]=i[o>>8&3],a[s+1]=i[o>>10&3],a[s+2]=i[o>>12&3],a[s+3]=i[o>>14],o=n[_+3],a[s+=t]=i[3&o],a[s+1]=i[o>>2&3],a[s+2]=i[o>>4&3],a[s+3]=i[o>>6&3],a[s+=t]=i[o>>8&3],a[s+1]=i[o>>10&3],a[s+2]=i[o>>12&3],a[s+3]=i[o>>14]}(e,r,n,i):function(e,t,r,n,i){for(var a=0!=(1&i)?8:16,o=0,s=0;s<r;s+=4)for(var _=0;_<t;_+=4){var E=new Uint8Array(64);f(E,n,o,i);for(var u=0,T=0;T<4;++T)for(var A=0;A<4;++A){var c=_+A,y=s+T;if(c<t&&y<r)for(var R=4*(t*(r-y)+c),p=0;p<4;++p)e[R++]=E[u++];else u+=4}o+=a}}(e,r,n,i,o)}};var T,A=(T=!0,function(e,t){var r=T?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return T=!1,r}),c=A(void 0,(function(){return c.toString().search("(((.+)+)+)+$").toString().constructor(c).search("(((.+)+)+)+$")}));c();var y,R=Object.freeze({encNONE:0,enrS3TCDXTN:14,enrPVRTPF_PVRTC2:19,enrPVRTPF_PVRTC:20,enrPVRTPF_PVRTC_4bpp:21,enrPVRTPF_ETC1:22}),p=(y=!0,function(e,t){var r=y?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return y=!1,r}),d=p(void 0,(function(){return d.toString().search("(((.+)+)+)+$").toString().constructor(d).search("(((.+)+)+)+$")}));d();var h=Object.freeze({SVC_Vertex:1,SVC_Normal:2,SVC_VertexColor:4,SVC_SecondColor:8,SVC_TexutreCoord:16,SVC_TexutreCoordIsW:32});function I(){return!0}function O(e,t){function n(){throw new i.t(t)}for(var a in t=r.u(t,"This object was destroyed, i.e., destroy() was called."),e)"function"==typeof e[a]&&(e[a]=n);e.isDestroyed=I}var S={STREAM_DRAW:o.d.STREAM_DRAW,STATIC_DRAW:o.d.STATIC_DRAW,DYNAMIC_DRAW:o.d.DYNAMIC_DRAW,validate:function(e){return e===S.STREAM_DRAW||e===S.STATIC_DRAW||e===S.DYNAMIC_DRAW}};function N(e){if(e=r.u(e,r.u.EMPTY_OBJECT),i.o.defined("options.context",e.context),!r.e(e.typedArray)&&!r.e(e.sizeInBytes))throw new i.t("Either options.sizeInBytes or options.typedArray is required.");if(r.e(e.typedArray)&&r.e(e.sizeInBytes))throw new i.t("Cannot pass in both options.sizeInBytes and options.typedArray.");if(r.e(e.typedArray)&&(i.o.typeOf.object("options.typedArray",e.typedArray),i.o.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),!S.validate(e.usage))throw new i.t("usage is invalid.");var t=e.context._gl,n=e.bufferTarget,a=e.typedArray,o=e.sizeInBytes,s=e.usage,_=r.e(a);_&&(o=a.byteLength),i.o.typeOf.number.greaterThan("sizeInBytes",o,0);var E=t.createBuffer();t.bindBuffer(n,E),t.bufferData(n,_?a:o,s),t.bindBuffer(n,null),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=n,this._sizeInBytes=o,this._usage=s,this._buffer=E,this.context=e.context,e.context.memorySize+=o}Object.defineProperties(N.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),N.prototype._getBuffer=function(){return this._buffer},N.prototype.copyFromArrayView=function(e,t){t=r.u(t,0),i.o.defined("arrayView",e),i.o.typeOf.number.lessThanOrEquals("offsetInBytes + arrayView.byteLength",t+e.byteLength,this._sizeInBytes);var n=this._gl,a=this._bufferTarget;n.bindBuffer(a,this._buffer),n.bufferSubData(a,t,e),n.bindBuffer(a,null)},N.prototype.copyFromBuffer=function(e,t,n,a){if(!this._webgl2)throw new i.t("A WebGL 2 context is required.");if(!r.e(e))throw new i.t("readBuffer must be defined.");if(!r.e(a)||a<=0)throw new i.t("sizeInBytes must be defined and be greater than zero.");if(!r.e(t)||t<0||t+a>e._sizeInBytes)throw new i.t("readOffset must be greater than or equal to zero and readOffset + sizeInBytes must be less than of equal to readBuffer.sizeInBytes.");if(!r.e(n)||n<0||n+a>this._sizeInBytes)throw new i.t("writeOffset must be greater than or equal to zero and writeOffset + sizeInBytes must be less than of equal to this.sizeInBytes.");if(this._buffer===e._buffer&&(n>=t&&n<t+a||t>n&&t<n+a))throw new i.t("When readBuffer is equal to this, the ranges [readOffset + sizeInBytes) and [writeOffset, writeOffset + sizeInBytes) must not overlap.");if(this._bufferTarget===o.d.ELEMENT_ARRAY_BUFFER&&e._bufferTarget!==o.d.ELEMENT_ARRAY_BUFFER||this._bufferTarget!==o.d.ELEMENT_ARRAY_BUFFER&&e._bufferTarget===o.d.ELEMENT_ARRAY_BUFFER)throw new i.t("Can not copy an index buffer into another buffer type.");var s=o.d.COPY_READ_BUFFER,_=o.d.COPY_WRITE_BUFFER,E=this._gl;E.bindBuffer(_,this._buffer),E.bindBuffer(s,e._buffer),E.copyBufferSubData(s,_,t,n,a),E.bindBuffer(_,null),E.bindBuffer(s,null)},N.prototype.getBufferData=function(e,t,n,a){if(t=r.u(t,0),n=r.u(n,0),!this._webgl2)throw new i.t("A WebGL 2 context is required.");if(!r.e(e))throw new i.t("arrayView is required.");var s,_,E=e.byteLength;if(r.e(a)?(s=a,r.e(E)?_=1:(E=e.length,_=e.BYTES_PER_ELEMENT)):r.e(E)?(s=E-n,_=1):(s=(E=e.length)-n,_=e.BYTES_PER_ELEMENT),n<0||n>E)throw new i.t("destinationOffset must be greater than zero and less than the arrayView length.");if(n+s>E)throw new i.t("destinationOffset + length must be less than or equal to the arrayViewLength.");if(t<0||t>this._sizeInBytes)throw new i.t("sourceOffset must be greater than zero and less than the buffers size.");if(t+s*_>this._sizeInBytes)throw new i.t("sourceOffset + length must be less than the buffers size.");var f=this._gl,u=o.d.COPY_READ_BUFFER;f.bindBuffer(u,this._buffer),f.getBufferSubData(u,t,e,n,a),f.bindBuffer(u,null)},N.prototype.isDestroyed=function(){return!1},N.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),this.context.memorySize-=this.sizeInBytes,O(this)};var l,D=(l=!0,function(e,t){var r=l?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return l=!1,r}),L=D(void 0,(function(){return L.toString().search("(((.+)+)+)+$").toString().constructor(L).search("(((.+)+)+)+$")}));function g(){}L(),g.ALPHA_DISABLE=0,g.ALPHA_ADD=1,g.ALPHA_COMBINE=2,g.ALPHA_SUBTRACT=3,g.ALPHA_MULTIPLY=4,g.ALPHA_MAXIMIZED=5,g.ALPHA_ONEONE=6,g.ALPHA_PREMULTIPLIED=7,g.ALPHA_PREMULTIPLIED_PORTERDUFF=8,g.ALPHA_INTERPOLATE=9,g.ALPHA_SCREENMODE=10,g.ALPHA_ONEONE_ONEONE=11,g.ALPHA_ALPHATOCOLOR=12,g.ALPHA_REVERSEONEMINUS=13,g.ALPHA_SRC_DSTONEMINUSSRCALPHA=14,g.ALPHA_ONEONE_ONEZERO=15,g.ALPHA_EXCLUSION=16,g.ALPHA_LAYER_ACCUMULATE=17,g.ALPHA_EQUATION_ADD=0,g.ALPHA_EQUATION_SUBSTRACT=1,g.ALPHA_EQUATION_REVERSE_SUBTRACT=2,g.ALPHA_EQUATION_MAX=3,g.ALPHA_EQUATION_MIN=4,g.ALPHA_EQUATION_DARKEN=5,g.DELAYLOADSTATE_NONE=0,g.DELAYLOADSTATE_LOADED=1,g.DELAYLOADSTATE_LOADING=2,g.DELAYLOADSTATE_NOTLOADED=4,g.NEVER=512,g.ALWAYS=519,g.LESS=513,g.EQUAL=514,g.LEQUAL=515,g.GREATER=516,g.GEQUAL=518,g.NOTEQUAL=517,g.KEEP=7680,g.ZERO=0,g.REPLACE=7681,g.INCR=7682,g.DECR=7683,g.INVERT=5386,g.INCR_WRAP=34055,g.DECR_WRAP=34056,g.FRONT=0,g.BACK=1,g.TEXTURE_CLAMP_ADDRESSMODE=0,g.TEXTURE_WRAP_ADDRESSMODE=1,g.TEXTURE_MIRROR_ADDRESSMODE=2,g.TEXTURE_CREATIONFLAG_STORAGE=1,g.TEXTUREFORMAT_ALPHA=0,g.TEXTUREFORMAT_LUMINANCE=1,g.TEXTUREFORMAT_LUMINANCE_ALPHA=2,g.TEXTUREFORMAT_RGB=4,g.TEXTUREFORMAT_RGBA=5,g.TEXTUREFORMAT_RED=6,g.TEXTUREFORMAT_R=6,g.TEXTUREFORMAT_RG=7,g.TEXTUREFORMAT_RED_INTEGER=8,g.TEXTUREFORMAT_R_INTEGER=8,g.TEXTUREFORMAT_RG_INTEGER=9,g.TEXTUREFORMAT_RGB_INTEGER=10,g.TEXTUREFORMAT_RGBA_INTEGER=11,g.TEXTUREFORMAT_BGRA=12,g.TEXTUREFORMAT_DEPTH24_STENCIL8=13,g.TEXTUREFORMAT_DEPTH32_FLOAT=14,g.TEXTUREFORMAT_DEPTH16=15,g.TEXTUREFORMAT_DEPTH24=16,g.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8=17,g.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8=18,g.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM=36492,g.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_BPTC_UNORM=36493,g.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT=36495,g.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_SIGNED_FLOAT=36494,g.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5=33779,g.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919,g.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3=33778,g.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918,g.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1=33777,g.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1=33776,g.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917,g.TEXTUREFORMAT_COMPRESSED_SRGB_S3TC_DXT1_EXT=35916,g.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4=37808,g.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840,g.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL=36196,g.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2=37492,g.TEXTUREFORMAT_COMPRESSED_SRGB8_ETC2=37493,g.TEXTUREFORMAT_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494,g.TEXTUREFORMAT_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495,g.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC=37496,g.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497,g.TEXTURETYPE_UNSIGNED_BYTE=0,g.TEXTURETYPE_UNSIGNED_INT=0,g.TEXTURETYPE_FLOAT=1,g.TEXTURETYPE_HALF_FLOAT=2,g.TEXTURETYPE_BYTE=3,g.TEXTURETYPE_SHORT=4,g.TEXTURETYPE_UNSIGNED_SHORT=5,g.TEXTURETYPE_INT=6,g.TEXTURETYPE_UNSIGNED_INTEGER=7,g.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,g.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,g.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,g.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,g.TEXTURETYPE_UNSIGNED_INT_24_8=12,g.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,g.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,g.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,g.TEXTURETYPE_UNDEFINED=16,g.TEXTURE_NEAREST_SAMPLINGMODE=1,g.TEXTURE_NEAREST_NEAREST=1,g.TEXTURE_BILINEAR_SAMPLINGMODE=2,g.TEXTURE_LINEAR_LINEAR=2,g.TEXTURE_TRILINEAR_SAMPLINGMODE=3,g.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,g.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,g.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,g.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,g.TEXTURE_NEAREST_LINEAR=7,g.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,g.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,g.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,g.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,g.TEXTURE_LINEAR_NEAREST=12,g.TEXTURE_EXPLICIT_MODE=0,g.TEXTURE_SPHERICAL_MODE=1,g.TEXTURE_PLANAR_MODE=2,g.TEXTURE_CUBIC_MODE=3,g.TEXTURE_PROJECTION_MODE=4,g.TEXTURE_SKYBOX_MODE=5,g.TEXTURE_INVCUBIC_MODE=6,g.TEXTURE_EQUIRECTANGULAR_MODE=7,g.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,g.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,g.TEXTURE_FILTERING_QUALITY_OFFLINE=4096,g.TEXTURE_FILTERING_QUALITY_HIGH=64,g.TEXTURE_FILTERING_QUALITY_MEDIUM=16,g.TEXTURE_FILTERING_QUALITY_LOW=8,g.SCALEMODE_FLOOR=1,g.SCALEMODE_NEAREST=2,g.SCALEMODE_CEILING=3,g.MATERIAL_TextureDirtyFlag=1,g.MATERIAL_LightDirtyFlag=2,g.MATERIAL_FresnelDirtyFlag=4,g.MATERIAL_AttributesDirtyFlag=8,g.MATERIAL_MiscDirtyFlag=16,g.MATERIAL_PrePassDirtyFlag=32,g.MATERIAL_AllDirtyFlag=63,g.MATERIAL_TriangleFillMode=0,g.MATERIAL_WireFrameFillMode=1,g.MATERIAL_PointFillMode=2,g.MATERIAL_PointListDrawMode=3,g.MATERIAL_LineListDrawMode=4,g.MATERIAL_LineLoopDrawMode=5,g.MATERIAL_LineStripDrawMode=6,g.MATERIAL_TriangleStripDrawMode=7,g.MATERIAL_TriangleFanDrawMode=8,g.MATERIAL_ClockWiseSideOrientation=0,g.MATERIAL_CounterClockWiseSideOrientation=1,g.ACTION_NothingTrigger=0,g.ACTION_OnPickTrigger=1,g.ACTION_OnLeftPickTrigger=2,g.ACTION_OnRightPickTrigger=3,g.ACTION_OnCenterPickTrigger=4,g.ACTION_OnPickDownTrigger=5,g.ACTION_OnDoublePickTrigger=6,g.ACTION_OnPickUpTrigger=7,g.ACTION_OnPickOutTrigger=16,g.ACTION_OnLongPressTrigger=8,g.ACTION_OnPointerOverTrigger=9,g.ACTION_OnPointerOutTrigger=10,g.ACTION_OnEveryFrameTrigger=11,g.ACTION_OnIntersectionEnterTrigger=12,g.ACTION_OnIntersectionExitTrigger=13,g.ACTION_OnKeyDownTrigger=14,g.ACTION_OnKeyUpTrigger=15,g.PARTICLES_BILLBOARDMODE_Y=2,g.PARTICLES_BILLBOARDMODE_ALL=7,g.PARTICLES_BILLBOARDMODE_STRETCHED=8,g.MESHES_CULLINGSTRATEGY_STANDARD=0,g.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,g.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,g.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,g.SCENELOADER_NO_LOGGING=0,g.SCENELOADER_MINIMAL_LOGGING=1,g.SCENELOADER_SUMMARY_LOGGING=2,g.SCENELOADER_DETAILED_LOGGING=3,g.PREPASS_IRRADIANCE_TEXTURE_TYPE=0,g.PREPASS_POSITION_TEXTURE_TYPE=1,g.PREPASS_VELOCITY_TEXTURE_TYPE=2,g.PREPASS_REFLECTIVITY_TEXTURE_TYPE=3,g.PREPASS_COLOR_TEXTURE_TYPE=4,g.PREPASS_DEPTH_TEXTURE_TYPE=5,g.PREPASS_NORMAL_TEXTURE_TYPE=6,g.PREPASS_ALBEDO_SQRT_TEXTURE_TYPE=7,g.BUFFER_CREATIONFLAG_READ=1,g.BUFFER_CREATIONFLAG_WRITE=2,g.BUFFER_CREATIONFLAG_READWRITE=3,g.BUFFER_CREATIONFLAG_UNIFORM=4,g.BUFFER_CREATIONFLAG_VERTEX=8,g.BUFFER_CREATIONFLAG_INDEX=16,g.BUFFER_CREATIONFLAG_STORAGE=32,g.RENDERPASS_MAIN=0,g.INPUT_ALT_KEY=18,g.INPUT_CTRL_KEY=17,g.INPUT_META_KEY1=91,g.INPUT_META_KEY2=92,g.INPUT_META_KEY3=93,g.INPUT_SHIFT_KEY=16,g.SNAPSHOTRENDERING_STANDARD=0,g.SNAPSHOTRENDERING_FAST=1,g.PERSPECTIVE_CAMERA=0,g.ORTHOGRAPHIC_CAMERA=1,g.FOVMODE_VERTICAL_FIXED=0,g.FOVMODE_HORIZONTAL_FIXED=1,g.RIG_MODE_NONE=0,g.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,g.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,g.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,g.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,g.RIG_MODE_STEREOSCOPIC_INTERLACED=14,g.RIG_MODE_VR=20,g.RIG_MODE_WEBVR=21,g.RIG_MODE_CUSTOM=22,g.MAX_SUPPORTED_UV_SETS=6,g.GL_ALPHA_EQUATION_ADD=32774,g.GL_ALPHA_EQUATION_MIN=32775,g.GL_ALPHA_EQUATION_MAX=32776,g.GL_ALPHA_EQUATION_SUBTRACT=32778,g.GL_ALPHA_EQUATION_REVERSE_SUBTRACT=32779,g.GL_ALPHA_FUNCTION_SRC=768,g.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_COLOR=769,g.GL_ALPHA_FUNCTION_SRC_ALPHA=770,g.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_ALPHA=771,g.GL_ALPHA_FUNCTION_DST_ALPHA=772,g.GL_ALPHA_FUNCTION_ONE_MINUS_DST_ALPHA=773,g.GL_ALPHA_FUNCTION_DST_COLOR=774,g.GL_ALPHA_FUNCTION_ONE_MINUS_DST_COLOR=775,g.GL_ALPHA_FUNCTION_SRC_ALPHA_SATURATED=776,g.GL_ALPHA_FUNCTION_CONSTANT_COLOR=32769,g.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_COLOR=32770,g.GL_ALPHA_FUNCTION_CONSTANT_ALPHA=32771,g.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_ALPHA=32772,g.SnippetUrl="";var U,B=(U=!0,function(e,t){var r=U?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return U=!1,r}),P=B(void 0,(function(){return P.toString().search("(((.+)+)+)+$").toString().constructor(P).search("(((.+)+)+)+$")}));function C(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=C._Counter++}P(),Object.defineProperty(C.prototype,"underlyingResource",{get:function(){return null},enumerable:!1,configurable:!0}),C._Counter=0;var b,v=(b=!0,function(e,t){var r=b?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return b=!1,r}),M=v(void 0,(function(){return M.toString().search("(((.+)+)+)+$").toString().constructor(M).search("(((.+)+)+)+$")}));function F(e,t,r,n,i,a,o,s){void 0===n&&(n=0),void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),this._isAlreadyOwned=!1,e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=r,this._instanced=a,this._divisor=s||1,t instanceof C?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=o?n:n*Float32Array.BYTES_PER_ELEMENT,!i&&this.create()}function m(e,t,r,n,i,a,o,s,_,E,f,u,T,A){if(void 0===f&&(f=!1),void 0===u&&(u=!1),void 0===T&&(T=1),void 0===A&&(A=!1),t instanceof F?(this._buffer=t,this._ownsBuffer=A):(this._buffer=new F(e,t,n,a,i,o,u),this._ownsBuffer=!0),this.uniqueId=m._Counter++,this._kind=r,null==E){var c=this.getData();this.type=m.FLOAT,c instanceof Int8Array?this.type=m.BYTE:c instanceof Uint8Array?this.type=m.UNSIGNED_BYTE:c instanceof Int16Array?this.type=m.SHORT:c instanceof Uint16Array?this.type=m.UNSIGNED_SHORT:c instanceof Int32Array?this.type=m.INT:c instanceof Uint32Array&&(this.type=m.UNSIGNED_INT)}else this.type=E;var y=m.GetTypeByteLength(this.type);u?(this._size=_||(a?a/y:m.DeduceStride(r)),this.byteStride=a||this._buffer.byteStride||this._size*y,this.byteOffset=s||0):(this._size=_||a||m.DeduceStride(r),this.byteStride=a?a*y:this._buffer.byteStride||this._size*y,this.byteOffset=(s||0)*y),this.normalized=f,this._instanced=void 0!==o&&o,this._instanceDivisor=o?T:0,this._computeHashCode()}M(),F.prototype.createVertexBuffer=function(e,t,r,n,i,a,o){void 0===a&&(a=!1);var s=a?t:t*Float32Array.BYTES_PER_ELEMENT,_=n?a?n:n*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new m(this._engine,this,e,this._updatable,!0,_,void 0===i?this._instanced:i,s,r,void 0,void 0,!0,this._divisor||o)},F.prototype.isUpdatable=function(){return this._updatable},F.prototype.getData=function(){return this._data},F.prototype.getBuffer=function(){return this._buffer},F.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},F.prototype.create=function(e){void 0===e&&(e=null),!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))},F.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},F.prototype.update=function(e){this.create(e)},F.prototype.updateDirectly=function(e,t,r,n){void 0===n&&(n=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,n?t:t*Float32Array.BYTES_PER_ELEMENT,r?r*this.byteStride:void 0),this._data=0===t&&void 0===r?e:null)},F.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)},F.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)},Object.defineProperty(m.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(e){this._instanceDivisor=e,this._instanced=0!=e,this._computeHashCode()},enumerable:!1,configurable:!0}),m.prototype._computeHashCode=function(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)},m.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},m.prototype.getKind=function(){return this._kind},m.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},m.prototype.getData=function(){return this._buffer.getData()},m.prototype.getFloatData=function(e,t){var r=this.getData();if(!r)return null;var n=this.getSize()*m.GetTypeByteLength(this.type),i=e*this.getSize();if(this.type!==m.FLOAT||this.byteStride!==n){var a=new Float32Array(i);return this.forEach(i,(function(e,t){return a[t]=e})),a}if(!(r instanceof Array||r instanceof Float32Array)||0!==this.byteOffset||r.length!==i){if(r instanceof Array){var o=this.byteOffset/4;return r.slice(o,o+i)}if(r instanceof ArrayBuffer)return new Float32Array(r,this.byteOffset,i);o=r.byteOffset+this.byteOffset;if(t){var s=new Float32Array(i),_=new Float32Array(r.buffer,o,i);return s.set(_),s}var E=o%4;return E&&(o=Math.max(0,o-E)),new Float32Array(r.buffer,o,i)}return t?r.slice():r},m.prototype.getBuffer=function(){return this._buffer.getBuffer()},m.prototype.getStrideSize=function(){return this.byteStride/m.GetTypeByteLength(this.type)},m.prototype.getOffset=function(){return this.byteOffset/m.GetTypeByteLength(this.type)},m.prototype.getSize=function(e){return void 0===e&&(e=!1),e?this._size*m.GetTypeByteLength(this.type):this._size},m.prototype.getIsInstanced=function(){return this._instanced},m.prototype.getInstanceDivisor=function(){return this._instanceDivisor},m.prototype.create=function(e){this._buffer.create(e)},m.prototype.update=function(e){this._buffer.update(e)},m.prototype.updateDirectly=function(e,t,r){void 0===r&&(r=!1),this._buffer.updateDirectly(e,t,void 0,r)},m.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},m.prototype.forEach=function(e,t){m.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,e,this.normalized,t)},m.DeduceStride=function(e){switch(e){case m.UVKind:case m.UV2Kind:case m.UV3Kind:case m.UV4Kind:case m.UV5Kind:case m.UV6Kind:return 2;case m.NormalKind:case m.PositionKind:return 3;case m.ColorKind:case m.MatricesIndicesKind:case m.MatricesIndicesExtraKind:case m.MatricesWeightsKind:case m.MatricesWeightsExtraKind:case m.TangentKind:return 4;default:throw new Error("Invalid kind '"+e+"'")}},m.GetTypeByteLength=function(e){switch(e){case m.BYTE:case m.UNSIGNED_BYTE:return 1;case m.SHORT:case m.UNSIGNED_SHORT:return 2;case m.INT:case m.UNSIGNED_INT:case m.FLOAT:return 4;default:throw new Error("Invalid type '".concat(e,"'"))}},m.ForEach=function(e,t,r,n,i,a,o,s){if(e instanceof Array)for(var _=t/4,E=r/4,f=0;f<a;f+=n){for(var u=0;u<n;u++)s(e[_+u],f+u);_+=E}else{var T=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),A=m.GetTypeByteLength(i);for(f=0;f<a;f+=n){var c=t;for(u=0;u<n;u++){s(m._GetFloatValue(T,i,c,o),f+u),c+=A}t+=r}}},m._GetFloatValue=function(e,t,r,n){switch(t){case m.BYTE:var i=e.getInt8(r);return n&&(i=Math.max(i/127,-1)),i;case m.UNSIGNED_BYTE:i=e.getUint8(r);return n&&(i/=255),i;case m.SHORT:i=e.getInt16(r,!0);return n&&(i=Math.max(i/32767,-1)),i;case m.UNSIGNED_SHORT:i=e.getUint16(r,!0);return n&&(i/=65535),i;case m.INT:return e.getInt32(r,!0);case m.UNSIGNED_INT:return e.getUint32(r,!0);case m.FLOAT:return e.getFloat32(r,!0);default:throw new Error("Invalid component type ".concat(t))}},m._Counter=0,m.BYTE=5120,m.UNSIGNED_BYTE=5121,m.SHORT=5122,m.UNSIGNED_SHORT=5123,m.INT=5124,m.UNSIGNED_INT=5125,m.FLOAT=5126,m.PositionKind="position",m.NormalKind="normal",m.TangentKind="tangent",m.UVKind="uv",m.UV2Kind="uv2",m.UV3Kind="uv3",m.UV4Kind="uv4",m.UV5Kind="uv5",m.UV6Kind="uv6",m.ColorKind="color",m.ColorInstanceKind="instanceColor",m.MatricesIndicesKind="matricesIndices",m.MatricesWeightsKind="matricesWeights",m.MatricesIndicesExtraKind="matricesIndicesExtra",m.MatricesWeightsExtraKind="matricesWeightsExtra";var x,G=(x=!0,function(e,t){var r=x?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return x=!1,r}),w=G(void 0,(function(){return w.toString().search("(((.+)+)+)+$").toString().constructor(w).search("(((.+)+)+)+$")}));function z(e,t,r){void 0===r&&(r=g.BUFFER_CREATIONFLAG_READWRITE),this._engine=e,this._engine._storageBuffers.push(this),this._create(t,r)}function X(e){var t=(e=r.u(e,r.u.EMPTY_OBJECT)).context,n=e.bufferTarget,i=e.typedArray,s=e.sizeInBytes,_=e.usage,E=r.e(i);E?s=i.byteLength:i=new Uint8Array(s);var f=g.BUFFER_CREATIONFLAG_STORAGE;r.e(_)&&(_==S.STREAM_DRAW||_==S.STATIC_DRAW?f|=g.BUFFER_CREATIONFLAG_WRITE:_==S.DYNAMIC_DRAW&&(f|=g.BUFFER_CREATIONFLAG_READWRITE)),r.e(n)?n==o.d.ELEMENT_ARRAY_BUFFER?(i instanceof Uint8Array&&(e.indexDatatype==a.IndexDatatype.UNSIGNED_INT?i=new Uint32Array(i.buffer,i.byteOffset,i.byteLength/4):e.indexDatatype==a.IndexDatatype.UNSIGNED_SHORT&&(i=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2))),this._dataBuffer=t.engine.createIndexBuffer(i)):n==o.d.ARRAY_BUFFER?(this._dataBuffer=new F(t.engine,i,!0),this._dataBuffer._data=null):console.log("BufferGPU not supported bufferTarget"):(this._dataBuffer=new z(t.engine,s,f),E&&this._dataBuffer.update(i,0,s)),this._bufferTarget=n,this._sizeInBytes=s,this._usage=_,this.context=e.context,e.context.memorySize+=s}function H(e){if(e=r.u(e,r.u.EMPTY_OBJECT),i.o.defined("options.context",e.context),!r.e(e.typedArray)&&!r.e(e.sizeInBytes))throw new i.t("Either options.sizeInBytes or options.typedArray is required.");if(r.e(e.typedArray)&&r.e(e.sizeInBytes))throw new i.t("Cannot pass in both options.sizeInBytes and options.typedArray.");r.e(e.typedArray)&&(i.o.typeOf.object("options.typedArray",e.typedArray),i.o.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),e.context.webgpu?this._inner=new X(e):this._inner=new N(e),this.vertexArrayDestroyable=!0}w(),z.prototype._create=function(e,t){this._bufferSize=e,this._creationFlags=t,this._buffer=this._engine.createStorageBuffer(e,t)},z.prototype._rebuild=function(){this._create(this._bufferSize,this._creationFlags)},z.prototype.getBuffer=function(){return this._buffer},z.prototype.update=function(e,t,r){this._buffer&&this._engine.updateStorageBuffer(this._buffer,e,t,r)},z.prototype.read=function(e,t,r){return this._engine.readFromStorageBuffer(this._buffer,e,t,r)},z.prototype.dispose=function(){var e=this._engine._storageBuffers,t=e.indexOf(this);-1!==t&&(e[t]=e[e.length-1],e.pop()),this._engine._releaseBuffer(this._buffer),this._buffer=null},Object.defineProperties(X.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}},dataBuffer:{get:function(){return this._dataBuffer}}}),X.prototype._getBuffer=function(){return console.log("BufferGPU.prototype._getBuffer"),this._dataBuffer},X.prototype.copyFromArrayView=function(e,t){this._dataBuffer.updateDirectly(e,t,null,!0)},X.prototype.copyFromBuffer=function(e,t,r,n){console.log("BufferGPU.prototype.copyFromBuffer")},X.prototype.getBufferData=function(e,t,r,n){console.log("BufferGPU.prototype.getBufferData")},X.prototype.isDestroyed=function(){return!1},X.prototype.destroy=function(){return this._bufferTarget!==o.d.ELEMENT_ARRAY_BUFFER?this._dataBuffer.dispose():this.context._engine._releaseBuffer(this._dataBuffer),this.context.memorySize-=this.sizeInBytes,O(this)},H.createVertexBuffer=function(e){return i.o.defined("options.context",e.context),new H({context:e.context,bufferTarget:o.d.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})},H.createIndexBuffer=function(e){if(i.o.defined("options.context",e.context),!a.IndexDatatype.validate(e.indexDatatype))throw new i.t("Invalid indexDatatype.");if(e.indexDatatype===a.IndexDatatype.UNSIGNED_INT&&!e.context.elementIndexUint)throw new i.t("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.");var t=e.context,r=e.indexDatatype,n=a.IndexDatatype.getSizeInBytes(r),s=new H({context:t,bufferTarget:o.d.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage,indexDatatype:r}),_=s.sizeInBytes/n;return Object.defineProperties(s,{indexDatatype:{get:function(){return r}},bytesPerIndex:{get:function(){return n}},numberOfIndices:{get:function(){return _}}}),s},Object.defineProperties(H.prototype,{sizeInBytes:{get:function(){return this._inner.sizeInBytes}},usage:{get:function(){return this._inner.usage}}}),H.prototype._getBuffer=function(){return this._inner._getBuffer()},H.prototype.copyFromArrayView=function(e,t){this._inner.copyFromArrayView(e,t)},H.prototype.copyFromBuffer=function(e,t,r,n){this._inner.copyFromBuffer(e,t,r,n)},H.prototype.getBufferData=function(e,t,r,n){this._inner.getBufferData(e,t,r,n)},H.prototype.isDestroyed=function(){return!1},H.prototype.destroy=function(){return this._inner.destroy(),O(this)};var V,Y=(V=!0,function(e,t){var r=V?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return V=!1,r}),K=Y(void 0,(function(){return K.toString().search("(((.+)+)+)+$").toString().constructor(K).search("(((.+)+)+)+$")}));function W(){}K(),W.computeNeighbors=function(e,t){for(var r=e.length/3,n=new Uint32Array(t+1),i=new Uint32Array(t+1),a=function(e,t){e<t?n[e+1]++:i[t+1]++},o=0;o<r;o++){var s=e[3*o],_=e[3*o+1],E=e[3*o+2];a(s,_),a(_,E),a(E,s)}for(o=_=s=0;o<t;o++)E=n[o+1],a=i[o+1],n[o+1]=s,i[o+1]=_,s+=E,_+=a;var f=new Uint32Array(6*r),u=n[t];for(a=function(e,t,r){if(e<t){var a=n[e+1]++;f[2*a]=t,f[2*a+1]=r}else a=i[t+1]++,f[2*u+2*a]=e,f[2*u+2*a+1]=r},o=0;o<r;o++)s=e[3*o],_=e[3*o+1],E=e[3*o+2],a(s,_,o),a(_,E,o),a(E,s,o);for(s=function(e,t){var r=2*e;for(e=t-e,t=1;t<e;t++){for(var n=f[r+2*t],i=f[r+2*t+1],a=t-1;0<=a&&f[r+2*a]>n;a--)f[r+2*a+2]=f[r+2*a],f[r+2*a+3]=f[r+2*a+1];f[r+2*a+2]=n,f[r+2*a+3]=i}},o=0;o<t;o++)s(n[o],n[o+1]),s(u+i[o],u+i[o+1]);var T=new Int32Array(3*r),A=function(t,r){return t===e[3*r]?0:t===e[3*r+1]?1:t===e[3*r+2]?2:-1};for(r=function(e,t){e=A(e,t),T[3*t+e]=-1},s=function(e,t,r,n){e=A(e,t),T[3*t+e]=n,r=A(r,n),T[3*n+r]=t},o=0;o<t;o++){_=n[o],E=n[o+1],a=i[o];for(var c=i[o+1];_<E&&a<c;){var y=f[2*_],R=f[2*u+2*a];y===R?(s(o,f[2*_+1],R,f[2*u+2*a+1]),_++,a++):y<R?(r(o,f[2*_+1]),_++):(r(R,f[2*u+2*a+1]),a++)}for(;_<E;)r(o,f[2*_+1]),_++;for(;a<c;)r(R=f[2*u+2*a],f[2*u+2*a+1]),a++}return T};var q=null;function k(){}function Q(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));return n(),e*Math.PI/180}W.deduplicate=function(e,t,r,n,i){void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=e.byteLength/(4*t)),e=new Uint32Array(e,n,i*t),n=new Uint32Array(i);var a=Math.floor(1.1*i)+1;(null==q||q.length<2*a)&&(q=new Uint32Array(function(e){--e;for(var t=1;32>t;t<<=1)e|=e>>t;return e+1}(2*a)));for(var o=0;o<2*a;o++)q[o]=0;var s=0,_=0!==r?Math.ceil(7.84*1.96/(r*r)*r*(1-r)):i;for(o=0;o<i;o++){if(o===_){if((f=1-s/o)+1.96*Math.sqrt(f*(1-f)/o)<r)return null;_*=2}for(var E,f=o*t,u=E=0;u<t;u++)E=(E=e[f+u]+E|0)+(E<<11)+(E>>>2)|0;u=(E>>>=0)%a;for(var T=s;0!==q[2*u+1];){if(q[2*u]===E){var A=q[2*u+1]-1,c=A*t;e:{for(var y=0;y<t;y++)if(e[f+y]!==e[c+y]){c=!1;break e}c=!0}if(c){T=n[A];break}}++u>=a&&(u-=a)}T===s&&(q[2*u]=E,q[2*u+1]=o+1,s++),n[o]=T}if(0!==r&&1-s/i<r)return null;for(r=new Uint32Array(t*s),o=s=0;o<i;o++)if(n[o]===s){for(a=e,_=o*t,f=r,E=s*t,u=t,T=0;T<u;T++)f[E+T]=a[_+T];s++}return{buffer:r.buffer,indices:n,uniqueCount:s}};var $=Q(4),j=Q(35),Z=Math.cos(j),J=Math.cos($);var ee={position0:new n.o,position1:new n.o,faceNormal0:new n.o,faceNormal1:new n.o,cosAngle:0},te=new n.o,re=new n.o;function ne(e,t){var r,i,a,o,s,_,E=(r=e.cosAngle,Math.acos(1<r?1:-1>r?-1:r));return i=re,a=e.position1,o=e.position0,s=o.x-a.x,_=o.y-a.y,(o=s*s+_*_+(a=o.z-a.z)*a)?(o=1/Math.sqrt(o),i.x=s*o,i.y=_*o,i.z=a*o):(i.x=0,i.y=0,i.z=0),n.o.cross(e.faceNormal0,e.faceNormal1,te),E*(0<n.o.dot(te,re)?-1:1)>t}var ie=new n.o,ae=new n.o,oe=new n.o;k.extractEdges=function(e){var t=e.vertices,r=e.dim,i=ee,a=i.position0,o=i.position1,s=i.faceNormal0,_=i.faceNormal1,E=function(e){for(var t=e.faces.length/3,r=e.vertices,i=e.dim,a=e.faces,o=new Float32Array(3*t),s=0;s<t;s++){var _=a[3*s+0],E=a[3*s+1],f=a[3*s+2];ie.x=r[i*_],ie.y=r[i*_+1],ie.z=r[i*_+2],ae.x=r[i*E],ae.y=r[i*E+1],ae.z=r[i*E+2],oe.x=r[i*f],oe.y=r[i*f+1],oe.z=r[i*f+2],n.o.subtract(ae,ie,ae),n.o.subtract(oe,ie,oe),n.o.cross(ae,oe,ie),T=void 0,(T=(u=ie).x*u.x+u.y*u.y+u.z*u.z)>0&&(T=1/Math.sqrt(T),u.x*=T,u.y*=T,u.z*=T),o[3*s+0]=ie.x,o[3*s+1]=ie.y,o[3*s+2]=ie.z}var u,T;return o}(e),f=function(e){var t=e.faces.length/3,r=e.faces,n=e.neighbors,i=0,a=0;for(a=0;a<t;a++){var o=n[3*a+0],s=n[3*a+1],_=n[3*a+2],E=r[3*a+0],f=r[3*a+1],u=r[3*a+2];i+=-1===o||E<f?1:0,i+=-1===s||f<u?1:0,i+=-1===_||u<E?1:0}var T=new Int32Array(4*i),A=0;for(a=0;a<t;a++)o=n[3*a+0],s=n[3*a+1],_=n[3*a+2],E=r[3*a+0],f=r[3*a+1],u=r[3*a+2],(-1===o||E<f)&&(T[A++]=E,T[A++]=f,T[A++]=a,T[A++]=o),(-1===s||f<u)&&(T[A++]=f,T[A++]=u,T[A++]=a,T[A++]=s),(-1===_||u<E)&&(T[A++]=u,T[A++]=E,T[A++]=a,T[A++]=_);return T}(e),u=f.length/4,T=new Float32Array(9*u),A=0,c=new Float32Array(12*u),y=0,R=0,p=0,d=function(e,t){0===t&&(t=e,e=0);for(var r=Array(t-e),n=e;n<t;n++)r[n-e]=n;return r}(0,u),h=new Float32Array(u);h.forEach((function(e,i,s){var _=f[4*i+0],E=f[4*i+1];a.x=t[_*r],a.y=t[_*r+1],a.z=t[_*r+2],o.x=t[E*r],o.y=t[E*r+1],o.z=t[E*r+2],s[i]=n.o.distance(a,o)})),d.sort((function(e,t){return h[t]-h[e]}));for(var I=[],O=[],S=0;S<u;S++){var N=d[S],l=h[N],D=f[4*N+0],L=f[4*N+1],g=f[4*N+2],U=f[4*N+3],B=-1===U;if(a.x=t[D*r],a.y=t[D*r+1],a.z=t[D*r+2],o.x=t[L*r],o.y=t[L*r+1],o.z=t[L*r+2],B)s.x=E[3*g],s.y=E[3*g+1],s.z=E[3*g+2],_.x=s.x,_.y=s.y,_.z=s.z,i.cosAngle=n.o.dot(s,_);else if(s.x=E[3*g],s.y=E[3*g+1],s.z=E[3*g+2],_.x=E[3*U],_.y=E[3*U+1],_.z=E[3*U+2],i.cosAngle=n.o.dot(s,_),i.cosAngle>J)continue;R+=l,p++,B||i.cosAngle<Z?(T[A++]=i.position0.x,T[A++]=i.position0.y,T[A++]=i.position0.z,T[A++]=i.position1.x,T[A++]=i.position1.y,T[A++]=i.position1.z,T[A++]=i.faceNormal0.x,T[A++]=i.faceNormal0.y,T[A++]=i.faceNormal0.z,I.push(l)):ne(i,$)&&(c[y++]=i.position0.x,c[y++]=i.position0.y,c[y++]=i.position0.z,c[y++]=i.position1.x,c[y++]=i.position1.y,c[y++]=i.position1.z,c[y++]=i.faceNormal0.x,c[y++]=i.faceNormal0.y,c[y++]=i.faceNormal0.z,c[y++]=i.faceNormal1.x,c[y++]=i.faceNormal1.y,c[y++]=i.faceNormal1.z,O.push(l))}T=T.slice(0,A),c=c.slice(0,y);var P=R/p,C=I.length,b=O.length;return{regular:{instancesData:T,instanceCount:C,edgeLength:C*P},silhouette:{instancesData:c,instanceCount:b,edgeLength:b*P},averageEdgeLength:P}};var se,_e=(se=!0,function(e,t){var r=se?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return se=!1,r}),Ee=_e(void 0,(function(){return Ee.toString().search("(((.+)+)+)+$").toString().constructor(Ee).search("(((.+)+)+)+$")}));function fe(e){}function ue(e){if(r.e(e.cachedSidenessVertexBuffer))return e.cachedSidenessVertexBuffer;var t=new Float32Array(8),n=0;return t[n++]=0,t[n++]=0,t[n++]=0,t[n++]=1,t[n++]=1,t[n++]=1,t[n++]=1,t[n++]=0,e.cachedSidenessVertexBuffer=H.createVertexBuffer({context:e,typedArray:t,usage:S.STATIC_DRAW}),e.cachedSidenessVertexBuffer.vertexArrayDestroyable=!1,e.cachedSidenessVertexBuffer}function Te(e,t){for(var r,i,a,o=t.componentsPerAttribute,s=e.vertCompressConstant,_=new n.o(e.minVerticesValue.x,e.minVerticesValue.y,e.minVerticesValue.z),E=new Uint16Array(t.typedArray.buffer,t.typedArray.byteOffset,t.typedArray.byteLength/2),f=new Float32Array(3*e.verticesCount),u=0;u<e.verticesCount;u++)r=E[o*u]*s+_.x,i=E[o*u+1]*s+_.y,a=E[o*u+2]*s+_.z,f[3*u]=r,f[3*u+1]=i,f[3*u+2]=a;return f}Ee(),fe.RegularInstanceStride=12,fe.SilhouetteInstanceStride=15,fe.createEdgeData=function(e,t,n){if(0==t.length)return null;var i,a=t[0];i=0===a.indexType?new Uint16Array(a.indicesTypedArray.buffer,a.indicesTypedArray.byteOffset,a.indicesTypedArray.byteLength/2):new Uint32Array(a.indicesTypedArray.buffer,a.indicesTypedArray.byteOffset,a.indicesTypedArray.byteLength/4);var o=fe.extractEdgeInformation(e,!1,i),s=k.extractEdges(o);return r.e(n)&&(r.e(s.regular.instancesData)&&n.push(s.regular.instancesData.buffer),r.e(s.silhouette.instancesData)&&n.push(s.silhouette.instancesData.buffer)),s},fe.createIndexBuffer=function(e){return r.e(e.cachedSidenessIndexBuffer)||(e.cachedSidenessIndexBuffer=H.createIndexBuffer({context:e,typedArray:(t=new Uint16Array(6),n=0,t[n++]=2,t[n++]=1,t[n++]=0,t[n++]=3,t[n++]=2,t[n++]=0,t),usage:S.STATIC_DRAW,indexDatatype:a.IndexDatatype.UNSIGNED_SHORT}),e.cachedSidenessIndexBuffer.vertexArrayDestroyable=!1),e.cachedSidenessIndexBuffer;var t,n},fe.createRegularEdgeAttributes=function(e,t,n){if(r.e(t.instancesData)&&0!=t.instancesData.length){var i={},a=[];t.attributeLocations=i,t.attributes=a;var o=H.createVertexBuffer({context:e,typedArray:t.instancesData,usage:S.STATIC_DRAW});t.instancesData=null;var s=_.ComponentDatatype.getSizeInBytes(_.ComponentDatatype.FLOAT),E=ue(e),f=0;i.aSideness=f++,a.push({name:"aSideness",index:i.aSideness,vertexBuffer:E,componentsPerAttribute:2,componentDatatype:_.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:2*_.ComponentDatatype.getSizeInBytes(_.ComponentDatatype.FLOAT),normalize:!1});var u=n||fe.RegularInstanceStride,T=0;i.aPosition0=f++,a.push({name:"aPosition0",index:i.aPosition0,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*T,strideInBytes:s*u,instanceDivisor:1}),T+=3,i.aPosition1=f++,a.push({name:"aPosition1",index:i.aPosition1,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*T,strideInBytes:s*u,instanceDivisor:1}),T+=3,i.aNormal=f++,a.push({name:"aNormal",index:i.aNormal,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*T,strideInBytes:s*u,instanceDivisor:1}),T+=3,i.batchId=f++,a.push({name:"batchId",index:i.batchId,vertexBuffer:o,componentsPerAttribute:1,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*T,strideInBytes:s*u,instanceDivisor:1}),T+=1,i.aVariantStroke=f++,a.push({name:"aVariantStroke",index:i.aVariantStroke,vertexBuffer:o,componentsPerAttribute:1,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*T,strideInBytes:s*u,instanceDivisor:1}),T+=1,i.aVariantExtension=f++,a.push({name:"aVariantExtension",index:i.aVariantExtension,vertexBuffer:o,componentsPerAttribute:1,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*T,strideInBytes:s*u,instanceDivisor:1}),T+=1}},fe.createSilhouetteEdgeAttributes=function(e,t){if(r.e(t.instancesData)&&0!=t.instancesData.length){var n={},i=[];t.attributeLocations=n,t.attributes=i;var a=H.createVertexBuffer({context:e,typedArray:t.instancesData,usage:S.STATIC_DRAW});t.instancesData=null;var o=_.ComponentDatatype.getSizeInBytes(_.ComponentDatatype.FLOAT),s=0;n.aSideness=s++,i.push({name:"aSideness",index:n.aSideness,vertexBuffer:ue(e),componentsPerAttribute:2,componentDatatype:_.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:2*o,normalize:!1});var E=fe.SilhouetteInstanceStride,f=0;n.aPosition0=s++,i.push({name:"aPosition0",index:n.aPosition0,vertexBuffer:a,componentsPerAttribute:3,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:o*f,strideInBytes:o*E,instanceDivisor:1}),f+=3,n.aPosition1=s++,i.push({name:"aPosition1",index:n.aPosition1,vertexBuffer:a,componentsPerAttribute:3,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:o*f,strideInBytes:o*E,instanceDivisor:1}),f+=3,n.aNormalA=s++,i.push({name:"aNormalA",index:n.aNormalA,vertexBuffer:a,componentsPerAttribute:3,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:o*f,strideInBytes:o*E,instanceDivisor:1}),f+=3,n.aNormalB=s++,i.push({name:"aNormalB",index:n.aNormalB,vertexBuffer:a,componentsPerAttribute:3,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:o*f,strideInBytes:o*E,instanceDivisor:1}),f+=3,n.batchId=s++,i.push({name:"batchId",index:n.batchId,vertexBuffer:a,componentsPerAttribute:1,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:o*f,strideInBytes:o*E,instanceDivisor:1}),f+=1,n.aVariantStroke=s++,i.push({name:"aVariantStroke",index:n.aVariantStroke,vertexBuffer:a,componentsPerAttribute:1,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:o*f,strideInBytes:o*E,instanceDivisor:1}),f+=1,n.aVariantExtension=s++,i.push({name:"aVariantExtension",index:n.aVariantExtension,vertexBuffer:a,componentsPerAttribute:1,componentDatatype:_.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:o*f,strideInBytes:o*E,instanceDivisor:1}),f+=1}},fe.extractEdgeInformation=function(e,t,n){var i,a=e.attrLocation.aPosition,o=e.vertexAttributes[a],s=r.e(e.nCompressOptions)&&(e.nCompressOptions&h.SVC_Vertex)===h.SVC_Vertex,_=o.componentsPerAttribute;s?(_=3,i=Te(e,o)):i=new Float32Array(o.typedArray.buffer,o.typedArray.byteOffset,o.typedArray.byteLength/4);var E=i.length/_;if(t&&n)return{faces:n,neighbors:W.computeNeighbors(n,E),vertices:i,dim:_};var f,u=o.typedArray.buffer;f=s?i.buffer:u.slice(o.typedArray.byteOffset,o.typedArray.byteOffset+o.typedArray.byteLength);var T=W.deduplicate(f,_),A=fe.selectIndexData(T.indices,n);return{faces:A,neighbors:W.computeNeighbors(A,T.uniqueCount),vertices:new Float32Array(T.buffer),dim:_}},fe.selectIndexData=function(e,t){if(t){t=t.slice();for(var r=0;r<t.length;r++)t[r]=e[t[r]];return t}return e};var Ae=new n.o,ce=new n.o,ye=new n.o,Re=new n.o,pe=new n.o,de=new n.o,he=new n.o,Ie=new n.o;function Oe(e,t){function n(e,t,r){var n=48217*e%2147483647,i=t+n/2147483647*(r-=t);return{seed:n,result:Math.round(i)}}var i=function(e,t){var r=new Float32Array(6),n=new Uint32Array(r.buffer),i=new Uint32Array(1);r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=t.x,r[4]=t.y,r[5]=t.z,i[0]=5381;for(var a=0;a<n.length;a++)i[0]=31*i[0]+n[a];return i[0]}(e,t);r.e(i)||(i=2147483647*Math.random());var a=n(i,0,255);i=a.seed,a.result,i=(a=n(i,0,5)).seed;var o,s=a.result;i=(a={seed:o=48217*i%2147483647,result:o/2147483646}).seed;var _=a.result;return _=-(1-Math.min(_/.7,1))+Math.max(0,_-.7)/(1-.7),{variantStroke:s,variantExtension:_=255*(Math.abs(_)**1.2*(0>_?-1:1)*.5+.5)}}fe.createEdgeDataByIndices=function(e,t){var i,a,o=e.attrLocation.aPosition,s=e.vertexAttributes[o],_=r.e(e.nCompressOptions)&&(e.nCompressOptions&h.SVC_Vertex)===h.SVC_Vertex,E=s.componentsPerAttribute;_?(E=3,i=Te(e,s)):i=new Float32Array(s.typedArray.buffer,s.typedArray.byteOffset,s.typedArray.byteLength/4);for(var f=[],u=[],T=(a=0===t.indexType?new Uint16Array(t.indicesTypedArray.buffer,t.indicesTypedArray.byteOffset,t.indicesTypedArray.byteLength/2):new Uint32Array(t.indicesTypedArray.buffer,t.indicesTypedArray.byteOffset,t.indicesTypedArray.byteLength/4)).length,A=0,c=0,y=4*Math.floor(T/4);c<y;c+=4){var R=a[c],p=a[c+1],d=a[c+2],I=a[c+3];if(Ae.x=i[E*R],Ae.y=i[E*R+1],Ae.z=i[E*R+2],ce.x=i[E*p],ce.y=i[E*p+1],ce.z=i[E*p+2],ye.x=i[E*d],ye.y=i[E*d+1],ye.z=i[E*d+2],Re.x=i[E*I],Re.y=i[E*I+1],Re.z=i[E*I+2],!(n.o.equals(ce,ye)||n.o.equals(ce,Re)||n.o.equals(ce,Ae)||n.o.equals(ye,Ae)||n.o.equals(Re,Ae))){if(d===I){if(n.o.subtract(ce,Ae,pe),n.o.subtract(ye,Ae,de),n.o.cross(pe,de,pe),n.o.equals(pe,n.o.ZERO))continue;n.o.normalize(pe,pe),f.push(Ae.x),f.push(Ae.y),f.push(Ae.z),f.push(ce.x),f.push(ce.y),f.push(ce.z),f.push(pe.x),f.push(pe.y),f.push(pe.z),f.push(R);var O=(N=Oe(Ae,ce)).variantStroke,S=N.variantExtension;f.push(O),f.push(S)}else{if(n.o.subtract(ce,Ae,pe),n.o.subtract(ye,Ae,de),n.o.cross(pe,de,pe),n.o.equals(pe,n.o.ZERO)||(n.o.normalize(pe,pe),n.o.subtract(ce,Ae,he),n.o.subtract(Re,Ae,Ie),n.o.cross(Ie,he,he),n.o.equals(he,n.o.ZERO)))continue;n.o.normalize(he,he),u.push(Ae.x),u.push(Ae.y),u.push(Ae.z),u.push(ce.x),u.push(ce.y),u.push(ce.z),u.push(pe.x),u.push(pe.y),u.push(pe.z),u.push(he.x),u.push(he.y),u.push(he.z),u.push(R);var N;O=(N=Oe(Ae,ce)).variantStroke,S=N.variantExtension;u.push(O),u.push(S)}A+=n.o.distance(Ae,ce)}}var l=A/(T/4),D=f.length/fe.RegularInstanceStride,L=u.length/fe.SilhouetteInstanceStride;return{regular:{instancesData:new Float32Array(f),instanceCount:D,edgeLength:D*l},silhouette:{instancesData:new Float32Array(u),instanceCount:L,edgeLength:L},averageEdgeLength:l}},e.L=u,e.S3MCompressType=R,e.VertexCompressOption=h,e._0x30c9ea=fe}));
