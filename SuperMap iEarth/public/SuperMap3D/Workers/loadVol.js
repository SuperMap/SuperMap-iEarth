define(["./createTaskProcessorWorker","./Cartesian3-c1138337","./Cartesian4-5c264813","./pako_inflate-e5e032ee","./Rectangle-52f780a9","./defaultValue-2110bb17","./Check-92c551fb","./Math-cd1437d9","./Cartographic-630e5de6","./Ellipsoid-ca2b8eb1"],(function(e,t,a,l,n,r,i,h,o,c){"use strict";var d,u=(d=!0,function(e,t){var a=d?function(){if(t){var a=t.apply(e,arguments);return t=null,a}}:function(){};return d=!1,a}),s=u(void 0,(function(){return s.toString().search("(((.+)+)+)+$").toString().constructor(s).search("(((.+)+)+)+$")}));s();var _=Object.freeze({UNLOAD:0,LOADING:1,LOADED:2,VOLLOADED:3,PARSING:4,PARSED:5,TRANSFORMING:6,TRANSFORMED:7,LOST:8,LOADVOL:9,FAILED:10,VOLFAILED:11});function f(e){var a=new t.o(1,255,65025);(a=t.o.multiplyByScalar(a,e,a)).x=a.x-Math.floor(a.x),a.y=a.y-Math.floor(a.y),a.z=a.z-Math.floor(a.z);var l=new t.o,n=new t.o(1/255,1/255,0);return l.x=a.y*n.x,l.y=a.z*n.y,l.z=a.z*n.z,a=t.o.subtract(a,l,a)}function g(e,t,l,n){for(var r=e._nLength*e._nLength*4,i=new Array(r),h=l-t,o=t,c=0;c<e.cellDepth;c++)for(var d=parseInt(c/e._nSideBlockCount)*e._nBlockLength,u=c%e._nSideBlockCount*e._nBlockLength,s=-1;s<e._nBlockLength-1;s++)for(var _=-1;_<e._nBlockLength-1;_++){var g=Math.min(_,e.validWidth-1),v=Math.min(s,e.validHeight-1);g=Math.max(0,g),v=Math.max(0,v);var y,p,L=0;if(e.ySpan>0&&(L=e.validHeight-e.cellHeight),g<e.cellWidth&&v>=L?(p=0,y=c*e.cellHeight*e.cellWidth+(e.validHeight-1-v)*e.cellWidth+g):g<e.cellWidth?(p=0==e.xSpan?1:2,y=c*e.cellHeight*e.cellWidth+(e.validHeight-e.cellHeight-1-v)*e.cellWidth+g):v>=L?(p=1,y=c*e.cellHeight*e.cellWidth+(e.validHeight-1-v)*e.cellWidth+g-e.cellWidth):(p=3,y=c*e.cellHeight*e.cellWidth+(e.validHeight-e.cellHeight-1-v)*e.cellWidth+g-e.cellWidth),!(y<0)){var x=n[p][y],B=new a.e(0,0,0,0);if(-9999!=x){x<t||x>l?x=o:o=x;var w=f(x=(x-t)/h);B.x=w.x,B.y=w.y,B.z=w.z,B.w=1}var W=255*B.x,S=255*B.y,D=255*B.z,H=255*B.w;i[4*(y=(d+s)*e._nLength+u+_)]=parseInt(W),i[4*y+1]=parseInt(S),i[4*y+2]=parseInt(D),i[4*y+3]=parseInt(H)}}return new Uint8Array(i,0,r)}return e((function(e,t){for(var r=e.arrayWork,i=[],h=0;h<r.length;h++)if(r[h]._s3mLoadState===_.LOADED){var o=r[h]._arrayBuffer.slice(16,r[h]._arrayBuffer.byteLength),c=l.pako.inflate(o).buffer;r[h]._arrayBuffer=c,r[h]._s3mLoadState=_.TRANSFORMED,i.push({index:h,buffer:c})}var d=e.textureLevel,u=e._availableNode,s=e._time,f=e._layerBounds,v=e._minFiltration,y=e._maxFiltration;d.cellWidth=e._cellWidth,d.cellHeight=e._cellHeight,d.cellDepth=e._cellDepth;var p=function(e,t,l,r,i,h,o){for(var c=e.length,d=[],u=0;u<c;u++)d.push(e[u]._arrayBuffer.slice(36,e[u]._arrayBuffer.byteLength));var s=4*t.cellWidth*t.cellHeight*t.cellDepth,_=e[0],f=e[c-1],v=t.cellWidth,y=t.cellHeight;o.EndCol-1==f._x&&(v=o.Width-f._x*v),o.EndRow-1==f._y&&(y=o.Height-f._y*y),t.startCol=_._x,t.startRow=_._y,t.endCol=f._x,t.endRow=f._y,t.ySpan=f._y-_._y,t.xSpan=f._x-_._x,t.ySpan>0&&(y+=t.cellHeight),t.xSpan>0&&(v+=t.cellWidth),t._nSideBlockCount=Math.ceil(Math.sqrt(t.cellDepth)),t._nBlockLength=Math.max(y,v)+2,t._nLength=function(e){for(var t=1;t<e;)t<<=1;return t}(t._nBlockLength*t._nSideBlockCount-2),t.validWidth=v,t.validHeight=y,t.bounds=new n.h(_._dataBounds.west,f._dataBounds.south,f._dataBounds.east,_._dataBounds.north);var p=new n.h(r.west,r.south,r.east,r.north);t.multiResolutionTranslation=new a.e((_._dataBounds.west-p.west)/p.width,(f._dataBounds.south-p.south)/p.height,p.width/t.bounds.width,p.height/t.bounds.height);for(var L=[],x=0;x<l;x++){var B=[];for(u=0;u<d.length;u++){var w=new Float32Array(d[u].slice(x*s,(x+1)*s));B.push(w)}L.push(g(t,i,h,B))}return L}(r,d,s,f,v,y,u);return{textureLevel:d,imageDatas:p,unzipTile:i}}))}));
