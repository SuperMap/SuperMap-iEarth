import{a as E}from"./chunk-RYEDLSXB.js";import{a as u}from"./chunk-EUSYH4JF.js";import{a as _e}from"./chunk-UIA2BV6O.js";import{b as B,d as we,g as A,k as se,l as $}from"./chunk-CJHFPVIB.js";import{a as b,b as ve}from"./chunk-SSYG2MIY.js";import{a as X}from"./chunk-SRPTWKHW.js";import{a as W}from"./chunk-Z4SOZDEW.js";import{a as g}from"./chunk-ZVKIUA3Y.js";import{a}from"./chunk-LBR6REQR.js";import{a as O}from"./chunk-GXFCHGTA.js";import{a as m}from"./chunk-UBHQMGET.js";import{a as F}from"./chunk-EDZQSM3T.js";import{a as _}from"./chunk-PJGSCWXZ.js";import{a as n}from"./chunk-NUC3LT2W.js";function q(e){this.planes=m(e,[])}var te=[new a,new a,new a];a.clone(a.UNIT_X,te[0]);a.clone(a.UNIT_Y,te[1]);a.clone(a.UNIT_Z,te[2]);var L=new a,Oe=new a,le=new u(new a(1,0,0),0);q.fromBoundingSphere=function(e,t){if(!n(e))throw new _("boundingSphere is required.");n(t)||(t=new q);var i=te.length,f=t.planes;f.length=2*i;for(var h=e.center,v=e.radius,s=0,d=0;d<i;++d){var r=te[d],o=f[s],y=f[s+1];n(o)||(o=f[s]=new g),n(y)||(y=f[s+1]=new g),a.multiplyByScalar(r,-v,L),a.add(h,L,L),o.x=r.x,o.y=r.y,o.z=r.z,o.w=-a.dot(r,L),a.multiplyByScalar(r,v,L),a.add(h,L,L),y.x=-r.x,y.y=-r.y,y.z=-r.z,y.w=-a.dot(a.negate(r,Oe),L),s+=2}return t};q.prototype.computeVisibility=function(e){if(!n(e))throw new _("boundingVolume is required.");for(var t=this.planes,i=!1,f=0,h=t.length;f<h;++f){var v=e.intersectPlane(u.fromCartesian4(t[f],le));if(v===B.OUTSIDE)return B.OUTSIDE;v===B.INTERSECTING&&(i=!0)}return i?B.INTERSECTING:B.INSIDE};q.prototype.computeVisibilityWithPlaneMask=function(e,t){if(!n(e))throw new _("boundingVolume is required.");if(!n(t))throw new _("parentPlaneMask is required.");if(t===q.MASK_OUTSIDE||t===q.MASK_INSIDE)return t;for(var i=q.MASK_INSIDE,f=this.planes,h=0,v=f.length;h<v;++h){var s=h<31?1<<h:0;if(!(h<31&&(t&s)===0)){var d=e.intersectPlane(u.fromCartesian4(f[h],le));if(d===B.OUTSIDE)return q.MASK_OUTSIDE;d===B.INTERSECTING&&(i|=s)}}return i};q.MASK_OUTSIDE=4294967295;q.MASK_INSIDE=0;q.MASK_INDETERMINATE=2147483647;var ne=q;function V(e){e=m(e,m.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=m(e.near,1),this._near=this.near,this.far=m(e.far,5e8),this._far=this.far,this._cullingVolume=new ne,this._orthographicMatrix=new b}function me(e){if(!n(e.right)||!n(e.left)||!n(e.top)||!n(e.bottom)||!n(e.near)||!n(e.far))throw new _("right, left, top, bottom, near, or far parameters are not set.");if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right)throw new _("right must be greater than left.");if(e.bottom>e.top)throw new _("top must be greater than bottom.");if(e.near>e.far)throw new _("near must be greater than zero and less than far.");e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=b.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}Object.defineProperties(V.prototype,{projectionMatrix:{get:function(){return me(this),this._orthographicMatrix}}});var xe=new a,Fe=new a,Me=new a,he=new a;V.prototype.computeCullingVolume=function(e,t,i){if(!n(e))throw new _("position is required.");if(!n(t))throw new _("direction is required.");if(!n(i))throw new _("up is required.");var f=this._cullingVolume.planes,h=this.top,v=this.bottom,s=this.right,d=this.left,r=this.near,o=this.far,y=a.cross(t,i,xe);a.normalize(y,y);var P=Fe;a.multiplyByScalar(t,r,P),a.add(e,P,P);var l=Me;a.multiplyByScalar(y,d,l),a.add(P,l,l);var c=f[0];return n(c)||(c=f[0]=new g),c.x=y.x,c.y=y.y,c.z=y.z,c.w=-a.dot(y,l),a.multiplyByScalar(y,s,l),a.add(P,l,l),c=f[1],n(c)||(c=f[1]=new g),c.x=-y.x,c.y=-y.y,c.z=-y.z,c.w=-a.dot(a.negate(y,he),l),a.multiplyByScalar(i,v,l),a.add(P,l,l),c=f[2],n(c)||(c=f[2]=new g),c.x=i.x,c.y=i.y,c.z=i.z,c.w=-a.dot(i,l),a.multiplyByScalar(i,h,l),a.add(P,l,l),c=f[3],n(c)||(c=f[3]=new g),c.x=-i.x,c.y=-i.y,c.z=-i.z,c.w=-a.dot(a.negate(i,he),l),c=f[4],n(c)||(c=f[4]=new g),c.x=t.x,c.y=t.y,c.z=t.z,c.w=-a.dot(t,P),a.multiplyByScalar(t,o,l),a.add(e,l,l),c=f[5],n(c)||(c=f[5]=new g),c.x=-t.x,c.y=-t.y,c.z=-t.z,c.w=-a.dot(a.negate(t,he),l),this._cullingVolume};V.prototype.getPixelDimensions=function(e,t,i,f,h){if(me(this),!n(e)||!n(t))throw new _("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new _("drawingBufferWidth must be greater than zero.");if(t<=0)throw new _("drawingBufferHeight must be greater than zero.");if(!n(i))throw new _("distance is required.");if(!n(f))throw new _("pixelRatio is required.");if(f<=0)throw new _("pixelRatio must be greater than zero.");if(!n(h))throw new _("A result object is required.");var v=this.right-this.left,s=this.top-this.bottom,d=f*v/e,r=f*s/t;return h.x=d,h.y=r,h};V.prototype.clone=function(e){return n(e)||(e=new V),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};V.prototype.equals=function(e){return n(e)&&e instanceof V&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};V.prototype.equalsEpsilon=function(e,t,i){return e===this||n(e)&&e instanceof V&&O.equalsEpsilon(this.right,e.right,t,i)&&O.equalsEpsilon(this.left,e.left,t,i)&&O.equalsEpsilon(this.top,e.top,t,i)&&O.equalsEpsilon(this.bottom,e.bottom,t,i)&&O.equalsEpsilon(this.near,e.near,t,i)&&O.equalsEpsilon(this.far,e.far,t,i)};var de=V;function R(e){e=m(e,m.EMPTY_OBJECT),this._offCenterFrustum=new de,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=m(e.near,1),this._near=this.near,this.far=m(e.far,5e8),this._far=this.far}R.packedLength=4;R.pack=function(e,t,i){return F.typeOf.object("value",e),F.defined("array",t),i=m(i,0),t[i++]=e.width,t[i++]=e.aspectRatio,t[i++]=e.near,t[i]=e.far,t};R.unpack=function(e,t,i){return F.defined("array",e),t=m(t,0),n(i)||(i=new R),i.width=e[t++],i.aspectRatio=e[t++],i.near=e[t++],i.far=e[t],i};function K(e){if(!n(e.width)||!n(e.aspectRatio)||!n(e.near)||!n(e.far))throw new _("width, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){if(e.aspectRatio<0)throw new _("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new _("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;var i=1/e.aspectRatio;t.right=e.width*.5,t.left=-t.right,t.top=i*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}Object.defineProperties(R.prototype,{projectionMatrix:{get:function(){return K(this),this._offCenterFrustum.projectionMatrix}}});R.prototype.computeCullingVolume=function(e,t,i){return K(this),this._offCenterFrustum.computeCullingVolume(e,t,i)};R.prototype.getPixelDimensions=function(e,t,i,f,h){return K(this),this._offCenterFrustum.getPixelDimensions(e,t,i,f,h)};R.prototype.clone=function(e){return n(e)||(e=new R),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e};R.prototype.equals=function(e){return!n(e)||!(e instanceof R)?!1:(K(this),K(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};R.prototype.equalsEpsilon=function(e,t,i){return!n(e)||!(e instanceof R)?!1:(K(this),K(e),O.equalsEpsilon(this.width,e.width,t,i)&&O.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,i))};var j=R;function S(e){e=m(e,m.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=m(e.near,1),this._near=this.near,this.far=m(e.far,5e8),this._far=this.far,this._cullingVolume=new ne,this._perspectiveMatrix=new b,this._infinitePerspective=new b}function pe(e){if(!n(e.right)||!n(e.left)||!n(e.top)||!n(e.bottom)||!n(e.near)||!n(e.far))throw new _("right, left, top, bottom, near, or far parameters are not set.");var t=e.top,i=e.bottom,f=e.right,h=e.left,v=e.near,s=e.far;if(t!==e._top||i!==e._bottom||h!==e._left||f!==e._right||v!==e._near||s!==e._far){if(e.near<=0||e.near>e.far)throw new _("near must be greater than zero and less than far.");e._left=h,e._right=f,e._top=t,e._bottom=i,e._near=v,e._far=s,e._perspectiveMatrix=b.computePerspectiveOffCenter(h,f,i,t,v,s,e._perspectiveMatrix),e._infinitePerspective=b.computeInfinitePerspectiveOffCenter(h,f,i,t,v,e._infinitePerspective)}}Object.defineProperties(S.prototype,{projectionMatrix:{get:function(){return pe(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return pe(this),this._infinitePerspective}}});var Re=new a,ze=new a,Te=new a,qe=new a;S.prototype.resetProjectionMatrix=function(){if(!n(this.right)||!n(this.left)||!n(this.top)||!n(this.bottom)||!n(this.near)||!n(this.far))throw new _("right, left, top, bottom, near, or far parameters are not set.");var e=this.top,t=this.bottom,i=this.right,f=this.left,h=this.near,v=this.far;if(this.near<=0||this.near>this.far)throw new _("near must be greater than zero and less than far.");this._left=f,this._right=i,this._top=e,this._bottom=t,this._near=h,this._far=v,this._perspectiveMatrix=b.computePerspectiveOffCenter(f,i,t,e,h,v,this._perspectiveMatrix),this._infinitePerspective=b.computeInfinitePerspectiveOffCenter(f,i,t,e,h,this._infinitePerspective)};S.prototype.computeCullingVolume=function(e,t,i,f){if(!n(e))throw new _("position is required.");if(!n(t))throw new _("direction is required.");if(!n(i))throw new _("up is required.");var h=this._cullingVolume.planes,v=m(f,0);v=Math.min(v,.5),v=Math.max(v,0);var s=this.top+this.top*v,d=this.bottom-this.top*v,r=this.right+this.right*v,o=this.left-this.right*v,y=this.near,P=this.far,l=a.cross(t,i,Re),c=ze;a.multiplyByScalar(t,y,c),a.add(e,c,c);var x=Te;a.multiplyByScalar(t,P,x),a.add(e,x,x);var p=qe;a.multiplyByScalar(l,o,p),a.add(c,p,p),a.subtract(p,e,p),a.normalize(p,p),a.cross(p,i,p),a.normalize(p,p);var w=h[0];return n(w)||(w=h[0]=new g),w.x=p.x,w.y=p.y,w.z=p.z,w.w=-a.dot(p,e),a.multiplyByScalar(l,r,p),a.add(c,p,p),a.subtract(p,e,p),a.cross(i,p,p),a.normalize(p,p),w=h[1],n(w)||(w=h[1]=new g),w.x=p.x,w.y=p.y,w.z=p.z,w.w=-a.dot(p,e),a.multiplyByScalar(i,d,p),a.add(c,p,p),a.subtract(p,e,p),a.cross(l,p,p),a.normalize(p,p),w=h[2],n(w)||(w=h[2]=new g),w.x=p.x,w.y=p.y,w.z=p.z,w.w=-a.dot(p,e),a.multiplyByScalar(i,s,p),a.add(c,p,p),a.subtract(p,e,p),a.cross(p,l,p),a.normalize(p,p),w=h[3],n(w)||(w=h[3]=new g),w.x=p.x,w.y=p.y,w.z=p.z,w.w=-a.dot(p,e),w=h[4],n(w)||(w=h[4]=new g),w.x=t.x,w.y=t.y,w.z=t.z,w.w=-a.dot(t,c),a.negate(t,p),w=h[5],n(w)||(w=h[5]=new g),w.x=p.x,w.y=p.y,w.z=p.z,w.w=-a.dot(p,x),this._cullingVolume};S.prototype.getPixelDimensions=function(e,t,i,f,h){if(pe(this),!n(e)||!n(t))throw new _("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new _("drawingBufferWidth must be greater than zero.");if(t<=0)throw new _("drawingBufferHeight must be greater than zero.");if(!n(i))throw new _("distance is required.");if(!n(f))throw new _("pixelRatio is required");if(f<=0)throw new _("pixelRatio must be greater than zero.");if(!n(h))throw new _("A result object is required.");var v=1/this.near,s=this.top*v,d=2*f*i*s/t;s=this.right*v;var r=2*f*i*s/e;return h.x=r,h.y=d,h};S.prototype.clone=function(e){return n(e)||(e=new S),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};S.prototype.equals=function(e){return n(e)&&e instanceof S&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};S.prototype.equalsEpsilon=function(e,t,i){return e===this||n(e)&&e instanceof S&&O.equalsEpsilon(this.right,e.right,t,i)&&O.equalsEpsilon(this.left,e.left,t,i)&&O.equalsEpsilon(this.top,e.top,t,i)&&O.equalsEpsilon(this.bottom,e.bottom,t,i)&&O.equalsEpsilon(this.near,e.near,t,i)&&O.equalsEpsilon(this.far,e.far,t,i)};var ye=S;function M(e){e=m(e,m.EMPTY_OBJECT),this._offCenterFrustum=new ye,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=m(e.near,1),this._near=this.near,this.far=m(e.far,5e8),this._far=this.far,this.xOffset=m(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=m(e.yOffset,0),this._yOffset=this.yOffset,this.reflect=!1}M.isNDCHalfZRange=!1;M.packedLength=6;M.pack=function(e,t,i){return F.typeOf.object("value",e),F.defined("array",t),i=m(i,0),t[i++]=e.fov,t[i++]=e.aspectRatio,t[i++]=e.near,t[i++]=e.far,t[i++]=e.xOffset,t[i]=e.yOffset,t};M.unpack=function(e,t,i){return F.defined("array",e),t=m(t,0),n(i)||(i=new M),i.fov=e[t++],i.aspectRatio=e[t++],i.near=e[t++],i.far=e[t++],i.xOffset=e[t++],i.yOffset=e[t],i};function k(e){if(!n(e.fov)||!n(e.aspectRatio)||!n(e.near)||!n(e.far))throw new _("fov, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI)throw new _("fov must be in the range [0, PI).");if(e.aspectRatio<0)throw new _("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new _("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:Math.atan(Math.tan(e.fov*.5)/e.aspectRatio)*2,e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset}}Object.defineProperties(M.prototype,{projectionMatrix:{get:function(){return k(this),this.reflect&&Se(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return k(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return k(this),this._fovy}},sseDenominator:{get:function(){return k(this),this._sseDenominator}}});M.prototype.resetProjectionMatrix=function(){return this._offCenterFrustum.resetProjectionMatrix()};M.prototype.computeCullingVolume=function(e,t,i,f){return k(this),this._offCenterFrustum.computeCullingVolume(e,t,i,f)};M.prototype.getPixelDimensions=function(e,t,i,f,h){return k(this),this._offCenterFrustum.getPixelDimensions(e,t,i,f,h)};M.prototype.clone=function(e){return n(e)||(e=new M),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e.reflect=this.reflect,e.clipPlane=this.clipPlane,e.currentViewMatrix=this.currentViewMatrix,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e};M.prototype.equals=function(e){return!n(e)||!(e instanceof M)?!1:(k(this),k(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};M.prototype.equalsEpsilon=function(e,t,i){return!n(e)||!(e instanceof M)?!1:(k(this),k(e),O.equalsEpsilon(this.fov,e.fov,t,i)&&O.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,i))};var Y=new u(a.UNIT_Z,1),ie=new g,I=new g,re=new g;function Se(e){if(!(!n(e.clipPlane)||!n(e.currentViewMatrix))){var t=e.currentViewMatrix,i=e._offCenterFrustum.projectionMatrix;b.multiplyByPlane(t,e.clipPlane,Y),ie.x=(O.sign(Y.normal.x)+i[8])/i[0],ie.y=(O.sign(Y.normal.y)+i[9])/i[5],ie.z=-1,ie.w=(1+i[10])/i[14],I.x=Y.normal.x,I.y=Y.normal.y,I.z=Y.normal.z,I.w=Y.distance,g.multiplyByScalar(I,2/g.dot(I,ie),re),i[2]=re.x,i[6]=re.y,i[10]=re.z+1,i[14]=re.w,b.halfZRange&&b.multiply(b.ConvertNDCToHalfZRange,i,i)}}var U=M;var fe=0,De=1;function G(e){F.typeOf.object("options",e),F.typeOf.object("options.frustum",e.frustum),F.typeOf.object("options.origin",e.origin),F.typeOf.object("options.orientation",e.orientation);var t=e.frustum,i=e.orientation,f=e.origin,h=m(e.vertexFormat,E.DEFAULT),v=m(e._drawNearPlane,!0),s,d;t instanceof U?(s=fe,d=U.packedLength):t instanceof j&&(s=De,d=j.packedLength),this._frustumType=s,this._frustum=t.clone(),this._origin=a.clone(f),this._orientation=A.clone(i),this._drawNearPlane=v,this._vertexFormat=h,this._workerName="createFrustumGeometry",this.packedLength=2+d+a.packedLength+A.packedLength+E.packedLength}G.pack=function(e,t,i){F.typeOf.object("value",e),F.defined("array",t),i=m(i,0);var f=e._frustumType,h=e._frustum;return t[i++]=f,f===fe?(U.pack(h,t,i),i+=U.packedLength):(j.pack(h,t,i),i+=j.packedLength),a.pack(e._origin,t,i),i+=a.packedLength,A.pack(e._orientation,t,i),i+=A.packedLength,E.pack(e._vertexFormat,t,i),i+=E.packedLength,t[i]=e._drawNearPlane?1:0,t};var Ve=new U,ke=new j,Ae=new A,Ee=new a,Ne=new E;G.unpack=function(e,t,i){F.defined("array",e),t=m(t,0);var f=e[t++],h;f===fe?(h=U.unpack(e,t,Ve),t+=U.packedLength):(h=j.unpack(e,t,ke),t+=j.packedLength);var v=a.unpack(e,t,Ee);t+=a.packedLength;var s=A.unpack(e,t,Ae);t+=A.packedLength;var d=E.unpack(e,t,Ne);t+=E.packedLength;var r=e[t]===1;if(!n(i))return new G({frustum:h,origin:v,orientation:s,vertexFormat:d,_drawNearPlane:r});var o=f===i._frustumType?i._frustum:void 0;return i._frustum=h.clone(o),i._frustumType=f,i._origin=a.clone(v,i._origin),i._orientation=A.clone(s,i._orientation),i._vertexFormat=E.clone(d,i._vertexFormat),i._drawNearPlane=r,i};function ee(e,t,i,f,h,v,s,d){for(var r=e/3*2,o=0;o<4;++o)n(t)&&(t[e]=v.x,t[e+1]=v.y,t[e+2]=v.z),n(i)&&(i[e]=s.x,i[e+1]=s.y,i[e+2]=s.z),n(f)&&(f[e]=d.x,f[e+1]=d.y,f[e+2]=d.z),e+=3;h[r]=0,h[r+1]=0,h[r+2]=1,h[r+3]=0,h[r+4]=1,h[r+5]=1,h[r+6]=0,h[r+7]=1}var Be=new W,Le=new b,ce=new b,ge=new a,Ce=new a,Pe=new a,je=new a,Ue=new a,He=new a,H=new Array(3),ae=new Array(4);ae[0]=new g(-1,-1,1,1);ae[1]=new g(1,-1,1,1);ae[2]=new g(1,1,1,1);ae[3]=new g(-1,1,1,1);var be=new Array(4);for(oe=0;oe<4;++oe)be[oe]=new g;var oe;G._computeNearFarPlanes=function(e,t,i,f,h,v,s,d){var r=W.fromQuaternion(t,Be),o=m(v,ge),y=m(s,Ce),P=m(d,Pe);o=W.getColumn(r,0,o),y=W.getColumn(r,1,y),P=W.getColumn(r,2,P),a.normalize(o,o),a.normalize(y,y),a.normalize(P,P),a.negate(o,o);var l=b.computeView(e,P,y,o,Le),c,x;if(i===fe){var p=f.projectionMatrix,w=b.multiply(p,l,ce);x=b.inverse(w,ce)}else c=b.inverseTransformation(l,ce);n(x)?(H[0]=f.near,H[1]=f.far):(H[0]=0,H[1]=f.near,H[2]=f.far);for(var z=0;z<2;++z)for(var T=0;T<4;++T){var C=g.clone(ae[T],be[T]);if(n(x)){C=b.multiplyByVector(x,C,C);var J=1/C.w;a.multiplyByScalar(C,J,C),a.subtract(C,e,C),a.normalize(C,C);var N=a.dot(P,C);a.multiplyByScalar(C,H[z]/N,C),a.add(C,e,C)}else{n(f._offCenterFrustum)&&(f=f._offCenterFrustum);var Z=H[z],D=H[z+1];C.x=(C.x*(f.right-f.left)+f.left+f.right)*.5,C.y=(C.y*(f.top-f.bottom)+f.bottom+f.top)*.5,C.z=(C.z*(Z-D)-Z-D)*.5,C.w=1,b.multiplyByVector(c,C,C)}h[12*z+T*3]=C.x,h[12*z+T*3+1]=C.y,h[12*z+T*3+2]=C.z}};G.createGeometry=function(e){var t=e._frustumType,i=e._frustum,f=e._origin,h=e._orientation,v=e._drawNearPlane,s=e._vertexFormat,d=v?6:5,r=new Float64Array(3*4*6);G._computeNearFarPlanes(f,h,t,i,r);var o=3*4*2;r[o]=r[3*4],r[o+1]=r[3*4+1],r[o+2]=r[3*4+2],r[o+3]=r[0],r[o+4]=r[1],r[o+5]=r[2],r[o+6]=r[3*3],r[o+7]=r[3*3+1],r[o+8]=r[3*3+2],r[o+9]=r[3*7],r[o+10]=r[3*7+1],r[o+11]=r[3*7+2],o+=3*4,r[o]=r[3*5],r[o+1]=r[3*5+1],r[o+2]=r[3*5+2],r[o+3]=r[3],r[o+4]=r[3+1],r[o+5]=r[3+2],r[o+6]=r[0],r[o+7]=r[1],r[o+8]=r[2],r[o+9]=r[3*4],r[o+10]=r[3*4+1],r[o+11]=r[3*4+2],o+=3*4,r[o]=r[3],r[o+1]=r[3+1],r[o+2]=r[3+2],r[o+3]=r[3*5],r[o+4]=r[3*5+1],r[o+5]=r[3*5+2],r[o+6]=r[3*6],r[o+7]=r[3*6+1],r[o+8]=r[3*6+2],r[o+9]=r[3*2],r[o+10]=r[3*2+1],r[o+11]=r[3*2+2],o+=3*4,r[o]=r[3*2],r[o+1]=r[3*2+1],r[o+2]=r[3*2+2],r[o+3]=r[3*6],r[o+4]=r[3*6+1],r[o+5]=r[3*6+2],r[o+6]=r[3*7],r[o+7]=r[3*7+1],r[o+8]=r[3*7+2],r[o+9]=r[3*3],r[o+10]=r[3*3+1],r[o+11]=r[3*3+2],v||(r=r.subarray(3*4));var y=new _e({position:new $({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:r})});if(n(s.normal)||n(s.tangent)||n(s.bitangent)||n(s.st)){var P=n(s.normal)?new Float32Array(12*d):void 0,l=n(s.tangent)?new Float32Array(3*4*d):void 0,c=n(s.bitangent)?new Float32Array(3*4*d):void 0,x=n(s.st)?new Float32Array(2*4*d):void 0,p=ge,w=Ce,z=Pe,T=a.negate(p,je),C=a.negate(w,Ue),Z=a.negate(z,He);o=0,v&&(ee(o,P,l,c,x,Z,p,w),o+=3*4),ee(o,P,l,c,x,z,T,w),o+=3*4,ee(o,P,l,c,x,T,Z,w),o+=3*4,ee(o,P,l,c,x,C,Z,T),o+=3*4,ee(o,P,l,c,x,p,z,w),o+=3*4,ee(o,P,l,c,x,w,z,T),n(P)&&(y.normal=new $({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:P})),n(l)&&(y.tangent=new $({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:l})),n(c)&&(y.bitangent=new $({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:c})),n(x)&&(y.st=new $({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:x}))}for(var D=new Uint16Array(6*d),J=0;J<d;++J){var N=J*6,Q=J*4;D[N]=Q,D[N+1]=Q+1,D[N+2]=Q+2,D[N+3]=Q,D[N+4]=Q+2,D[N+5]=Q+3}return new se({attributes:y,indices:D,primitiveType:ve.TRIANGLES,boundingSphere:we.fromVertices(r)})};var Xt=G;export{j as a,U as b,Xt as c};
