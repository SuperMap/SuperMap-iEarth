define(["exports","./S3MPixelFormat-6885e30a","./defaultValue-2110bb17","./Cartesian3-c1138337","./Check-92c551fb","./IndexDatatype-d833345d","./WebGLConstants-92042d9e","./PrimitiveType-d9ba7368","./ComponentDatatype-3cfb1146"],(function(e,t,r,n,i,a,o,s,f){"use strict";function _(e,t,r,n){var i=e|t<<8,a=i>>11&31,o=i>>5&63,s=31&i;return r[n+0]=a<<3|a>>2,r[n+1]=o<<2|o>>4,r[n+2]=s<<3|s>>2,r[n+3]=255,i}function E(e,t,r,n){var i=0;0!=(6&n)&&(i=8),function(e,t,r,n){for(var i=new Uint8Array(16),a=_(t[r+0],t[r+1],i,0),o=_(t[r+2],t[r+3],i,4),s=0;s<3;s++){var f=i[s],E=i[4+s];n&&a<=o?(i[8+s]=(f+E)/2,i[12+s]=0):(i[8+s]=(2*f+E)/3,i[12+s]=(f+2*E)/3)}i[11]=255,i[15]=n&&a<=o?0:255;var u=new Uint8Array(16);for(s=0;s<4;++s){var T=t[r+4+s];u[4*s+0]=3&T,u[4*s+1]=T>>2&3,u[4*s+2]=T>>4&3,u[4*s+3]=T>>6&3}for(s=0;s<16;++s)for(var A=4*u[s],c=0;c<4;++c)e[4*s+c]=i[A+c]}(e,t,r+i,0!=(1&n)),0!=(2&n)?function(e,t,r){for(var n=0;n<8;++n){var i=bytes[r+n],a=15&i,o=240&i;e[8*n+3]=a|a<<4,e[8*n+7]=o|o>>4}}(e,0,r):0!=(4&n)&&function(e,t,r){var n=t[r+0],i=t[r+1],a=new Uint8Array(8);if(a[0]=n,a[1]=i,n<=i){for(var o=1;o<5;++o)a[1+o]=((5-o)*n+o*i)/5;a[6]=0,a[7]=255}else for(o=1;o<7;++o)a[1+o]=((7-o)*n+o*i)/7;var s=new Uint8Array(16),f=(r+=2,0);for(o=0;o<2;++o){for(var _=0,E=0;E<3;++E)_|=t[r++]<<8*E;for(E=0;E<8;++E){var u=_>>3*E&7;s[f++]=u}}for(o=0;o<16;++o)e[4*o+3]=a[s[o]]}(e,t,r)}function u(e){}u.decode=function(e,r,n,i,a){if(null!=e&&null!=i&&0!=n&&0!=r){var o=0;1&(o=a>t.S3MPixelFormat.BGR||a===t.S3MPixelFormat.LUMINANCE_ALPHA?4:33)&&32&o?function(e,t,r,n){for(var i=new Uint16Array(4),a=e,o=0,s=0,f=0,_=0,E=0,u=0,T=0,A=0,c=0,y=t/4,R=r/4,p=0;p<R;p++)for(var h=0;h<y;h++)f=4*((R-p)*y+h),i[0]=n[f],i[1]=n[f+1],_=31&i[0],E=2016&i[0],u=63488&i[0],T=31&i[1],A=2016&i[1],c=63488&i[1],i[2]=5*_+3*T>>3|5*E+3*A>>3&2016|5*u+3*c>>3&63488,i[3]=5*T+3*_>>3|5*A+3*E>>3&2016|5*c+3*u>>3&63488,o=n[f+2],a[s=4*p*t+4*h]=i[3&o],a[s+1]=i[o>>2&3],a[s+2]=i[o>>4&3],a[s+3]=i[o>>6&3],a[s+=t]=i[o>>8&3],a[s+1]=i[o>>10&3],a[s+2]=i[o>>12&3],a[s+3]=i[o>>14],o=n[f+3],a[s+=t]=i[3&o],a[s+1]=i[o>>2&3],a[s+2]=i[o>>4&3],a[s+3]=i[o>>6&3],a[s+=t]=i[o>>8&3],a[s+1]=i[o>>10&3],a[s+2]=i[o>>12&3],a[s+3]=i[o>>14]}(e,r,n,i):function(e,t,r,n,i){for(var a=0!=(1&i)?8:16,o=0,s=0;s<r;s+=4)for(var f=0;f<t;f+=4){var _=new Uint8Array(64);E(_,n,o,i);for(var u=0,T=0;T<4;++T)for(var A=0;A<4;++A){var c=f+A,y=s+T;if(c<t&&y<r)for(var R=4*(t*(r-y)+c),p=0;p<4;++p)e[R++]=_[u++];else u+=4}o+=a}}(e,r,n,i,o)}};var T,A=(T=!0,function(e,t){var r=T?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return T=!1,r}),c=A(void 0,(function(){return c.toString().search("(((.+)+)+)+$").toString().constructor(c).search("(((.+)+)+)+$")}));c();var y,R=Object.freeze({encNONE:0,enrS3TCDXTN:14,enrPVRTPF_PVRTC2:19,enrPVRTPF_PVRTC:20,enrPVRTPF_PVRTC_4bpp:21,enrPVRTPF_ETC1:22}),p=(y=!0,function(e,t){var r=y?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return y=!1,r}),h=p(void 0,(function(){return h.toString().search("(((.+)+)+)+$").toString().constructor(h).search("(((.+)+)+)+$")}));h();var d=Object.freeze({SVC_Vertex:1,SVC_Normal:2,SVC_VertexColor:4,SVC_SecondColor:8,SVC_TexutreCoord:16,SVC_TexutreCoordIsW:32});function I(){return!0}function O(e,t){function n(){throw new i.t(t)}for(var a in t=r.u(t,"This object was destroyed, i.e., destroy() was called."),e)"function"==typeof e[a]&&(e[a]=n);e.isDestroyed=I}var S={STREAM_DRAW:o.s.STREAM_DRAW,STATIC_DRAW:o.s.STATIC_DRAW,DYNAMIC_DRAW:o.s.DYNAMIC_DRAW,validate:function(e){return e===S.STREAM_DRAW||e===S.STATIC_DRAW||e===S.DYNAMIC_DRAW}};const N=1;function l(e){if(e=r.u(e,r.u.EMPTY_OBJECT),i.o.defined("options.context",e.context),!r.e(e.typedArray)&&!r.e(e.sizeInBytes))throw new i.t("Either options.sizeInBytes or options.typedArray is required.");if(r.e(e.typedArray)&&r.e(e.sizeInBytes))throw new i.t("Cannot pass in both options.sizeInBytes and options.typedArray.");if(r.e(e.typedArray)&&(i.o.typeOf.object("options.typedArray",e.typedArray),i.o.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),!S.validate(e.usage))throw new i.t("usage is invalid.");var t=e.context._gl,n=e.bufferTarget,a=e.typedArray,o=e.sizeInBytes,s=e.usage,f=r.e(a);f&&(o=a.byteLength),i.o.typeOf.number.greaterThan("sizeInBytes",o,0);var _=t.createBuffer();t.bindBuffer(n,_),t.bufferData(n,f?a:o,s),t.bindBuffer(n,null),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=n,this._sizeInBytes=o,this._usage=s,this._buffer=_,this.context=e.context,e.context.memorySize+=o,this._ownerName=e.owner,this.context.memoryAnalyzer.allocateGPUMemory(N,e.owner,o)}Object.defineProperties(l.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),l.prototype._getBuffer=function(){return this._buffer},l.prototype.copyFromArrayView=function(e,t){t=r.u(t,0),i.o.defined("arrayView",e),i.o.typeOf.number.lessThanOrEquals("offsetInBytes + arrayView.byteLength",t+e.byteLength,this._sizeInBytes);var n=this._gl,a=this._bufferTarget;n.bindBuffer(a,this._buffer),n.bufferSubData(a,t,e),n.bindBuffer(a,null)},l.prototype.copyFromBuffer=function(e,t,n,a){if(!this._webgl2)throw new i.t("A WebGL 2 context is required.");if(!r.e(e))throw new i.t("readBuffer must be defined.");if(!r.e(a)||a<=0)throw new i.t("sizeInBytes must be defined and be greater than zero.");if(!r.e(t)||t<0||t+a>e.sizeInBytes)throw new i.t("readOffset must be greater than or equal to zero and readOffset + sizeInBytes must be less than of equal to readBuffer.sizeInBytes.");if(!r.e(n)||n<0||n+a>this._sizeInBytes)throw new i.t("writeOffset must be greater than or equal to zero and writeOffset + sizeInBytes must be less than of equal to this.sizeInBytes.");if(this._buffer===e.buffer&&(n>=t&&n<t+a||t>n&&t<n+a))throw new i.t("When readBuffer is equal to this, the ranges [readOffset + sizeInBytes) and [writeOffset, writeOffset + sizeInBytes) must not overlap.");if(this._bufferTarget===o.s.ELEMENT_ARRAY_BUFFER&&e.bufferTarget!==o.s.ELEMENT_ARRAY_BUFFER||this._bufferTarget!==o.s.ELEMENT_ARRAY_BUFFER&&e.bufferTarget===o.s.ELEMENT_ARRAY_BUFFER)throw new i.t("Can not copy an index buffer into another buffer type.");var s=o.s.COPY_READ_BUFFER,f=o.s.COPY_WRITE_BUFFER,_=this._gl;_.bindBuffer(f,this._buffer),_.bindBuffer(s,e.buffer),_.copyBufferSubData(s,f,t,n,a),_.bindBuffer(f,null),_.bindBuffer(s,null)},l.prototype.getBufferData=function(e,t,n,a){if(t=r.u(t,0),n=r.u(n,0),!this._webgl2)throw new i.t("A WebGL 2 context is required.");if(!r.e(e))throw new i.t("arrayView is required.");var s,f,_=e.byteLength;if(r.e(a)?(s=a,r.e(_)?f=1:(_=e.length,f=e.BYTES_PER_ELEMENT)):r.e(_)?(s=_-n,f=1):(s=(_=e.length)-n,f=e.BYTES_PER_ELEMENT),n<0||n>_)throw new i.t("destinationOffset must be greater than zero and less than the arrayView length.");if(n+s>_)throw new i.t("destinationOffset + length must be less than or equal to the arrayViewLength.");if(t<0||t>this._sizeInBytes)throw new i.t("sourceOffset must be greater than zero and less than the buffers size.");if(t+s*f>this._sizeInBytes)throw new i.t("sourceOffset + length must be less than the buffers size.");var E=this._gl,u=o.s.COPY_READ_BUFFER;E.bindBuffer(u,this._buffer),E.getBufferSubData(u,t,e,n,a),E.bindBuffer(u,null)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return!this.context._contextWasLost&&this._gl.deleteBuffer(this._buffer),this.context.memorySize-=this.sizeInBytes,this.context.memoryAnalyzer.releaseGPUMemory(N,this._ownerName,this.sizeInBytes),O(this)};var D,L=(D=!0,function(e,t){var r=D?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return D=!1,r}),g=L(void 0,(function(){return g.toString().search("(((.+)+)+)+$").toString().constructor(g).search("(((.+)+)+)+$")}));function U(){}g(),U.ALPHA_DISABLE=0,U.ALPHA_ADD=1,U.ALPHA_COMBINE=2,U.ALPHA_SUBTRACT=3,U.ALPHA_MULTIPLY=4,U.ALPHA_MAXIMIZED=5,U.ALPHA_ONEONE=6,U.ALPHA_PREMULTIPLIED=7,U.ALPHA_PREMULTIPLIED_PORTERDUFF=8,U.ALPHA_INTERPOLATE=9,U.ALPHA_SCREENMODE=10,U.ALPHA_ONEONE_ONEONE=11,U.ALPHA_ALPHATOCOLOR=12,U.ALPHA_REVERSEONEMINUS=13,U.ALPHA_SRC_DSTONEMINUSSRCALPHA=14,U.ALPHA_ONEONE_ONEZERO=15,U.ALPHA_EXCLUSION=16,U.ALPHA_LAYER_ACCUMULATE=17,U.ALPHA_EQUATION_ADD=0,U.ALPHA_EQUATION_SUBSTRACT=1,U.ALPHA_EQUATION_REVERSE_SUBTRACT=2,U.ALPHA_EQUATION_MAX=3,U.ALPHA_EQUATION_MIN=4,U.ALPHA_EQUATION_DARKEN=5,U.DELAYLOADSTATE_NONE=0,U.DELAYLOADSTATE_LOADED=1,U.DELAYLOADSTATE_LOADING=2,U.DELAYLOADSTATE_NOTLOADED=4,U.NEVER=512,U.ALWAYS=519,U.LESS=513,U.EQUAL=514,U.LEQUAL=515,U.GREATER=516,U.GEQUAL=518,U.NOTEQUAL=517,U.KEEP=7680,U.ZERO=0,U.REPLACE=7681,U.INCR=7682,U.DECR=7683,U.INVERT=5386,U.INCR_WRAP=34055,U.DECR_WRAP=34056,U.FRONT=0,U.BACK=1,U.TEXTURE_CLAMP_ADDRESSMODE=0,U.TEXTURE_WRAP_ADDRESSMODE=1,U.TEXTURE_MIRROR_ADDRESSMODE=2,U.TEXTURE_CREATIONFLAG_STORAGE=1,U.TEXTUREFORMAT_ALPHA=0,U.TEXTUREFORMAT_LUMINANCE=1,U.TEXTUREFORMAT_LUMINANCE_ALPHA=2,U.TEXTUREFORMAT_RGB=4,U.TEXTUREFORMAT_RGBA=5,U.TEXTUREFORMAT_RED=6,U.TEXTUREFORMAT_R=6,U.TEXTUREFORMAT_RG=7,U.TEXTUREFORMAT_RED_INTEGER=8,U.TEXTUREFORMAT_R_INTEGER=8,U.TEXTUREFORMAT_RG_INTEGER=9,U.TEXTUREFORMAT_RGB_INTEGER=10,U.TEXTUREFORMAT_RGBA_INTEGER=11,U.TEXTUREFORMAT_BGRA=12,U.TEXTUREFORMAT_DEPTH24_STENCIL8=13,U.TEXTUREFORMAT_DEPTH32_FLOAT=14,U.TEXTUREFORMAT_DEPTH16=15,U.TEXTUREFORMAT_DEPTH24=16,U.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8=17,U.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8=18,U.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM=36492,U.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_BPTC_UNORM=36493,U.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT=36495,U.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_SIGNED_FLOAT=36494,U.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5=33779,U.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919,U.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3=33778,U.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918,U.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1=33777,U.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1=33776,U.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917,U.TEXTUREFORMAT_COMPRESSED_SRGB_S3TC_DXT1_EXT=35916,U.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4=37808,U.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840,U.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL=36196,U.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2=37492,U.TEXTUREFORMAT_COMPRESSED_SRGB8_ETC2=37493,U.TEXTUREFORMAT_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494,U.TEXTUREFORMAT_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495,U.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC=37496,U.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497,U.TEXTURETYPE_UNSIGNED_BYTE=0,U.TEXTURETYPE_UNSIGNED_INT=0,U.TEXTURETYPE_FLOAT=1,U.TEXTURETYPE_HALF_FLOAT=2,U.TEXTURETYPE_BYTE=3,U.TEXTURETYPE_SHORT=4,U.TEXTURETYPE_UNSIGNED_SHORT=5,U.TEXTURETYPE_INT=6,U.TEXTURETYPE_UNSIGNED_INTEGER=7,U.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,U.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,U.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,U.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,U.TEXTURETYPE_UNSIGNED_INT_24_8=12,U.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,U.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,U.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,U.TEXTURETYPE_UNDEFINED=16,U.TEXTURE_NEAREST_SAMPLINGMODE=1,U.TEXTURE_NEAREST_NEAREST=1,U.TEXTURE_BILINEAR_SAMPLINGMODE=2,U.TEXTURE_LINEAR_LINEAR=2,U.TEXTURE_TRILINEAR_SAMPLINGMODE=3,U.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,U.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,U.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,U.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,U.TEXTURE_NEAREST_LINEAR=7,U.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,U.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,U.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,U.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,U.TEXTURE_LINEAR_NEAREST=12,U.TEXTURE_EXPLICIT_MODE=0,U.TEXTURE_SPHERICAL_MODE=1,U.TEXTURE_PLANAR_MODE=2,U.TEXTURE_CUBIC_MODE=3,U.TEXTURE_PROJECTION_MODE=4,U.TEXTURE_SKYBOX_MODE=5,U.TEXTURE_INVCUBIC_MODE=6,U.TEXTURE_EQUIRECTANGULAR_MODE=7,U.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,U.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,U.TEXTURE_FILTERING_QUALITY_OFFLINE=4096,U.TEXTURE_FILTERING_QUALITY_HIGH=64,U.TEXTURE_FILTERING_QUALITY_MEDIUM=16,U.TEXTURE_FILTERING_QUALITY_LOW=8,U.SCALEMODE_FLOOR=1,U.SCALEMODE_NEAREST=2,U.SCALEMODE_CEILING=3,U.MATERIAL_TextureDirtyFlag=1,U.MATERIAL_LightDirtyFlag=2,U.MATERIAL_FresnelDirtyFlag=4,U.MATERIAL_AttributesDirtyFlag=8,U.MATERIAL_MiscDirtyFlag=16,U.MATERIAL_PrePassDirtyFlag=32,U.MATERIAL_AllDirtyFlag=63,U.MATERIAL_TriangleFillMode=0,U.MATERIAL_WireFrameFillMode=1,U.MATERIAL_PointFillMode=2,U.MATERIAL_PointListDrawMode=3,U.MATERIAL_LineListDrawMode=4,U.MATERIAL_LineLoopDrawMode=5,U.MATERIAL_LineStripDrawMode=6,U.MATERIAL_TriangleStripDrawMode=7,U.MATERIAL_TriangleFanDrawMode=8,U.MATERIAL_ClockWiseSideOrientation=0,U.MATERIAL_CounterClockWiseSideOrientation=1,U.ACTION_NothingTrigger=0,U.ACTION_OnPickTrigger=1,U.ACTION_OnLeftPickTrigger=2,U.ACTION_OnRightPickTrigger=3,U.ACTION_OnCenterPickTrigger=4,U.ACTION_OnPickDownTrigger=5,U.ACTION_OnDoublePickTrigger=6,U.ACTION_OnPickUpTrigger=7,U.ACTION_OnPickOutTrigger=16,U.ACTION_OnLongPressTrigger=8,U.ACTION_OnPointerOverTrigger=9,U.ACTION_OnPointerOutTrigger=10,U.ACTION_OnEveryFrameTrigger=11,U.ACTION_OnIntersectionEnterTrigger=12,U.ACTION_OnIntersectionExitTrigger=13,U.ACTION_OnKeyDownTrigger=14,U.ACTION_OnKeyUpTrigger=15,U.PARTICLES_BILLBOARDMODE_Y=2,U.PARTICLES_BILLBOARDMODE_ALL=7,U.PARTICLES_BILLBOARDMODE_STRETCHED=8,U.MESHES_CULLINGSTRATEGY_STANDARD=0,U.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,U.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,U.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,U.SCENELOADER_NO_LOGGING=0,U.SCENELOADER_MINIMAL_LOGGING=1,U.SCENELOADER_SUMMARY_LOGGING=2,U.SCENELOADER_DETAILED_LOGGING=3,U.PREPASS_IRRADIANCE_TEXTURE_TYPE=0,U.PREPASS_POSITION_TEXTURE_TYPE=1,U.PREPASS_VELOCITY_TEXTURE_TYPE=2,U.PREPASS_REFLECTIVITY_TEXTURE_TYPE=3,U.PREPASS_COLOR_TEXTURE_TYPE=4,U.PREPASS_DEPTH_TEXTURE_TYPE=5,U.PREPASS_NORMAL_TEXTURE_TYPE=6,U.PREPASS_ALBEDO_SQRT_TEXTURE_TYPE=7,U.BUFFER_CREATIONFLAG_READ=1,U.BUFFER_CREATIONFLAG_WRITE=2,U.BUFFER_CREATIONFLAG_READWRITE=3,U.BUFFER_CREATIONFLAG_UNIFORM=4,U.BUFFER_CREATIONFLAG_VERTEX=8,U.BUFFER_CREATIONFLAG_INDEX=16,U.BUFFER_CREATIONFLAG_STORAGE=32,U.RENDERPASS_MAIN=0,U.INPUT_ALT_KEY=18,U.INPUT_CTRL_KEY=17,U.INPUT_META_KEY1=91,U.INPUT_META_KEY2=92,U.INPUT_META_KEY3=93,U.INPUT_SHIFT_KEY=16,U.SNAPSHOTRENDERING_STANDARD=0,U.SNAPSHOTRENDERING_FAST=1,U.PERSPECTIVE_CAMERA=0,U.ORTHOGRAPHIC_CAMERA=1,U.FOVMODE_VERTICAL_FIXED=0,U.FOVMODE_HORIZONTAL_FIXED=1,U.RIG_MODE_NONE=0,U.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,U.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,U.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,U.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,U.RIG_MODE_STEREOSCOPIC_INTERLACED=14,U.RIG_MODE_VR=20,U.RIG_MODE_WEBVR=21,U.RIG_MODE_CUSTOM=22,U.MAX_SUPPORTED_UV_SETS=6,U.GL_ALPHA_EQUATION_ADD=32774,U.GL_ALPHA_EQUATION_MIN=32775,U.GL_ALPHA_EQUATION_MAX=32776,U.GL_ALPHA_EQUATION_SUBTRACT=32778,U.GL_ALPHA_EQUATION_REVERSE_SUBTRACT=32779,U.GL_ALPHA_FUNCTION_SRC=768,U.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_COLOR=769,U.GL_ALPHA_FUNCTION_SRC_ALPHA=770,U.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_ALPHA=771,U.GL_ALPHA_FUNCTION_DST_ALPHA=772,U.GL_ALPHA_FUNCTION_ONE_MINUS_DST_ALPHA=773,U.GL_ALPHA_FUNCTION_DST_COLOR=774,U.GL_ALPHA_FUNCTION_ONE_MINUS_DST_COLOR=775,U.GL_ALPHA_FUNCTION_SRC_ALPHA_SATURATED=776,U.GL_ALPHA_FUNCTION_CONSTANT_COLOR=32769,U.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_COLOR=32770,U.GL_ALPHA_FUNCTION_CONSTANT_ALPHA=32771,U.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_ALPHA=32772,U.SnippetUrl="";var B,P=(B=!0,function(e,t){var r=B?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return B=!1,r}),C=P(void 0,(function(){return C.toString().search("(((.+)+)+)+$").toString().constructor(C).search("(((.+)+)+)+$")}));function b(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=b._Counter++}C(),Object.defineProperty(b.prototype,"underlyingResource",{get:function(){return null},enumerable:!1,configurable:!0}),b._Counter=0;var v,M=(v=!0,function(e,t){var r=v?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return v=!1,r}),x=M(void 0,(function(){return x.toString().search("(((.+)+)+)+$").toString().constructor(x).search("(((.+)+)+)+$")}));function F(e,t,r,n,i,a,o,s){void 0===n&&(n=0),void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),this._isAlreadyOwned=!1,e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=r,this._instanced=a,this._divisor=s||1,t instanceof b?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=o?n:n*Float32Array.BYTES_PER_ELEMENT,!i&&this.create()}function m(e,t,r,n,i,a,o,s,f,_,E,u,T,A){if(void 0===E&&(E=!1),void 0===u&&(u=!1),void 0===T&&(T=1),void 0===A&&(A=!1),t instanceof F?(this._buffer=t,this._ownsBuffer=A):(this._buffer=new F(e,t,n,a,i,o,u),this._ownsBuffer=!0),this.uniqueId=m._Counter++,this._kind=r,null==_){var c=this.getData();this.type=m.FLOAT,c instanceof Int8Array?this.type=m.BYTE:c instanceof Uint8Array?this.type=m.UNSIGNED_BYTE:c instanceof Int16Array?this.type=m.SHORT:c instanceof Uint16Array?this.type=m.UNSIGNED_SHORT:c instanceof Int32Array?this.type=m.INT:c instanceof Uint32Array&&(this.type=m.UNSIGNED_INT)}else this.type=_;var y=m.GetTypeByteLength(this.type);u?(this._size=f||(a?a/y:m.DeduceStride(r)),this.byteStride=a||this._buffer.byteStride||this._size*y,this.byteOffset=s||0):(this._size=f||a||m.DeduceStride(r),this.byteStride=a?a*y:this._buffer.byteStride||this._size*y,this.byteOffset=(s||0)*y),this.normalized=E,this._instanced=void 0!==o&&o,this._instanceDivisor=o?T:0,this._computeHashCode()}x(),F.prototype.createVertexBuffer=function(e,t,r,n,i,a,o){void 0===a&&(a=!1);var s=a?t:t*Float32Array.BYTES_PER_ELEMENT,f=n?a?n:n*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new m(this._engine,this,e,this._updatable,!0,f,void 0===i?this._instanced:i,s,r,void 0,void 0,!0,this._divisor||o)},F.prototype.isUpdatable=function(){return this._updatable},F.prototype.getData=function(){return this._data},F.prototype.getBuffer=function(){return this._buffer},F.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},F.prototype.create=function(e){void 0===e&&(e=null),!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))},F.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},F.prototype.update=function(e){this.create(e)},F.prototype.updateDirectly=function(e,t,r,n){void 0===n&&(n=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,n?t:t*Float32Array.BYTES_PER_ELEMENT,r?r*this.byteStride:void 0),this._data=0===t&&void 0===r?e:null)},F.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)},F.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)},Object.defineProperty(m.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(e){this._instanceDivisor=e,this._instanced=0!=e,this._computeHashCode()},enumerable:!1,configurable:!0}),m.prototype._computeHashCode=function(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)},m.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},m.prototype.getKind=function(){return this._kind},m.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},m.prototype.getData=function(){return this._buffer.getData()},m.prototype.getFloatData=function(e,t){var r=this.getData();if(!r)return null;var n=this.getSize()*m.GetTypeByteLength(this.type),i=e*this.getSize();if(this.type!==m.FLOAT||this.byteStride!==n){var a=new Float32Array(i);return this.forEach(i,(function(e,t){return a[t]=e})),a}if(!(r instanceof Array||r instanceof Float32Array)||0!==this.byteOffset||r.length!==i){if(r instanceof Array){var o=this.byteOffset/4;return r.slice(o,o+i)}if(r instanceof ArrayBuffer)return new Float32Array(r,this.byteOffset,i);o=r.byteOffset+this.byteOffset;if(t){var s=new Float32Array(i),f=new Float32Array(r.buffer,o,i);return s.set(f),s}var _=o%4;return _&&(o=Math.max(0,o-_)),new Float32Array(r.buffer,o,i)}return t?r.slice():r},m.prototype.getBuffer=function(){return this._buffer.getBuffer()},m.prototype.getStrideSize=function(){return this.byteStride/m.GetTypeByteLength(this.type)},m.prototype.getOffset=function(){return this.byteOffset/m.GetTypeByteLength(this.type)},m.prototype.getSize=function(e){return void 0===e&&(e=!1),e?this._size*m.GetTypeByteLength(this.type):this._size},m.prototype.getIsInstanced=function(){return this._instanced},m.prototype.getInstanceDivisor=function(){return this._instanceDivisor},m.prototype.create=function(e){this._buffer.create(e)},m.prototype.update=function(e){this._buffer.update(e)},m.prototype.updateDirectly=function(e,t,r){void 0===r&&(r=!1),this._buffer.updateDirectly(e,t,void 0,r)},m.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},m.prototype.forEach=function(e,t){m.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,e,this.normalized,t)},m.DeduceStride=function(e){switch(e){case m.UVKind:case m.UV2Kind:case m.UV3Kind:case m.UV4Kind:case m.UV5Kind:case m.UV6Kind:return 2;case m.NormalKind:case m.PositionKind:return 3;case m.ColorKind:case m.MatricesIndicesKind:case m.MatricesIndicesExtraKind:case m.MatricesWeightsKind:case m.MatricesWeightsExtraKind:case m.TangentKind:return 4;default:throw new Error("Invalid kind '"+e+"'")}},m.GetTypeByteLength=function(e){switch(e){case m.BYTE:case m.UNSIGNED_BYTE:return 1;case m.SHORT:case m.UNSIGNED_SHORT:return 2;case m.INT:case m.UNSIGNED_INT:case m.FLOAT:return 4;default:throw new Error("Invalid type '".concat(e,"'"))}},m.ForEach=function(e,t,r,n,i,a,o,s){if(e instanceof Array)for(var f=t/4,_=r/4,E=0;E<a;E+=n){for(var u=0;u<n;u++)s(e[f+u],E+u);f+=_}else{var T=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),A=m.GetTypeByteLength(i);for(E=0;E<a;E+=n){var c=t;for(u=0;u<n;u++){s(m._GetFloatValue(T,i,c,o),E+u),c+=A}t+=r}}},m._GetFloatValue=function(e,t,r,n){switch(t){case m.BYTE:var i=e.getInt8(r);return n&&(i=Math.max(i/127,-1)),i;case m.UNSIGNED_BYTE:i=e.getUint8(r);return n&&(i/=255),i;case m.SHORT:i=e.getInt16(r,!0);return n&&(i=Math.max(i/32767,-1)),i;case m.UNSIGNED_SHORT:i=e.getUint16(r,!0);return n&&(i/=65535),i;case m.INT:return e.getInt32(r,!0);case m.UNSIGNED_INT:return e.getUint32(r,!0);case m.FLOAT:return e.getFloat32(r,!0);default:throw new Error("Invalid component type ".concat(t))}},m._Counter=0,m.BYTE=5120,m.UNSIGNED_BYTE=5121,m.SHORT=5122,m.UNSIGNED_SHORT=5123,m.INT=5124,m.UNSIGNED_INT=5125,m.FLOAT=5126,m.PositionKind="position",m.NormalKind="normal",m.TangentKind="tangent",m.UVKind="uv",m.UV2Kind="uv2",m.UV3Kind="uv3",m.UV4Kind="uv4",m.UV5Kind="uv5",m.UV6Kind="uv6",m.ColorKind="color",m.ColorInstanceKind="instanceColor",m.MatricesIndicesKind="matricesIndices",m.MatricesWeightsKind="matricesWeights",m.MatricesIndicesExtraKind="matricesIndicesExtra",m.MatricesWeightsExtraKind="matricesWeightsExtra";var w,G=(w=!0,function(e,t){var r=w?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return w=!1,r}),z=G(void 0,(function(){return z.toString().search("(((.+)+)+)+$").toString().constructor(z).search("(((.+)+)+)+$")}));function X(e,t,r){void 0===r&&(r=U.BUFFER_CREATIONFLAG_READWRITE),this._engine=e,this._engine._storageBuffers.push(this),this._create(t,r)}function H(e){var t=(e=r.u(e,r.u.EMPTY_OBJECT)).context,n=e.bufferTarget,i=e.typedArray,s=e.sizeInBytes,f=e.usage,_=r.e(i);_?s=i.byteLength:i=new Uint8Array(s);var E=U.BUFFER_CREATIONFLAG_STORAGE;r.e(f)&&(f==S.STREAM_DRAW||f==S.STATIC_DRAW?E|=U.BUFFER_CREATIONFLAG_WRITE:f==S.DYNAMIC_DRAW&&(E|=U.BUFFER_CREATIONFLAG_READWRITE)),r.e(n)?n==o.s.ELEMENT_ARRAY_BUFFER?(i instanceof Uint8Array&&(e.indexDatatype==a.IndexDatatype.UNSIGNED_INT?i=new Uint32Array(i.buffer,i.byteOffset,i.byteLength/4):e.indexDatatype==a.IndexDatatype.UNSIGNED_SHORT&&(i=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2))),this._dataBuffer=t.engine.createIndexBuffer(i)):n==o.s.ARRAY_BUFFER?(this._dataBuffer=new F(t.engine,i,!0),this._dataBuffer._data=null):console.log("BufferGPU not supported bufferTarget"):(this._dataBuffer=new X(t.engine,s,E),_&&this._dataBuffer.update(i,0,s)),this._bufferTarget=n,this._sizeInBytes=s,this._usage=f,this.context=e.context,e.context.memorySize+=s,this._ownerName=e.owner,this.context.memoryAnalyzer.allocateGPUMemory(N,e.owner,s)}function V(e){if(e=r.u(e,r.u.EMPTY_OBJECT),i.o.defined("options.context",e.context),!r.e(e.typedArray)&&!r.e(e.sizeInBytes))throw new i.t("Either options.sizeInBytes or options.typedArray is required.");if(r.e(e.typedArray)&&r.e(e.sizeInBytes))throw new i.t("Cannot pass in both options.sizeInBytes and options.typedArray.");r.e(e.typedArray)&&(i.o.typeOf.object("options.typedArray",e.typedArray),i.o.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),this._id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),e.context.webgpu?this._inner=new H(e):this._inner=new l(e),this.vertexArrayDestroyable=!0}z(),X.prototype._create=function(e,t){this._bufferSize=e,this._creationFlags=t,this._buffer=this._engine.createStorageBuffer(e,t)},X.prototype._rebuild=function(){this._create(this._bufferSize,this._creationFlags)},X.prototype.getBuffer=function(){return this._buffer},X.prototype.update=function(e,t,r){this._buffer&&this._engine.updateStorageBuffer(this._buffer,e,t,r)},X.prototype.read=function(e,t,r){return this._engine.readFromStorageBuffer(this._buffer,e,t,r)},X.prototype.dispose=function(){var e=this._engine._storageBuffers,t=e.indexOf(this);-1!==t&&(e[t]=e[e.length-1],e.pop()),this._engine._releaseBuffer(this._buffer),this._buffer=null},Object.defineProperties(H.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}},dataBuffer:{get:function(){return this._dataBuffer}}}),H.prototype._getBuffer=function(){return console.log("BufferGPU.prototype._getBuffer"),this._dataBuffer},H.prototype.copyFromArrayView=function(e,t){this._bufferTarget===o.s.ELEMENT_ARRAY_BUFFER?this.context.engine.updateDynamicIndexBuffer(this._dataBuffer,e):this._dataBuffer.updateDirectly(e,t,null,!0)},H.prototype.copyFromBuffer=function(e,t,r,n){console.log("BufferGPU.prototype.copyFromBuffer")},H.prototype.getBufferData=function(e,t,r,n){console.log("BufferGPU.prototype.getBufferData")},H.prototype.isDestroyed=function(){return!1},H.prototype.destroy=function(){return this._bufferTarget!==o.s.ELEMENT_ARRAY_BUFFER?this._dataBuffer.dispose():this.context._engine._releaseBuffer(this._dataBuffer),this.context.memorySize-=this.sizeInBytes,this.context.memoryAnalyzer.releaseGPUMemory(N,this._ownerName,this.sizeInBytes),O(this)},V.createVertexBuffer=function(e){return i.o.defined("options.context",e.context),new V({context:e.context,bufferTarget:o.s.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage,owner:e.owner})},V.createIndexBuffer=function(e){if(i.o.defined("options.context",e.context),!a.IndexDatatype.validate(e.indexDatatype))throw new i.t("Invalid indexDatatype.");if(e.indexDatatype===a.IndexDatatype.UNSIGNED_INT&&!e.context.elementIndexUint)throw new i.t("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.");var t=e.context,r=e.indexDatatype,n=a.IndexDatatype.getSizeInBytes(r),s=new V({context:t,bufferTarget:o.s.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage,indexDatatype:r,owner:e.owner}),f=s.sizeInBytes/n;return Object.defineProperties(s,{indexDatatype:{get:function(){return r}},bytesPerIndex:{get:function(){return n}},numberOfIndices:{get:function(){return f}}}),s},Object.defineProperties(V.prototype,{sizeInBytes:{get:function(){return this._inner.sizeInBytes}},usage:{get:function(){return this._inner.usage}},bufferTarget:{get:function(){return this._inner._bufferTarget}},buffer:{get:function(){return this._inner._buffer}}}),V.prototype._getBuffer=function(){return this._inner._getBuffer()},V.prototype.copyFromArrayView=function(e,t){this._inner.copyFromArrayView(e,t)},V.prototype.copyFromBuffer=function(e,t,r,n){this._inner.copyFromBuffer(e,t,r,n)},V.prototype.getBufferData=function(e,t,r,n){this._inner.getBufferData(e,t,r,n)},V.prototype.isDestroyed=function(){return!1},V.prototype.destroy=function(){return this._inner.destroy(),O(this)};var Y,W=(Y=!0,function(e,t){var r=Y?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return Y=!1,r}),K=W(void 0,(function(){return K.toString().search("(((.+)+)+)+$").toString().constructor(K).search("(((.+)+)+)+$")}));function q(){}K(),q.computeNeighbors=function(e,t){for(var r=e.length/3,n=new Uint32Array(t+1),i=new Uint32Array(t+1),a=function(e,t){e<t?n[e+1]++:i[t+1]++},o=0;o<r;o++){var s=e[3*o],f=e[3*o+1],_=e[3*o+2];a(s,f),a(f,_),a(_,s)}for(o=f=s=0;o<t;o++)_=n[o+1],a=i[o+1],n[o+1]=s,i[o+1]=f,s+=_,f+=a;var E=new Uint32Array(6*r),u=n[t];for(a=function(e,t,r){if(e<t){var a=n[e+1]++;E[2*a]=t,E[2*a+1]=r}else a=i[t+1]++,E[2*u+2*a]=e,E[2*u+2*a+1]=r},o=0;o<r;o++)s=e[3*o],f=e[3*o+1],_=e[3*o+2],a(s,f,o),a(f,_,o),a(_,s,o);for(s=function(e,t){var r=2*e;for(e=t-e,t=1;t<e;t++){for(var n=E[r+2*t],i=E[r+2*t+1],a=t-1;0<=a&&E[r+2*a]>n;a--)E[r+2*a+2]=E[r+2*a],E[r+2*a+3]=E[r+2*a+1];E[r+2*a+2]=n,E[r+2*a+3]=i}},o=0;o<t;o++)s(n[o],n[o+1]),s(u+i[o],u+i[o+1]);var T=new Int32Array(3*r),A=function(t,r){return t===e[3*r]?0:t===e[3*r+1]?1:t===e[3*r+2]?2:-1};for(r=function(e,t){e=A(e,t),T[3*t+e]=-1},s=function(e,t,r,n){e=A(e,t),T[3*t+e]=n,r=A(r,n),T[3*n+r]=t},o=0;o<t;o++){f=n[o],_=n[o+1],a=i[o];for(var c=i[o+1];f<_&&a<c;){var y=E[2*f],R=E[2*u+2*a];y===R?(s(o,E[2*f+1],R,E[2*u+2*a+1]),f++,a++):y<R?(r(o,E[2*f+1]),f++):(r(R,E[2*u+2*a+1]),a++)}for(;f<_;)r(o,E[2*f+1]),f++;for(;a<c;)r(R=E[2*u+2*a],E[2*u+2*a+1]),a++}return T};var k=null;function Q(){}function $(e){var t,r=(t=!0,function(e,r){var n=t?function(){if(r){var t=r.apply(e,arguments);return r=null,t}}:function(){};return t=!1,n}),n=r(this,(function(){return n.toString().search("(((.+)+)+)+$").toString().constructor(n).search("(((.+)+)+)+$")}));return n(),e*Math.PI/180}q.deduplicate=function(e,t,r,n,i){void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=e.byteLength/(4*t)),e=new Uint32Array(e,n,i*t),n=new Uint32Array(i);var a=Math.floor(1.1*i)+1;(null==k||k.length<2*a)&&(k=new Uint32Array(function(e){--e;for(var t=1;32>t;t<<=1)e|=e>>t;return e+1}(2*a)));for(var o=0;o<2*a;o++)k[o]=0;var s=0,f=0!==r?Math.ceil(7.84*1.96/(r*r)*r*(1-r)):i;for(o=0;o<i;o++){if(o===f){if((E=1-s/o)+1.96*Math.sqrt(E*(1-E)/o)<r)return null;f*=2}for(var _,E=o*t,u=_=0;u<t;u++)_=(_=e[E+u]+_|0)+(_<<11)+(_>>>2)|0;u=(_>>>=0)%a;for(var T=s;0!==k[2*u+1];){if(k[2*u]===_){var A=k[2*u+1]-1,c=A*t;e:{for(var y=0;y<t;y++)if(e[E+y]!==e[c+y]){c=!1;break e}c=!0}if(c){T=n[A];break}}++u>=a&&(u-=a)}T===s&&(k[2*u]=_,k[2*u+1]=o+1,s++),n[o]=T}if(0!==r&&1-s/i<r)return null;for(r=new Uint32Array(t*s),o=s=0;o<i;o++)if(n[o]===s){for(a=e,f=o*t,E=r,_=s*t,u=t,T=0;T<u;T++)E[_+T]=a[f+T];s++}return{buffer:r.buffer,indices:n,uniqueCount:s}};var j=$(4),Z=$(35),J=Math.cos(Z),ee=Math.cos(j);var te={position0:new n.o,position1:new n.o,faceNormal0:new n.o,faceNormal1:new n.o,cosAngle:0},re=new n.o,ne=new n.o;function ie(e,t){var r,i,a,o,s,f,_=(r=e.cosAngle,Math.acos(1<r?1:-1>r?-1:r));return i=ne,a=e.position1,o=e.position0,s=o.x-a.x,f=o.y-a.y,(o=s*s+f*f+(a=o.z-a.z)*a)?(o=1/Math.sqrt(o),i.x=s*o,i.y=f*o,i.z=a*o):(i.x=0,i.y=0,i.z=0),n.o.cross(e.faceNormal0,e.faceNormal1,re),_*(0<n.o.dot(re,ne)?-1:1)>t}var ae=new n.o,oe=new n.o,se=new n.o;Q.extractEdges=function(e){var t=e.vertices,r=e.dim,i=te,a=i.position0,o=i.position1,s=i.faceNormal0,f=i.faceNormal1,_=function(e){for(var t=e.faces.length/3,r=e.vertices,i=e.dim,a=e.faces,o=new Float32Array(3*t),s=0;s<t;s++){var f=a[3*s+0],_=a[3*s+1],E=a[3*s+2];ae.x=r[i*f],ae.y=r[i*f+1],ae.z=r[i*f+2],oe.x=r[i*_],oe.y=r[i*_+1],oe.z=r[i*_+2],se.x=r[i*E],se.y=r[i*E+1],se.z=r[i*E+2],n.o.subtract(oe,ae,oe),n.o.subtract(se,ae,se),n.o.cross(oe,se,ae),T=void 0,(T=(u=ae).x*u.x+u.y*u.y+u.z*u.z)>0&&(T=1/Math.sqrt(T),u.x*=T,u.y*=T,u.z*=T),o[3*s+0]=ae.x,o[3*s+1]=ae.y,o[3*s+2]=ae.z}var u,T;return o}(e),E=function(e){var t=e.faces.length/3,r=e.faces,n=e.neighbors,i=0,a=0;for(a=0;a<t;a++){var o=n[3*a+0],s=n[3*a+1],f=n[3*a+2],_=r[3*a+0],E=r[3*a+1],u=r[3*a+2];i+=-1===o||_<E?1:0,i+=-1===s||E<u?1:0,i+=-1===f||u<_?1:0}var T=new Int32Array(4*i),A=0;for(a=0;a<t;a++)o=n[3*a+0],s=n[3*a+1],f=n[3*a+2],_=r[3*a+0],E=r[3*a+1],u=r[3*a+2],(-1===o||_<E)&&(T[A++]=_,T[A++]=E,T[A++]=a,T[A++]=o),(-1===s||E<u)&&(T[A++]=E,T[A++]=u,T[A++]=a,T[A++]=s),(-1===f||u<_)&&(T[A++]=u,T[A++]=_,T[A++]=a,T[A++]=f);return T}(e),u=E.length/4,T=new Float32Array(9*u),A=0,c=new Float32Array(12*u),y=0,R=0,p=0,h=function(e,t){0===t&&(t=e,e=0);for(var r=Array(t-e),n=e;n<t;n++)r[n-e]=n;return r}(0,u),d=new Float32Array(u);d.forEach((function(e,i,s){var f=E[4*i+0],_=E[4*i+1];a.x=t[f*r],a.y=t[f*r+1],a.z=t[f*r+2],o.x=t[_*r],o.y=t[_*r+1],o.z=t[_*r+2],s[i]=n.o.distance(a,o)})),h.sort((function(e,t){return d[t]-d[e]}));for(var I=[],O=[],S=0;S<u;S++){var N=h[S],l=d[N],D=E[4*N+0],L=E[4*N+1],g=E[4*N+2],U=E[4*N+3],B=-1===U;if(a.x=t[D*r],a.y=t[D*r+1],a.z=t[D*r+2],o.x=t[L*r],o.y=t[L*r+1],o.z=t[L*r+2],B)s.x=_[3*g],s.y=_[3*g+1],s.z=_[3*g+2],f.x=s.x,f.y=s.y,f.z=s.z,i.cosAngle=n.o.dot(s,f);else if(s.x=_[3*g],s.y=_[3*g+1],s.z=_[3*g+2],f.x=_[3*U],f.y=_[3*U+1],f.z=_[3*U+2],i.cosAngle=n.o.dot(s,f),i.cosAngle>ee)continue;R+=l,p++,B||i.cosAngle<J?(T[A++]=i.position0.x,T[A++]=i.position0.y,T[A++]=i.position0.z,T[A++]=i.position1.x,T[A++]=i.position1.y,T[A++]=i.position1.z,T[A++]=i.faceNormal0.x,T[A++]=i.faceNormal0.y,T[A++]=i.faceNormal0.z,I.push(l)):ie(i,j)&&(c[y++]=i.position0.x,c[y++]=i.position0.y,c[y++]=i.position0.z,c[y++]=i.position1.x,c[y++]=i.position1.y,c[y++]=i.position1.z,c[y++]=i.faceNormal0.x,c[y++]=i.faceNormal0.y,c[y++]=i.faceNormal0.z,c[y++]=i.faceNormal1.x,c[y++]=i.faceNormal1.y,c[y++]=i.faceNormal1.z,O.push(l))}T=T.slice(0,A),c=c.slice(0,y);var P=R/p,C=I.length,b=O.length;return{regular:{instancesData:T,instanceCount:C,edgeLength:C*P},silhouette:{instancesData:c,instanceCount:b,edgeLength:b*P},averageEdgeLength:P}};var fe,_e=(fe=!0,function(e,t){var r=fe?function(){if(t){var r=t.apply(e,arguments);return t=null,r}}:function(){};return fe=!1,r}),Ee=_e(void 0,(function(){return Ee.toString().search("(((.+)+)+)+$").toString().constructor(Ee).search("(((.+)+)+)+$")}));function ue(e){}function Te(e,t){if(r.e(e.cachedSidenessVertexBuffer))return e.cachedSidenessVertexBuffer;var n=new Float32Array(8),i=0;return n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=1,n[i++]=1,n[i++]=1,n[i++]=1,n[i++]=0,e.cachedSidenessVertexBuffer=V.createVertexBuffer({context:e,typedArray:n,usage:S.STATIC_DRAW,owner:t}),e.cachedSidenessVertexBuffer.vertexArrayDestroyable=!1,e.cachedSidenessVertexBuffer}function Ae(e,t){for(var r,i,a,o=t.componentsPerAttribute,s=e.vertCompressConstant,f=new n.o(e.minVerticesValue.x,e.minVerticesValue.y,e.minVerticesValue.z),_=new Uint16Array(t.typedArray.buffer,t.typedArray.byteOffset,t.typedArray.byteLength/2),E=new Float32Array(3*e.verticesCount),u=0;u<e.verticesCount;u++)r=_[o*u]*s+f.x,i=_[o*u+1]*s+f.y,a=_[o*u+2]*s+f.z,E[3*u]=r,E[3*u+1]=i,E[3*u+2]=a;return E}Ee(),ue.RegularInstanceStride=12,ue.SilhouetteInstanceStride=15,ue.createEdgeData=function(e,t,n){if(0==t.length)return null;var i,a=t[0];i=0===a.indexType?new Uint16Array(a.indicesTypedArray.buffer,a.indicesTypedArray.byteOffset,a.indicesTypedArray.byteLength/2):new Uint32Array(a.indicesTypedArray.buffer,a.indicesTypedArray.byteOffset,a.indicesTypedArray.byteLength/4);var o=ue.extractEdgeInformation(e,!1,i),s=Q.extractEdges(o);return r.e(n)&&(r.e(s.regular.instancesData)&&n.push(s.regular.instancesData.buffer),r.e(s.silhouette.instancesData)&&n.push(s.silhouette.instancesData.buffer)),s},ue.createIndexBuffer=function(e,t){return r.e(e.cachedSidenessIndexBuffer)||(e.cachedSidenessIndexBuffer=V.createIndexBuffer({context:e,typedArray:(n=new Uint16Array(6),i=0,n[i++]=2,n[i++]=1,n[i++]=0,n[i++]=3,n[i++]=2,n[i++]=0,n),usage:S.STATIC_DRAW,indexDatatype:a.IndexDatatype.UNSIGNED_SHORT,owner:t}),e.cachedSidenessIndexBuffer.vertexArrayDestroyable=!1),e.cachedSidenessIndexBuffer;var n,i},ue.createRegularEdgeAttributes=function(e,t,n,i){if(r.e(t.instancesData)&&0!=t.instancesData.length){var a={},o=[];t.attributeLocations=a,t.attributes=o;var s=V.createVertexBuffer({context:e,typedArray:t.instancesData,usage:S.STATIC_DRAW,owner:i});t.instancesData=null;var _=f.ComponentDatatype.getSizeInBytes(f.ComponentDatatype.FLOAT),E=Te(e,i),u=0;a.aSideness=u++,o.push({name:"aSideness",index:a.aSideness,vertexBuffer:E,componentsPerAttribute:2,componentDatatype:f.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:2*f.ComponentDatatype.getSizeInBytes(f.ComponentDatatype.FLOAT),normalize:!1});var T=n||ue.RegularInstanceStride,A=0;a.aPosition0=u++,o.push({name:"aPosition0",index:a.aPosition0,vertexBuffer:s,componentsPerAttribute:3,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:_*A,strideInBytes:_*T,instanceDivisor:1}),A+=3,a.aPosition1=u++,o.push({name:"aPosition1",index:a.aPosition1,vertexBuffer:s,componentsPerAttribute:3,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:_*A,strideInBytes:_*T,instanceDivisor:1}),A+=3,a.aNormal=u++,o.push({name:"aNormal",index:a.aNormal,vertexBuffer:s,componentsPerAttribute:3,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:_*A,strideInBytes:_*T,instanceDivisor:1}),A+=3,a.batchId=u++,o.push({name:"batchId",index:a.batchId,vertexBuffer:s,componentsPerAttribute:1,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:_*A,strideInBytes:_*T,instanceDivisor:1}),A+=1,a.aVariantStroke=u++,o.push({name:"aVariantStroke",index:a.aVariantStroke,vertexBuffer:s,componentsPerAttribute:1,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:_*A,strideInBytes:_*T,instanceDivisor:1}),A+=1,a.aVariantExtension=u++,o.push({name:"aVariantExtension",index:a.aVariantExtension,vertexBuffer:s,componentsPerAttribute:1,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:_*A,strideInBytes:_*T,instanceDivisor:1}),A+=1}},ue.createSilhouetteEdgeAttributes=function(e,t,n){if(r.e(t.instancesData)&&0!=t.instancesData.length){var i={},a=[];t.attributeLocations=i,t.attributes=a;var o=V.createVertexBuffer({context:e,typedArray:t.instancesData,usage:S.STATIC_DRAW,owner:n});t.instancesData=null;var s=f.ComponentDatatype.getSizeInBytes(f.ComponentDatatype.FLOAT),_=0;i.aSideness=_++,a.push({name:"aSideness",index:i.aSideness,vertexBuffer:Te(e,n),componentsPerAttribute:2,componentDatatype:f.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:2*s,normalize:!1});var E=ue.SilhouetteInstanceStride,u=0;i.aPosition0=_++,a.push({name:"aPosition0",index:i.aPosition0,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*u,strideInBytes:s*E,instanceDivisor:1}),u+=3,i.aPosition1=_++,a.push({name:"aPosition1",index:i.aPosition1,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*u,strideInBytes:s*E,instanceDivisor:1}),u+=3,i.aNormalA=_++,a.push({name:"aNormalA",index:i.aNormalA,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*u,strideInBytes:s*E,instanceDivisor:1}),u+=3,i.aNormalB=_++,a.push({name:"aNormalB",index:i.aNormalB,vertexBuffer:o,componentsPerAttribute:3,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*u,strideInBytes:s*E,instanceDivisor:1}),u+=3,i.batchId=_++,a.push({name:"batchId",index:i.batchId,vertexBuffer:o,componentsPerAttribute:1,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*u,strideInBytes:s*E,instanceDivisor:1}),u+=1,i.aVariantStroke=_++,a.push({name:"aVariantStroke",index:i.aVariantStroke,vertexBuffer:o,componentsPerAttribute:1,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*u,strideInBytes:s*E,instanceDivisor:1}),u+=1,i.aVariantExtension=_++,a.push({name:"aVariantExtension",index:i.aVariantExtension,vertexBuffer:o,componentsPerAttribute:1,componentDatatype:f.ComponentDatatype.FLOAT,normalize:!0,offsetInBytes:s*u,strideInBytes:s*E,instanceDivisor:1}),u+=1}},ue.extractEdgeInformation=function(e,t,n){var i,a=e.attrLocation.aPosition,o=e.vertexAttributes[a],s=r.e(e.nCompressOptions)&&(e.nCompressOptions&d.SVC_Vertex)===d.SVC_Vertex,f=o.componentsPerAttribute;s?(f=3,i=Ae(e,o)):i=new Float32Array(o.typedArray.buffer,o.typedArray.byteOffset,o.typedArray.byteLength/4);var _=i.length/f;if(t&&n)return{faces:n,neighbors:q.computeNeighbors(n,_),vertices:i,dim:f};var E,u=o.typedArray.buffer;E=s?i.buffer:u.slice(o.typedArray.byteOffset,o.typedArray.byteOffset+o.typedArray.byteLength);var T=q.deduplicate(E,f),A=ue.selectIndexData(T.indices,n);return{faces:A,neighbors:q.computeNeighbors(A,T.uniqueCount),vertices:new Float32Array(T.buffer),dim:f}},ue.selectIndexData=function(e,t){if(t){t=t.slice();for(var r=0;r<t.length;r++)t[r]=e[t[r]];return t}return e};var ce=new n.o,ye=new n.o,Re=new n.o,pe=new n.o,he=new n.o,de=new n.o,Ie=new n.o,Oe=new n.o;function Se(e,t){function n(e,t,r){var n=48217*e%2147483647,i=t+n/2147483647*(r-=t);return{seed:n,result:Math.round(i)}}var i=function(e,t){var r=new Float32Array(6),n=new Uint32Array(r.buffer),i=new Uint32Array(1);r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=t.x,r[4]=t.y,r[5]=t.z,i[0]=5381;for(var a=0;a<n.length;a++)i[0]=31*i[0]+n[a];return i[0]}(e,t);r.e(i)||(i=2147483647*Math.random());var a=n(i,0,255);i=a.seed,a.result,i=(a=n(i,0,5)).seed;var o,s=a.result;i=(a={seed:o=48217*i%2147483647,result:o/2147483646}).seed;var f=a.result;return f=-(1-Math.min(f/.7,1))+Math.max(0,f-.7)/(1-.7),{variantStroke:s,variantExtension:f=255*(Math.abs(f)**1.2*(0>f?-1:1)*.5+.5)}}ue.createEdgeDataByIndices=function(e,t){var i,a,o=e.attrLocation.aPosition,s=e.vertexAttributes[o],f=r.e(e.nCompressOptions)&&(e.nCompressOptions&d.SVC_Vertex)===d.SVC_Vertex,_=s.componentsPerAttribute;f?(_=3,i=Ae(e,s)):i=new Float32Array(s.typedArray.buffer,s.typedArray.byteOffset,s.typedArray.byteLength/4);for(var E=[],u=[],T=(a=0===t.indexType?new Uint16Array(t.indicesTypedArray.buffer,t.indicesTypedArray.byteOffset,t.indicesTypedArray.byteLength/2):new Uint32Array(t.indicesTypedArray.buffer,t.indicesTypedArray.byteOffset,t.indicesTypedArray.byteLength/4)).length,A=0,c=0,y=4*Math.floor(T/4);c<y;c+=4){var R=a[c],p=a[c+1],h=a[c+2],I=a[c+3];if(ce.x=i[_*R],ce.y=i[_*R+1],ce.z=i[_*R+2],ye.x=i[_*p],ye.y=i[_*p+1],ye.z=i[_*p+2],Re.x=i[_*h],Re.y=i[_*h+1],Re.z=i[_*h+2],pe.x=i[_*I],pe.y=i[_*I+1],pe.z=i[_*I+2],!(n.o.equals(ye,Re)||n.o.equals(ye,pe)||n.o.equals(ye,ce)||n.o.equals(Re,ce)||n.o.equals(pe,ce))){if(h===I){if(n.o.subtract(ye,ce,he),n.o.subtract(Re,ce,de),n.o.cross(he,de,he),n.o.equals(he,n.o.ZERO))continue;n.o.normalize(he,he),E.push(ce.x),E.push(ce.y),E.push(ce.z),E.push(ye.x),E.push(ye.y),E.push(ye.z),E.push(he.x),E.push(he.y),E.push(he.z),E.push(R);var O=(N=Se(ce,ye)).variantStroke,S=N.variantExtension;E.push(O),E.push(S)}else{if(n.o.subtract(ye,ce,he),n.o.subtract(Re,ce,de),n.o.cross(he,de,he),n.o.equals(he,n.o.ZERO)||(n.o.normalize(he,he),n.o.subtract(ye,ce,Ie),n.o.subtract(pe,ce,Oe),n.o.cross(Oe,Ie,Ie),n.o.equals(Ie,n.o.ZERO)))continue;n.o.normalize(Ie,Ie),u.push(ce.x),u.push(ce.y),u.push(ce.z),u.push(ye.x),u.push(ye.y),u.push(ye.z),u.push(he.x),u.push(he.y),u.push(he.z),u.push(Ie.x),u.push(Ie.y),u.push(Ie.z),u.push(R);var N;O=(N=Se(ce,ye)).variantStroke,S=N.variantExtension;u.push(O),u.push(S)}A+=n.o.distance(ce,ye)}}var l=A/(T/4),D=E.length/ue.RegularInstanceStride,L=u.length/ue.SilhouetteInstanceStride;return{regular:{instancesData:new Float32Array(E),instanceCount:D,edgeLength:D*l},silhouette:{instancesData:new Float32Array(u),instanceCount:L,edgeLength:L},averageEdgeLength:l}},e.L=u,e.S3MCompressType=R,e.VertexCompressOption=d,e._0x581ba9=ue}));
