import{a as c}from"./chunk-J67OD5PY.js";import{a as N}from"./chunk-D45ASFTR.js";import{j as D}from"./chunk-CJHFPVIB.js";import{a as E}from"./chunk-SSYG2MIY.js";import{b as O}from"./chunk-3HZNWEV7.js";import{a as q}from"./chunk-LBR6REQR.js";import{a as m}from"./chunk-GXFCHGTA.js";import{a as p}from"./chunk-NUC3LT2W.js";var I={};function x(e,r){return m.equalsEpsilon(e.latitude,r.latitude,m.EPSILON10)&&m.equalsEpsilon(e.longitude,r.longitude,m.EPSILON10)}var M=new O,R=new O;function U(e,r,o,a){r=N(r,q.equalsEpsilon);var h=r.length;if(!(h<2)){var b=p(a),y=p(o),v=!0,A=new Array(h),u=new Array(h),f=new Array(h),w=r[0];A[0]=w;var l=e.cartesianToCartographic(w,M);y&&(l.height=o[0]),v=v&&l.height==0,u[0]=l.height,b?f[0]=a[0]:f[0]=0;for(var t=1,s=1;s<h;++s){var d=r[s],g=e.cartesianToCartographic(d,R);y&&(g.height=o[s]),v=v&&g.height==0,x(l,g)?l.height<g.height&&(u[t-1]=g.height):(A[t]=d,u[t]=g.height,b?f[t]=a[s]:f[t]=0,O.clone(g,l),++t)}if(!(v||t<2))return A.length=t,u.length=t,f.length=t,{positions:A,topHeights:u,bottomHeights:f}}}var z=new Array(2),G=new Array(2),W={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};I.computePositions=function(e,r,o,a,h,b,y){var v=U(e,r,o,a);if(!!p(v)){var A=D.eastNorthUpToFixedFrame(v.positions[0],e,new E),u=E.inverse(A,new E);r=v.positions,o=v.topHeights,a=v.bottomHeights;var f=r.length,w=f-2,l,t,s,d,g=m.chordLength(h,e.maximumRadius),n=W;if(n.minDistance=g,n.ellipsoid=e,b){var F=0,i;for(i=0;i<f-1;i++)F+=c.numberOfPoints(r[i],r[i+1],g)+1;l=new Float64Array(F*3),t=new Float64Array(F*3),p(y)&&(s=new Float64Array(F*3),d=new Float64Array(F*3));var L=z,P=G;n.positions=L,n.height=P;var T=0;for(i=0;i<f-1;i++){L[0]=r[i],L[1]=r[i+1],P[0]=o[i],P[1]=o[i+1];var S=c.generateArc(n);l.set(S,T),p(y)&&s.set(C(S,u),T),P[0]=a[i],P[1]=a[i+1],t.set(c.generateArc(n),T),p(y)&&d.set(C(c.generateArc(n),u),T),T+=S.length}}else n.positions=r,n.height=o,l=new Float64Array(c.generateArc(n)),p(y)&&(s=new Float64Array(C(c.generateArc(n)))),n.height=a,t=new Float64Array(c.generateArc(n)),p(y)&&(d=new Float64Array(C(c.generateArc(n))));var B={pos:{bottomPositions:t,topPositions:l,numCorners:w}};return p(y)&&(B.localPos={bottomPositions:d,topPositions:s,numCorners:w}),B}};function C(e,r){for(var o=new Array(e.length),a=0;a<e.length;a+=3){var h=new q(e[a],e[a+1],e[a+2]);E.multiplyByPoint(r,h,h),o[a]=h.x,o[a+1]=h.y,o[a+2]=h.z}return o}var _=I;export{_ as a};
