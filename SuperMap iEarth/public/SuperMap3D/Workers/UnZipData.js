define(["./createTaskProcessorWorker","./pako_inflate-e5e032ee","./CompressedTextureBuffer-58c71280","./defaultValue-2110bb17","./PixelFormat-e54716df","./RuntimeError-6daf0e01","./S3MPixelFormat-6885e30a","./WebGLConstants-92042d9e"],(function(e,r,t,n,a,i,f,E){"use strict";var u,o,_=1,s=2,l={};l[0]=a.PixelFormat.RGB_DXT1,l[_]=a.PixelFormat.RGBA_DXT3,l[s]=a.PixelFormat.RGBA_DXT5;var c,y=0;function T(e){var r=e.data,f=r.byteLength,E=new Uint8Array(r,e.offset),_=c._malloc(f);!function(e,r,t,n){var a,i=t/4,f=n%4,E=new Uint32Array(e.buffer,0,(n-f)/4),u=new Uint32Array(r.buffer);for(a=0;a<E.length;a++)u[i+a]=E[a];for(a=n-f;a<n;a++)r[t+a]=e[a]}(E,c.HEAPU8,_,f);var s=c._crn_get_dxt_format(_,f),T=l[s];if(!n.e(T))throw new i.t("Unsupported compressed format.");var U,m=c._crn_get_levels(_,f),A=c._crn_get_width(_,f),p=c._crn_get_height(_,f),B=0;for(U=0;U<m;++U)B+=a.PixelFormat.compressedTextureSizeInBytes(T,A>>U,p>>U);if(y<B&&(n.e(u)&&c._free(u),u=c._malloc(B),o=new Uint8Array(c.HEAPU8.buffer,u,B),y=B),c._crn_decompress(_,f,u,B,0,m),c._free(_),n.u(e.bMipMap,!1)){var P=o.slice(0,B);return new t.e(T,A,p,P)}var d=a.PixelFormat.compressedTextureSizeInBytes(T,A,p),g=o.subarray(0,d),w=new Uint8Array(d);return w.set(g,0),new t.e(T,A,p,w)}function U(e){var r=new DataView(e),t=0,n=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var a=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var i=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var f=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var E=r.getUint32(t,!0);t+=Uint32Array.BYTES_PER_ELEMENT;var u=T({data:e.slice(t,t+E)}).bufferView,o=new ArrayBuffer(t+u.byteLength),_=new Uint8Array(o),s=new Uint32Array(o);return t=0,s[0]=n,t+=Uint32Array.BYTES_PER_ELEMENT,s[1]=a,t+=Uint32Array.BYTES_PER_ELEMENT,s[2]=i,t+=Uint32Array.BYTES_PER_ELEMENT,s[3]=f,t+=Uint32Array.BYTES_PER_ELEMENT,s[4]=u.byteLength,t+=Uint32Array.BYTES_PER_ELEMENT,_.set(u,t),o}function m(e,t){for(var n=e.data,a=[],i=0;i<n.length;i++){var E,u=n[i];try{var o=new Uint8Array(u.zipBuffer);E=r.pako.inflate(o).buffer,new DataView(E).getUint32(0,!0)===f.S3MPixelFormat.CRN_DXT5&&(E=U(E)),t.push(E),a.push({unzipBuffer:E,name:u.name})}catch(r){u.unzipLength===u.zippedLength&&(E=u.zipBuffer.buffer,e.isCRN&&(E=U(E)),t.push(E),a.push({unzipBuffer:E,name:u.name}));continue}}return{data:a}}function A(){self.onmessage=e(m),self.postMessage(!0)}return function(e){var r=e.data.webAssemblyConfig;if(n.e(r))return require([r.modulePath],(function(e){n.e(r.wasmBinaryFile)?(n.e(e)||(e=self.Module),c=e,A()):(c=e,A())}))}}));
