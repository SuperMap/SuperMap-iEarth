import{a as N}from"./chunk-X3VIQ4EU.js";import{a as $}from"./chunk-NRJCFN72.js";import"./chunk-J67OD5PY.js";import"./chunk-XYWAVEQ2.js";import{a as Q,b as X}from"./chunk-MPSLJKIO.js";import"./chunk-HOZ5IOFP.js";import{b as Z}from"./chunk-ZMHH4UFY.js";import{a as ae}from"./chunk-D45ASFTR.js";import"./chunk-6X6ULKRC.js";import"./chunk-REXJO6A6.js";import"./chunk-EUSYH4JF.js";import{a as j}from"./chunk-44AFRGCG.js";import{a as ne}from"./chunk-UIA2BV6O.js";import{d as ie,k as oe,l as K}from"./chunk-CJHFPVIB.js";import"./chunk-NPAFDOYL.js";import{b as re}from"./chunk-SSYG2MIY.js";import{a as W}from"./chunk-SRPTWKHW.js";import"./chunk-6S43R6PL.js";import"./chunk-Z4SOZDEW.js";import"./chunk-MX7ZM7WW.js";import"./chunk-EHDXVZQM.js";import"./chunk-NLYLRNUA.js";import{b as E}from"./chunk-7TOCOFC3.js";import"./chunk-ZVKIUA3Y.js";import"./chunk-3HZNWEV7.js";import{a as g}from"./chunk-LBR6REQR.js";import{a as O}from"./chunk-GXFCHGTA.js";import{a as L}from"./chunk-UBHQMGET.js";import{a as F}from"./chunk-EDZQSM3T.js";import"./chunk-PJGSCWXZ.js";import{a as D}from"./chunk-NUC3LT2W.js";import"./chunk-SFC4FDPW.js";var he=new g,fe=new g,ue=new g;function de(e,i){for(var t=0;t<e.length;t++)e[t]=i.scaleToGeodeticSurface(e[t],e[t]);return e}function se(e,i){var t=[],a=e.positions,p=e.corners,v=e.endPositions,H=new ne,_,d=0,u=0,r,m=0,h;for(r=0;r<a.length;r+=2)h=a[r].length-3,d+=h,m+=h/3*4,u+=a[r+1].length-3;for(d+=3,u+=3,r=0;r<p.length;r++){_=p[r];var P=p[r].leftPositions;D(P)?(h=P.length,d+=h,m+=h/3*2):(h=p[r].rightPositions.length,u+=h,m+=h/3*2)}var C=D(v),l;C&&(l=v[0].length-3,d+=l,u+=l,l/=3,m+=l*4);var M=d+u,c=new Float64Array(M),o=0,n=M-1,y,w,b,T,S,U,Y=l/2,f=j.createTypedArray(M/3,m+4),s=0;if(f[s++]=o/3,f[s++]=(n-2)/3,C){t.push(o/3),U=he,S=fe;var ee=v[0];for(r=0;r<Y;r++)U=g.fromArray(ee,(Y-1-r)*3,U),S=g.fromArray(ee,(Y+r)*3,S),N.addAttribute(c,S,o),N.addAttribute(c,U,void 0,n),w=o/3,T=w+1,y=(n-2)/3,b=y-1,f[s++]=y,f[s++]=b,f[s++]=w,f[s++]=T,o+=3,n-=3}var q=0,z=a[q++],k=a[q++];for(c.set(z,o),c.set(k,n-k.length+1),h=k.length-3,t.push(o/3,(n-2)/3),r=0;r<h;r+=3)w=o/3,T=w+1,y=(n-2)/3,b=y-1,f[s++]=y,f[s++]=b,f[s++]=w,f[s++]=T,o+=3,n-=3;for(r=0;r<p.length;r++){var A;_=p[r];var J=_.leftPositions,x=_.rightPositions,R,G=ue;if(D(J)){for(n-=3,R=b,t.push(T),A=0;A<J.length/3;A++)G=g.fromArray(J,A*3,G),f[s++]=R-A-1,f[s++]=R-A,N.addAttribute(c,G,void 0,n),n-=3;t.push(R-Math.floor(J.length/6)),i===$.BEVELED&&t.push((n-2)/3+1),o+=3}else{for(o+=3,R=T,t.push(b),A=0;A<x.length/3;A++)G=g.fromArray(x,A*3,G),f[s++]=R+A,f[s++]=R+A+1,N.addAttribute(c,G,o),o+=3;t.push(R+Math.floor(x.length/6)),i===$.BEVELED&&t.push(o/3-1),n-=3}for(z=a[q++],k=a[q++],z.splice(0,3),k.splice(k.length-3,3),c.set(z,o),c.set(k,n-k.length+1),h=k.length-3,A=0;A<k.length;A+=3)T=o/3,w=T-1,b=(n-2)/3,y=b+1,f[s++]=y,f[s++]=b,f[s++]=w,f[s++]=T,o+=3,n-=3;o-=3,n+=3,t.push(o/3,(n-2)/3)}if(C){o+=3,n-=3,U=he,S=fe;var te=v[1];for(r=0;r<Y;r++)U=g.fromArray(te,(l-r-1)*3,U),S=g.fromArray(te,r*3,S),N.addAttribute(c,U,void 0,n),N.addAttribute(c,S,o),T=o/3,w=T-1,b=(n-2)/3,y=b+1,f[s++]=y,f[s++]=b,f[s++]=w,f[s++]=T,o+=3,n-=3;t.push(o/3)}else t.push(o/3,(n-2)/3);return f[s++]=o/3,f[s++]=(n-2)/3,H.position=new K({componentDatatype:W.DOUBLE,componentsPerAttribute:3,values:c}),{attributes:H,indices:f,wallIndices:t}}function le(e){var i=e.ellipsoid,t=N.computePositions(e),a=se(t,e.cornerType),p=a.wallIndices,v=e.height,H=e.extrudedHeight,_=a.attributes,d=a.indices,u=_.position.values,r=u.length,m=new Float64Array(r);m.set(u);var h=new Float64Array(r*2);if(u=Z.scaleToGeodeticHeight(u,v,i),m=Z.scaleToGeodeticHeight(m,H,i),h.set(u),h.set(m,r),_.position.values=h,r/=3,D(e.offsetAttribute)){var P=new Uint8Array(r*2);if(e.offsetAttribute===X.TOP)P=Q(P,1,0,r);else{var C=e.offsetAttribute===X.NONE?0:1;P=Q(P,C)}_.applyOffset=new K({componentDatatype:W.UNSIGNED_BYTE,componentsPerAttribute:1,values:P})}var l,M=d.length,c=j.createTypedArray(h.length/3,(M+p.length)*2);c.set(d);var o=M;for(l=0;l<M;l+=2){var n=d[l],y=d[l+1];c[o++]=n+r,c[o++]=y+r}var w,b;for(l=0;l<p.length;l++)w=p[l],b=w+r,c[o++]=w,c[o++]=b;return{attributes:_,indices:c}}function V(e){e=L(e,L.EMPTY_OBJECT);var i=e.positions,t=e.width;F.typeOf.object("options.positions",i),F.typeOf.number("options.width",t);var a=L(e.height,0),p=L(e.extrudedHeight,a);this._positions=i,this._ellipsoid=E.clone(L(e.ellipsoid,E.WGS84)),this._width=t,this._height=Math.max(a,p),this._extrudedHeight=Math.min(a,p),this._cornerType=L(e.cornerType,$.ROUNDED),this._granularity=L(e.granularity,O.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+i.length*g.packedLength+E.packedLength+6}V.pack=function(e,i,t){F.typeOf.object("value",e),F.typeOf.object("array",i),t=L(t,0);var a=e._positions,p=a.length;i[t++]=p;for(var v=0;v<p;++v,t+=g.packedLength)g.pack(a[v],i,t);return E.pack(e._ellipsoid,i,t),t+=E.packedLength,i[t++]=e._width,i[t++]=e._height,i[t++]=e._extrudedHeight,i[t++]=e._cornerType,i[t++]=e._granularity,i[t]=L(e._offsetAttribute,-1),i};var pe=E.clone(E.UNIT_SPHERE),B={positions:void 0,ellipsoid:pe,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};V.unpack=function(e,i,t){F.typeOf.object("array",e),i=L(i,0);for(var a=e[i++],p=new Array(a),v=0;v<a;++v,i+=g.packedLength)p[v]=g.unpack(e,i);var H=E.unpack(e,i,pe);i+=E.packedLength;var _=e[i++],d=e[i++],u=e[i++],r=e[i++],m=e[i++],h=e[i];return D(t)?(t._positions=p,t._ellipsoid=E.clone(H,t._ellipsoid),t._width=_,t._height=d,t._extrudedHeight=u,t._cornerType=r,t._granularity=m,t._offsetAttribute=h===-1?void 0:h,t):(B.positions=p,B.width=_,B.height=d,B.extrudedHeight=u,B.cornerType=r,B.granularity=m,B.offsetAttribute=h===-1?void 0:h,new V(B))};V.createGeometry=function(e){var i=e._positions,t=e._width,a=e._ellipsoid;i=de(i,a);var p=ae(i,g.equalsEpsilon);if(!(p.length<2||t<=0)){var v=e._height,H=e._extrudedHeight,_=!O.equalsEpsilon(v,H,0,O.EPSILON2),d={ellipsoid:a,positions:p,width:t,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1},u;if(_)d.height=v,d.extrudedHeight=H,d.offsetAttribute=e._offsetAttribute,u=le(d);else{var r=N.computePositions(d);if(u=se(r,d.cornerType),u.attributes.position.values=Z.scaleToGeodeticHeight(u.attributes.position.values,v,a),D(e._offsetAttribute)){var m=u.attributes.position.values.length,h=new Uint8Array(m/3),P=e._offsetAttribute===X.NONE?0:1;Q(h,P),u.attributes.applyOffset=new K({componentDatatype:W.UNSIGNED_BYTE,componentsPerAttribute:1,values:h})}}var C=u.attributes,l=ie.fromVertices(C.position.values,void 0,3);return new oe({attributes:C,indices:u.indices,primitiveType:re.LINES,boundingSphere:l,offsetAttribute:e._offsetAttribute})}};var I=V;function ve(e,i){return D(i)&&(e=I.unpack(e,i)),e._ellipsoid=E.clone(e._ellipsoid),I.createGeometry(e)}var Fe=ve;export{Fe as default};
